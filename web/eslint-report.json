[{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\App.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'Project' is defined but never used.","line":36,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":15},{"ruleId":"no-unused-vars","severity":1,"message":"'DrafterPortalPage' is defined but never used.","line":51,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":51,"endColumn":25},{"ruleId":"no-unused-vars","severity":1,"message":"'DevPanel' is defined but never used.","line":62,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":62,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from 'react';\nimport { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';\nimport { ToastContainer } from 'react-toastify';\nimport { io } from 'socket.io-client';\n\n// PWA Components\nimport { useServiceWorker } from './hooks/useServiceWorker';\n// import { useKeyboardShortcuts } from './hooks/useKeyboardShortcuts'; // TODO: Move inside Router\nimport { useStandaloneMode } from './hooks/useStandaloneMode';\nimport ErrorBoundary from './components/common/ErrorBoundary';\nimport PWAInstallPrompt from './components/common/PWAInstallPrompt';\nimport PWAUpdateModal from './components/common/UpdateModal';\nimport AppUpdateModal from './components/ui/UpdateModal';\nimport { BUILD_SIZE } from './config/version';\n\n// Analytics\nimport { analytics } from './services/analyticsService';\n\n// Components\nimport Login from './components/Login';\nimport ForgotPassword from './components/ForgotPassword';\nimport RecoverCredentials from './components/RecoverCredentials';\nimport ResetPassword from './components/ResetPassword';\nimport Logout from './components/Logout';\n\n// Pages\nimport Dashboard from './pages/Dashboard';\nimport Home from './pages/Home';\nimport Account from './pages/Account';\nimport Companies from './pages/Companies';\nimport CreateTicket from './pages/CreateTicket';\nimport ExistingProjects from './pages/ExistingProjects';\nimport Inventory from './pages/Inventory';\nimport PhotoGallery from './pages/PhotoGallery';\nimport PreferredEquipment from './pages/PreferredEquipment';\nimport Project from './pages/Project';\nimport ServiceTerritory from './pages/ServiceTerritory';\nimport Support from './pages/Support';\n\n// Auth Pages\nimport Register from './pages/Auth/Register';\nimport RegistrationSuccess from './pages/Auth/RegistrationSuccess';\nimport RedeemInvite from './pages/Auth/RedeemInvite';\n\n// Portal Pages\nimport SalesPortal from './pages/SalesPortal';\nimport DesignPortal from './pages/DesignPortal';\nimport PermittingPortal from './pages/PermittingPortal';\nimport InstallPortal from './pages/InstallPortal';\nimport SchedulingPortal from './pages/SchedulingPortal';\nimport DrafterPortalPage from './pages/DrafterPortalPage';\n\n// Drafter Portal\nimport DrafterDashboard from './pages/DrafterPortal/DrafterDashboard';\nimport DrafterWorkspace from './pages/DrafterPortal/DrafterWorkspace';\nimport AdminDrafterQueue from './pages/DrafterPortal/AdminDrafterQueue';\n\n// Admin Pages\nimport PendingRegistrations from './pages/Admin/PendingRegistrations';\n\n// Dev Tools\nimport DevPanel from './components/dev/DevPanel';\n\nfunction App() {\n  const { updateAvailable, applyUpdate, dismissUpdate } = useServiceWorker();\n  const [showUpdateModal, setShowUpdateModal] = useState(false);\n\n  // Premium Desktop PWA Features\n  const { isStandalone, displayMode } = useStandaloneMode();\n\n  // TODO: Move keyboard shortcuts inside Router context\n  // Keyboard shortcuts require Router context (useNavigate hook)\n  // const shortcuts = useKeyboardShortcuts({\n  //   onSearch: () => {\n  //     console.log('[App] Search shortcut triggered (Cmd/Ctrl+K)');\n  //   },\n  //   onEscape: () => {\n  //     setShowUpdateModal(false);\n  //   }\n  // });\n\n  // Set PWA mode class\n  useEffect(() => {\n    if (isStandalone) {\n      document.body.classList.add('pwa-standalone');\n    } else {\n      document.body.classList.remove('pwa-standalone');\n    }\n  }, [displayMode, isStandalone]);\n\n  // Initialize analytics\n  useEffect(() => {\n    analytics.init().catch((error) => {\n      console.error('[App] Analytics initialization failed:', error);\n    });\n\n    // End session on app unload\n    const handleBeforeUnload = () => {\n      analytics.endSession();\n    };\n\n    window.addEventListener('beforeunload', handleBeforeUnload);\n\n    return () => {\n      window.removeEventListener('beforeunload', handleBeforeUnload);\n    };\n  }, []);\n\n  // Listen for backend-triggered app updates\n  useEffect(() => {\n    const socket = io(process.env.REACT_APP_API_URL || 'https://api.skyfireapp.io', {\n      transports: ['websocket', 'polling'],\n      reconnection: true,\n      reconnectionAttempts: 5,        // Max 5 attempts\n      reconnectionDelay: 1000,        // Start with 1 second\n      reconnectionDelayMax: 30000,    // Max 30 seconds between attempts\n      timeout: 20000,\n      autoConnect: false,             // Don't auto-connect immediately\n    });\n\n    // Only connect if user is authenticated\n    const userData = sessionStorage.getItem('userData');\n    if (userData) {\n      socket.connect();\n    }\n\n    socket.on('app:update', ({ version }) => {\n      setShowUpdateModal(true);\n    });\n\n    // Suppress error spam in console\n    socket.on('connect_error', (error) => {\n      // Only log in development, suppress in production\n      if (process.env.NODE_ENV === 'development') {\n        console.warn('[Socket] Connection error (will retry):', error.message);\n      }\n    });\n\n    return () => socket.disconnect();\n  }, []);\n\n  return (\n    <ErrorBoundary>\n      <Router future={{ v7_startTransition: true, v7_relativeSplatPath: true }}>\n        <div className=\"App\">\n          <ToastContainer\n            position=\"top-right\"\n            autoClose={5000}\n            hideProgressBar={false}\n            newestOnTop\n            closeOnClick\n            rtl={false}\n            pauseOnFocusLoss\n            draggable\n            pauseOnHover\n            theme=\"dark\"\n            limit={5}\n          />\n          {/* <DevPanel /> */}\n          <Routes>\n          {/* Auth Routes */}\n          <Route path=\"/\" element={<Navigate to=\"/login\" replace />} />\n          <Route path=\"/login\" element={<Login />} />\n          <Route path=\"/register\" element={<Register />} />\n          <Route path=\"/forgot-password\" element={<ForgotPassword />} />\n          <Route path=\"/recover-credentials\" element={<RecoverCredentials />} />\n          <Route path=\"/reset-password\" element={<ResetPassword />} />\n          <Route path=\"/logout\" element={<Logout />} />\n\n          {/* Registration Routes - PUBLIC (no auth required) */}\n          <Route path=\"/registration-success\" element={<RegistrationSuccess />} />\n          <Route path=\"/redeem-invite\" element={<RedeemInvite />} />\n\n          {/* Dashboard Routes */}\n          <Route path=\"/dashboard\" element={<Dashboard />} />\n          <Route path=\"/home\" element={<Home />} />\n          <Route path=\"/account\" element={<Account />} />\n          <Route path=\"/companies\" element={<Companies />} />\n          <Route path=\"/create-ticket\" element={<CreateTicket />} />\n          <Route path=\"/existing-projects\" element={<ExistingProjects />} />\n          <Route path=\"/inventory\" element={<Inventory />} />\n          <Route path=\"/photo-gallery\" element={<PhotoGallery />} />\n          <Route path=\"/preferred-equipment\" element={<PreferredEquipment />} />\n          <Route path=\"/project/:projectUuid\" element={<DesignPortal />} />\n          <Route path=\"/service-territory\" element={<ServiceTerritory />} />\n          <Route path=\"/support\" element={<Support />} />\n          <Route path=\"/scheduling\" element={<SchedulingPortal />} />\n\n          {/* Portal Routes */}\n          <Route path=\"/project/:projectUuid/sales\" element={<SalesPortal />} />\n          <Route path=\"/project/:projectUuid/design\" element={<DesignPortal />} />\n          <Route path=\"/project/:projectUuid/permitting\" element={<PermittingPortal />} />\n          <Route path=\"/project/:projectUuid/install\" element={<InstallPortal />} />\n\n          {/* Drafter Portal */}\n          <Route path=\"/drafter-portal\" element={<DrafterDashboard />} />\n          <Route path=\"/drafter-portal/workspace/:uuid\" element={<DrafterWorkspace />} />\n          <Route path=\"/admin/drafter-queue\" element={<AdminDrafterQueue />} />\n          <Route path=\"/drafterportal\" element={<Navigate to=\"/drafter-portal\" replace />} />\n\n          {/* Admin Routes */}\n          <Route path=\"/admin/pending-registrations\" element={<PendingRegistrations />} />\n        </Routes>\n\n        {/* PWA Components - render at root level */}\n        <PWAInstallPrompt />\n        <PWAUpdateModal\n          visible={updateAvailable}\n          onUpdate={applyUpdate}\n          onDismiss={dismissUpdate}\n          updateSize={BUILD_SIZE}\n        />\n\n        {/* Backend-triggered update modal */}\n        <AppUpdateModal\n          isOpen={showUpdateModal}\n          onClose={() => setShowUpdateModal(false)}\n        />\n      </div>\n    </Router>\n    </ErrorBoundary>\n  );\n}\n\nexport default App;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\Admin\\CustomerInvitation.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\Admin\\InviteCustomerModal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ForgotPassword.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\Login.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\Logout.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\OTPModal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\RecoverCredentials.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'showModal' is assigned a value but never used.","line":14,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'email' is assigned a value but never used.","line":15,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":15},{"ruleId":"no-unused-vars","severity":1,"message":"'navigate' is assigned a value but never used.","line":16,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useFormik } from 'formik';\nimport * as Yup from 'yup';\nimport { toast } from 'react-toastify';\nimport { Container, Row, Col, Form, Label } from 'reactstrap';\nimport axios from 'axios';\n\n// Reusable UI Components\nimport { FormInput, Button } from './ui';\n\nconst RecoverCredentials = () => {\n  const [loading, setLoading] = useState(false);\n  const [showModal, setShowModal] = useState(false);\n  const [email, setEmail] = useState('');\n  const navigate = useNavigate();\n\n  // Email recovery form\n  const emailValidation = useFormik({\n    initialValues: {\n      email: '',\n    },\n    validationSchema: Yup.object({\n      email: Yup.string().email('Invalid email').required('Please enter your email'),\n    }),\n    onSubmit: async (values) => {\n      setLoading(true);\n      try {\n        await axios.post('/api/auth/recover-password', { email: values.email });\n        setEmail(values.email);\n        setShowModal(true);\n        toast('Recovery code sent to your email!', {\n          position: 'top-right',\n          hideProgressBar: true,\n          closeOnClick: false,\n          className: 'bg-success text-white',\n        });\n        setLoading(false);\n      } catch (error) {\n        setLoading(false);\n        toast('Error sending recovery code. Please try again.', {\n          position: 'top-right',\n          hideProgressBar: true,\n          closeOnClick: false,\n          className: 'bg-danger text-white',\n        });\n      }\n    },\n  });\n\n  // Phone lookup form\n  const phoneValidation = useFormik({\n    initialValues: {\n      phoneNo: '',\n    },\n    validationSchema: Yup.object({\n      phoneNo: Yup.string().required('Please Enter Your Phone No'),\n    }),\n    onSubmit: async (values) => {\n      try {\n        const response = await axios.post('/api/auth/lookup-email', {\n          phoneNo: values.phoneNo,\n        });\n        toast(`Your email is: ${response.data.email}`, {\n          position: 'top-right',\n          hideProgressBar: true,\n          closeOnClick: false,\n          className: 'bg-success text-white',\n        });\n      } catch (error) {\n        toast('No account found with this phone number', {\n          position: 'top-right',\n          hideProgressBar: true,\n          closeOnClick: false,\n          className: 'bg-danger text-white',\n        });\n      }\n    },\n  });\n\n  return (\n    <>\n      <div className=\"recover-cred-page-wrapper auth-bg-cover d-flex justify-content-center align-items-center min-vh-100\">\n        <div className=\"recover-cred-page-content overflow-hidden\">\n          <Container className=\"overflow-hidden h-100\">\n            <Row className=\"g-0 h-100\">\n              {/* Left Content */}\n              <Col sm={6} className=\"h-100\">\n                <div className=\"p-lg-5 recover-cred-page-wrapper--left-content\">\n                  <div className=\"recover-cred-page-wrapper--left-content-wraper\">\n                    <div className=\"py-2\">\n                      <h5 className=\"text-white\">Recover Credentials</h5>\n                    </div>\n                    <div className=\"mt-4\">\n                      {/* Forgot Email Section */}\n                      <div className=\"mb-3\">\n                        <p className=\"text-white py-4\">Forgot Email?</p>\n                        <Form\n                          onSubmit={(e) => {\n                            e.preventDefault();\n                            phoneValidation.handleSubmit();\n                            return false;\n                          }}\n                          action=\"#\"\n                        >\n                          <Row className=\"d-flex align-items-center\">\n                            <Col lg={9} md={9} sm={12}>\n                              <Label htmlFor=\"phoneNo\" className=\"form-label text-white\">\n                                Lookup with phone number Ex:(###) ###-####\n                              </Label>\n                              <FormInput\n                                type=\"text\"\n                                id=\"phoneNo\"\n                                name=\"phoneNo\"\n                                onChange={phoneValidation.handleChange}\n                                onBlur={phoneValidation.handleBlur}\n                                value={phoneValidation.values.phoneNo || ''}\n                                error={phoneValidation.touched.phoneNo && phoneValidation.errors.phoneNo}\n                                hint=\"This Phone Number Associated with your account\"\n                                size=\"md\"\n                              />\n                            </Col>\n                            <Col lg={3} md={3} sm={12}>\n                              <Button variant=\"primary\" fullWidth type=\"submit\">\n                                Look Up\n                              </Button>\n                            </Col>\n                          </Row>\n                        </Form>\n                      </div>\n\n                      {/* Forgot Password Section */}\n                      <div className=\"mb-3\">\n                        <p className=\"text-white py-4\">Forgot Password?</p>\n                        <Form\n                          onSubmit={(e) => {\n                            e.preventDefault();\n                            emailValidation.handleSubmit();\n                            return false;\n                          }}\n                          action=\"#\"\n                        >\n                          <Row className=\"d-flex align-items-center\">\n                            <Col lg={9} md={9} sm={12}>\n                              <Label htmlFor=\"email\" className=\"form-label text-white\">\n                                Recover with your email\n                              </Label>\n                              <FormInput\n                                type=\"text\"\n                                id=\"email\"\n                                name=\"email\"\n                                onChange={emailValidation.handleChange}\n                                onBlur={emailValidation.handleBlur}\n                                value={emailValidation.values.email || ''}\n                                error={emailValidation.touched.email && emailValidation.errors.email}\n                                hint=\"This Email Associated with your account\"\n                                size=\"md\"\n                              />\n                            </Col>\n                            <Col lg={3} md={3} sm={12}>\n                              <Button\n                                variant=\"primary\"\n                                fullWidth\n                                type=\"submit\"\n                                loading={loading}\n                              >\n                                Send Code\n                              </Button>\n                            </Col>\n                          </Row>\n                        </Form>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </Col>\n\n              {/* Right Content */}\n              <Col sm={6} className=\"h-100\">\n                <div className=\"recover-cred-page-wrapper--right-content\">\n                  <div className=\"recover-cred-page-wrapper--right-content--top-div\">\n                    <img src=\"/logo.png\" alt=\"\" className=\"logo\" />\n                  </div>\n                  <div className=\"recover-cred-page-wrapper--right-content--bottom-div\"></div>\n                </div>\n              </Col>\n            </Row>\n          </Container>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default RecoverCredentials;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ResetPassword.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\Team\\AddUserModal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\Team\\RoleSelector.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\Team\\TeamSuggestionCard.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\account\\ChangePasswordModal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\account\\CompanyLogoUpload.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\account\\KeyboardShortcutsPanel.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\account\\ProfileSection.js","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadProfile'. Either include it or remove the dependency array.","line":29,"column":6,"nodeType":"ArrayExpression","endLine":29,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [loadProfile]","fix":{"range":[922,924],"text":"[loadProfile]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport FormSection from '../ui/FormSection';\nimport FormInput from '../ui/FormInput';\nimport Button from '../ui/Button';\nimport CompanyLogoUpload from './CompanyLogoUpload';\nimport { getUserProfile, updateUserProfile, uploadCompanyLogo, removeCompanyLogo } from '../../services/accountAPI';\nimport styles from './ProfileSection.module.css';\n\n/**\n * ProfileSection - User profile editing form\n * Includes company logo, name, email, phone, display name, account details\n */\nconst ProfileSection = ({ onSuccess, onError }) => {\n  const [loading, setLoading] = useState(false);\n  const [saving, setSaving] = useState(false);\n  const [formData, setFormData] = useState({\n    firstName: '',\n    lastName: '',\n    email: '',\n    phone: '',\n    displayName: '',\n    companyLogo: null,\n    createdAt: null,\n    updatedAt: null,\n  });\n\n  useEffect(() => {\n    loadProfile();\n  }, []);\n\n  const loadProfile = async () => {\n    try {\n      setLoading(true);\n      const response = await getUserProfile();\n      const profile = response.data || response; // Handle both wrapped and unwrapped responses\n\n      console.log('[ProfileSection] Loaded profile:', profile);\n\n      setFormData({\n        firstName: profile.first_name || profile.firstName || '',\n        lastName: profile.last_name || profile.lastName || '',\n        email: profile.email || '',\n        phone: profile.phone || '',\n        displayName: profile.display_name || profile.displayName || '',\n        companyLogo: profile.company_logo || profile.companyLogo || null,\n        createdAt: profile.created_at || profile.createdAt || null,\n        updatedAt: profile.updated_at || profile.updatedAt || null,\n      });\n    } catch (error) {\n      console.error('[ProfileSection] Failed to load profile:', error);\n      if (onError) onError(error.message || 'Failed to load profile');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleChange = (field, value) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n  };\n\n  const formatDate = (dateString) => {\n    if (!dateString) return 'N/A';\n    try {\n      return new Date(dateString).toLocaleDateString('en-US', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric'\n      });\n    } catch (error) {\n      return 'N/A';\n    }\n  };\n\n  const handleLogoUpload = async (formDataFile) => {\n    try {\n      const result = await uploadCompanyLogo(formDataFile);\n      setFormData(prev => ({ ...prev, companyLogo: result.logo_url }));\n      if (onSuccess) onSuccess('Logo uploaded successfully');\n    } catch (error) {\n      console.error('Failed to upload logo:', error);\n      if (onError) onError('Failed to upload logo');\n    }\n  };\n\n  const handleLogoRemove = async () => {\n    try {\n      await removeCompanyLogo();\n      setFormData(prev => ({ ...prev, companyLogo: null }));\n      if (onSuccess) onSuccess('Logo removed successfully');\n    } catch (error) {\n      console.error('Failed to remove logo:', error);\n      if (onError) onError('Failed to remove logo');\n    }\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    try {\n      setSaving(true);\n      const response = await updateUserProfile({\n        firstName: formData.firstName,\n        lastName: formData.lastName,\n        email: formData.email,\n        phone: formData.phone,\n        displayName: formData.displayName,\n      });\n\n      console.log('[ProfileSection] Profile updated:', response);\n\n      // Update sessionStorage userData after successful save\n      const storedUserData = sessionStorage.getItem('userData');\n      if (storedUserData) {\n        try {\n          const userData = JSON.parse(storedUserData);\n          const updatedUserData = {\n            ...userData,\n            firstName: formData.firstName,\n            lastName: formData.lastName,\n            email: formData.email,\n            phone: formData.phone,\n            displayName: formData.displayName,\n          };\n          sessionStorage.setItem('userData', JSON.stringify(updatedUserData));\n          console.log('[ProfileSection] Updated sessionStorage userData');\n        } catch (err) {\n          console.error('[ProfileSection] Failed to update sessionStorage:', err);\n        }\n      }\n\n      if (onSuccess) onSuccess('Profile updated successfully');\n    } catch (error) {\n      console.error('[ProfileSection] Failed to update profile:', error);\n      if (onError) onError(error.message || 'Failed to update profile');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <FormSection title=\"Profile Information\">\n        <div className={styles.loading}>Loading profile...</div>\n      </FormSection>\n    );\n  }\n\n  return (\n    <FormSection title=\"Profile Information\">\n      <form onSubmit={handleSubmit} className={styles.form}>\n        <div className={styles.logoAndDetailsRow}>\n          <div className={styles.logoSection}>\n            <CompanyLogoUpload\n              logoUrl={formData.companyLogo}\n              onUpload={handleLogoUpload}\n              onRemove={handleLogoRemove}\n            />\n          </div>\n\n          <div className={styles.accountDetailsSection}>\n            <div className={styles.detailItem}>\n              <span className={styles.detailLabel}>Member Since</span>\n              <span className={styles.detailValue}>{formatDate(formData.createdAt)}</span>\n            </div>\n            <div className={styles.detailItem}>\n              <span className={styles.detailLabel}>Last Updated</span>\n              <span className={styles.detailValue}>{formatDate(formData.updatedAt)}</span>\n            </div>\n          </div>\n        </div>\n\n        <div className={styles.row}>\n          <FormInput\n            label=\"First Name\"\n            value={formData.firstName}\n            onChange={(e) => handleChange('firstName', e.target.value)}\n            required\n            autoCapitalize\n          />\n          <FormInput\n            label=\"Last Name\"\n            value={formData.lastName}\n            onChange={(e) => handleChange('lastName', e.target.value)}\n            required\n            autoCapitalize\n          />\n        </div>\n\n        <div className={styles.row}>\n          <FormInput\n            label=\"Email\"\n            type=\"email\"\n            value={formData.email}\n            onChange={(e) => handleChange('email', e.target.value)}\n            required\n          />\n          <FormInput\n            label=\"Phone\"\n            type=\"tel\"\n            value={formData.phone}\n            onChange={(e) => handleChange('phone', e.target.value)}\n          />\n        </div>\n\n        <FormInput\n          label=\"Display Name\"\n          value={formData.displayName}\n          onChange={(e) => handleChange('displayName', e.target.value)}\n          helper=\"Optional: Shown instead of your real name in the app\"\n        />\n\n        <div className={styles.actions}>\n          <Button\n            type=\"submit\"\n            variant=\"primary\"\n            loading={saving}\n            disabled={saving}\n          >\n            Save Changes\n          </Button>\n        </div>\n      </form>\n    </FormSection>\n  );\n};\n\nexport default ProfileSection;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\account\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\auth\\RedeemInvite.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\auth\\RegistrationSuccess.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\chatter\\ChatterInput.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\chatter\\ChatterMessage.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\chatter\\ChatterPanel.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\chatter\\ChatterThread.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'replyCount' is assigned a value but never used.","line":68,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":68,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'hasReacted' is assigned a value but never used.","line":71,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":71,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'reactionCount' is assigned a value but never used.","line":76,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":76,"endColumn":22}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { motion } from 'framer-motion';\nimport logger from '../../services/devLogger';\nimport UserAvatar from './UserAvatar';\nimport { SendButton } from '../ui';\nimport styles from '../../styles/Chatter.module.css';\n\n/**\n * ChatterThread - Individual thread card with replies\n *\n * @param {object} thread - Thread data with replies array\n * @param {function} onReact - Callback when thumbs up is clicked\n * @param {function} onReply - Callback when a reply is sent\n * @param {string} currentUserUuid - Current user's UUID for permissions\n */\nconst ChatterThread = ({ thread, onReact, onReply, currentUserUuid }) => {\n  const [replyText, setReplyText] = useState('');\n  const [sending, setSending] = useState(false);\n\n  // Format timestamp to relative time\n  const formatTime = (timestamp) => {\n    const date = new Date(timestamp);\n    const now = new Date();\n    const diff = now - date;\n    const minutes = Math.floor(diff / 60000);\n    const hours = Math.floor(diff / 3600000);\n    const days = Math.floor(diff / 86400000);\n\n    if (minutes < 1) return 'Just now';\n    if (minutes < 60) return `${minutes}m ago`;\n    if (hours < 24) return `${hours}h ago`;\n    if (days < 7) return `${days}d ago`;\n    return date.toLocaleDateString();\n  };\n\n  // Highlight @mentions in text\n  const renderContentWithMentions = (content) => {\n    const mentionPattern = /@[\\w\\s]+/g;\n    const parts = content.split(mentionPattern);\n    const mentions = content.match(mentionPattern) || [];\n\n    return parts.map((part, index) => (\n      <React.Fragment key={index}>\n        {part}\n        {mentions[index] && (\n          <span className={styles.messageMention}>{mentions[index]}</span>\n        )}\n      </React.Fragment>\n    ));\n  };\n\n  // Get unique participants from replies\n  const getParticipants = () => {\n    const participants = new Map();\n\n    // Add thread author\n    participants.set(thread.user.uuid, thread.user);\n\n    // Add reply authors\n    thread.replies?.forEach(reply => {\n      participants.set(reply.user.uuid, reply.user);\n    });\n\n    return Array.from(participants.values()).slice(0, 4); // Max 4 avatars\n  };\n\n  const participants = getParticipants();\n  const replyCount = thread.replies?.length || 0;\n\n  // Check if current user has reacted\n  const hasReacted = thread.reactions?.some(r =>\n    r.emoji === 'ðŸ‘' && r.users.includes(currentUserUuid)\n  );\n\n  // Get reaction count\n  const reactionCount = thread.reactions?.find(r => r.emoji === 'ðŸ‘')?.users.length || 0;\n\n  const handleSendReply = async () => {\n    if (!replyText.trim() || sending) return;\n\n    setSending(true);\n    try {\n      await onReply(thread.id, replyText.trim());\n      setReplyText('');\n    } catch (error) {\n      logger.error('Chatter', 'Failed to send reply:', error);\n    } finally {\n      setSending(false);\n    }\n  };\n\n  const handleKeyDown = (e) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendReply();\n    }\n  };\n\n  return (\n    <div className={styles.threadCard}>\n      {/* Thread Header */}\n      <div className={styles.threadHeader}>\n        <UserAvatar user={thread.user} size=\"md\" />\n        <div className={styles.threadHeaderContent}>\n          <div className={styles.threadHeaderTop}>\n            <div className={styles.threadAuthorSection}>\n              <span className={styles.threadAuthor}>\n                {thread.user.firstName} {thread.user.lastName}\n              </span>\n              {/* Participant Avatars - moved next to author name */}\n              {participants.length > 1 && (\n                <div className={styles.participantAvatars}>\n                  {participants.map((participant, index) => (\n                    <div key={participant.uuid} style={{ zIndex: participants.length - index }}>\n                      <UserAvatar user={participant} size=\"sm\" />\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n            <span className={styles.threadTimestamp}>\n              {formatTime(thread.createdAt)}\n            </span>\n          </div>\n          <div className={styles.threadContent}>\n            {renderContentWithMentions(thread.content)}\n          </div>\n        </div>\n      </div>\n\n      {/* Replies Container */}\n      {thread.replies && thread.replies.length > 0 && (\n        <div className={styles.repliesContainer}>\n          {thread.replies.map(reply => (\n            <motion.div\n              key={reply.id}\n              className={styles.replyItem}\n              initial={{ opacity: 0, y: 5 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.2 }}\n            >\n              <UserAvatar user={reply.user} size=\"sm\" />\n              <div className={styles.replyContent}>\n                <div className={styles.replyHeader}>\n                  <span className={styles.replyAuthor}>\n                    {reply.user.firstName} {reply.user.lastName}\n                  </span>\n                  <span className={styles.replyTimestamp}>\n                    {formatTime(reply.createdAt)}\n                  </span>\n                </div>\n                <div className={styles.replyText}>\n                  {renderContentWithMentions(reply.content)}\n                </div>\n              </div>\n            </motion.div>\n          ))}\n        </div>\n      )}\n\n      {/* Thread Footer (Inline Reply Input) */}\n      <div className={styles.threadFooter}>\n        <div className={styles.inlineReplyInput}>\n          <UserAvatar\n            user={{\n              firstName: JSON.parse(sessionStorage.getItem('userData') || '{}').first_name || 'You',\n              lastName: '',\n            }}\n            size=\"sm\"\n          />\n          <textarea\n            className={styles.inlineReplyTextarea}\n            placeholder=\"Write a reply...\"\n            value={replyText}\n            onChange={(e) => setReplyText(e.target.value)}\n            onKeyDown={handleKeyDown}\n            rows={1}\n          />\n          <SendButton\n            onClick={handleSendReply}\n            disabled={!replyText.trim()}\n            loading={sending}\n            showIcon={false}\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ChatterThread;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\chatter\\MentionDropdown.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\chatter\\NotificationBell.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\chatter\\UserAvatar.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\checklist\\ChecklistItem.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\checklist\\ChecklistPanel.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'STATUS_OPTIONS' is defined but never used.","line":5,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":42},{"ruleId":"no-unused-vars","severity":1,"message":"'SUB_STATUS_LABELS' is defined but never used.","line":5,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":61}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport * as Icons from 'lucide-react';\nimport { toast } from 'react-toastify';\nimport { CHECKLIST_CONFIG, STATUS_OPTIONS, SUB_STATUS_LABELS } from '../../constants/checklistConfig';\nimport ChecklistItem from './ChecklistItem';\nimport TaskModal from './TaskModal';\nimport axiosInstance from '../../api/axiosInstance';\nimport logger from '../../services/devLogger';\nimport styles from './ChecklistPanel.module.css';\n\n/**\n * ChecklistPanel - Main container for project workflow checklist\n *\n * @param {string} projectUuid - Project UUID\n * @param {boolean} compact - Compact mode for sidebar display\n */\nconst ChecklistPanel = ({ projectUuid, compact = false }) => {\n  const [checklistData, setChecklistData] = useState({});\n  const [expandedSections, setExpandedSections] = useState(['sales']); // Start with Sales expanded\n  const [expandedItems, setExpandedItems] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [taskModalOpen, setTaskModalOpen] = useState(false);\n  const [taskContext, setTaskContext] = useState(null); // { sectionId, itemId }\n\n  // Fetch checklist data\n  useEffect(() => {\n    const fetchChecklistData = async () => {\n      if (!projectUuid) return;\n\n      setLoading(true);\n      try {\n        const response = await axiosInstance.get(`/checklist/project/${projectUuid}`);\n        if (response.data?.data) {\n          setChecklistData(response.data.data);\n        }\n      } catch (error) {\n        logger.error('ChecklistPanel', 'Failed to fetch checklist:', error);\n        // Initialize with empty data structure\n        setChecklistData({});\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchChecklistData();\n  }, [projectUuid]);\n\n  // Toggle section expansion\n  const toggleSection = (sectionId) => {\n    setExpandedSections(prev =>\n      prev.includes(sectionId)\n        ? prev.filter(id => id !== sectionId)\n        : [...prev, sectionId]\n    );\n  };\n\n  // Toggle item expansion\n  const toggleItem = (itemId) => {\n    setExpandedItems(prev =>\n      prev.includes(itemId)\n        ? prev.filter(id => id !== itemId)\n        : [...prev, itemId]\n    );\n  };\n\n  // Update item status\n  const updateItemStatus = async (sectionId, itemId, status, subStatus = null) => {\n    const currentUser = JSON.parse(sessionStorage.getItem('userData') || '{}');\n    const timestamp = new Date().toISOString();\n\n    const updateData = {\n      status,\n      subStatus,\n      updatedAt: timestamp,\n      updatedBy: {\n        uuid: currentUser.uuid,\n        name: `${currentUser.firstName || ''} ${currentUser.lastName || ''}`.trim() || 'Unknown',\n      }\n    };\n\n    // Optimistic update\n    setChecklistData(prev => ({\n      ...prev,\n      [sectionId]: {\n        ...prev[sectionId],\n        [itemId]: {\n          ...prev[sectionId]?.[itemId],\n          ...updateData,\n          history: [\n            ...(prev[sectionId]?.[itemId]?.history || []),\n            { ...updateData, action: 'status_change' }\n          ]\n        }\n      }\n    }));\n\n    try {\n      await axiosInstance.put(`/checklist/project/${projectUuid}/${sectionId}/${itemId}`, updateData);\n      toast.success('Status updated');\n    } catch (error) {\n      logger.error('ChecklistPanel', 'Failed to update status:', error);\n      toast.error('Failed to update status');\n      // Revert on error - refetch data\n    }\n\n    // If revision selected, expand the item to show notes\n    if (status === 'revision') {\n      setExpandedItems(prev => prev.includes(itemId) ? prev : [...prev, itemId]);\n    }\n  };\n\n  // Submit revision notes\n  const submitRevisionNotes = async (sectionId, itemId, notes) => {\n    const currentUser = JSON.parse(sessionStorage.getItem('userData') || '{}');\n    const timestamp = new Date().toISOString();\n\n    const revisionRecord = {\n      type: 'revision_note',\n      notes,\n      createdAt: timestamp,\n      createdBy: {\n        uuid: currentUser.uuid,\n        name: `${currentUser.firstName || ''} ${currentUser.lastName || ''}`.trim() || 'Unknown',\n      }\n    };\n\n    // Optimistic update\n    setChecklistData(prev => ({\n      ...prev,\n      [sectionId]: {\n        ...prev[sectionId],\n        [itemId]: {\n          ...prev[sectionId]?.[itemId],\n          revisions: [\n            ...(prev[sectionId]?.[itemId]?.revisions || []),\n            revisionRecord\n          ]\n        }\n      }\n    }));\n\n    try {\n      await axiosInstance.post(`/checklist/project/${projectUuid}/${sectionId}/${itemId}/revision`, {\n        notes\n      });\n      toast.success('Revision notes saved');\n    } catch (error) {\n      logger.error('ChecklistPanel', 'Failed to save revision:', error);\n      toast.error('Failed to save revision notes');\n    }\n  };\n\n  // Edit timestamp record\n  const editTimestamp = async (sectionId, itemId, recordIndex, newTimestamp) => {\n    try {\n      await axiosInstance.put(`/checklist/project/${projectUuid}/${sectionId}/${itemId}/history/${recordIndex}`, {\n        timestamp: newTimestamp\n      });\n\n      // Update local state\n      setChecklistData(prev => {\n        const history = [...(prev[sectionId]?.[itemId]?.history || [])];\n        if (history[recordIndex]) {\n          history[recordIndex] = { ...history[recordIndex], updatedAt: newTimestamp };\n        }\n        return {\n          ...prev,\n          [sectionId]: {\n            ...prev[sectionId],\n            [itemId]: {\n              ...prev[sectionId]?.[itemId],\n              history\n            }\n          }\n        };\n      });\n\n      toast.success('Timestamp updated');\n    } catch (error) {\n      logger.error('ChecklistPanel', 'Failed to update timestamp:', error);\n      toast.error('Failed to update timestamp');\n    }\n  };\n\n  // Open task modal\n  const openTaskModal = (sectionId, itemId) => {\n    setTaskContext({ sectionId, itemId });\n    setTaskModalOpen(true);\n  };\n\n  // Create task\n  const createTask = async (taskData) => {\n    if (!taskContext) return;\n\n    const { sectionId, itemId } = taskContext;\n    const currentUser = JSON.parse(sessionStorage.getItem('userData') || '{}');\n\n    try {\n      await axiosInstance.post(`/checklist/project/${projectUuid}/${sectionId}/${itemId}/tasks`, {\n        ...taskData,\n        createdBy: currentUser.uuid\n      });\n\n      toast.success('Task created');\n      setTaskModalOpen(false);\n      setTaskContext(null);\n    } catch (error) {\n      logger.error('ChecklistPanel', 'Failed to create task:', error);\n      toast.error('Failed to create task');\n    }\n  };\n\n  // Get item data helper\n  const getItemData = (sectionId, itemId) => {\n    return checklistData[sectionId]?.[itemId] || {\n      status: 'pending',\n      subStatus: null,\n      history: [],\n      revisions: [],\n      tasks: []\n    };\n  };\n\n  if (loading) {\n    return (\n      <div className={styles.checklistPanel}>\n        <div className={styles.loadingState}>\n          <Icons.Loader className={styles.spinner} size={24} />\n          <span>Loading checklist...</span>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`${styles.checklistPanel} ${compact ? styles.compact : ''}`}>\n      {/* Header */}\n      {!compact && (\n        <div className={styles.header}>\n          <h2 className={styles.title}>\n            <Icons.CheckSquare size={20} />\n            Project Checklist\n          </h2>\n        </div>\n      )}\n\n      {/* Sections */}\n      <div className={styles.sectionsContainer}>\n        {CHECKLIST_CONFIG.map((section) => {\n          const IconComponent = Icons[section.icon] || Icons.Folder;\n          const isExpanded = expandedSections.includes(section.id);\n\n          // Calculate section progress\n          const sectionItems = section.items;\n          const completedCount = sectionItems.filter(item =>\n            getItemData(section.id, item.id).status === 'complete'\n          ).length;\n          const progress = sectionItems.length > 0\n            ? Math.round((completedCount / sectionItems.length) * 100)\n            : 0;\n\n          return (\n            <div key={section.id} className={styles.section}>\n              {/* Section Header */}\n              <button\n                className={`${styles.sectionHeader} ${isExpanded ? styles.expanded : ''}`}\n                onClick={() => toggleSection(section.id)}\n              >\n                <div className={styles.sectionInfo}>\n                  <IconComponent size={18} className={styles.sectionIcon} />\n                  <span className={styles.sectionLabel}>{section.label}</span>\n                </div>\n\n                <div className={styles.sectionMeta}>\n                  <div className={styles.progressBadge}>\n                    <span>{completedCount}/{sectionItems.length}</span>\n                    <div className={styles.progressBar}>\n                      <div\n                        className={styles.progressFill}\n                        style={{ width: `${progress}%` }}\n                      />\n                    </div>\n                  </div>\n                  <Icons.ChevronDown\n                    size={18}\n                    className={`${styles.chevron} ${isExpanded ? styles.rotated : ''}`}\n                  />\n                </div>\n              </button>\n\n              {/* Section Items */}\n              <AnimatePresence>\n                {isExpanded && (\n                  <motion.div\n                    className={styles.sectionContent}\n                    initial={{ height: 0, opacity: 0 }}\n                    animate={{ height: 'auto', opacity: 1 }}\n                    exit={{ height: 0, opacity: 0 }}\n                    transition={{ duration: 0.2 }}\n                  >\n                    {section.items.map((item) => {\n                      const itemData = getItemData(section.id, item.id);\n                      const isItemExpanded = expandedItems.includes(item.id);\n\n                      return (\n                        <ChecklistItem\n                          key={item.id}\n                          item={item}\n                          data={itemData}\n                          isExpanded={isItemExpanded}\n                          onToggle={() => toggleItem(item.id)}\n                          onStatusChange={(status, subStatus) =>\n                            updateItemStatus(section.id, item.id, status, subStatus)\n                          }\n                          onRevisionSubmit={(notes) =>\n                            submitRevisionNotes(section.id, item.id, notes)\n                          }\n                          onEditTimestamp={(recordIndex, newTimestamp) =>\n                            editTimestamp(section.id, item.id, recordIndex, newTimestamp)\n                          }\n                          onAddTask={() => openTaskModal(section.id, item.id)}\n                        />\n                      );\n                    })}\n                  </motion.div>\n                )}\n              </AnimatePresence>\n            </div>\n          );\n        })}\n      </div>\n\n      {/* Task Modal */}\n      <TaskModal\n        isOpen={taskModalOpen}\n        onClose={() => {\n          setTaskModalOpen(false);\n          setTaskContext(null);\n        }}\n        onSubmit={createTask}\n        projectUuid={projectUuid}\n      />\n    </div>\n  );\n};\n\nexport default ChecklistPanel;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\checklist\\TaskModal.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'Icons' is defined but never used.","line":3,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Modal, Button } from '../ui';\nimport * as Icons from 'lucide-react';\nimport * as teamService from '../../services/teamService';\nimport styles from './TaskModal.module.css';\n\n/**\n * TaskModal - Modal for creating and assigning tasks\n */\nconst TaskModal = ({ isOpen, onClose, onSubmit, projectUuid }) => {\n  const [title, setTitle] = useState('');\n  const [description, setDescription] = useState('');\n  const [assigneeUuid, setAssigneeUuid] = useState('');\n  const [dueDate, setDueDate] = useState('');\n  const [priority, setPriority] = useState('normal');\n  const [teamMembers, setTeamMembers] = useState([]);\n  const [loading, setLoading] = useState(false);\n\n  // Fetch team members for assignment dropdown\n  useEffect(() => {\n    const fetchTeamMembers = async () => {\n      try {\n        const response = await teamService.getCompanyUsers();\n        setTeamMembers(response.data || []);\n      } catch (error) {\n        console.error('Failed to fetch team members:', error);\n        setTeamMembers([]);\n      }\n    };\n\n    if (isOpen) {\n      fetchTeamMembers();\n    }\n  }, [isOpen]);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (!title.trim()) return;\n\n    setLoading(true);\n    try {\n      await onSubmit({\n        title: title.trim(),\n        description: description.trim(),\n        assigneeUuid: assigneeUuid || null,\n        dueDate: dueDate || null,\n        priority,\n      });\n\n      // Reset form\n      setTitle('');\n      setDescription('');\n      setAssigneeUuid('');\n      setDueDate('');\n      setPriority('normal');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onClose={onClose}\n      title=\"Create Task\"\n      size=\"md\"\n    >\n      <form onSubmit={handleSubmit} className={styles.taskForm}>\n        {/* Task Title */}\n        <div className={styles.formGroup}>\n          <label className={styles.label}>Task Title *</label>\n          <input\n            type=\"text\"\n            className={styles.input}\n            value={title}\n            onChange={(e) => setTitle(e.target.value)}\n            placeholder=\"Enter task title...\"\n            required\n          />\n        </div>\n\n        {/* Description */}\n        <div className={styles.formGroup}>\n          <label className={styles.label}>Description</label>\n          <textarea\n            className={styles.textarea}\n            value={description}\n            onChange={(e) => setDescription(e.target.value)}\n            placeholder=\"Add task details...\"\n            rows={3}\n          />\n        </div>\n\n        {/* Assignee */}\n        <div className={styles.formGroup}>\n          <label className={styles.label}>Assign To</label>\n          <select\n            className={styles.select}\n            value={assigneeUuid}\n            onChange={(e) => setAssigneeUuid(e.target.value)}\n          >\n            <option value=\"\">Unassigned</option>\n            {teamMembers.map((member) => (\n              <option key={member.uuid} value={member.uuid}>\n                {member.first_name || member.firstName} {member.last_name || member.lastName}\n              </option>\n            ))}\n          </select>\n        </div>\n\n        {/* Due Date & Priority Row */}\n        <div className={styles.formRow}>\n          <div className={styles.formGroup}>\n            <label className={styles.label}>Due Date</label>\n            <input\n              type=\"date\"\n              className={styles.input}\n              value={dueDate}\n              onChange={(e) => setDueDate(e.target.value)}\n            />\n          </div>\n\n          <div className={styles.formGroup}>\n            <label className={styles.label}>Priority</label>\n            <select\n              className={styles.select}\n              value={priority}\n              onChange={(e) => setPriority(e.target.value)}\n            >\n              <option value=\"low\">Low</option>\n              <option value=\"normal\">Normal</option>\n              <option value=\"high\">High</option>\n              <option value=\"urgent\">Urgent</option>\n            </select>\n          </div>\n        </div>\n\n        {/* Actions */}\n        <div className={styles.actions}>\n          <Button variant=\"secondary\" onClick={onClose} type=\"button\">\n            Cancel\n          </Button>\n          <Button variant=\"primary\" type=\"submit\" disabled={!title.trim() || loading}>\n            {loading ? 'Creating...' : 'Create Task'}\n          </Button>\n        </div>\n      </form>\n    </Modal>\n  );\n};\n\nexport default TaskModal;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\checklist\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\common\\AddressAutocomplete.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\common\\ComingSoonPlaceholder.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\common\\CompactTabs.js","messages":[{"ruleId":"jsx-a11y/anchor-is-valid","severity":1,"message":"The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/anchor-is-valid.md","line":73,"column":13,"nodeType":"JSXOpeningElement","endLine":83,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport styles from '../../styles/CompactTabs.module.css';\n\n/**\n * CompactTabs - Sub-tab navigation with underline indicators\n *\n * Uses the standard sub-tab pattern from Dashboard (Equipment/BOS style)\n *\n * @param {Array} tabs - Array of tab objects: [{id: 'tab1', label: 'Tab 1'}, ...]\n * @param {string} defaultTab - Initial active tab ID (defaults to first tab)\n * @param {string} activeTab - Controlled active tab (optional, for external state control)\n * @param {function} onTabChange - Callback when tab changes: (tabId) => {}\n * @param {Object} tabContent - Object mapping tab IDs to their content: {tab1: <Component />, tab2: <Component />}\n * @param {string} storageKey - Optional sessionStorage key to persist active tab\n * @param {function} renderControls - Optional function to render controls on the right side: (activeTab) => ReactNode\n */\nconst CompactTabs = ({\n  tabs = [],\n  defaultTab,\n  activeTab: controlledActiveTab,\n  onTabChange,\n  tabContent = {},\n  storageKey,\n  renderControls\n}) => {\n  // Get saved tab state or use default\n  const getSavedTab = () => {\n    if (storageKey) {\n      const saved = sessionStorage.getItem(storageKey);\n      if (saved) return saved;\n    }\n    return defaultTab || tabs[0]?.id;\n  };\n\n  const [internalActiveTab, setInternalActiveTab] = useState(getSavedTab());\n\n  // Use controlled activeTab if provided, otherwise use internal state\n  const activeTab = controlledActiveTab !== undefined ? controlledActiveTab : internalActiveTab;\n\n  // Update internalActiveTab if defaultTab changes externally (only in uncontrolled mode)\n  useEffect(() => {\n    if (controlledActiveTab === undefined && defaultTab) {\n      setInternalActiveTab(defaultTab);\n      if (storageKey) {\n        sessionStorage.setItem(storageKey, defaultTab);\n      }\n    }\n  }, [defaultTab, storageKey, controlledActiveTab]);\n\n  const handleTabChange = (tabId) => {\n    // Update internal state only if not controlled\n    if (controlledActiveTab === undefined) {\n      setInternalActiveTab(tabId);\n    }\n\n    // Save to sessionStorage if storageKey provided\n    if (storageKey) {\n      sessionStorage.setItem(storageKey, tabId);\n    }\n\n    // Call parent callback if provided\n    if (onTabChange) {\n      onTabChange(tabId);\n    }\n  };\n\n  return (\n    <div className={styles.compactTabsContainer}>\n      {/* Tabs Navigation - Standard Sub-Tab Pattern */}\n      <div className={styles.viewNavigation}>\n        <div className={styles.viewNavigationTabs}>\n          {tabs.map((tab, index) => (\n            <a\n              key={tab.id}\n              href=\"#\"\n              onClick={(e) => {\n                e.preventDefault();\n                handleTabChange(tab.id);\n              }}\n              className={`${styles.viewLink} ${\n                index === 0 ? styles.viewLinkFirst : ''\n              } ${activeTab === tab.id ? styles.viewLinkActive : ''}`}\n            >\n              {tab.label}\n              {activeTab === tab.id && (\n                <div\n                  className={`${styles.viewLinkIndicator} ${\n                    index === 0 ? styles.viewLinkIndicatorFirst : styles.viewLinkIndicatorCenter\n                  }`}\n                />\n              )}\n            </a>\n          ))}\n        </div>\n        {renderControls && (\n          <div className={styles.viewNavigationControls}>\n            {typeof renderControls === 'function' && renderControls(activeTab)}\n          </div>\n        )}\n      </div>\n\n      {/* Tab Content */}\n      <div className={styles.contentArea}>\n        {tabContent[activeTab] || (\n          <div className={styles.emptyState}>\n            <div className={styles.emptyStateIcon}>ðŸ“‹</div>\n            <div className={styles.emptyStateTitle}>No content</div>\n            <div className={styles.emptyStateText}>\n              Content for this tab has not been configured\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default CompactTabs;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\common\\ErrorBoundary.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\common\\Note.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\common\\PWAInstallPrompt.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\common\\ProjectPanelTabs.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\common\\SearchableSelect.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\common\\TabbedPanel.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\common\\Toggle.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\common\\UpdateModal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\common\\UpdateToast.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\dashboard\\DashboardStats.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\dashboard\\DrafterPortal.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'Link' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":14},{"ruleId":"no-unused-vars","severity":1,"message":"'moment' is defined but never used.","line":5,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":14},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has missing dependencies: 'ActionButtonsRenderer' and 'StatusDropdown'. Either include them or remove the dependency array.","line":541,"column":6,"nodeType":"ArrayExpression","endLine":541,"endColumn":20,"suggestions":[{"desc":"Update the dependencies array to be: [ActionButtonsRenderer, StatusDropdown, isSuperAdmin]","fix":{"range":[17892,17906],"text":"[ActionButtonsRenderer, StatusDropdown, isSuperAdmin]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'STATUS_STEP_MAP'. Either include it or remove the dependency array.","line":592,"column":6,"nodeType":"ArrayExpression","endLine":592,"endColumn":49,"suggestions":[{"desc":"Update the dependencies array to be: [STATUS_STEP_MAP, projectsData, searchQuery, selectedStatus]","fix":{"range":[19605,19648],"text":"[STATUS_STEP_MAP, projectsData, searchQuery, selectedStatus]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useMemo, useRef, useEffect } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { AgGridReact } from 'ag-grid-react';\nimport { ModuleRegistry, AllCommunityModule } from 'ag-grid-community';\nimport moment from 'moment';\nimport { toast } from 'react-toastify';\n// Removed ag-grid.css import - using Theming API instead\nimport styles from '../../styles/Dashboard.module.css';\nimport { CSS_GRADIENTS } from '../../styles/gradient';\nimport { updateProjectStatus } from '../../services/projectService';\nimport { LaunchButton } from '../ui';\nimport speechBubbleIcon from '../../assets/images/speech-bubble-plus-128.png';\nimport eyeIcon from '../../assets/images/eye-icon-128.png';\nimport logger from '../../services/devLogger';\n\n// Register AG Grid modules\nModuleRegistry.registerModules([AllCommunityModule]);\n\n// Status mapping from completed_step to status name\nconst STATUS_MAP = {\n  0: 'Sales',\n  1: 'Site Survey',\n  2: 'Design',\n  3: 'Revisions',\n  4: 'Permits',\n  5: 'Install',\n  6: 'Commissioning',\n  7: 'Inspection',\n  8: 'PTO',\n  9: 'Canceled',\n  10: 'On Hold'\n};\n\n// Status options for dropdown\nconst STATUS_OPTIONS = [\n  { label: 'Sales', value: 0 },\n  { label: 'Site Survey', value: 1 },\n  { label: 'Design', value: 2 },\n  { label: 'Revisions', value: 3 },\n  { label: 'Permits', value: 4 },\n  { label: 'Install', value: 5 },\n  { label: 'Commissioning', value: 6 },\n  { label: 'Inspection', value: 7 },\n  { label: 'PTO', value: 8 },\n  { label: 'Canceled', value: 9 },\n  { label: 'On Hold', value: 10 },\n];\n\n// Status colors matching mobile app (using design tokens from tokens.css)\nconst STATUS_COLORS = {\n  'Sales': 'var(--status-sales)',\n  'Site Survey': 'var(--status-site-survey)',\n  'Design': 'var(--status-design)',\n  'Revisions': 'var(--status-revisions)',\n  'Permits': 'var(--status-permits)',\n  'Install': 'var(--status-install)',\n  'Commissioning': 'var(--status-commissioning)',\n  'Inspection': 'var(--status-inspection)',\n  'PTO': 'var(--status-pto)',\n  'On Hold': 'var(--status-on-hold)',\n  'Canceled': 'var(--status-canceled)'\n};\n\n/**\n * DrafterPortal - Drafter portal view with projects table\n * Based on ProjectsOverview component\n */\nconst DrafterPortal = ({ projects = [], loading = false, selectedStatus = 'all', onProjectsUpdate, onViewChatter, onNewProject, isNewProjectOpen = false }) => {\n  const [searchQuery, setSearchQuery] = useState('');\n  const [projectsData, setProjectsData] = useState(projects);\n  const gridRef = useRef(null);\n  const navigate = useNavigate();\n\n  // Update local state when projects prop changes\n  useEffect(() => {\n    setProjectsData(projects);\n  }, [projects]);\n\n  // Get user data to check if superuser\n  const userData = JSON.parse(sessionStorage.getItem('userData') || '{}');\n  const companyData = JSON.parse(sessionStorage.getItem('companyData') || '{}');\n  const isSuperAdmin = userData?.isSuperAdmin === true;\n\n  // Handle status change\n  const handleStatusChange = async (projectUuid, newStatus, oldStatus) => {\n    // Optimistic update\n    setProjectsData(prevProjects =>\n      prevProjects.map(project =>\n        project.uuid === projectUuid\n          ? { ...project, completed_step: newStatus }\n          : project\n      )\n    );\n\n    try {\n      await updateProjectStatus(projectUuid, companyData.uuid, newStatus);\n      toast.success('Status updated successfully', {\n        position: 'top-right',\n        autoClose: 2000,\n      });\n      // Notify parent component to refresh data if callback provided\n      if (onProjectsUpdate) {\n        onProjectsUpdate();\n      }\n    } catch (error) {\n      // Rollback on error\n      setProjectsData(prevProjects =>\n        prevProjects.map(project =>\n          project.uuid === projectUuid\n            ? { ...project, completed_step: oldStatus }\n            : project\n        )\n      );\n      toast.error('Failed to update status', {\n        position: 'top-right',\n        autoClose: 3000,\n      });\n      logger.error('Dashboard', 'Error updating status:', error);\n    }\n  };\n\n  // Action buttons component for AG Grid (Chat + Eye + Launch)\n  const ActionButtonsRenderer = (params) => {\n    const handleLaunchClick = () => {\n      navigate(`/project/${params.data.uuid}`);\n    };\n\n    const handleChatClick = (e) => {\n      e.stopPropagation();\n\n      // Build project info object for the chatter header\n      const project = params.data;\n      const projectInfo = {\n        uuid: project.uuid,\n        customerName: `${project.details?.customer_last_name || ''}, ${project.details?.customer_first_name || ''}`.trim() || 'Unknown Customer',\n        address: project.site\n          ? `${project.site.address || ''}${project.site.city ? `, ${project.site.city}` : ''}${project.site.state ? `, ${project.site.state}` : ''}${project.site.zip_code ? ` ${project.site.zip_code}` : ''}`\n          : 'No address',\n        projectId: project.details?.installer_project_id || project.uuid?.slice(0, 8),\n        defaultTab: 'notes' // Open to notes tab\n      };\n\n      // Call the onViewChatter callback from props\n      if (params.context?.onViewChatter) {\n        params.context.onViewChatter(projectInfo);\n      }\n    };\n\n    const handleOverviewClick = (e) => {\n      e.stopPropagation();\n\n      // Build project info object for the chatter header\n      const project = params.data;\n      const projectInfo = {\n        uuid: project.uuid,\n        customerName: `${project.details?.customer_last_name || ''}, ${project.details?.customer_first_name || ''}`.trim() || 'Unknown Customer',\n        address: project.site\n          ? `${project.site.address || ''}${project.site.city ? `, ${project.site.city}` : ''}${project.site.state ? `, ${project.site.state}` : ''}${project.site.zip_code ? ` ${project.site.zip_code}` : ''}`\n          : 'No address',\n        projectId: project.details?.installer_project_id || project.uuid?.slice(0, 8),\n        defaultTab: 'overview' // Open to overview tab\n      };\n\n      // Call the onViewChatter callback from props\n      if (params.context?.onViewChatter) {\n        params.context.onViewChatter(projectInfo);\n      }\n    };\n\n    return (\n      <div style={{ display: 'flex', gap: '0', alignItems: 'center', justifyContent: 'center', marginLeft: '-8px' }}>\n        {/* Chat Bubble Icon - Opens Notes Tab */}\n        <button\n          onClick={handleChatClick}\n          title=\"View project notes\"\n          style={{\n            padding: '0.09375rem 0.125rem',\n            background: 'transparent',\n            border: 'none',\n            cursor: 'pointer',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            transition: 'all 0.2s',\n            marginRight: '0',\n          }}\n        >\n          <img\n            src={speechBubbleIcon}\n            alt=\"Notes\"\n            style={{\n              width: '32px',\n              height: '32px',\n              opacity: 1,\n              transition: 'all 0.2s',\n              filter: 'brightness(0) saturate(100%) invert(46%) sepia(98%) saturate(1648%) hue-rotate(202deg) brightness(101%) contrast(93%)',\n            }}\n          />\n        </button>\n\n        {/* Eye Icon - Opens Overview Tab */}\n        <button\n          onClick={handleOverviewClick}\n          title=\"View project overview\"\n          style={{\n            padding: '0.09375rem 0.125rem',\n            background: 'transparent',\n            border: 'none',\n            cursor: 'pointer',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            transition: 'all 0.2s',\n            marginRight: '0.25rem',\n          }}\n        >\n          <img\n            src={eyeIcon}\n            alt=\"Overview\"\n            style={{\n              width: '32px',\n              height: '32px',\n              opacity: 1,\n              transition: 'all 0.2s',\n              filter: 'brightness(0) saturate(100%) invert(46%) sepia(98%) saturate(1648%) hue-rotate(202deg) brightness(101%) contrast(93%)',\n            }}\n          />\n        </button>\n\n        {/* Launch Button */}\n        <LaunchButton onClick={handleLaunchClick} />\n      </div>\n    );\n  };\n\n  // Status cell renderer - editable dropdown\n  const StatusDropdown = (params) => {\n    const currentStatus = params.value ?? 0;\n    const statusName = STATUS_MAP[currentStatus] || 'Unknown';\n    const color = STATUS_COLORS[statusName] || 'var(--status-on-hold)';\n    const projectUuid = params.data.uuid;\n\n    const handleChange = (e) => {\n      const newStatus = parseInt(e.target.value, 10);\n      if (newStatus !== currentStatus) {\n        handleStatusChange(projectUuid, newStatus, currentStatus);\n      }\n    };\n\n    return (\n      <select\n        value={currentStatus}\n        onChange={handleChange}\n        style={{\n          width: '100%',\n          height: '100%',\n          padding: '0 0.5rem',\n          background: CSS_GRADIENTS.PANEL,\n          border: 'none',\n          borderRadius: '0.25rem',\n          color: color,\n          fontWeight: 600,\n          fontSize: '0.875rem',\n          cursor: 'pointer',\n          appearance: 'none',\n          backgroundImage: `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%23FD7332' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 8l4 4 4-4'/%3E%3C/svg%3E\")`,\n          backgroundPosition: 'right 0.5rem center',\n          backgroundRepeat: 'no-repeat',\n          backgroundSize: '1em 1em',\n          paddingRight: '2rem'\n        }}\n      >\n        {STATUS_OPTIONS.map(option => (\n          <option\n            key={option.value}\n            value={option.value}\n            style={{\n              background: 'var(--gray-800)',\n              color: STATUS_COLORS[option.label] || 'var(--text-primary)',\n              padding: '0.5rem'\n            }}\n          >\n            {option.label}\n          </option>\n        ))}\n      </select>\n    );\n  };\n\n  // Column definitions\n  const columnDefs = useMemo(() => {\n    const baseCols = [];\n\n    // Actions (first column) - pinned left, no header text, not resizable\n    baseCols.push({\n      headerName: '',\n      field: '',\n      width: 160,\n      suppressSizeToFit: true,\n      pinned: 'left',\n      lockPosition: true,\n      resizable: false,\n      suppressMovable: true,\n      cellRenderer: ActionButtonsRenderer,\n      cellStyle: { display: 'flex', alignItems: 'center', justifyContent: 'center' },\n      headerClass: 'ag-header-cell-center',\n      headerTooltip: 'Actions'\n    });\n\n    // Company (second column for superadmin)\n    if (isSuperAdmin) {\n      baseCols.push({\n        headerName: 'Company',\n        field: 'company.name',\n        width: 160,\n        headerTooltip: 'Company',\n        tooltipField: 'company.name'\n      });\n    }\n\n    // Customer (2nd/3rd column depending on superadmin)\n    baseCols.push({\n      headerName: 'Customer',\n      valueGetter: (params) => {\n        const first = params.data.details?.customer_first_name || '';\n        const last = params.data.details?.customer_last_name || '';\n        return `${last}, ${first}`;\n      },\n      width: 180,\n      sortable: true,\n      headerTooltip: 'Customer Name',\n      tooltipValueGetter: (params) => {\n        const first = params.data.details?.customer_first_name || '';\n        const last = params.data.details?.customer_last_name || '';\n        return `${last}, ${first}`;\n      }\n    });\n\n    // Project ID\n    baseCols.push({\n      headerName: 'Project ID',\n      field: 'details.installer_project_id',\n      width: 130,\n      cellRenderer: (params) => params.value || params.data.uuid.slice(0, 8),\n      headerTooltip: 'Project ID',\n      tooltipValueGetter: (params) => params.data.details?.installer_project_id || params.data.uuid\n    });\n\n    // Status\n    baseCols.push({\n      headerName: 'Status',\n      field: 'completed_step',\n      width: 140,\n      cellRenderer: StatusDropdown,\n      sortable: true,\n      cellStyle: { padding: '0' },\n      headerTooltip: 'Project Status'\n    });\n\n    // Address\n    baseCols.push({\n      headerName: 'Address',\n      valueGetter: (params) => {\n        const address = params.data.site?.address || '';\n        const city = params.data.site?.city || '';\n        return address ? `${address}, ${city}` : '';\n      },\n      width: 220,\n      headerTooltip: 'Site Address',\n      tooltipValueGetter: (params) => {\n        const address = params.data.site?.address || '';\n        const city = params.data.site?.city || '';\n        return address ? `${address}, ${city}` : '';\n      }\n    });\n\n    // Jurisdiction\n    baseCols.push({\n      headerName: 'Jurisdiction',\n      field: 'site.jurisdiction',\n      width: 140,\n      headerTooltip: 'Jurisdiction',\n      tooltipField: 'site.jurisdiction'\n    });\n\n    // Utility\n    baseCols.push({\n      headerName: 'Utility',\n      field: 'site.utility',\n      width: 120,\n      sortable: true,\n      headerTooltip: 'Utility Provider',\n      tooltipField: 'site.utility'\n    });\n\n    // Proposal\n    baseCols.push({\n      headerName: 'Proposal',\n      field: 'proposal_url',\n      width: 100,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'Proposal Document'\n    });\n\n    // Signatures\n    baseCols.push({\n      headerName: 'Signatures',\n      field: 'signatures_url',\n      width: 110,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'Customer Signatures'\n    });\n\n    // Site Survey\n    baseCols.push({\n      headerName: 'Site Survey',\n      field: 'site_survey_url',\n      width: 110,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'Site Survey Document'\n    });\n\n    // Site Plan\n    baseCols.push({\n      headerName: 'Site Plan',\n      field: 'site_plan_url',\n      width: 100,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'Site Plan Document'\n    });\n\n    // Plan Set\n    baseCols.push({\n      headerName: 'Plan Set',\n      field: 'plan_set_url',\n      width: 100,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'Plan Set Document'\n    });\n\n    // Permits\n    baseCols.push({\n      headerName: 'Permits',\n      field: 'permits_url',\n      width: 100,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'Permits Document'\n    });\n\n    // Interconnection\n    baseCols.push({\n      headerName: 'Interconnection',\n      field: 'interconnection_url',\n      width: 130,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'Interconnection Agreement'\n    });\n\n    // HOA\n    baseCols.push({\n      headerName: 'HOA',\n      field: 'hoa_url',\n      width: 90,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'HOA Approval'\n    });\n\n    // Install\n    baseCols.push({\n      headerName: 'Install',\n      field: 'install_url',\n      width: 90,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'Installation Photos'\n    });\n\n    // Commission\n    baseCols.push({\n      headerName: 'Commission',\n      field: 'commission_url',\n      width: 110,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'Commission Documents'\n    });\n\n    // Inspection\n    baseCols.push({\n      headerName: 'Inspection',\n      field: 'inspection_url',\n      width: 110,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'Inspection Reports'\n    });\n\n    // PTO\n    baseCols.push({\n      headerName: 'PTO',\n      field: 'pto_url',\n      width: 90,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'Permission To Operate'\n    });\n\n    return baseCols;\n  }, [isSuperAdmin]);\n\n  // Map selectedStatus to completed_step value\n  const STATUS_STEP_MAP = {\n    all: null,\n    sales: 0,\n    site_survey: 1,\n    design: [2, 3], // Includes both Design and Revisions\n    permits: 4,\n    install: 5,\n    commissioning: 6,\n    inspection: 7,\n    pto: 8,\n  };\n\n  // Filter projects based on search and status\n  const filteredProjects = useMemo(() => {\n    let filtered = [...projectsData];\n\n    // Filter by status\n    if (selectedStatus !== 'all') {\n      const stepValue = STATUS_STEP_MAP[selectedStatus];\n      if (stepValue !== undefined && stepValue !== null) {\n        // Handle array of step values (e.g., Design includes steps 2 and 3)\n        if (Array.isArray(stepValue)) {\n          filtered = filtered.filter(p => stepValue.includes(p.completed_step));\n        } else {\n          filtered = filtered.filter(p => p.completed_step === stepValue);\n        }\n      }\n    }\n\n    // Filter by search query\n    if (searchQuery.trim()) {\n      const query = searchQuery.toLowerCase();\n      filtered = filtered.filter(p => {\n        const customerName = `${p.details?.customer_first_name || ''} ${p.details?.customer_last_name || ''}`.toLowerCase();\n        const projectId = (p.details?.installer_project_id || '').toLowerCase();\n        const address = (p.site?.address || '').toLowerCase();\n        const city = (p.site?.city || '').toLowerCase();\n        const companyName = (p.company?.name || '').toLowerCase();\n\n        return customerName.includes(query) ||\n               projectId.includes(query) ||\n               address.includes(query) ||\n               city.includes(query) ||\n               companyName.includes(query);\n      });\n    }\n\n    return filtered;\n  }, [projectsData, searchQuery, selectedStatus]);\n\n  // Default column definitions for AG Grid\n  const defaultColDef = useMemo(() => ({\n    sortable: true,\n    filter: false,\n    resizable: true,\n    suppressMovable: true\n  }), []);\n\n  if (loading) {\n    return (\n      <div className={styles.projectsOverviewContainer}>\n        <div className={styles.emptyStateCenter}>\n          <div className={styles.emptyStateIcon}>â³</div>\n          <p>Loading projects...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={styles.projectsOverviewContainer}>\n      {/* Search Filter with New Project Button */}\n      <div className={styles.filters}>\n        <button\n          onClick={onNewProject}\n          className={`${styles.projectsNewButton} ${\n            isNewProjectOpen ? styles.projectsNewButtonActive : styles.projectsNewButtonInactive\n          }`}\n          onMouseEnter={(e) => {\n            if (isNewProjectOpen) {\n              e.currentTarget.style.transform = 'translateY(-1px)';\n              e.currentTarget.style.boxShadow = '0 4px 12px rgba(253, 115, 50, 0.4)';\n            } else {\n              e.currentTarget.style.transform = 'translateY(-1px)';\n              e.currentTarget.style.background = 'rgba(255, 255, 255, 0.05)';\n              e.currentTarget.style.borderColor = 'rgba(255, 255, 255, 0.3)';\n            }\n          }}\n          onMouseLeave={(e) => {\n            e.currentTarget.style.transform = 'translateY(0)';\n            if (isNewProjectOpen) {\n              e.currentTarget.style.boxShadow = '0 2px 8px rgba(253, 115, 50, 0.3)';\n            } else {\n              e.currentTarget.style.background = CSS_GRADIENTS.PANEL;\n              e.currentTarget.style.borderColor = 'rgba(255, 255, 255, 0.2)';\n            }\n          }}\n        >\n          <span className={styles.projectsNewButtonIcon}>+</span>\n          <span>Project</span>\n        </button>\n        <input\n          type=\"text\"\n          placeholder=\"Search by customer, project ID, address, or company...\"\n          value={searchQuery}\n          onChange={(e) => setSearchQuery(e.target.value)}\n          className={`${styles.filterInput} ${styles.searchInputFlex}`}\n        />\n      </div>\n\n      {/* Projects Table */}\n      {filteredProjects.length === 0 ? (\n        <div className={styles.emptyState}>\n          <div className={styles.emptyStateIcon}>ðŸ”</div>\n          <h3 className={styles.emptyStateTitle}>No Projects Found</h3>\n          <p className={styles.emptyStateDescription}>\n            {searchQuery ? 'Try adjusting your search or filters' : 'No projects match the selected filters'}\n          </p>\n        </div>\n      ) : (\n        <div\n          className={`${styles.agGridDark} ${styles.agGridContainer}`}\n        >\n          <AgGridReact\n            ref={gridRef}\n            rowData={filteredProjects}\n            columnDefs={columnDefs}\n            defaultColDef={defaultColDef}\n            context={{ onViewChatter }}\n            pagination={false}\n            rowHeight={38}\n            headerHeight={38}\n            animateRows={true}\n            domLayout=\"normal\"\n          />\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default DrafterPortal;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\dashboard\\PlanSetVersions.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'activeQCType' is assigned a value but never used.","line":41,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":41,"endColumn":22},{"ruleId":"no-unused-vars","severity":1,"message":"'setActiveQCType' is assigned a value but never used.","line":41,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":41,"endColumn":39},{"ruleId":"no-unused-vars","severity":1,"message":"'handleDownload' is assigned a value but never used.","line":176,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":176,"endColumn":23},{"ruleId":"jsx-a11y/anchor-is-valid","severity":1,"message":"The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/anchor-is-valid.md","line":295,"column":15,"nodeType":"JSXOpeningElement","endLine":306,"endColumn":16},{"ruleId":"jsx-a11y/anchor-is-valid","severity":1,"message":"The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/anchor-is-valid.md","line":330,"column":13,"nodeType":"JSXOpeningElement","endLine":337,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\nimport { io } from 'socket.io-client';\nimport axios from '../../config/axios';\nimport { toast } from 'react-toastify';\nimport logger from '../../services/devLogger';\nimport styles from '../../styles/Dashboard.module.css';\nimport PdfFullScreenModal from '../pdf/PdfFullScreenModal';\nimport PdfAnnotationLayer from '../pdf/PdfAnnotationLayer';\nimport PdfToolbar from '../pdf/PdfToolbar';\nimport { LoadingSpinner, SearchableDropdown, Button } from '../ui';\n\n/**\n * PlanSetVersions - Version tabs for viewing different plan set iterations\n * Fetches versions from API and displays PDFs with presigned URLs\n * Listens for real-time PDF upload notifications via Socket.io\n */\nconst PlanSetVersions = ({ projectUuid, onQCPanelChange }) => {\n  const [versions, setVersions] = useState([]);\n  const [selectedVersion, setSelectedVersion] = useState(null);\n  const [presignedUrl, setPresignedUrl] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [loadingPdf, setLoadingPdf] = useState(false);\n  const [error, setError] = useState(null);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n\n  // Status tab state: 'draft' or 'published'\n  const [statusTab, setStatusTab] = useState('draft');\n\n  // View state: 'planset' or 'specsheets'\n  const [currentView, setCurrentView] = useState('planset');\n\n  // Annotation state\n  const [isAnnotationMode, setIsAnnotationMode] = useState(true); // Start with tools open\n  const [currentTool, setCurrentTool] = useState('select');\n  const [currentColor, setCurrentColor] = useState('var(--color-danger)'); // Red default\n  const [annotations, setAnnotations] = useState([]);\n  const [hasChanges, setHasChanges] = useState(false);\n  const annotationLayerRef = React.useRef(null);\n\n  // QC Checklist panel state - now supports 'site' and 'design' types\n  const [activeQCType, setActiveQCType] = useState(null); // null, 'site', or 'design'\n\n  // Fetch all versions (extracted to useCallback so it can be called from socket listener)\n  const fetchVersions = useCallback(async () => {\n    if (!projectUuid) {\n      setLoading(false);\n      return;\n    }\n\n    try {\n      setLoading(true);\n      setError(null);\n      const response = await axios.get(`/project/${projectUuid}/versions`);\n\n      if (response.data.success && response.data.versions.length > 0) {\n        setVersions(response.data.versions);\n\n        // Determine if we have published versions\n        const publishedVersions = response.data.versions.filter(v => v.status === 'published');\n        const draftVersions = response.data.versions.filter(v => v.status === 'draft' || !v.status);\n\n        // If we have published, show published tab; otherwise show draft\n        if (publishedVersions.length > 0) {\n          setStatusTab('published');\n          const latestPublished = publishedVersions.find(v => v.is_latest) || publishedVersions[publishedVersions.length - 1];\n          setSelectedVersion(latestPublished.version_number);\n        } else if (draftVersions.length > 0) {\n          setStatusTab('draft');\n          const latestDraft = draftVersions.find(v => v.is_latest) || draftVersions[draftVersions.length - 1];\n          setSelectedVersion(latestDraft.version_number);\n        }\n      } else {\n        setVersions([]);\n      }\n    } catch (error) {\n      logger.error('Dashboard', 'Error fetching versions:', error);\n      setError('Failed to load plan set versions');\n      setVersions([]);\n    } finally {\n      setLoading(false);\n    }\n  }, [projectUuid]);\n\n  // Fetch versions on mount\n  useEffect(() => {\n    fetchVersions();\n  }, [fetchVersions]);\n\n  // Fetch presigned URL when version changes\n  useEffect(() => {\n    const fetchPresignedUrl = async () => {\n      if (!projectUuid || !selectedVersion) {\n        return;\n      }\n\n      try {\n        setLoadingPdf(true);\n        setPresignedUrl(null);\n        const response = await axios.get(`/project/${projectUuid}/versions/${selectedVersion}/presigned-url`);\n\n        if (response.data.success) {\n          setPresignedUrl(response.data.presigned_url);\n        }\n      } catch (error) {\n        logger.error('Dashboard', 'Error fetching presigned URL:', error);\n        setError(`Failed to load Version ${selectedVersion} PDF`);\n      } finally {\n        setLoadingPdf(false);\n      }\n    };\n\n    fetchPresignedUrl();\n  }, [projectUuid, selectedVersion]);\n\n  // Socket.io real-time PDF notifications\n  useEffect(() => {\n    if (!projectUuid) {\n      return;\n    }\n\n    logger.debug('Dashboard', '[PlanSetVersions] Initializing Socket.io connection');\n\n    const socket = io('https://api.skyfireapp.io', {\n      transports: ['websocket', 'polling'],\n      reconnection: true,\n      reconnectionDelay: 1000,\n      reconnectionAttempts: 5\n    });\n\n    socket.on('connect', () => {\n      logger.log('Dashboard', '[PlanSetVersions] Socket connected, joining project room:', projectUuid);\n      socket.emit('join-project', projectUuid);\n    });\n\n    socket.on('disconnect', (reason) => {\n      logger.log('Dashboard', '[PlanSetVersions] Socket disconnected:', reason);\n    });\n\n    socket.on('connect_error', (error) => {\n      logger.error('Dashboard', '[PlanSetVersions] Socket connection error:', error);\n    });\n\n    socket.on('pdf-ready', (data) => {\n      logger.log('Dashboard', '[PlanSetVersions] PDF ready notification received:', data);\n\n      // Show toast notification\n      toast.success(`Plan Set V${data.version_number} is ready!`, {\n        position: 'top-right',\n        autoClose: 5000,\n        hideProgressBar: false,\n        closeOnClick: true,\n        pauseOnHover: true,\n        draggable: true\n      });\n\n      // Refetch versions to show new PDF\n      fetchVersions();\n    });\n\n    return () => {\n      logger.debug('Dashboard', '[PlanSetVersions] Cleaning up Socket.io connection');\n      socket.emit('leave-project', projectUuid);\n      socket.disconnect();\n    };\n  }, [projectUuid, fetchVersions]);\n\n  const handleVersionClick = (versionNumber) => {\n    setSelectedVersion(versionNumber);\n    setPresignedUrl(null); // Clear current PDF while loading new one\n  };\n\n  const handleFullScreen = () => {\n    setIsModalOpen(true);\n  };\n\n  const handleDownload = () => {\n    if (presignedUrl) {\n      window.open(presignedUrl, '_blank');\n    }\n  };\n\n  const handleToggleAnnotationMode = () => {\n    setIsAnnotationMode(!isAnnotationMode);\n  };\n\n  const handleAnnotationsChange = (newAnnotations) => {\n    setAnnotations(newAnnotations);\n    setHasChanges(true);\n  };\n\n  const handleSaveMarkup = async () => {\n    // If we're in draft mode with changes, publish the version\n    if (statusTab === 'draft' && hasChanges) {\n      await handlePublish();\n    } else {\n      logger.debug('Dashboard', 'Save markup clicked - no changes to publish');\n    }\n  };\n\n  // Publish current draft version\n  const handlePublish = async () => {\n    if (!projectUuid || !selectedVersion) {\n      return;\n    }\n\n    try {\n      const response = await axios.post(`/project/${projectUuid}/versions/${selectedVersion}/publish`);\n\n      if (response.data.success) {\n        toast.success(`Version ${selectedVersion} published successfully!`, {\n          position: 'top-right',\n          autoClose: 3000\n        });\n\n        // Refetch versions to update UI\n        await fetchVersions();\n      }\n    } catch (error) {\n      logger.error('Dashboard', 'Error publishing version:', error);\n      toast.error('Failed to publish version', {\n        position: 'top-right',\n        autoClose: 5000\n      });\n    }\n  };\n\n  // Get filtered versions based on current status tab\n  const getFilteredVersions = () => {\n    return versions.filter(v => {\n      const versionStatus = v.status || 'draft'; // Default to draft if no status\n      return versionStatus === statusTab;\n    });\n  };\n\n  // Handle status tab change\n  const handleStatusTabChange = (newStatus) => {\n    setStatusTab(newStatus);\n\n    // Auto-select first version in the new tab\n    const filteredVersions = versions.filter(v => {\n      const versionStatus = v.status || 'draft';\n      return versionStatus === newStatus;\n    });\n\n    if (filteredVersions.length > 0) {\n      const latest = filteredVersions.find(v => v.is_latest) || filteredVersions[filteredVersions.length - 1];\n      setSelectedVersion(latest.version_number);\n    } else {\n      setSelectedVersion(null);\n      setPresignedUrl(null);\n    }\n  };\n\n  // Loading state\n  if (loading) {\n    return (\n      <div className={styles.fullHeightCenter}>\n        <LoadingSpinner size=\"lg\" label=\"Loading versions...\" />\n      </div>\n    );\n  }\n\n  // No versions available\n  if (versions.length === 0) {\n    return (\n      <div className={styles.fullHeightCenter}>\n        <div className={styles.emptyStateContainer}>\n          <div className={styles.emptyStateIcon}>ðŸ“„</div>\n          <h3 className={styles.emptyStateHeading}>\n            No Plan Sets Available\n          </h3>\n          <p className={styles.emptyStateText}>\n            Plan sets will appear here once generated\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  // Define view steps for standard sub-tab navigation\n  const viewSteps = [\n    { key: 'draft', label: 'Draft' },\n    { key: 'published', label: 'Published' },\n  ];\n\n  return (\n    <div className={styles.mainContainer}>\n      {/* Header: Sub-tab Navigation + Version Dropdown */}\n      <div className={styles.headerSection}>\n        {/* Left Side: Standard Sub-tab Navigation + Version Dropdown */}\n        <div className={styles.headerLeft}>\n          {/* Standard Sub-tab Navigation */}\n          <div className={styles.viewNavigation}>\n            {viewSteps.map((view, index) => (\n              <a\n                key={view.key}\n                href=\"#\"\n                onClick={(e) => {\n                  e.preventDefault();\n                  setCurrentView('planset');\n                  handleStatusTabChange(view.key);\n                }}\n                className={`${styles.viewLink} ${index === 0 ? styles.viewLinkFirst : ''} ${\n                  view.key === statusTab && currentView === 'planset' ? styles.viewLinkActive : ''\n                }`}\n              >\n                {view.label}\n                {view.key === statusTab && currentView === 'planset' && (\n                  <span className={`${styles.viewLinkIndicator} ${index === 0 ? styles.viewLinkIndicatorFirst : styles.viewLinkIndicatorCenter}`} />\n                )}\n              </a>\n            ))}\n\n            {/* Version Dropdown - Between Published and Spec Sheets */}\n            {currentView === 'planset' && getFilteredVersions().length > 0 && (\n              <div className={styles.versionDropdown}>\n                <SearchableDropdown\n                  value={selectedVersion || ''}\n                  onChange={handleVersionClick}\n                  options={getFilteredVersions().map(v => ({\n                    value: v.version_number,\n                    label: `V${v.version_number}${v.is_latest ? ' (Latest)' : ''}`\n                  }))}\n                  placeholder=\"Select version...\"\n                />\n              </div>\n            )}\n\n            {/* Spec Sheets Tab */}\n            <a\n              href=\"#\"\n              onClick={(e) => {\n                e.preventDefault();\n                setCurrentView('specsheets');\n              }}\n              className={`${styles.viewLink} ${currentView === 'specsheets' ? styles.viewLinkActive : ''}`}\n            >\n              Spec Sheets\n              {currentView === 'specsheets' && (\n                <span className={`${styles.viewLinkIndicator} ${styles.viewLinkIndicatorCenter}`} />\n              )}\n            </a>\n          </div>\n        </div>\n\n        {/* Action Buttons */}\n        <div className={styles.actionButtons}>\n          {/* Publish Button - Always visible */}\n          {selectedVersion && statusTab === 'draft' && (\n            <Button\n              variant=\"outline\"\n              onClick={handlePublish}\n              size=\"md\"\n            >\n              Publish\n            </Button>\n          )}\n\n          {/* Tools Button - Only visible when PDF is loaded */}\n          {presignedUrl && (\n            <button\n              onClick={handleToggleAnnotationMode}\n              className={`${styles.pillButton} ${isAnnotationMode ? styles.pillButtonPrimary : styles.pillButtonOutlinePrimary}`}\n            >\n              Tools\n            </button>\n          )}\n\n          {/* Full Screen Button - Only visible when PDF is loaded */}\n          {presignedUrl && (\n            <button\n              onClick={handleFullScreen}\n              className={`${styles.pillButton} ${isModalOpen ? styles.pillButtonPrimary : styles.pillButtonSecondary}`}\n            >\n              Full Screen\n            </button>\n          )}\n        </div>\n      </div>\n\n      {/* Content Area */}\n      <div className={styles.contentArea}>\n        {currentView === 'planset' ? (\n        /* PDF Viewer Container */\n        <div className={styles.pdfContainer}>\n          {error && (\n          <div className={styles.errorAlert}>\n            âš ï¸ {error}\n          </div>\n        )}\n\n        {loadingPdf ? (\n          <div className={styles.flexCenter} style={{ flex: 1 }}>\n            <LoadingSpinner size=\"lg\" label=\"Loading PDF...\" />\n          </div>\n        ) : presignedUrl ? (\n          <>\n            <iframe\n              src={presignedUrl}\n              className={styles.pdfIframe}\n              title={`Plan Set Version ${selectedVersion}`}\n            />\n\n            {/* Annotation Layer Overlay */}\n            <PdfAnnotationLayer\n              ref={annotationLayerRef}\n              isActive={isAnnotationMode}\n              currentTool={currentTool}\n              currentColor={currentColor}\n              annotations={annotations}\n              onAnnotationsChange={handleAnnotationsChange}\n              onToolChange={setCurrentTool}\n              currentPage={1}\n            />\n\n            {/* Annotation Toolbar */}\n            {isAnnotationMode && (\n              <PdfToolbar\n                currentTool={currentTool}\n                onToolChange={setCurrentTool}\n                currentColor={currentColor}\n                onColorChange={setCurrentColor}\n                canSave={hasChanges}\n                onSave={handleSaveMarkup}\n                statusTab={statusTab}\n              />\n            )}\n          </>\n        ) : (\n          <div className={styles.flexCenter} style={{ flex: 1 }}>\n            <div className={styles.textCenter} style={{ color: 'var(--text-disabled)' }}>\n              <p>Select a version to view the plan set</p>\n            </div>\n          </div>\n        )}\n        </div>\n        ) : (\n        /* Spec Sheets View */\n        <div className={styles.specSheetsPlaceholder}>\n          <div className={styles.specSheetsContent}>\n            <div className={styles.emptyStateIcon}>ðŸ“„</div>\n            <h4 className={styles.specSheetsTitle}>\n              No Spec Sheets Uploaded\n            </h4>\n            <p className={styles.specSheetsDescription}>\n              Upload equipment specification sheets to continue\n            </p>\n            <button\n              type=\"button\"\n              onClick={() => {\n                alert('Spec sheet upload functionality coming soon');\n              }}\n              className={styles.uploadButton}\n            >\n              Upload Spec Sheets\n            </button>\n          </div>\n        </div>\n        )}\n      </div>\n\n      {/* Full Screen Modal */}\n      <PdfFullScreenModal\n        isOpen={isModalOpen}\n        onClose={() => setIsModalOpen(false)}\n        presignedUrl={presignedUrl}\n        versionNumber={selectedVersion}\n        fileName=\"Plan Set\"\n      />\n    </div>\n  );\n};\n\nexport default PlanSetVersions;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\dashboard\\ProjectDetailsTabs.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\dashboard\\ProjectOverviewTabs.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\dashboard\\ProjectsOverview.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'Link' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":14},{"ruleId":"no-unused-vars","severity":1,"message":"'moment' is defined but never used.","line":5,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":14},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has missing dependencies: 'ActionButtonsRenderer' and 'StatusDropdown'. Either include them or remove the dependency array.","line":586,"column":6,"nodeType":"ArrayExpression","endLine":586,"endColumn":20,"suggestions":[{"desc":"Update the dependencies array to be: [ActionButtonsRenderer, StatusDropdown, isSuperAdmin]","fix":{"range":[19442,19456],"text":"[ActionButtonsRenderer, StatusDropdown, isSuperAdmin]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'STATUS_STEP_MAP'. Either include it or remove the dependency array.","line":653,"column":6,"nodeType":"ArrayExpression","endLine":653,"endColumn":65,"suggestions":[{"desc":"Update the dependencies array to be: [STATUS_STEP_MAP, projectsData, searchQuery, selectedStatus, showRecentOnly]","fix":{"range":[21731,21790],"text":"[STATUS_STEP_MAP, projectsData, searchQuery, selectedStatus, showRecentOnly]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useMemo, useRef, useEffect } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { AgGridReact } from 'ag-grid-react';\nimport { ModuleRegistry, AllCommunityModule } from 'ag-grid-community';\nimport moment from 'moment';\nimport { toast } from 'react-toastify';\n// Removed ag-grid.css import - using Theming API instead\nimport styles from '../../styles/Dashboard.module.css';\nimport { CSS_GRADIENTS } from '../../styles/gradient';\nimport { updateProjectStatus } from '../../services/projectService';\nimport { LaunchButton } from '../ui';\nimport speechBubbleIcon from '../../assets/images/speech-bubble-plus-128.png';\nimport eyeIcon from '../../assets/images/eye-icon-128.png';\nimport logger from '../../services/devLogger';\n\n// Register AG Grid modules\nModuleRegistry.registerModules([AllCommunityModule]);\n\n// Status mapping from completed_step to status name\nconst STATUS_MAP = {\n  0: 'Sales',\n  1: 'Site Survey',\n  2: 'Design',\n  3: 'Revisions',\n  4: 'Permits',\n  5: 'Install',\n  6: 'Commissioning',\n  7: 'Inspection',\n  8: 'PTO',\n  9: 'Canceled',\n  10: 'On Hold'\n};\n\n// Status options for dropdown\nconst STATUS_OPTIONS = [\n  { label: 'Sales', value: 0 },\n  { label: 'Site Survey', value: 1 },\n  { label: 'Design', value: 2 },\n  { label: 'Revisions', value: 3 },\n  { label: 'Permits', value: 4 },\n  { label: 'Install', value: 5 },\n  { label: 'Commissioning', value: 6 },\n  { label: 'Inspection', value: 7 },\n  { label: 'PTO', value: 8 },\n  { label: 'Canceled', value: 9 },\n  { label: 'On Hold', value: 10 },\n];\n\n// Status colors matching mobile app (using design tokens from tokens.css)\nconst STATUS_COLORS = {\n  'Sales': 'var(--status-sales)',\n  'Site Survey': 'var(--status-site-survey)',\n  'Design': 'var(--status-design)',\n  'Revisions': 'var(--status-revisions)',\n  'Permits': 'var(--status-permits)',\n  'Install': 'var(--status-install)',\n  'Commissioning': 'var(--status-commissioning)',\n  'Inspection': 'var(--status-inspection)',\n  'PTO': 'var(--status-pto)',\n  'On Hold': 'var(--status-on-hold)',\n  'Canceled': 'var(--status-canceled)'\n};\n\n/**\n * ProjectsOverview - Comprehensive projects table with AG Grid\n * Displays all project data from /project endpoint\n */\nconst ProjectsOverview = ({ projects = [], loading = false, selectedStatus = 'all', onProjectsUpdate, onViewChatter, onNewProject, isNewProjectOpen = false }) => {\n  const [searchQuery, setSearchQuery] = useState('');\n  const [showRecentOnly, setShowRecentOnly] = useState(false);\n  const [projectsData, setProjectsData] = useState(projects);\n  const [hasRecentProjects, setHasRecentProjects] = useState(() => {\n    try {\n      const recent = JSON.parse(localStorage.getItem('recentProjects') || '{}');\n      return Object.keys(recent).length > 0;\n    } catch {\n      return false;\n    }\n  });\n  const gridRef = useRef(null);\n  const navigate = useNavigate();\n\n  // Update local state when projects prop changes\n  useEffect(() => {\n    setProjectsData(projects);\n  }, [projects]);\n\n  // Get user data to check if superuser\n  const userData = JSON.parse(sessionStorage.getItem('userData') || '{}');\n  const companyData = JSON.parse(sessionStorage.getItem('companyData') || '{}');\n  const isSuperAdmin = userData?.isSuperAdmin === true;\n\n  // Handle status change\n  const handleStatusChange = async (projectUuid, newStatus, oldStatus) => {\n    // Optimistic update\n    setProjectsData(prevProjects =>\n      prevProjects.map(project =>\n        project.uuid === projectUuid\n          ? { ...project, completed_step: newStatus }\n          : project\n      )\n    );\n\n    try {\n      await updateProjectStatus(projectUuid, companyData.uuid, newStatus);\n      toast.success('Status updated successfully', {\n        position: 'top-right',\n        autoClose: 2000,\n      });\n      // Notify parent component to refresh data if callback provided\n      if (onProjectsUpdate) {\n        onProjectsUpdate();\n      }\n    } catch (error) {\n      // Rollback on error\n      setProjectsData(prevProjects =>\n        prevProjects.map(project =>\n          project.uuid === projectUuid\n            ? { ...project, completed_step: oldStatus }\n            : project\n        )\n      );\n      toast.error('Failed to update status', {\n        position: 'top-right',\n        autoClose: 3000,\n      });\n      logger.error('Dashboard', 'Error updating status:', error);\n    }\n  };\n\n  // Action buttons component for AG Grid (Chat + Eye + Launch)\n  const ActionButtonsRenderer = (params) => {\n    const handleLaunchClick = () => {\n      // Track this project as recently accessed\n      const recentProjects = JSON.parse(localStorage.getItem('recentProjects') || '{}');\n      recentProjects[params.data.uuid] = Date.now();\n      localStorage.setItem('recentProjects', JSON.stringify(recentProjects));\n\n      // Update state to show Recent Projects button\n      setHasRecentProjects(true);\n\n      navigate(`/project/${params.data.uuid}`);\n    };\n\n    const handleChatClick = (e) => {\n      e.stopPropagation();\n\n      // Build project info object for the chatter header\n      const project = params.data;\n      const projectInfo = {\n        uuid: project.uuid,\n        customerName: `${project.details?.customer_last_name || ''}, ${project.details?.customer_first_name || ''}`.trim() || 'Unknown Customer',\n        address: project.site\n          ? `${project.site.address || ''}${project.site.city ? `, ${project.site.city}` : ''}${project.site.state ? `, ${project.site.state}` : ''}${project.site.zip_code ? ` ${project.site.zip_code}` : ''}`\n          : 'No address',\n        projectId: project.details?.installer_project_id || project.uuid?.slice(0, 8),\n        defaultTab: 'notes' // Open to notes tab\n      };\n\n      // Call the onViewChatter callback from props\n      if (params.context?.onViewChatter) {\n        params.context.onViewChatter(projectInfo);\n      }\n    };\n\n    const handleOverviewClick = (e) => {\n      e.stopPropagation();\n\n      // Build project info object for the chatter header\n      const project = params.data;\n      const projectInfo = {\n        uuid: project.uuid,\n        customerName: `${project.details?.customer_last_name || ''}, ${project.details?.customer_first_name || ''}`.trim() || 'Unknown Customer',\n        address: project.site\n          ? `${project.site.address || ''}${project.site.city ? `, ${project.site.city}` : ''}${project.site.state ? `, ${project.site.state}` : ''}${project.site.zip_code ? ` ${project.site.zip_code}` : ''}`\n          : 'No address',\n        projectId: project.details?.installer_project_id || project.uuid?.slice(0, 8),\n        defaultTab: 'overview' // Open to overview tab\n      };\n\n      // Call the onViewChatter callback from props\n      if (params.context?.onViewChatter) {\n        params.context.onViewChatter(projectInfo);\n      }\n    };\n\n    return (\n      <div className={styles.statusBadgeContainer}>\n        {/* Chat Bubble Icon - Opens Notes Tab */}\n        <button\n          onClick={handleChatClick}\n          title=\"View project notes\"\n          style={{\n            padding: '0.09375rem 0.125rem',\n            background: 'transparent',\n            border: 'none',\n            cursor: 'pointer',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            transition: 'all 0.2s',\n            marginRight: '0',\n          }}\n        >\n          <img\n            src={speechBubbleIcon}\n            alt=\"Notes\"\n            style={{\n              width: '32px',\n              height: '32px',\n              opacity: 1,\n              transition: 'all 0.2s',\n              filter: 'brightness(0) saturate(100%) invert(46%) sepia(98%) saturate(1648%) hue-rotate(202deg) brightness(101%) contrast(93%)',\n            }}\n          />\n        </button>\n\n        {/* Eye Icon - Opens Overview Tab */}\n        <button\n          onClick={handleOverviewClick}\n          title=\"View project overview\"\n          style={{\n            padding: '0.09375rem 0.125rem',\n            background: 'transparent',\n            border: 'none',\n            cursor: 'pointer',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            transition: 'all 0.2s',\n            marginRight: '0.25rem',\n          }}\n        >\n          <img\n            src={eyeIcon}\n            alt=\"Overview\"\n            style={{\n              width: '32px',\n              height: '32px',\n              opacity: 1,\n              transition: 'all 0.2s',\n              filter: 'brightness(0) saturate(100%) invert(46%) sepia(98%) saturate(1648%) hue-rotate(202deg) brightness(101%) contrast(93%)',\n            }}\n          />\n        </button>\n\n        {/* Launch Button */}\n        <LaunchButton onClick={handleLaunchClick} />\n      </div>\n    );\n  };\n\n  // Status cell renderer - editable dropdown\n  const StatusDropdown = (params) => {\n    const currentStatus = params.value ?? 0;\n    const statusName = STATUS_MAP[currentStatus] || 'Unknown';\n    const color = STATUS_COLORS[statusName] || 'var(--status-on-hold)';\n    const projectUuid = params.data.uuid;\n\n    const handleChange = (e) => {\n      const newStatus = parseInt(e.target.value, 10);\n      if (newStatus !== currentStatus) {\n        handleStatusChange(projectUuid, newStatus, currentStatus);\n      }\n    };\n\n    return (\n      <select\n        value={currentStatus}\n        onChange={handleChange}\n        style={{\n          width: '100%',\n          height: '100%',\n          padding: '0 0.5rem',\n          background: 'transparent',\n          border: 'none',\n          borderRadius: '0.25rem',\n          color: color,\n          fontWeight: 600,\n          fontSize: '0.875rem',\n          cursor: 'pointer',\n          appearance: 'none',\n          backgroundImage: `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%23FD7332' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 8l4 4 4-4'/%3E%3C/svg%3E\")`,\n          backgroundPosition: 'right 0.5rem center',\n          backgroundRepeat: 'no-repeat',\n          backgroundSize: '1em 1em',\n          paddingRight: '2rem'\n        }}\n      >\n        {STATUS_OPTIONS.map(option => (\n          <option\n            key={option.value}\n            value={option.value}\n            style={{\n              background: 'var(--gray-800)',\n              color: STATUS_COLORS[option.label] || 'var(--text-primary)',\n              padding: '0.5rem'\n            }}\n          >\n            {option.label}\n          </option>\n        ))}\n      </select>\n    );\n  };\n\n  // Column definitions\n  const columnDefs = useMemo(() => {\n    const baseCols = [];\n\n    // Actions (first column) - pinned left, no header text, not resizable\n    baseCols.push({\n      headerName: '',\n      field: '',\n      width: 160,\n      suppressSizeToFit: true,\n      pinned: 'left',\n      lockPosition: true,\n      resizable: false,\n      suppressMovable: true,\n      cellRenderer: ActionButtonsRenderer,\n      cellStyle: { display: 'flex', alignItems: 'center', justifyContent: 'center' },\n      headerClass: 'ag-header-cell-center',\n      headerTooltip: 'Actions'\n    });\n\n    // Company (second column for superadmin) - Pinned left\n    if (isSuperAdmin) {\n      baseCols.push({\n        headerName: 'Company',\n        field: 'company.name',\n        width: 160,\n        pinned: 'left',\n        lockPosition: true,\n        suppressSizeToFit: true,\n        headerTooltip: 'Company',\n        tooltipField: 'company.name'\n      });\n    }\n\n    // Customer (2nd/3rd column depending on superadmin) - Pinned left\n    baseCols.push({\n      headerName: 'Customer',\n      valueGetter: (params) => {\n        const first = params.data.details?.customer_first_name || '';\n        const last = params.data.details?.customer_last_name || '';\n        return `${last}, ${first}`;\n      },\n      width: 180,\n      sortable: true,\n      pinned: 'left',\n      lockPosition: true,\n      suppressSizeToFit: true,\n      headerTooltip: 'Customer Name',\n      tooltipValueGetter: (params) => {\n        const first = params.data.details?.customer_first_name || '';\n        const last = params.data.details?.customer_last_name || '';\n        return `${last}, ${first}`;\n      }\n    });\n\n    // Installer column (for superadmin only) - shows company name\n    if (isSuperAdmin) {\n      baseCols.push({\n        headerName: 'Installer',\n        field: 'company.name',\n        width: 160,\n        sortable: true,\n        editable: false,\n        pinned: 'left',\n        lockPosition: true,\n        suppressSizeToFit: true,\n        headerTooltip: 'Installer Company',\n        tooltipField: 'company.name'\n      });\n    }\n\n    // Project ID\n    baseCols.push({\n      headerName: 'Project ID',\n      field: 'details.installer_project_id',\n      width: 130,\n      cellRenderer: (params) => params.value || params.data.uuid.slice(0, 8),\n      headerTooltip: 'Project ID',\n      tooltipValueGetter: (params) => params.data.details?.installer_project_id || params.data.uuid\n    });\n\n    // Status\n    baseCols.push({\n      headerName: 'Status',\n      field: 'completed_step',\n      width: 140,\n      cellRenderer: StatusDropdown,\n      sortable: true,\n      cellStyle: { padding: '0' },\n      headerTooltip: 'Project Status'\n    });\n\n    // Address\n    baseCols.push({\n      headerName: 'Address',\n      valueGetter: (params) => {\n        const address = params.data.site?.address || '';\n        const city = params.data.site?.city || '';\n        const state = params.data.site?.state || '';\n        const zip = params.data.site?.zip_code || '';\n        const parts = [address, city, state, zip].filter(Boolean);\n        return parts.join(', ');\n      },\n      width: 220,\n      headerTooltip: 'Site Address',\n      tooltipValueGetter: (params) => {\n        const address = params.data.site?.address || '';\n        const city = params.data.site?.city || '';\n        const state = params.data.site?.state || '';\n        const zip = params.data.site?.zip_code || '';\n        const parts = [address, city, state, zip].filter(Boolean);\n        return parts.join(', ');\n      }\n    });\n\n    // Jurisdiction\n    baseCols.push({\n      headerName: 'Jurisdiction',\n      field: 'site.jurisdiction',\n      width: 140,\n      headerTooltip: 'Jurisdiction',\n      tooltipField: 'site.jurisdiction'\n    });\n\n    // Utility\n    baseCols.push({\n      headerName: 'Utility',\n      field: 'site.utility',\n      width: 120,\n      sortable: true,\n      headerTooltip: 'Utility Provider',\n      tooltipField: 'site.utility'\n    });\n\n    // Proposal\n    baseCols.push({\n      headerName: 'Proposal',\n      field: 'proposal_url',\n      width: 100,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'Proposal Document'\n    });\n\n    // Signatures\n    baseCols.push({\n      headerName: 'Signatures',\n      field: 'signatures_url',\n      width: 110,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'Customer Signatures'\n    });\n\n    // Site Survey\n    baseCols.push({\n      headerName: 'Site Survey',\n      field: 'site_survey_url',\n      width: 110,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'Site Survey Document'\n    });\n\n    // Site Plan\n    baseCols.push({\n      headerName: 'Site Plan',\n      field: 'site_plan_url',\n      width: 100,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'Site Plan Document'\n    });\n\n    // Plan Set\n    baseCols.push({\n      headerName: 'Plan Set',\n      field: 'plan_set_url',\n      width: 100,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'Plan Set Document'\n    });\n\n    // Permits\n    baseCols.push({\n      headerName: 'Permits',\n      field: 'permits_url',\n      width: 100,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'Permits Document'\n    });\n\n    // Interconnection\n    baseCols.push({\n      headerName: 'Interconnection',\n      field: 'interconnection_url',\n      width: 130,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'Interconnection Agreement'\n    });\n\n    // HOA\n    baseCols.push({\n      headerName: 'HOA',\n      field: 'hoa_url',\n      width: 90,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'HOA Approval'\n    });\n\n    // Install\n    baseCols.push({\n      headerName: 'Install',\n      field: 'install_url',\n      width: 90,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'Installation Photos'\n    });\n\n    // Commission\n    baseCols.push({\n      headerName: 'Commission',\n      field: 'commission_url',\n      width: 110,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'Commission Documents'\n    });\n\n    // Inspection\n    baseCols.push({\n      headerName: 'Inspection',\n      field: 'inspection_url',\n      width: 110,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'Inspection Reports'\n    });\n\n    // PTO\n    baseCols.push({\n      headerName: 'PTO',\n      field: 'pto_url',\n      width: 90,\n      cellRenderer: (params) => {\n        if (!params.value) return '-';\n        return `<a href=\"${params.value}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: var(--color-link); text-decoration: underline;\">View</a>`;\n      },\n      headerTooltip: 'Permission To Operate'\n    });\n\n    return baseCols;\n  }, [isSuperAdmin]);\n\n  // Map selectedStatus to completed_step value\n  const STATUS_STEP_MAP = {\n    all: null,\n    sales: 0,\n    site_survey: 1,\n    design: [2, 3], // Includes both Design and Revisions\n    permits: 4,\n    install: 5,\n    commissioning: 6,\n    inspection: 7,\n    pto: 8,\n  };\n\n  // Filter projects based on search and status\n  const filteredProjects = useMemo(() => {\n    let filtered = [...projectsData];\n\n    // Filter by status\n    if (selectedStatus !== 'all') {\n      const stepValue = STATUS_STEP_MAP[selectedStatus];\n      if (stepValue !== undefined && stepValue !== null) {\n        // Handle array of step values (e.g., Design includes steps 2 and 3)\n        if (Array.isArray(stepValue)) {\n          filtered = filtered.filter(p => stepValue.includes(p.completed_step));\n        } else {\n          filtered = filtered.filter(p => p.completed_step === stepValue);\n        }\n      }\n    }\n\n    // Filter by recent projects\n    if (showRecentOnly) {\n      const recentProjects = JSON.parse(localStorage.getItem('recentProjects') || '{}');\n      const recentUuids = Object.keys(recentProjects);\n\n      // Filter to only include projects that have been launched\n      filtered = filtered.filter(p => recentUuids.includes(p.uuid));\n\n      // Sort by most recent first\n      filtered.sort((a, b) => {\n        const timeA = recentProjects[a.uuid] || 0;\n        const timeB = recentProjects[b.uuid] || 0;\n        return timeB - timeA; // Most recent first\n      });\n    }\n\n    // Filter by search query\n    if (searchQuery.trim()) {\n      const query = searchQuery.toLowerCase();\n      filtered = filtered.filter(p => {\n        const customerName = `${p.details?.customer_first_name || ''} ${p.details?.customer_last_name || ''}`.toLowerCase();\n        const projectId = (p.details?.installer_project_id || '').toLowerCase();\n        const address = (p.site?.address || '').toLowerCase();\n        const city = (p.site?.city || '').toLowerCase();\n        const companyName = (p.company?.name || '').toLowerCase();\n\n        return customerName.includes(query) ||\n               projectId.includes(query) ||\n               address.includes(query) ||\n               city.includes(query) ||\n               companyName.includes(query);\n      });\n    }\n\n    return filtered;\n  }, [projectsData, searchQuery, selectedStatus, showRecentOnly]);\n\n  // Default column definitions for AG Grid\n  const defaultColDef = useMemo(() => ({\n    sortable: true,\n    filter: false,\n    resizable: true,\n    suppressMovable: true,\n    minWidth: 80\n  }), []);\n\n  // Row class rules for highlighting selected projects\n  const getRowClass = (params) => {\n    // Add custom class for better visibility when row is selected\n    return params.node.isSelected() ? 'ag-row-selected-custom' : '';\n  };\n\n  if (loading) {\n    return (\n      <div className={styles.projectsOverviewContainer}>\n        <div className={styles.emptyStateCenter}>\n          <div className={styles.emptyStateIcon}>â³</div>\n          <p>Loading projects...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={styles.projectsOverviewContainer}>\n      {/* Search Filter with New Project Button */}\n      <div className={styles.filters}>\n        <button\n          onClick={onNewProject}\n          className={`${styles.projectsNewButton} ${\n            isNewProjectOpen ? styles.projectsNewButtonActive : styles.projectsNewButtonInactive\n          }`}\n        >\n          <span className={styles.projectsNewButtonIcon}>+</span>\n          <span>Project</span>\n        </button>\n        <input\n          type=\"text\"\n          placeholder=\"Search by customer, project ID, address, or company...\"\n          value={searchQuery}\n          onChange={(e) => setSearchQuery(e.target.value)}\n          className={`${styles.filterInput} ${styles.searchInputContainer}`}\n        />\n        <div className={styles.searchSpacer} />\n        {hasRecentProjects && (\n          <button\n            onClick={() => setShowRecentOnly(!showRecentOnly)}\n            className={`${styles.recentProjectsButton} ${\n              showRecentOnly ? styles.recentProjectsButtonActive : styles.recentProjectsButtonInactive\n            }`}\n            onMouseEnter={(e) => {\n              if (showRecentOnly) {\n                e.currentTarget.style.transform = 'translateY(-1px)';\n                e.currentTarget.style.boxShadow = '0 4px 12px rgba(253, 115, 50, 0.4)';\n              } else {\n                e.currentTarget.style.transform = 'translateY(-1px)';\n                e.currentTarget.style.background = 'rgba(255, 255, 255, 0.05)';\n                e.currentTarget.style.borderColor = 'rgba(255, 255, 255, 0.3)';\n              }\n            }}\n            onMouseLeave={(e) => {\n              e.currentTarget.style.transform = 'translateY(0)';\n              if (showRecentOnly) {\n                e.currentTarget.style.boxShadow = '0 2px 8px rgba(253, 115, 50, 0.3)';\n              } else {\n                e.currentTarget.style.background = CSS_GRADIENTS.PANEL;\n                e.currentTarget.style.borderColor = 'rgba(255, 255, 255, 0.2)';\n              }\n            }}\n          >\n            Recent Projects\n          </button>\n        )}\n      </div>\n\n      {/* Projects Table */}\n      {filteredProjects.length === 0 ? (\n        <div className={styles.emptyState}>\n          <div className={styles.emptyStateIcon}>ðŸ”</div>\n          <h3 className={styles.emptyStateTitle}>No Projects Found</h3>\n          <p className={styles.emptyStateDescription}>\n            {searchQuery ? 'Try adjusting your search or filters' : 'No projects match the selected filters'}\n          </p>\n        </div>\n      ) : (\n        <div\n          className={`${styles.agGridDark} ${styles.agGridContainer} ${styles.projectsGridContainer}`}\n        >\n          <AgGridReact\n            ref={gridRef}\n            rowData={filteredProjects}\n            columnDefs={columnDefs}\n            defaultColDef={defaultColDef}\n            context={{ onViewChatter }}\n            pagination={false}\n            rowHeight={38}\n            headerHeight={38}\n            animateRows={true}\n            domLayout=\"normal\"\n            getRowClass={getRowClass}\n            enableRangeSelection={false}\n          />\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ProjectsOverview;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\dashboard\\SitePlanVersions.js","messages":[{"ruleId":"jsx-a11y/anchor-is-valid","severity":1,"message":"The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/anchor-is-valid.md","line":44,"column":15,"nodeType":"JSXOpeningElement","endLine":54,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport styles from '../../styles/Dashboard.module.css';\nimport { SearchableDropdown, Button } from '../ui';\nimport ChatterPanel from '../chatter/ChatterPanel';\nimport portalStyles from '../../styles/Portal.module.css';\n\n/**\n * SitePlanVersions - Site Plan tab with Draft/Published sub-tabs\n * Manages site plan versions and CAD integration\n */\nconst SitePlanVersions = ({ projectUuid, projectName }) => {\n  const navigate = useNavigate();\n  const [currentView, setCurrentView] = useState('draft');\n  const [selectedVersion, setSelectedVersion] = useState('19');\n\n  // Mock version data - will be replaced with API call later\n  const versions = [\n    { value: '19', label: 'V19 (Latest)' },\n    { value: '18', label: 'V18' },\n    { value: '17', label: 'V17' },\n  ];\n\n  // Define sub-tabs\n  const viewSteps = [\n    // { key: 'cad', label: 'CAD' },\n    { key: 'draft', label: 'Draft' },\n    { key: 'published', label: 'Published' },\n  ];\n\n  const handleVersionChange = (version) => {\n    setSelectedVersion(version);\n  };\n\n  return (\n    <div className={styles.mainContainer}>\n      {/* Header: Sub-tab Navigation + Version Dropdown + Drafter Portal Button */}\n      <div className={styles.headerSection}>\n        {/* Left Side: Sub-tab Navigation + Version Dropdown */}\n        <div className={styles.headerLeft}>\n          {/* Sub-tab Navigation */}\n          <div className={styles.viewNavigation}>\n            {viewSteps.map((view, index) => (\n              <a\n                key={view.key}\n                href=\"#\"\n                onClick={(e) => {\n                  e.preventDefault();\n                  setCurrentView(view.key);\n                }}\n                className={`${styles.viewLink} ${index === 0 ? styles.viewLinkFirst : ''} ${\n                  currentView === view.key ? styles.viewLinkActive : ''\n                }`}\n              >\n                {view.label}\n                {currentView === view.key && (\n                  <span className={`${styles.viewLinkIndicator} ${index === 0 ? styles.viewLinkIndicatorFirst : styles.viewLinkIndicatorCenter}`} />\n                )}\n              </a>\n            ))}\n\n            {/* Version Dropdown */}\n            {(currentView === 'draft' || currentView === 'published') && (\n              <div className={styles.versionDropdown}>\n                <SearchableDropdown\n                  value={selectedVersion}\n                  onChange={handleVersionChange}\n                  options={versions}\n                  placeholder=\"Select version...\"\n                />\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Right Side: Drafter Portal Button */}\n        <div className={styles.headerRight}>\n          <Button\n            variant=\"primary\"\n            size=\"sm\"\n            onClick={() => navigate('/drafterportal')}\n          >\n            Drafter Portal\n          </Button>\n        </div>\n      </div>\n\n      {/* Content Area */}\n      <div className={styles.contentArea}>\n        {/* CAD view commented out */}\n        {/* {currentView === 'cad' && (\n          <div className={styles.pdfContainer}>\n            <div className={portalStyles.comingSoonContainer}>\n              <div className={portalStyles.comingSoonIcon}>ðŸ–¥ï¸</div>\n              <h3 className={portalStyles.comingSoonHeading}>CAD Integration</h3>\n              <p>CAD launcher functionality will be available soon</p>\n            </div>\n          </div>\n        )} */}\n\n        {currentView === 'draft' && (\n          <div className={styles.pdfContainer}>\n            <div className={portalStyles.comingSoonContainer}>\n              <div className={portalStyles.comingSoonIcon}>ðŸ“„</div>\n              <h3 className={portalStyles.comingSoonHeading}>Draft Site Plans</h3>\n              <p>Draft site plan viewer coming soon</p>\n            </div>\n          </div>\n        )}\n\n        {currentView === 'published' && (\n          <div className={styles.pdfContainer}>\n            <div className={portalStyles.comingSoonContainer}>\n              <div className={portalStyles.comingSoonIcon}>âœ“</div>\n              <h3 className={portalStyles.comingSoonHeading}>Published Site Plans</h3>\n              <p>Published site plan viewer coming soon</p>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Chatter Panel - Always visible on right side */}\n      {projectUuid && (\n        <div className={portalStyles.chatterContainer} style={{\n          position: 'absolute',\n          right: 0,\n          top: '80px',\n          width: '300px',\n          maxHeight: 'calc(100vh - 200px)'\n        }}>\n          <ChatterPanel\n            projectUuid={projectUuid}\n            projectName={projectName}\n            isDrawer={false}\n            maxHeight=\"calc(100vh - 200px)\"\n          />\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default SitePlanVersions;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\dashboard\\StatCard.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\dashboard\\StatusTabCard.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'CSS_GRADIENTS' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect } from 'react';\nimport { motion, useSpring, useTransform } from 'framer-motion';\nimport styles from '../../styles/Dashboard.module.css';\nimport { CSS_GRADIENTS } from '../../styles/gradient';\n\n/**\n * Animated number counter component\n */\nconst AnimatedCounter = ({ value }) => {\n  const spring = useSpring(0, { stiffness: 100, damping: 30 });\n  const display = useTransform(spring, (current) => Math.round(current));\n  const [displayValue, setDisplayValue] = React.useState(0);\n\n  useEffect(() => {\n    spring.set(value);\n  }, [spring, value]);\n\n  useEffect(() => {\n    const unsubscribe = display.on('change', (latest) => {\n      setDisplayValue(latest);\n    });\n    return unsubscribe;\n  }, [display]);\n\n  return <span>{displayValue}</span>;\n};\n\n/**\n * StatusTabCard - Individual status tab with file folder effect\n *\n * @param {string} label - Status label (e.g., \"All\", \"Design\")\n * @param {number} count - Number of projects in this status\n * @param {number} change - Change from last month (can be negative)\n * @param {string} color - Status color (hex)\n * @param {boolean} isSelected - Whether this tab is selected\n * @param {function} onClick - Click handler\n * @param {boolean} loading - Loading state\n * @param {boolean} showMetrics - Whether to show count and change metrics\n * @param {string} customColor - Custom background color for selected tab\n */\nconst StatusTabCard = ({\n  label,\n  count = 0,\n  change = 0,\n  color,\n  isSelected = false,\n  onClick,\n  loading = false,\n  showMetrics = true,\n  customColor\n}) => {\n  if (loading) {\n    return (\n      <button\n        className={`${styles.statusTab} ${styles.statusTabLoading}`}\n        disabled\n      >\n        <div className={`${styles.skeleton} ${styles.skeletonLabel}`}></div>\n        <div className={`${styles.skeleton} ${styles.skeletonCount}`}></div>\n        <div className={`${styles.skeleton} ${styles.skeletonChange}`}></div>\n      </button>\n    );\n  }\n\n  return (\n    <motion.button\n      onClick={onClick}\n      className={`${styles.statusTab} ${isSelected ? styles.statusTabSelected : ''}`}\n      style={{\n        background: isSelected && customColor ? customColor : undefined\n      }}\n      initial={{ opacity: 0, y: -10 }}\n      animate={{ opacity: 1, y: 0 }}\n      whileHover={!isSelected ? { y: -2 } : undefined}\n      transition={{ duration: 0.2 }}\n    >\n      {/* Status Label */}\n      <span className={styles.statusTabLabelWrapper}>\n        <span className={styles.statusTabLabelText}>\n          {label}\n        </span>\n        {isSelected && (\n          <span className={styles.statusTabUnderline} />\n        )}\n      </span>\n\n      {/* Count */}\n      {showMetrics && (\n        <span className={styles.statusTabCount}>\n          <AnimatedCounter value={count} />\n        </span>\n      )}\n    </motion.button>\n  );\n};\n\nexport default StatusTabCard;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\dashboard\\StatusTabs.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\debug\\ImagePerformanceTracker.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\debug\\PerformanceMonitor.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\dev\\DevPanel.js","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has an unnecessary dependency: 'logs'. Either exclude it or remove the dependency array.","line":33,"column":6,"nodeType":"ArrayExpression","endLine":33,"endColumn":54,"suggestions":[{"desc":"Update the dependencies array to be: [levelFilter, categoryFilter, searchQuery]","fix":{"range":[986,1034],"text":"[levelFilter, categoryFilter, searchQuery]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has an unnecessary dependency: 'logs'. Either exclude it or remove the dependency array.","line":38,"column":6,"nodeType":"ArrayExpression","endLine":38,"endColumn":12,"suggestions":[{"desc":"Update the dependencies array to be: []","fix":{"range":[1142,1148],"text":"[]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has an unnecessary dependency: 'logs'. Either exclude it or remove the dependency array.","line":43,"column":6,"nodeType":"ArrayExpression","endLine":43,"endColumn":12,"suggestions":[{"desc":"Update the dependencies array to be: []","fix":{"range":[1250,1256],"text":"[]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo } from 'react';\nimport logger from '../../services/devLogger';\nimport styles from './DevPanel.module.css';\n\n/**\n * DEVPANEL LITE - Development Logging UI\n *\n * Simple floating panel for viewing and managing development logs\n * Only renders in development mode\n */\nconst DevPanel = () => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [logs, setLogs] = useState([]);\n  const [levelFilter, setLevelFilter] = useState('');\n  const [categoryFilter, setCategoryFilter] = useState('');\n  const [searchQuery, setSearchQuery] = useState('');\n\n  // Subscribe to log updates\n  useEffect(() => {\n    const unsubscribe = logger.subscribe((newLogs) => {\n      setLogs(newLogs);\n    });\n\n    // Initialize with current logs\n    setLogs(logger.getLogs());\n\n    return unsubscribe;\n  }, []);\n\n  // Filter logs\n  const filteredLogs = useMemo(() => {\n    return logger.getFilteredLogs(levelFilter || null, categoryFilter || null, searchQuery);\n  }, [logs, levelFilter, categoryFilter, searchQuery]);\n\n  // Get unique categories\n  const categories = useMemo(() => {\n    return logger.getCategories();\n  }, [logs]);\n\n  // Get error count\n  const errorCount = useMemo(() => {\n    return logger.getErrorCount();\n  }, [logs]);\n\n  // Handle copy to clipboard\n  const handleCopy = async () => {\n    const success = await logger.copyToClipboard(filteredLogs);\n    if (success) {\n      alert('Logs copied to clipboard! Paste into Claude Code for analysis.');\n    } else {\n      alert('Failed to copy logs to clipboard');\n    }\n  };\n\n  // Handle clear logs\n  const handleClear = () => {\n    if (window.confirm('Clear all logs?')) {\n      logger.clear();\n    }\n  };\n\n  // Don't render in production\n  if (process.env.NODE_ENV !== 'development') {\n    return null;\n  }\n\n  return (\n    <>\n      {/* Toggle Button */}\n      <button\n        className={styles.toggleButton}\n        onClick={() => setIsOpen(!isOpen)}\n        title=\"DevLogger\"\n      >\n        <span className={styles.toggleIcon}>ðŸ”§</span>\n        {errorCount > 0 && (\n          <span className={styles.errorBadge}>{errorCount}</span>\n        )}\n      </button>\n\n      {/* Panel */}\n      {isOpen && (\n        <div className={styles.panel}>\n          {/* Header */}\n          <div className={styles.header}>\n            <h3 className={styles.title}>DevLogger Lite</h3>\n            <button\n              className={styles.closeButton}\n              onClick={() => setIsOpen(false)}\n              title=\"Close\"\n            >\n              Ã—\n            </button>\n          </div>\n\n          {/* Controls */}\n          <div className={styles.controls}>\n            {/* Level Filter */}\n            <select\n              className={styles.select}\n              value={levelFilter}\n              onChange={(e) => setLevelFilter(e.target.value)}\n            >\n              <option value=\"\">All Levels</option>\n              <option value=\"CRITICAL\">Critical</option>\n              <option value=\"ERROR\">Error</option>\n              <option value=\"WARN\">Warning</option>\n              <option value=\"SUCCESS\">Success</option>\n              <option value=\"INFO\">Info</option>\n              <option value=\"DEBUG\">Debug</option>\n            </select>\n\n            {/* Category Filter */}\n            <select\n              className={styles.select}\n              value={categoryFilter}\n              onChange={(e) => setCategoryFilter(e.target.value)}\n            >\n              <option value=\"\">All Categories</option>\n              {categories.map(cat => (\n                <option key={cat} value={cat}>{cat}</option>\n              ))}\n            </select>\n\n            {/* Search */}\n            <input\n              type=\"text\"\n              className={styles.searchInput}\n              placeholder=\"Search logs...\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n            />\n          </div>\n\n          {/* Actions */}\n          <div className={styles.actions}>\n            <button\n              className={styles.actionButton}\n              onClick={handleCopy}\n              title=\"Copy logs for Claude Code\"\n            >\n              ðŸ“‹ Copy for Claude\n            </button>\n            <button\n              className={styles.actionButton}\n              onClick={handleClear}\n              title=\"Clear all logs\"\n            >\n              ðŸ—‘ï¸ Clear\n            </button>\n            <span className={styles.logCount}>\n              {filteredLogs.length} / {logs.length} logs\n            </span>\n          </div>\n\n          {/* Log List */}\n          <div className={styles.logList}>\n            {filteredLogs.length === 0 ? (\n              <div className={styles.emptyState}>\n                No logs to display\n              </div>\n            ) : (\n              filteredLogs.map(log => (\n                <div\n                  key={log.id}\n                  className={`${styles.logEntry} ${styles[`level${log.level}`]}`}\n                >\n                  <div className={styles.logHeader}>\n                    <span className={styles.logLevel}>{log.level}</span>\n                    <span className={styles.logCategory}>{log.category}</span>\n                    <span className={styles.logTime}>\n                      {log.timestamp.toLocaleTimeString()}\n                    </span>\n                  </div>\n                  <div className={styles.logMessage}>{log.message}</div>\n                </div>\n              ))\n            )}\n          </div>\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default DevPanel;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\equipment\\PreferredEquipmentModal.js","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadPreferredEquipment'. Either include it or remove the dependency array.","line":36,"column":6,"nodeType":"ArrayExpression","endLine":36,"endColumn":40,"suggestions":[{"desc":"Update the dependencies array to be: [isOpen, companyId, equipmentType, loadPreferredEquipment]","fix":{"range":[1338,1372],"text":"[isOpen, companyId, equipmentType, loadPreferredEquipment]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * PreferredEquipmentModal - Quick selection from company's preferred equipment\n *\n * Shows a simple list of preferred equipment for quick selection.\n * User clicks an item â†’ modal closes and returns selected make/model.\n */\n\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport Modal from '../ui/Modal';\nimport { getPreferredEquipment } from '../../services/preferredEquipmentService';\nimport styles from './PreferredEquipmentModal.module.css';\n\nconst PreferredEquipmentModal = ({\n  isOpen,\n  onClose,\n  onSelect,      // Called with { make, model, wattage? } when user selects\n  onSelectOther, // Called when user wants to use full catalog instead\n  equipmentType, // 'solar-panels', 'inverters', 'micro-inverters', 'batteries', etc.\n  title,         // e.g., \"Select Solar Panel\"\n}) => {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const [equipment, setEquipment] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // Get company ID from session\n  const userData = JSON.parse(sessionStorage.getItem('userData') || '{}');\n  const companyId = userData?.company?.uuid;\n\n  useEffect(() => {\n    if (isOpen && companyId && equipmentType) {\n      loadPreferredEquipment();\n    }\n  }, [isOpen, companyId, equipmentType]);\n\n  const loadPreferredEquipment = async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const data = await getPreferredEquipment(companyId, equipmentType);\n      const items = Array.isArray(data) ? data : data?.data || [];\n      setEquipment(items);\n    } catch (err) {\n      console.error('[PreferredEquipmentModal] Error loading equipment:', err);\n      setError('Failed to load preferred equipment');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSelect = (item) => {\n    onSelect({\n      make: item.make,\n      model: item.model,\n      wattage: item.wattage || null,\n      isDefault: item.is_default,\n    });\n    onClose();\n  };\n\n  const handleSelectOther = () => {\n    if (onSelectOther) {\n      onSelectOther();\n    }\n    onClose();\n  };\n\n  const handleGoToInventory = () => {\n    // Save current project location for return navigation\n    sessionStorage.setItem('returnToProject', location.pathname);\n    onClose();\n    navigate('/account', { state: { openInventory: true } });\n  };\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onClose={onClose}\n      title={title || 'Select Preferred Equipment'}\n      size=\"md\"\n      contained={true}\n    >\n      <div className={styles.modalContent}>\n        {loading ? (\n          <div className={styles.loadingState}>\n            <div className={styles.spinner} />\n            <p>Loading preferred equipment...</p>\n          </div>\n        ) : error ? (\n          <div className={styles.errorState}>\n            <p>{error}</p>\n            <button onClick={loadPreferredEquipment} className={styles.retryButton}>\n              Retry\n            </button>\n          </div>\n        ) : equipment.length === 0 ? (\n          <div className={styles.emptyState}>\n            <p className={styles.emptyTitle}>No Preferred Equipment</p>\n            <p className={styles.emptyHint}>\n              You haven't added any preferred equipment yet.\n            </p>\n            <div className={styles.emptyActions}>\n              <button onClick={handleGoToInventory} className={styles.inventoryButton}>\n                Go to Inventory\n              </button>\n              <button onClick={handleSelectOther} className={styles.otherButton}>\n                Select from Full Catalog\n              </button>\n            </div>\n          </div>\n        ) : (\n          <>\n            <p className={styles.instruction}>\n              Click to select, or choose \"Other\" to browse full catalog.\n            </p>\n\n            <div className={styles.equipmentList}>\n              {equipment.map((item) => (\n                <button\n                  key={item.uuid}\n                  className={`${styles.equipmentItem} ${item.is_default ? styles.defaultItem : ''}`}\n                  onClick={() => handleSelect(item)}\n                >\n                  <div className={styles.equipmentInfo}>\n                    <span className={styles.make}>{item.make}</span>\n                    <span className={styles.model}>{item.model}</span>\n                  </div>\n                  {item.is_default && (\n                    <span className={styles.defaultBadge}>Default</span>\n                  )}\n                </button>\n              ))}\n            </div>\n\n            <div className={styles.footer}>\n              <button onClick={handleSelectOther} className={styles.otherButton}>\n                Other (Full Catalog)\n              </button>\n            </div>\n          </>\n        )}\n      </div>\n    </Modal>\n  );\n};\n\nexport default PreferredEquipmentModal;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\equipment\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\maps\\AerialViewMap.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\maps\\AzimuthFinder.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'compassRef' is assigned a value but never used.","line":25,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":19},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'isLocked'. Either include it or remove the dependency array.","line":127,"column":6,"nodeType":"ArrayExpression","endLine":127,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [isLocked, lat, lng]","fix":{"range":[4454,4464],"text":"[isLocked, lat, lng]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'redrawCanvas'. Either include it or remove the dependency array. Mutable values like 'googleMapRef.current' aren't valid dependencies because mutating them doesn't re-render the component.","line":187,"column":6,"nodeType":"ArrayExpression","endLine":187,"endColumn":28,"suggestions":[{"desc":"Update the dependencies array to be: [redrawCanvas]","fix":{"range":[6156,6178],"text":"[redrawCanvas]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'calculateAzimuth', 'drawCompass', and 'drawMeasurement'. Either include them or remove the dependency array.","line":226,"column":6,"nodeType":"ArrayExpression","endLine":226,"endColumn":176,"suggestions":[{"desc":"Update the dependencies array to be: [showCompass, measurements, drawing, startPoint, currentPoint, drawCompass, selectedMeasurement, drawMeasurement, calculateAzimuth, selectedPlane]","fix":{"range":[7347,7517],"text":"[showCompass, measurements, drawing, startPoint, currentPoint, drawCompass, selectedMeasurement, drawMeasurement, calculateAzimuth, selectedPlane]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'handleCopyToClipboard', 'handleDeleteSelected', 'redo', and 'undo'. Either include them or remove the dependency array.","line":578,"column":6,"nodeType":"ArrayExpression","endLine":578,"endColumn":55,"suggestions":[{"desc":"Update the dependencies array to be: [selectedMeasurement, measurements, historyIndex, handleDeleteSelected, undo, redo, handleCopyToClipboard]","fix":{"range":[17770,17819],"text":"[selectedMeasurement, measurements, historyIndex, handleDeleteSelected, undo, redo, handleCopyToClipboard]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useRef, useState, useEffect, useCallback } from 'react';\nimport PropTypes from 'prop-types';\nimport { toast } from 'react-toastify';\nimport html2canvas from 'html2canvas';\nimport azimuthService from '../../services/azimuthService';\nimport LoadingSpinner from '../ui/LoadingSpinner';\nimport styles from './AzimuthFinder.module.css';\n\n/**\n * AzimuthFinder - Interactive tool for measuring roof plane orientations\n * Features compass overlay, multi-plane support, and project file integration\n */\nconst AzimuthFinder = ({\n  lat,\n  lng,\n  address,\n  projectUuid,\n  initialMeasurements = [],\n  onMeasurementsChange,\n}) => {\n  const mapContainerRef = useRef(null); // Container for map + canvas (for screenshot)\n  const mapRef = useRef(null);\n  const googleMapRef = useRef(null);\n  const canvasRef = useRef(null);\n  const compassRef = useRef(null);\n\n  // State\n  const [measurements, setMeasurements] = useState(initialMeasurements);\n  const [isLocked, setIsLocked] = useState(false);\n  const [selectedPlane, setSelectedPlane] = useState(1);\n  const [showExtraPlanes, setShowExtraPlanes] = useState(false);\n  const [showLabels, setShowLabels] = useState(true);\n  const [snapToAngles, setSnapToAngles] = useState(false);\n  const [showCompass, setShowCompass] = useState(false); // Compass OFF by default\n  const [compassColor, setCompassColor] = useState('white');\n  const [compassSize, setCompassSize] = useState(300);\n  const [compassOpacity, setCompassOpacity] = useState(0.7);\n  const [compassPosition, setCompassPosition] = useState({ x: 0, y: 0 }); // Offset from center, (0,0) = centered\n  const [drawing, setDrawing] = useState(false);\n  const [startPoint, setStartPoint] = useState(null);\n  const [currentPoint, setCurrentPoint] = useState(null);\n  const [history, setHistory] = useState([]);\n  const [historyIndex, setHistoryIndex] = useState(-1);\n  const [selectedMeasurement, setSelectedMeasurement] = useState(null);\n  const [saving, setSaving] = useState(false);\n  const [isDraggingCompass, setIsDraggingCompass] = useState(false);\n\n  // Plane colors for canvas drawing - matches design tokens\n  // Canvas API requires actual hex values, not CSS variables\n  const planeColors = [\n    'var(--color-info)', // --color-accent-blue\n    'var(--color-success)', // --color-success\n    'var(--color-warning)', // --color-warning\n    '#8B5CF6', // --color-accent-purple\n    '#EC4899', // --color-accent-pink\n    '#06B6D4', // --color-accent-cyan\n    '#EAB308', // Yellow (custom)\n    'var(--color-error)', // --color-error\n  ];\n\n  // Cardinal directions\n  const getCardinalDirection = (azimuth) => {\n    const directions = ['N', 'NE', 'E', 'SE', 'S', 'SW', 'W', 'NW'];\n    const index = Math.round(azimuth / 45) % 8;\n    return directions[index];\n  };\n\n  // Calculate azimuth from two points\n  const calculateAzimuth = (start, end) => {\n    const dx = end.x - start.x;\n    const dy = start.y - end.y; // Inverted because canvas y increases downward\n    let angle = Math.atan2(dx, dy) * (180 / Math.PI);\n    if (angle < 0) angle += 360;\n\n    // Snap to 45Â° if enabled\n    if (snapToAngles) {\n      angle = Math.round(angle / 45) * 45;\n    }\n\n    return Math.round(angle);\n  };\n\n  // Initialize Google Map\n  useEffect(() => {\n    if (!lat || !lng || !window.google || !mapRef.current) return;\n\n    const position = { lat, lng };\n\n    const map = new window.google.maps.Map(mapRef.current, {\n      center: position,\n      zoom: 21, // Maximum zoom for highest detail\n      mapTypeId: 'satellite',\n      tilt: 0, // Force overhead view for accurate measurements\n      heading: 0,\n\n      // Enable Google's native compass (shows N/E/S/W)\n      rotateControl: true,\n      rotateControlOptions: {\n        position: window.google.maps.ControlPosition.RIGHT_TOP\n      },\n\n      // Other controls\n      streetViewControl: false,\n      fullscreenControl: true,\n      zoomControl: true,\n      zoomControlOptions: {\n        position: window.google.maps.ControlPosition.RIGHT_BOTTOM\n      },\n      scaleControl: true,\n      mapTypeControl: true,\n      mapTypeControlOptions: {\n        position: window.google.maps.ControlPosition.TOP_RIGHT,\n        mapTypeIds: ['satellite', 'hybrid']\n      },\n\n      draggable: !isLocked,\n      scrollwheel: !isLocked,\n      disableDoubleClickZoom: isLocked,\n    });\n\n    googleMapRef.current = map;\n\n    // Update map draggable state when lock changes\n    return () => {\n      googleMapRef.current = null;\n    };\n  }, [lat, lng]);\n\n  // Update map controls when lock state changes\n  useEffect(() => {\n    if (googleMapRef.current) {\n      googleMapRef.current.setOptions({\n        draggable: !isLocked,\n        scrollwheel: !isLocked,\n        disableDoubleClickZoom: isLocked,\n      });\n    }\n  }, [isLocked]);\n\n  // Initialize canvas and handle resizing with device pixel ratio support\n  useEffect(() => {\n    if (!canvasRef.current || !mapRef.current) return;\n\n    const canvas = canvasRef.current;\n    const mapContainer = mapRef.current;\n\n    const resizeCanvas = () => {\n      const rect = mapContainer.getBoundingClientRect();\n      const dpr = window.devicePixelRatio || 1;\n\n      // Set actual size in memory (scaled for high-DPI displays)\n      canvas.width = rect.width * dpr;\n      canvas.height = rect.height * dpr;\n\n      // Set display size (CSS pixels)\n      canvas.style.width = rect.width + 'px';\n      canvas.style.height = rect.height + 'px';\n\n      // Scale context to match device pixel ratio\n      const ctx = canvas.getContext('2d');\n      ctx.scale(dpr, dpr);\n\n      redrawCanvas();\n    };\n\n    // Initial size\n    resizeCanvas();\n\n    // Resize on window resize\n    window.addEventListener('resize', resizeCanvas);\n\n    // Also resize when map is fully loaded\n    if (googleMapRef.current && window.google) {\n      const listener = window.google.maps.event.addListenerOnce(\n        googleMapRef.current,\n        'idle',\n        resizeCanvas\n      );\n\n      return () => {\n        window.removeEventListener('resize', resizeCanvas);\n        if (listener) window.google.maps.event.removeListener(listener);\n      };\n    }\n\n    return () => window.removeEventListener('resize', resizeCanvas);\n  }, [googleMapRef.current]);\n\n  // Redraw canvas\n  const redrawCanvas = useCallback(() => {\n    if (!canvasRef.current) return;\n\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    const dpr = window.devicePixelRatio || 1;\n\n    // Get display dimensions (CSS pixels)\n    const displayWidth = canvas.width / dpr;\n    const displayHeight = canvas.height / dpr;\n\n    // Clear canvas (use display dimensions since ctx is already scaled)\n    ctx.clearRect(0, 0, displayWidth, displayHeight);\n\n    // Draw compass only if enabled\n    if (showCompass) {\n      drawCompass(ctx, displayWidth, displayHeight);\n    }\n\n    // Draw all measurements\n    measurements.forEach((measurement, index) => {\n      const isSelected = selectedMeasurement === index;\n      drawMeasurement(ctx, measurement, isSelected);\n    });\n\n    // Draw current drawing line\n    if (drawing && startPoint && currentPoint) {\n      const azimuth = calculateAzimuth(startPoint, currentPoint);\n      const tempMeasurement = {\n        start: startPoint,\n        end: currentPoint,\n        azimuth,\n        plane: selectedPlane,\n      };\n      drawMeasurement(ctx, tempMeasurement, false, true);\n    }\n  }, [measurements, selectedMeasurement, drawing, startPoint, currentPoint, selectedPlane, compassPosition, compassSize, compassOpacity, compassColor, showLabels, showCompass]);\n\n  // Draw compass overlay\n  const drawCompass = (ctx, displayWidth, displayHeight) => {\n    // Calculate center position (display center + offset)\n    const centerX = (displayWidth / 2) + compassPosition.x;\n    const centerY = (displayHeight / 2) + compassPosition.y;\n    const radius = compassSize / 2;\n\n    ctx.save();\n    ctx.globalAlpha = compassOpacity;\n\n    // Determine stroke and text colors based on compass color\n    // Using hardcoded colors for canvas drawing - Canvas API doesn't support CSS variables\n    const strokeColor = compassColor === 'orange' ? 'var(--color-primary)' : compassColor; // --color-primary when orange\n    const textColor = strokeColor;\n\n    // Outer circle\n    ctx.strokeStyle = strokeColor;\n    ctx.lineWidth = 3;\n    ctx.beginPath();\n    ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);\n    ctx.stroke();\n\n    // Inner circle\n    ctx.beginPath();\n    ctx.arc(centerX, centerY, radius - 10, 0, 2 * Math.PI);\n    ctx.stroke();\n\n    // Cardinal directions\n    const cardinals = ['N', 'E', 'S', 'W'];\n    const angles = [0, 90, 180, 270];\n\n    ctx.font = `bold ${Math.round(compassSize / 15)}px Arial`;\n    ctx.fillStyle = textColor;\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n\n    angles.forEach((angle, i) => {\n      const rad = (angle - 90) * Math.PI / 180;\n      const x = centerX + Math.cos(rad) * (radius - 30);\n      const y = centerY + Math.sin(rad) * (radius - 30);\n      ctx.fillText(cardinals[i], x, y);\n    });\n\n    // Draw degree marks - 4 levels of granularity for precision\n    ctx.strokeStyle = strokeColor;\n\n    for (let i = 0; i < 360; i += 1) {\n      const angle = (i - 90) * Math.PI / 180;\n      let innerRadius;\n      let tickWidth;\n\n      if (i % 30 === 0) {\n        // Major ticks every 30Â° - longest, thickest\n        innerRadius = radius - 25;\n        tickWidth = 2.5;\n      } else if (i % 10 === 0) {\n        // Medium ticks every 10Â°\n        innerRadius = radius - 18;\n        tickWidth = 1.5;\n      } else if (i % 5 === 0) {\n        // Minor ticks every 5Â°\n        innerRadius = radius - 12;\n        tickWidth = 1;\n      } else {\n        // Micro ticks every 1Â° - shortest, thinnest\n        innerRadius = radius - 7;\n        tickWidth = 0.5;\n      }\n\n      ctx.lineWidth = tickWidth;\n      ctx.beginPath();\n      ctx.moveTo(\n        centerX + Math.cos(angle) * innerRadius,\n        centerY + Math.sin(angle) * innerRadius\n      );\n      ctx.lineTo(\n        centerX + Math.cos(angle) * radius,\n        centerY + Math.sin(angle) * radius\n      );\n      ctx.stroke();\n    }\n\n    // Draw degree labels every 10Â°\n    ctx.fillStyle = textColor;\n    for (let i = 0; i < 360; i += 10) {\n      const angle = (i - 90) * Math.PI / 180;\n      ctx.font = i % 30 === 0\n        ? `bold ${Math.round(compassSize / 28)}px Arial`  // Larger for 30Â° marks\n        : `${Math.round(compassSize / 35)}px Arial`;       // Smaller for 10Â° marks\n      ctx.textAlign = 'center';\n      ctx.textBaseline = 'middle';\n      const labelRadius = radius - (i % 30 === 0 ? 40 : 32);\n      ctx.fillText(\n        i.toString(),\n        centerX + Math.cos(angle) * labelRadius,\n        centerY + Math.sin(angle) * labelRadius\n      );\n    }\n\n    // North arrow (red)\n    ctx.fillStyle = 'var(--color-error)'; // --color-error\n    ctx.beginPath();\n    ctx.moveTo(centerX, centerY - radius + 30);\n    ctx.lineTo(centerX - 8, centerY - radius + 50);\n    ctx.lineTo(centerX + 8, centerY - radius + 50);\n    ctx.closePath();\n    ctx.fill();\n\n    ctx.restore();\n  };\n\n  // Draw measurement line\n  const drawMeasurement = (ctx, measurement, isSelected, isDrawing = false) => {\n    const color = planeColors[measurement.plane - 1];\n    const { start, end, azimuth } = measurement;\n\n    ctx.save();\n\n    // Line\n    ctx.strokeStyle = color;\n    ctx.lineWidth = isSelected ? 4 : isDrawing ? 3 : 2;\n    ctx.setLineDash(isDrawing ? [5, 5] : []);\n    ctx.beginPath();\n    ctx.moveTo(start.x, start.y);\n    ctx.lineTo(end.x, end.y);\n    ctx.stroke();\n\n    // Arrowhead\n    const angle = Math.atan2(end.y - start.y, end.x - start.x);\n    const arrowLength = 15;\n    const arrowAngle = Math.PI / 6;\n\n    ctx.fillStyle = color;\n    ctx.beginPath();\n    ctx.moveTo(end.x, end.y);\n    ctx.lineTo(\n      end.x - arrowLength * Math.cos(angle - arrowAngle),\n      end.y - arrowLength * Math.sin(angle - arrowAngle)\n    );\n    ctx.lineTo(\n      end.x - arrowLength * Math.cos(angle + arrowAngle),\n      end.y - arrowLength * Math.sin(angle + arrowAngle)\n    );\n    ctx.closePath();\n    ctx.fill();\n\n    // Start point circle\n    ctx.fillStyle = color;\n    ctx.beginPath();\n    ctx.arc(start.x, start.y, 6, 0, 2 * Math.PI);\n    ctx.fill();\n\n    // Label\n    if (showLabels && !isDrawing) {\n      const midX = (start.x + end.x) / 2;\n      const midY = (start.y + end.y) / 2;\n      const cardinal = getCardinalDirection(azimuth);\n      const text = `${azimuth}Â° ${cardinal}`;\n\n      ctx.font = 'bold 14px Arial';\n      ctx.fillStyle = 'var(--gray-800)'; // --gray-800\n      ctx.strokeStyle = 'var(--text-primary)'; // white for outline\n      ctx.lineWidth = 4;\n      ctx.textAlign = 'center';\n      ctx.textBaseline = 'middle';\n\n      ctx.strokeText(text, midX, midY - 15);\n      ctx.fillText(text, midX, midY - 15);\n    }\n\n    ctx.restore();\n  };\n\n  // Redraw on state changes\n  useEffect(() => {\n    redrawCanvas();\n  }, [redrawCanvas]);\n\n  // Mouse event handlers\n  const getCanvasCoordinates = (e) => {\n    const canvas = canvasRef.current;\n    const rect = canvas.getBoundingClientRect();\n    return {\n      x: e.clientX - rect.left,\n      y: e.clientY - rect.top,\n    };\n  };\n\n  const handleMouseDown = (e) => {\n    if (!isLocked) return;\n\n    const point = getCanvasCoordinates(e);\n    const canvas = canvasRef.current;\n    const dpr = window.devicePixelRatio || 1;\n    const displayWidth = canvas.width / dpr;\n    const displayHeight = canvas.height / dpr;\n\n    // Check if clicking on compass (for dragging with Shift key)\n    if (e.shiftKey && showCompass) {\n      // Calculate actual compass center (using display dimensions)\n      const compassCenterX = (displayWidth / 2) + compassPosition.x;\n      const compassCenterY = (displayHeight / 2) + compassPosition.y;\n      const dx = point.x - compassCenterX;\n      const dy = point.y - compassCenterY;\n      const distance = Math.sqrt(dx * dx + dy * dy);\n\n      if (distance < compassSize / 2) {\n        setIsDraggingCompass(true);\n        return;\n      }\n    }\n\n    // Start drawing measurement\n    setDrawing(true);\n    setStartPoint(point);\n    setCurrentPoint(point);\n  };\n\n  const handleMouseMove = (e) => {\n    if (isDraggingCompass) {\n      const point = getCanvasCoordinates(e);\n      const canvas = canvasRef.current;\n      const dpr = window.devicePixelRatio || 1;\n      const displayWidth = canvas.width / dpr;\n      const displayHeight = canvas.height / dpr;\n\n      // Calculate offset from canvas center (using display dimensions)\n      const offsetX = point.x - (displayWidth / 2);\n      const offsetY = point.y - (displayHeight / 2);\n\n      setCompassPosition({ x: offsetX, y: offsetY });\n      return;\n    }\n\n    if (drawing && startPoint) {\n      const point = getCanvasCoordinates(e);\n      setCurrentPoint(point);\n    }\n  };\n\n  const handleMouseUp = (e) => {\n    if (isDraggingCompass) {\n      setIsDraggingCompass(false);\n      return;\n    }\n\n    if (drawing && startPoint && currentPoint) {\n      const endPoint = getCanvasCoordinates(e);\n\n      // Ensure minimum line length\n      const dx = endPoint.x - startPoint.x;\n      const dy = endPoint.y - startPoint.y;\n      const length = Math.sqrt(dx * dx + dy * dy);\n\n      if (length > 20) {\n        const azimuth = calculateAzimuth(startPoint, endPoint);\n        const newMeasurement = {\n          start: startPoint,\n          end: endPoint,\n          azimuth,\n          plane: selectedPlane,\n          id: Date.now(),\n        };\n\n        const newMeasurements = [...measurements, newMeasurement];\n        setMeasurements(newMeasurements);\n        addToHistory(newMeasurements);\n\n        if (onMeasurementsChange) {\n          onMeasurementsChange(newMeasurements);\n        }\n      }\n    }\n\n    setDrawing(false);\n    setStartPoint(null);\n    setCurrentPoint(null);\n  };\n\n  // History management\n  const addToHistory = (newMeasurements) => {\n    const newHistory = history.slice(0, historyIndex + 1);\n    newHistory.push(newMeasurements);\n    setHistory(newHistory);\n    setHistoryIndex(newHistory.length - 1);\n  };\n\n  const undo = () => {\n    if (historyIndex > 0) {\n      const prevIndex = historyIndex - 1;\n      setHistoryIndex(prevIndex);\n      setMeasurements(history[prevIndex]);\n      if (onMeasurementsChange) {\n        onMeasurementsChange(history[prevIndex]);\n      }\n    }\n  };\n\n  const redo = () => {\n    if (historyIndex < history.length - 1) {\n      const nextIndex = historyIndex + 1;\n      setHistoryIndex(nextIndex);\n      setMeasurements(history[nextIndex]);\n      if (onMeasurementsChange) {\n        onMeasurementsChange(history[nextIndex]);\n      }\n    }\n  };\n\n  // Keyboard shortcuts\n  useEffect(() => {\n    const handleKeyDown = (e) => {\n      // L - Toggle lock\n      if (e.key === 'l' || e.key === 'L') {\n        setIsLocked(prev => !prev);\n      }\n      // S - Toggle snap\n      if (e.key === 's' || e.key === 'S') {\n        setSnapToAngles(prev => !prev);\n      }\n      // Delete/Backspace - Delete selected\n      if ((e.key === 'Delete' || e.key === 'Backspace') && selectedMeasurement !== null) {\n        handleDeleteSelected();\n      }\n      // Escape - Deselect\n      if (e.key === 'Escape') {\n        setSelectedMeasurement(null);\n        setDrawing(false);\n        setStartPoint(null);\n        setCurrentPoint(null);\n      }\n      // Ctrl+Z - Undo\n      if (e.ctrlKey && e.key === 'z') {\n        e.preventDefault();\n        undo();\n      }\n      // Ctrl+Y - Redo\n      if (e.ctrlKey && e.key === 'y') {\n        e.preventDefault();\n        redo();\n      }\n      // Ctrl+C - Copy to clipboard\n      if (e.ctrlKey && e.key === 'c' && measurements.length > 0) {\n        e.preventDefault();\n        handleCopyToClipboard();\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [selectedMeasurement, measurements, historyIndex]);\n\n  // Tool handlers\n  const handleDeleteSelected = () => {\n    if (selectedMeasurement !== null) {\n      const newMeasurements = measurements.filter((_, i) => i !== selectedMeasurement);\n      setMeasurements(newMeasurements);\n      addToHistory(newMeasurements);\n      setSelectedMeasurement(null);\n      if (onMeasurementsChange) {\n        onMeasurementsChange(newMeasurements);\n      }\n    }\n  };\n\n  const handleClearAll = () => {\n    setMeasurements([]);\n    addToHistory([]);\n    setSelectedMeasurement(null);\n    if (onMeasurementsChange) {\n      onMeasurementsChange([]);\n    }\n  };\n\n  const handleResetCompass = () => {\n    setCompassPosition({ x: 0, y: 0 }); // Reset to center (no offset)\n    setCompassSize(300);\n    setCompassOpacity(0.7);\n  };\n\n  const handleCopyToClipboard = () => {\n    const text = measurements.map(m =>\n      `Plane ${m.plane}: ${m.azimuth}Â° ${getCardinalDirection(m.azimuth)}`\n    ).join('\\n');\n\n    navigator.clipboard.writeText(text).then(() => {\n      toast.success('Measurements copied to clipboard!');\n    }).catch(() => {\n      toast.error('Failed to copy to clipboard');\n    });\n  };\n\n  // Save to project\n  const handleSaveToProject = async () => {\n    if (!projectUuid) {\n      toast.error('Project context required to save');\n      return;\n    }\n\n    if (measurements.length === 0) {\n      toast.error('No measurements to save');\n      return;\n    }\n\n    setSaving(true);\n    try {\n      // 1. Capture the entire map container (satellite imagery + canvas overlay)\n      const mapContainer = mapContainerRef.current;\n\n      if (!mapContainer) {\n        throw new Error('Map container not found');\n      }\n\n      // Use html2canvas to capture the map + overlay together\n      const capturedCanvas = await html2canvas(mapContainer, {\n        useCORS: true,           // Allow cross-origin images (Google Maps tiles)\n        allowTaint: true,        // Allow tainted canvas\n        backgroundColor: null,   // Transparent background\n        scale: 2,                // Higher resolution (2x for retina displays)\n        logging: false,          // Disable console logging\n        imageTimeout: 15000,     // Longer timeout for map tiles to load\n      });\n\n      // 2. Convert to blob\n      const blob = await new Promise((resolve) =>\n        capturedCanvas.toBlob(resolve, 'image/png')\n      );\n\n      // 3. Generate filename\n      const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, 19);\n      const fileName = `azimuth-map-${timestamp}.png`;\n\n      // 4. Get presigned upload URL\n      const { uploadUrl, fileKey } = await azimuthService.getUploadUrl(projectUuid, fileName);\n\n      // 5. Upload to S3 using presigned URL\n      const uploadResponse = await fetch(uploadUrl, {\n        method: 'PUT',\n        body: blob,\n        headers: {\n          'Content-Type': 'image/png',\n        },\n      });\n\n      if (!uploadResponse.ok) {\n        throw new Error('Failed to upload to S3');\n      }\n\n      // 6. Register file with project\n      await azimuthService.registerFile(projectUuid, {\n        fileName,\n        fileType: 'azimuth_map',\n        fileUrl: fileKey,\n        fileSizeBytes: blob.size,\n        mimeType: 'image/png',\n        label: 'Azimuth Measurement Map',\n        metadata: {\n          measurements: measurements.map(m => ({\n            plane: m.plane,\n            azimuth: m.azimuth,\n            start: m.start,\n            end: m.end,\n          })),\n          address: address || 'Unknown location',\n          capturedAt: new Date().toISOString(),\n        },\n      });\n\n      // 7. Save measurements data (optional - endpoint may not exist yet)\n      await azimuthService.saveMeasurements(projectUuid, measurements);\n\n      toast.success('Azimuth map saved to project files!');\n    } catch (error) {\n      console.error('Save failed:', error);\n      toast.error('Failed to save azimuth map');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  return (\n    <div className={styles.container}>\n      {/* Toolbar */}\n      <div className={styles.toolbar}>\n        {/* Lock/Unlock */}\n        <button\n          type=\"button\"\n          onClick={() => setIsLocked(prev => !prev)}\n          className={`${styles.toolButton} ${isLocked ? styles.toolButtonActive : ''}`}\n          title={`${isLocked ? 'Unlock' : 'Lock'} map (L)`}\n        >\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n            {isLocked ? (\n              <>\n                <rect x=\"3\" y=\"11\" width=\"18\" height=\"11\" rx=\"2\" ry=\"2\" />\n                <path d=\"M7 11V7a5 5 0 0 1 10 0v4\" />\n              </>\n            ) : (\n              <>\n                <rect x=\"3\" y=\"11\" width=\"18\" height=\"11\" rx=\"2\" ry=\"2\" />\n                <path d=\"M7 11V7a5 5 0 0 1 9.9-1\" />\n              </>\n            )}\n          </svg>\n          <span>{isLocked ? 'Locked' : 'Unlocked'}</span>\n        </button>\n\n        {/* Snap to Angles */}\n        <button\n          type=\"button\"\n          onClick={() => setSnapToAngles(prev => !prev)}\n          className={`${styles.toolButton} ${snapToAngles ? styles.toolButtonActive : ''}`}\n          title=\"Snap to 45Â° angles (S)\"\n        >\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n            <path d=\"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z\" />\n          </svg>\n          <span>Snap</span>\n        </button>\n\n        {/* Show/Hide Labels */}\n        <button\n          type=\"button\"\n          onClick={() => setShowLabels(prev => !prev)}\n          className={`${styles.toolButton} ${showLabels ? styles.toolButtonActive : ''}`}\n          title=\"Toggle labels\"\n        >\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n            <path d=\"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z\" />\n            <path d=\"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z\" />\n          </svg>\n          <span>Labels</span>\n        </button>\n\n        {/* Toggle Compass Overlay */}\n        <button\n          type=\"button\"\n          onClick={() => setShowCompass(prev => !prev)}\n          className={`${styles.toolButton} ${showCompass ? styles.toolButtonActive : ''}`}\n          title=\"Toggle compass overlay\"\n        >\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n            <circle cx=\"12\" cy=\"12\" r=\"10\" />\n            <polygon points=\"16.24,7.76 14.12,14.12 7.76,16.24 9.88,9.88\" fill=\"currentColor\" />\n          </svg>\n          <span>Compass</span>\n        </button>\n\n        <div className={styles.toolDivider} />\n\n        {/* Undo */}\n        <button\n          type=\"button\"\n          onClick={undo}\n          disabled={historyIndex <= 0}\n          className={styles.toolButton}\n          title=\"Undo (Ctrl+Z)\"\n        >\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n            <path d=\"M3 7v6h6\" />\n            <path d=\"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13\" />\n          </svg>\n        </button>\n\n        {/* Redo */}\n        <button\n          type=\"button\"\n          onClick={redo}\n          disabled={historyIndex >= history.length - 1}\n          className={styles.toolButton}\n          title=\"Redo (Ctrl+Y)\"\n        >\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n            <path d=\"M21 7v6h-6\" />\n            <path d=\"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7\" />\n          </svg>\n        </button>\n\n        {/* Delete Selected */}\n        <button\n          type=\"button\"\n          onClick={handleDeleteSelected}\n          disabled={selectedMeasurement === null}\n          className={styles.toolButton}\n          title=\"Delete selected (Del)\"\n        >\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n            <polyline points=\"3 6 5 6 21 6\" />\n            <path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\" />\n          </svg>\n        </button>\n\n        {/* Clear All */}\n        <button\n          type=\"button\"\n          onClick={handleClearAll}\n          disabled={measurements.length === 0}\n          className={styles.toolButton}\n          title=\"Clear all measurements\"\n        >\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n            <polyline points=\"3 6 5 6 21 6\" />\n            <path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\" />\n            <line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\" />\n            <line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\" />\n          </svg>\n        </button>\n\n        <div className={styles.toolDivider} />\n\n        {/* Save to Project */}\n        <button\n          type=\"button\"\n          onClick={handleSaveToProject}\n          disabled={saving || measurements.length === 0}\n          className={`${styles.toolButton} ${styles.saveButton}`}\n          title=\"Save to project files\"\n        >\n          {saving ? (\n            <LoadingSpinner size=\"sm\" />\n          ) : (\n            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n              <path d=\"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z\" />\n              <polyline points=\"17 21 17 13 7 13 7 21\" />\n              <polyline points=\"7 3 7 8 15 8\" />\n            </svg>\n          )}\n          <span>Save to Project</span>\n        </button>\n      </div>\n\n      {/* Main Content */}\n      <div className={styles.mainContent}>\n        {/* Sidebar */}\n        <div className={styles.sidebar}>\n          {/* Plane Selector */}\n          <div className={styles.section}>\n            <h3 className={styles.sectionTitle}>Measurement Plane</h3>\n            <div className={styles.planeGrid}>\n              {[1, 2, 3, 4].map(plane => (\n                <button\n                  key={plane}\n                  type=\"button\"\n                  onClick={() => setSelectedPlane(plane)}\n                  className={`${styles.planeButton} ${selectedPlane === plane ? styles.planeButtonActive : ''}`}\n                  style={{\n                    borderColor: planeColors[plane - 1],\n                    backgroundColor: selectedPlane === plane ? planeColors[plane - 1] : 'transparent',\n                  }}\n                >\n                  {plane}\n                </button>\n              ))}\n            </div>\n\n            {!showExtraPlanes && (\n              <button\n                type=\"button\"\n                onClick={() => setShowExtraPlanes(true)}\n                className={styles.expandButton}\n              >\n                + Show Planes 5-8\n              </button>\n            )}\n\n            {showExtraPlanes && (\n              <>\n                <div className={styles.planeGrid} style={{ marginTop: '0.5rem' }}>\n                  {[5, 6, 7, 8].map(plane => (\n                    <button\n                      key={plane}\n                      type=\"button\"\n                      onClick={() => setSelectedPlane(plane)}\n                      className={`${styles.planeButton} ${selectedPlane === plane ? styles.planeButtonActive : ''}`}\n                      style={{\n                        borderColor: planeColors[plane - 1],\n                        backgroundColor: selectedPlane === plane ? planeColors[plane - 1] : 'transparent',\n                      }}\n                    >\n                      {plane}\n                    </button>\n                  ))}\n                </div>\n                <button\n                  type=\"button\"\n                  onClick={() => setShowExtraPlanes(false)}\n                  className={styles.expandButton}\n                >\n                  - Hide Planes 5-8\n                </button>\n              </>\n            )}\n          </div>\n\n          {/* Compass Settings - Only show when compass is enabled */}\n          {showCompass && (\n            <div className={styles.section}>\n              <h3 className={styles.sectionTitle}>Compass Settings</h3>\n\n              {/* Color */}\n              <label className={styles.settingLabel}>\n                Color\n                <div className={styles.colorButtons}>\n                  {['white', 'black', 'orange', 'blue'].map(color => (\n                    <button\n                      key={color}\n                      type=\"button\"\n                      onClick={() => setCompassColor(color)}\n                      className={`${styles.colorButton} ${compassColor === color ? styles.colorButtonActive : ''}`}\n                      style={{\n                        backgroundColor: color === 'orange' ? 'var(--color-primary)' : color,\n                        border: color === 'white' ? '1px solid var(--text-disabled)' : 'none',\n                      }}\n                    />\n                  ))}\n                </div>\n              </label>\n\n              {/* Size */}\n              <label className={styles.settingLabel}>\n                Size: {compassSize}px\n                <input\n                  type=\"range\"\n                  min=\"150\"\n                  max=\"600\"\n                  value={compassSize}\n                  onChange={(e) => setCompassSize(Number(e.target.value))}\n                  className={styles.slider}\n                />\n              </label>\n\n              {/* Opacity */}\n              <label className={styles.settingLabel}>\n                Opacity: {Math.round(compassOpacity * 100)}%\n                <input\n                  type=\"range\"\n                  min=\"0.2\"\n                  max=\"1\"\n                  step=\"0.1\"\n                  value={compassOpacity}\n                  onChange={(e) => setCompassOpacity(Number(e.target.value))}\n                  className={styles.slider}\n                />\n              </label>\n\n              <button\n                type=\"button\"\n                onClick={handleResetCompass}\n                className={styles.resetButton}\n              >\n                Reset Compass Position\n              </button>\n            </div>\n          )}\n\n          {/* Measurements List */}\n          <div className={styles.section}>\n            <h3 className={styles.sectionTitle}>Measurements ({measurements.length})</h3>\n            {measurements.length === 0 ? (\n              <p className={styles.emptyText}>No measurements yet. Lock the map and click to draw.</p>\n            ) : (\n              <div className={styles.measurementsList}>\n                {measurements.map((m, i) => (\n                  <div\n                    key={m.id || i}\n                    onClick={() => setSelectedMeasurement(i)}\n                    className={`${styles.measurementItem} ${selectedMeasurement === i ? styles.measurementItemActive : ''}`}\n                  >\n                    <div\n                      className={styles.measurementColor}\n                      style={{ backgroundColor: planeColors[m.plane - 1] }}\n                    />\n                    <div className={styles.measurementInfo}>\n                      <div className={styles.measurementPlane}>Plane {m.plane}</div>\n                      <div className={styles.measurementValue}>{m.azimuth}Â° {getCardinalDirection(m.azimuth)}</div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n\n          {/* Instructions */}\n          <div className={styles.section}>\n            <h3 className={styles.sectionTitle}>Instructions</h3>\n            <ul className={styles.instructionsList}>\n              <li>Lock the map to enable drawing</li>\n              <li>Click and drag to measure azimuth</li>\n              <li>Use Google's compass (top-right) for N/E/S/W reference</li>\n              <li>Enable custom compass overlay for precision tick marks</li>\n              <li>Shift+drag to move custom compass over roof areas</li>\n              <li>Press L to toggle lock</li>\n              <li>Press S to snap to 45Â°</li>\n            </ul>\n          </div>\n        </div>\n\n        {/* Map View */}\n        <div className={styles.mapView}>\n          {/* Wrapper for screenshot capture (map + canvas together) */}\n          <div ref={mapContainerRef} className={styles.mapWrapper}>\n            <div ref={mapRef} className={styles.map} />\n            <canvas\n              ref={canvasRef}\n              className={styles.canvas}\n              onMouseDown={handleMouseDown}\n              onMouseMove={handleMouseMove}\n              onMouseUp={handleMouseUp}\n              style={{ cursor: isLocked ? 'crosshair' : 'grab' }}\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nAzimuthFinder.propTypes = {\n  lat: PropTypes.number.isRequired,\n  lng: PropTypes.number.isRequired,\n  address: PropTypes.string,\n  projectUuid: PropTypes.string, // Optional - Save to Project is optional feature\n  initialMeasurements: PropTypes.array,\n  onMeasurementsChange: PropTypes.func,\n};\n\nexport default AzimuthFinder;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\maps\\MapPanel.js","messages":[{"ruleId":"jsx-a11y/anchor-is-valid","severity":1,"message":"The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/anchor-is-valid.md","line":138,"column":11,"nodeType":"JSXOpeningElement","endLine":146,"endColumn":12}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport StreetViewMap from './StreetViewMap';\nimport AerialViewMap from './AerialViewMap';\nimport AzimuthFinder from './AzimuthFinder';\nimport useGoogleMaps from '../../hooks/useGoogleMaps';\nimport LoadingSpinner from '../ui/LoadingSpinner';\nimport styles from './MapPanel.module.css';\n\n// Icon components\nconst CompassIcon = ({ className }) => (\n  <svg className={className} width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <circle cx=\"12\" cy=\"12\" r=\"10\" />\n    <polygon points=\"16.24,7.76 14.12,14.12 7.76,16.24 9.88,9.88\" fill=\"currentColor\" />\n  </svg>\n);\n\n/**\n * MapPanel - Google Maps integration with Street View, Aerial View, and Azimuth Finder\n * Uses subtab navigation pattern like Equipment form\n */\nconst MapPanel = ({\n  address,\n  city,\n  state,\n  zip,\n  lat,\n  lng,\n  projectUuid,\n  azimuthMeasurements,\n  onAzimuthChange,\n}) => {\n  const { isLoaded, loadError } = useGoogleMaps();\n  const [coordinates, setCoordinates] = useState({ lat, lng });\n  const [geocoding, setGeocoding] = useState(false);\n  const [geocodeError, setGeocodeError] = useState(null);\n  const [activeView, setActiveView] = useState('street');\n\n  const viewTabs = [\n    { key: 'street', label: 'Street View' },\n    { key: 'aerial', label: 'Aerial View' },\n    { key: 'azimuth', label: 'Azimuth Finder', icon: CompassIcon },\n  ];\n\n  // Geocode address if coordinates not provided\n  useEffect(() => {\n    if ((lat && lng) || !address || !isLoaded) {\n      return;\n    }\n\n    setGeocoding(true);\n    setGeocodeError(null);\n\n    const fullAddress = [address, city, state, zip].filter(Boolean).join(', ');\n    const geocoder = new window.google.maps.Geocoder();\n\n    geocoder.geocode({ address: fullAddress }, (results, status) => {\n      setGeocoding(false);\n\n      if (status === 'OK' && results[0]) {\n        const location = results[0].geometry.location;\n        setCoordinates({\n          lat: location.lat(),\n          lng: location.lng(),\n        });\n      } else {\n        setGeocodeError('Unable to locate address on map');\n      }\n    });\n  }, [address, city, state, zip, lat, lng, isLoaded]);\n\n  // No address provided\n  if (!address) {\n    return (\n      <div className={styles.messageContainer}>\n        <div className={styles.messageIcon}>ðŸ“</div>\n        <h3 className={styles.messageHeading}>No Address Available</h3>\n        <p className={styles.messageText}>\n          No address data is available for this project. Please add an address in the Project Information section.\n        </p>\n      </div>\n    );\n  }\n\n  // Loading Google Maps script\n  if (!isLoaded) {\n    return (\n      <div className={styles.loadingContainer}>\n        <LoadingSpinner />\n        <p className={styles.loadingText}>Loading Google Maps...</p>\n      </div>\n    );\n  }\n\n  // Google Maps script load error\n  if (loadError) {\n    return (\n      <div className={styles.errorContainer}>\n        <div className={styles.errorIcon}>âš ï¸</div>\n        <h3 className={styles.errorHeading}>Failed to Load Maps</h3>\n        <p className={styles.errorText}>\n          Unable to load Google Maps. Please check your internet connection and try again.\n        </p>\n      </div>\n    );\n  }\n\n  // Geocoding in progress\n  if (geocoding) {\n    return (\n      <div className={styles.loadingContainer}>\n        <LoadingSpinner />\n        <p className={styles.loadingText}>Locating address...</p>\n      </div>\n    );\n  }\n\n  // Geocoding failed\n  if (geocodeError) {\n    return (\n      <div className={styles.errorContainer}>\n        <div className={styles.errorIcon}>ðŸ“</div>\n        <h3 className={styles.errorHeading}>Location Not Found</h3>\n        <p className={styles.errorText}>\n          {geocodeError}. Please verify the address in the Project Information section.\n        </p>\n        <p className={styles.addressDisplay}>\n          {[address, city, state, zip].filter(Boolean).join(', ')}\n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <div className={styles.container}>\n      {/* Subtab Navigation */}\n      <div className={styles.subtabContainer}>\n        {viewTabs.map((view, index) => (\n          <a\n            key={view.key}\n            href=\"#\"\n            onClick={(e) => {\n              e.preventDefault();\n              setActiveView(view.key);\n            }}\n            className={`${styles.subtabLink} ${activeView === view.key ? styles.subtabLinkActive : ''} ${index === 0 ? styles.subtabLinkFirst : ''}`}\n          >\n            {view.icon && <view.icon className={styles.subtabIcon} />}\n            {view.label}\n            {activeView === view.key && (\n              <span className={`${styles.subtabIndicator} ${index === 0 ? styles.subtabIndicatorFirst : styles.subtabIndicatorCenter}`} />\n            )}\n          </a>\n        ))}\n      </div>\n\n      {/* Map Content */}\n      <div className={styles.mapContent}>\n        {activeView === 'street' && (\n          <StreetViewMap\n            lat={coordinates.lat}\n            lng={coordinates.lng}\n            address={address}\n          />\n        )}\n        {activeView === 'aerial' && (\n          <AerialViewMap\n            lat={coordinates.lat}\n            lng={coordinates.lng}\n            address={address}\n          />\n        )}\n        {activeView === 'azimuth' && (\n          <AzimuthFinder\n            lat={coordinates.lat}\n            lng={coordinates.lng}\n            address={[address, city, state, zip].filter(Boolean).join(', ')}\n            projectUuid={projectUuid}\n            initialMeasurements={azimuthMeasurements}\n            onMeasurementsChange={onAzimuthChange}\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default MapPanel;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\maps\\StreetViewMap.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\maps\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\modals\\AttestationModal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\modals\\BOSDetectionModal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\modals\\GenerateStatusModal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\modals\\UtilityValidationModal.js","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchUtilities'. Either include it or remove the dependency array.","line":28,"column":6,"nodeType":"ArrayExpression","endLine":28,"endColumn":23,"suggestions":[{"desc":"Update the dependencies array to be: [fetchUtilities, isOpen, zipCode]","fix":{"range":[1072,1089],"text":"[fetchUtilities, isOpen, zipCode]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport Modal from '../ui/Modal';\nimport { FormSelect, Button } from '../ui';\nimport axios from '../../config/axios';\nimport logger from '../../services/devLogger';\n\n/**\n * UtilityValidationModal - Modal to prompt user to select utility if missing\n * Shows when user tries to print draft but utility field is blank\n *\n * @param {boolean} isOpen - Whether modal is open\n * @param {function} onClose - Close handler\n * @param {function} onSave - Save handler with selected utility\n * @param {string} zipCode - Project zip code to fetch utilities\n * @param {string} projectUuid - Project UUID for saving\n */\nconst UtilityValidationModal = ({ isOpen, onClose, onSave, zipCode, projectUuid }) => {\n  const [selectedUtility, setSelectedUtility] = useState('');\n  const [utilities, setUtilities] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  // Fetch utilities when modal opens\n  useEffect(() => {\n    if (isOpen && zipCode) {\n      fetchUtilities();\n    }\n  }, [isOpen, zipCode]);\n\n  const fetchUtilities = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n\n      logger.log('UtilityValidationModal', 'Fetching utilities for ZIP:', zipCode);\n\n      const userData = JSON.parse(sessionStorage.getItem('userData') || '{}');\n      const companyId = userData?.company?.uuid;\n\n      if (!companyId) {\n        throw new Error('Company ID not found');\n      }\n\n      const response = await axios.get(`/utility-zipcodes/zips/${zipCode}/utilities`, {\n        params: { companyId }\n      });\n\n      const utilityData = response.data?.data || response.data || [];\n      logger.log('UtilityValidationModal', 'Fetched utilities:', utilityData);\n\n      // Remove duplicates and sort\n      const uniqueUtilities = [...new Set(utilityData)].sort();\n      setUtilities(uniqueUtilities);\n\n      // Auto-select if only one option\n      if (uniqueUtilities.length === 1) {\n        setSelectedUtility(uniqueUtilities[0]);\n      } else if (uniqueUtilities.length === 0) {\n        setError(`No utilities found for ZIP code ${zipCode}`);\n      }\n    } catch (err) {\n      logger.error('UtilityValidationModal', 'Failed to fetch utilities:', err);\n      setError('Failed to load utilities. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSave = () => {\n    if (!selectedUtility) {\n      setError('Please select a utility before continuing');\n      return;\n    }\n\n    onSave(selectedUtility);\n  };\n\n  const utilityOptions = utilities.map(utility => ({\n    label: utility,\n    value: utility\n  }));\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onClose={onClose}\n      title=\"Utility Required\"\n      size=\"sm\"\n      scopedToPanel={true}\n      contained={true}\n      footer={\n        <>\n          <Button variant=\"secondary\" onClick={onClose}>\n            Cancel\n          </Button>\n          <Button\n            variant=\"primary\"\n            onClick={handleSave}\n            disabled={!selectedUtility || loading}\n          >\n            Save & Continue\n          </Button>\n        </>\n      }\n    >\n      <div>\n        <p style={{ marginBottom: '16px', color: 'var(--text-secondary)' }}>\n          This project is missing the utility. Please add it now.\n        </p>\n\n        {loading ? (\n          <p style={{ color: 'var(--text-muted)', textAlign: 'center' }}>\n            Loading utilities...\n          </p>\n        ) : error ? (\n          <p style={{ color: 'var(--color-error)', marginBottom: '12px' }}>\n            {error}\n          </p>\n        ) : null}\n\n        <FormSelect\n          label=\"Utility\"\n          options={utilityOptions}\n          value={selectedUtility}\n          onChange={(e) => setSelectedUtility(e.target.value)}\n          placeholder=\"Select Utility...\"\n          disabled={loading || utilities.length === 0}\n          fullWidth\n        />\n\n        {utilities.length > 0 && (\n          <p style={{\n            marginTop: '8px',\n            fontSize: 'var(--text-xs)',\n            color: 'var(--text-muted)'\n          }}>\n            {utilities.length === 1\n              ? 'Only one utility available - auto-selected'\n              : `${utilities.length} utilities available for ZIP code ${zipCode}`\n            }\n          </p>\n        )}\n      </div>\n    </Modal>\n  );\n};\n\nexport default UtilityValidationModal;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\pdf\\PdfAnnotationLayer.js","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'annotations', 'currentTool', and 'loadAnnotations'. Either include them or remove the dependency array.","line":159,"column":6,"nodeType":"ArrayExpression","endLine":159,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [annotations, currentTool, isActive, loadAnnotations]","fix":{"range":[4767,4777],"text":"[annotations, currentTool, isActive, loadAnnotations]"}}]},{"ruleId":"no-unused-vars","severity":1,"message":"'annotation' is assigned a value but never used.","line":165,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":165,"endColumn":26},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'addDeltaSymbol', 'addTextBox', 'onToolChange', and 'saveAnnotations'. Either include them or remove the dependency array. If 'onToolChange' changes too often, find the parent component that defines it and wrap that definition in useCallback.","line":397,"column":6,"nodeType":"ArrayExpression","endLine":397,"endColumn":67,"suggestions":[{"desc":"Update the dependencies array to be: [currentTool, currentColor, isActive, isDrawing, currentPage, addTextBox, addDeltaSymbol, onToolChange, saveAnnotations]","fix":{"range":[12117,12178],"text":"[currentTool, currentColor, isActive, isDrawing, currentPage, addTextBox, addDeltaSymbol, onToolChange, saveAnnotations]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'saveAnnotations'. Either include it or remove the dependency array.","line":1421,"column":6,"nodeType":"ArrayExpression","endLine":1421,"endColumn":19,"suggestions":[{"desc":"Update the dependencies array to be: [currentPage, saveAnnotations]","fix":{"range":[39422,39435],"text":"[currentPage, saveAnnotations]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'redo', 'saveAnnotations', and 'undo'. Either include them or remove the dependency array.","line":1470,"column":6,"nodeType":"ArrayExpression","endLine":1470,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [isActive, redo, saveAnnotations, undo]","fix":{"range":[40817,40827],"text":"[isActive, redo, saveAnnotations, undo]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useRef, useState, useImperativeHandle, forwardRef } from 'react';\nimport { Canvas, Textbox, Line, Circle, Group, Text, Path, Triangle, Rect } from 'fabric';\nimport logger from '../../services/devLogger';\nimport styles from './PdfAnnotationLayer.module.css';\n\n/**\n * PdfAnnotationLayer - Fabric.js canvas overlay for PDF annotations\n *\n * Features:\n * - Transparent canvas overlay on top of PDF iframe\n * - Supports drawing tools: select, text, arrow, delta, revision cloud\n * - Color picker with 4 presets: red, blue, green, yellow\n * - Annotations saved as JSON\n * - Per-page annotation tracking\n *\n * @param {boolean} isActive - Whether annotation mode is active\n * @param {string} currentTool - Current selected tool\n * @param {string} currentColor - Current selected color\n * @param {array} annotations - Existing annotations to load\n * @param {function} onAnnotationsChange - Callback when annotations change\n * @param {function} onToolChange - Callback to switch tools (for auto-switching to select)\n * @param {number} currentPage - Current PDF page number (for multi-page support)\n */\nconst PdfAnnotationLayer = forwardRef(({\n  isActive = false,\n  currentTool = 'select',\n  currentColor = 'var(--color-danger)', // Red default\n  annotations = [],\n  onAnnotationsChange,\n  onToolChange,\n  currentPage = 1\n}, ref) => {\n  const canvasRef = useRef(null);\n  const fabricCanvasRef = useRef(null);\n  const [isDrawing, setIsDrawing] = useState(false);\n  const drawingObjectRef = useRef(null);\n  const startPointRef = useRef({ x: 0, y: 0 });\n  const historyRef = useRef([]);\n  const historyStepRef = useRef(0);\n  const arrowPartsRef = useRef({ line: null, triangle: null });\n  const cloudStartRef = useRef({ x: 0, y: 0 });\n\n  // Leader line state (module-level for proper updates)\n  const leaderStateRef = useRef({\n    startX: 0,\n    startY: 0,\n    color: 'var(--color-danger)',\n    tempLine: null,\n    tempArrowhead: null,\n    tempTextbox: null\n  });\n\n  // Whiteout tool state\n  const whiteoutStateRef = useRef({\n    startX: 0,\n    startY: 0,\n    tempRect: null\n  });\n\n  // Line tool state\n  const lineStateRef = useRef({\n    startX: 0,\n    startY: 0,\n    tempLine: null\n  });\n\n  // Square tool state\n  const squareStateRef = useRef({\n    startX: 0,\n    startY: 0,\n    tempRect: null\n  });\n\n  // Circle tool state\n  const circleStateRef = useRef({\n    startX: 0,\n    startY: 0,\n    tempCircle: null\n  });\n\n  // Initialize Fabric.js canvas\n  useEffect(() => {\n    if (!canvasRef.current || fabricCanvasRef.current || !isActive) {\n      return;\n    }\n\n    let resizeHandler = null;\n\n    // Small delay to ensure DOM is ready\n    const initTimeout = setTimeout(() => {\n      const canvasElement = canvasRef.current;\n      if (!canvasElement) return;\n\n      const container = canvasElement.parentElement;\n      if (!container) return;\n\n      const canvas = new Canvas(canvasElement, {\n        isDrawingMode: false,\n        selection: currentTool === 'select',\n        backgroundColor: 'transparent',\n        renderOnAddRemove: true,\n        enableRetinaScaling: true,\n        width: container.offsetWidth,\n        height: container.offsetHeight\n      });\n\n      fabricCanvasRef.current = canvas;\n\n      // Handle canvas resize\n      resizeHandler = () => {\n        if (fabricCanvasRef.current && canvasRef.current?.parentElement) {\n          try {\n            const rect = canvasRef.current.parentElement.getBoundingClientRect();\n            fabricCanvasRef.current.setDimensions({\n              width: rect.width,\n              height: rect.height\n            });\n            fabricCanvasRef.current.renderAll();\n          } catch (err) {\n            // Ignore resize errors if canvas is being disposed\n          }\n        }\n      };\n\n      window.addEventListener('resize', resizeHandler);\n\n      // Load existing annotations\n      if (annotations.length > 0) {\n        loadAnnotations(canvas, annotations);\n      }\n\n      // Add double-click handler for leader line and whiteout text editing\n      canvas.on('mouse:dblclick', (opt) => {\n        const target = opt.target;\n        if (!target) return;\n\n        if (target.customType === 'leaderLine') {\n          handleLeaderDoubleClick(canvas, opt);\n        } else if (target.customType === 'whiteout') {\n          handleWhiteoutDoubleClick(canvas, opt);\n        } else if (target.deltaLetter) {\n          handleDeltaDoubleClick(canvas, opt);\n        }\n      });\n\n      canvas.renderAll();\n    }, 100);\n\n    return () => {\n      clearTimeout(initTimeout);\n      if (resizeHandler) {\n        window.removeEventListener('resize', resizeHandler);\n      }\n      if (fabricCanvasRef.current) {\n        fabricCanvasRef.current.dispose();\n        fabricCanvasRef.current = null;\n      }\n    };\n  }, [isActive]);\n\n  // Load annotations from JSON\n  const loadAnnotations = async (canvas, annotationsData) => {\n    const pageAnnotations = annotationsData.filter(a => a.page === currentPage);\n\n    for (const annotation of pageAnnotations) {\n      // In fabric v6+, we need to reconstruct objects manually\n      // For now, we'll skip loading saved annotations until Phase 4\n      // when we implement proper serialization\n    }\n  };\n\n  // Update tool mode\n  useEffect(() => {\n    const canvas = fabricCanvasRef.current;\n    if (!canvas) {\n      return;\n    }\n\n    // CRITICAL: Disable selection when NOT in select mode\n    const isSelectMode = currentTool === 'select';\n\n    canvas.selection = isSelectMode;\n    canvas.isDrawingMode = false;\n\n    // Make all objects selectable/non-selectable based on tool\n    canvas.forEachObject((obj) => {\n      obj.selectable = isSelectMode;\n      obj.evented = isSelectMode;\n      obj.hoverCursor = isSelectMode ? 'move' : 'default';\n    });\n\n    // Update canvas cursor based on tool\n    if (isSelectMode) {\n      canvas.defaultCursor = 'default';\n      canvas.hoverCursor = 'move';\n    } else {\n      canvas.defaultCursor = 'crosshair';\n      canvas.hoverCursor = 'crosshair';\n    }\n\n    canvas.renderAll();\n  }, [currentTool]);\n\n  // Handle drawing events based on current tool\n  useEffect(() => {\n    const canvas = fabricCanvasRef.current;\n    if (!canvas || !isActive) {\n      return;\n    }\n\n    const handleMouseDown = (e) => {\n      if (currentTool === 'select') {\n        return;\n      }\n\n      const pointer = canvas.getPointer(e.e);\n      startPointRef.current = { x: pointer.x, y: pointer.y };\n      setIsDrawing(true);\n\n      switch (currentTool) {\n        case 'text':\n          addTextBox(canvas, pointer.x, pointer.y, currentColor);\n          setIsDrawing(false); // Text doesn't need mouse move\n          break;\n\n        case 'whiteout':\n          startWhiteout(canvas, pointer.x, pointer.y);\n          break;\n\n        case 'leader':\n          startLeaderLine(canvas, pointer.x, pointer.y, currentColor);\n          break;\n\n        case 'arrow':\n          startArrow(canvas, pointer.x, pointer.y, currentColor);\n          break;\n\n        case 'delta':\n          addDeltaSymbol(canvas, pointer.x, pointer.y, currentColor);\n          setIsDrawing(false); // Delta doesn't need mouse move\n          break;\n\n        case 'cloud':\n          startRevisionCloud(canvas, pointer.x, pointer.y, currentColor);\n          break;\n\n        case 'line':\n          startLine(canvas, pointer.x, pointer.y, currentColor);\n          break;\n\n        case 'square':\n          startSquare(canvas, pointer.x, pointer.y, currentColor);\n          break;\n\n        case 'circle':\n          startCircle(canvas, pointer.x, pointer.y, currentColor);\n          break;\n\n        default:\n          break;\n      }\n    };\n\n    const handleMouseMove = (e) => {\n      if (!isDrawing) {\n        return;\n      }\n\n      // Some tools use their own state refs, not drawingObjectRef\n      const customStateTools = ['leader', 'whiteout', 'line', 'square', 'circle'];\n      if (!customStateTools.includes(currentTool) && !drawingObjectRef.current) {\n        return;\n      }\n\n      const pointer = canvas.getPointer(e.e);\n\n      if (currentTool === 'arrow') {\n        updateArrow(drawingObjectRef.current, startPointRef.current.x, startPointRef.current.y, pointer.x, pointer.y);\n        canvas.renderAll();\n      } else if (currentTool === 'leader') {\n        updateLeaderLine(canvas, pointer.x, pointer.y);\n      } else if (currentTool === 'whiteout') {\n        updateWhiteout(canvas, pointer.x, pointer.y);\n      } else if (currentTool === 'cloud') {\n        updateRevisionCloud(drawingObjectRef.current, pointer.x, pointer.y);\n        canvas.renderAll();\n      } else if (currentTool === 'line') {\n        updateLine(canvas, pointer.x, pointer.y);\n      } else if (currentTool === 'square') {\n        updateSquare(canvas, pointer.x, pointer.y);\n      } else if (currentTool === 'circle') {\n        updateCircle(canvas, pointer.x, pointer.y);\n      }\n    };\n\n    const handleMouseUp = () => {\n      if (isDrawing) {\n        // Special handling for arrow: group line and triangle\n        if (currentTool === 'arrow' && arrowPartsRef.current.line && arrowPartsRef.current.triangle) {\n          const { line, triangle } = arrowPartsRef.current;\n\n          // Remove individual parts from canvas\n          canvas.remove(line);\n          canvas.remove(triangle);\n\n          // Create group with both parts\n          const arrowGroup = new Group([line, triangle], {\n            selectable: true,\n            evented: true,\n            hasControls: true,\n            customType: 'arrow'\n          });\n\n          canvas.add(arrowGroup);\n          arrowPartsRef.current = { line: null, triangle: null };\n\n          setIsDrawing(false);\n          drawingObjectRef.current = null;\n          saveAnnotations(canvas);\n          saveHistory(canvas);\n        } else if (currentTool === 'leader') {\n          // Finalize leader line (new implementation)\n          finalizeLeaderLine(canvas);\n\n          setIsDrawing(false);\n          drawingObjectRef.current = null;\n          saveAnnotations(canvas);\n          saveHistory(canvas);\n        } else if (currentTool === 'whiteout') {\n          // Finalize whiteout\n          finalizeWhiteout(canvas);\n\n          setIsDrawing(false);\n          drawingObjectRef.current = null;\n          saveAnnotations(canvas);\n          saveHistory(canvas);\n        } else if (currentTool === 'cloud' && drawingObjectRef.current) {\n          // Make cloud selectable after drawing\n          drawingObjectRef.current.set({\n            selectable: true,\n            evented: true,\n            hasControls: true,\n            customType: 'cloud'\n          });\n\n          setIsDrawing(false);\n          drawingObjectRef.current = null;\n          saveAnnotations(canvas);\n          saveHistory(canvas);\n        } else if (currentTool === 'line') {\n          // Finalize line\n          finalizeLine(canvas);\n\n          setIsDrawing(false);\n          drawingObjectRef.current = null;\n          saveAnnotations(canvas);\n          saveHistory(canvas);\n        } else if (currentTool === 'square') {\n          // Finalize square\n          finalizeSquare(canvas);\n\n          setIsDrawing(false);\n          drawingObjectRef.current = null;\n          saveAnnotations(canvas);\n          saveHistory(canvas);\n        } else if (currentTool === 'circle') {\n          // Finalize circle\n          finalizeCircle(canvas);\n\n          setIsDrawing(false);\n          drawingObjectRef.current = null;\n          saveAnnotations(canvas);\n          saveHistory(canvas);\n        } else if (drawingObjectRef.current) {\n          setIsDrawing(false);\n          drawingObjectRef.current = null;\n          saveAnnotations(canvas);\n          saveHistory(canvas);\n        }\n\n        // Auto-switch back to select mode after drawing\n        if (onToolChange && currentTool !== 'select') {\n          onToolChange('select');\n        }\n      }\n    };\n\n    canvas.on('mouse:down', handleMouseDown);\n    canvas.on('mouse:move', handleMouseMove);\n    canvas.on('mouse:up', handleMouseUp);\n\n    return () => {\n      canvas.off('mouse:down', handleMouseDown);\n      canvas.off('mouse:move', handleMouseMove);\n      canvas.off('mouse:up', handleMouseUp);\n    };\n  }, [currentTool, currentColor, isActive, isDrawing, currentPage]);\n\n  // Add text box\n  const addTextBox = (canvas, x, y, color) => {\n    const textbox = new Textbox('Type here...', {\n      left: x,\n      top: y,\n      width: 200,\n      fontSize: 14,\n      fill: color,\n      fontFamily: 'Arial',\n      editable: true,\n      selectable: true\n    });\n\n    canvas.add(textbox);\n    canvas.setActiveObject(textbox);\n    textbox.enterEditing();\n    canvas.renderAll();\n    saveAnnotations(canvas);\n    saveHistory(canvas);\n\n    // Auto-switch back to select mode after adding text\n    if (onToolChange) {\n      onToolChange('select');\n    }\n  };\n\n  // ===== LEADER LINE TOOL - NEW IMPLEMENTATION =====\n\n  // Start drawing leader line (mouse down)\n  const startLeaderLine = (canvas, x, y, color) => {\n    const leader = leaderStateRef.current;\n    leader.startX = x;\n    leader.startY = y;\n    leader.color = color;\n\n    logger.debug('PDF', 'Leader line START:', { x, y, color });\n\n    // Create line from click point\n    leader.tempLine = new Line([x, y, x, y], {\n      stroke: color,\n      strokeWidth: 2,\n      selectable: false,\n      evented: false\n    });\n\n    // Create arrowhead at START (where user clicked)\n    leader.tempArrowhead = new Triangle({\n      left: x,\n      top: y,\n      width: 12,\n      height: 16,\n      fill: color,\n      originX: 'center',\n      originY: 'bottom',\n      angle: 180, // Will rotate during drag\n      selectable: false,\n      evented: false\n    });\n\n    // Create textbox (empty initially, but with background for visibility)\n    leader.tempTextbox = new Textbox('', {\n      left: x + 15,\n      top: y - 10,\n      width: 120,\n      fontSize: 12,\n      fontFamily: 'Arial',\n      fill: color,\n      backgroundColor: 'rgba(0, 0, 0, 0.1)',\n      editable: false,\n      selectable: false,\n      evented: false\n    });\n\n    // Add all three objects separately (NOT grouped yet)\n    canvas.add(leader.tempLine);\n    canvas.add(leader.tempArrowhead);\n    canvas.add(leader.tempTextbox);\n\n    logger.debug('PDF', 'Added leader objects to canvas:', {\n      line: leader.tempLine,\n      arrowhead: leader.tempArrowhead,\n      textbox: leader.tempTextbox\n    });\n\n    canvas.renderAll();\n  };\n\n  // Update leader line during drawing (mouse move)\n  const updateLeaderLine = (canvas, currentX, currentY) => {\n    const leader = leaderStateRef.current;\n    if (!leader.tempLine || !leader.tempArrowhead || !leader.tempTextbox) return;\n\n    const x1 = leader.startX;\n    const y1 = leader.startY;\n    const x2 = currentX;\n    const y2 = currentY;\n\n    // Update line endpoint\n    leader.tempLine.set({ x2, y2 });\n    leader.tempLine.setCoords();\n\n    // Calculate angle: arrowhead points FROM end TOWARD start\n    const angleRad = Math.atan2(y1 - y2, x1 - x2);\n    const angleDeg = (angleRad * 180 / Math.PI) + 90;\n\n    // Rotate arrowhead (stays at start point)\n    leader.tempArrowhead.set({ angle: angleDeg });\n    leader.tempArrowhead.setCoords();\n\n    // Position textbox at drag endpoint\n    // Smart offset so text doesn't overlap line\n    const dragRight = x2 >= x1;\n    const dragDown = y2 >= y1;\n    const textOffsetX = dragRight ? 10 : -110;\n    const textOffsetY = dragDown ? 5 : -25;\n\n    leader.tempTextbox.set({\n      left: x2 + textOffsetX,\n      top: y2 + textOffsetY\n    });\n    leader.tempTextbox.setCoords();\n\n    canvas.renderAll();\n  };\n\n  // Finalize leader line (mouse up) - Auto-enters edit mode\n  const finalizeLeaderLine = (canvas) => {\n    const leader = leaderStateRef.current;\n\n    logger.debug('PDF', 'Leader line FINALIZE called - entering edit mode');\n\n    if (!leader.tempLine || !leader.tempArrowhead || !leader.tempTextbox) {\n      logger.warn('PDF', 'Leader line finalize ABORTED - missing objects');\n      return null;\n    }\n\n    // Remove from canvas temporarily\n    canvas.remove(leader.tempLine);\n    canvas.remove(leader.tempArrowhead);\n    canvas.remove(leader.tempTextbox);\n\n    // Configure textbox for immediate editing\n    leader.tempTextbox.set({\n      text: '', // Empty so user can type immediately\n      editable: true,\n      selectable: true,\n      evented: true\n    });\n\n    // Re-add objects individually (NOT grouped yet)\n    canvas.add(leader.tempLine);\n    canvas.add(leader.tempArrowhead);\n    canvas.add(leader.tempTextbox);\n\n    // Store references for grouping after edit\n    const lineRef = leader.tempLine;\n    const arrowRef = leader.tempArrowhead;\n    const textRef = leader.tempTextbox;\n\n    // Clear temp variables now\n    leader.tempLine = null;\n    leader.tempArrowhead = null;\n    leader.tempTextbox = null;\n\n    // Enter text editing mode immediately\n    canvas.setActiveObject(textRef);\n    textRef.enterEditing();\n\n    // When user exits editing, group everything\n    const groupAfterEdit = () => {\n      textRef.off('editing:exited', groupAfterEdit);\n\n      // If text is empty, set placeholder\n      if (!textRef.text || textRef.text.trim() === '') {\n        textRef.set({ text: 'Note...' });\n      }\n\n      // Remove individual objects\n      canvas.remove(lineRef);\n      canvas.remove(arrowRef);\n      canvas.remove(textRef);\n\n      // Create final group\n      const leaderGroup = new Group(\n        [lineRef, arrowRef, textRef],\n        {\n          selectable: true,\n          evented: true,\n          hasControls: true,\n          hasBorders: true,\n          customType: 'leaderLine',\n          subTargetCheck: true\n        }\n      );\n\n      canvas.add(leaderGroup);\n      canvas.setActiveObject(leaderGroup);\n      canvas.renderAll();\n\n      logger.debug('PDF', 'Leader line grouped after text edit');\n    };\n\n    textRef.on('editing:exited', groupAfterEdit);\n    canvas.renderAll();\n\n    return textRef;\n  };\n\n  // Double-click to re-edit leader line text\n  const handleLeaderDoubleClick = (canvas, opt) => {\n    const target = opt.target;\n    if (!target || target.customType !== 'leaderLine') return;\n\n    logger.debug('PDF', 'Double-click on leader - entering edit mode');\n\n    const objects = target.getObjects();\n    const line = objects[0];\n    const arrowhead = objects[1];\n    const textbox = objects[2];\n\n    const groupLeft = target.left || 0;\n    const groupTop = target.top || 0;\n\n    // Remove group\n    canvas.remove(target);\n\n    // Recreate objects at absolute positions\n    const newLine = new Line(\n      [\n        groupLeft + (line.x1 || 0),\n        groupTop + (line.y1 || 0),\n        groupLeft + (line.x2 || 0),\n        groupTop + (line.y2 || 0)\n      ],\n      {\n        stroke: line.stroke,\n        strokeWidth: line.strokeWidth,\n        selectable: false,\n        evented: false\n      }\n    );\n\n    const newArrowhead = new Triangle({\n      left: groupLeft + (arrowhead.left || 0),\n      top: groupTop + (arrowhead.top || 0),\n      width: arrowhead.width,\n      height: arrowhead.height,\n      fill: arrowhead.fill,\n      originX: arrowhead.originX,\n      originY: arrowhead.originY,\n      angle: arrowhead.angle,\n      selectable: false,\n      evented: false\n    });\n\n    const newTextbox = new Textbox(textbox.text || '', {\n      left: groupLeft + (textbox.left || 0),\n      top: groupTop + (textbox.top || 0),\n      width: textbox.width,\n      fontSize: textbox.fontSize,\n      fontFamily: textbox.fontFamily,\n      fill: textbox.fill,\n      editable: true,\n      selectable: true,\n      evented: true\n    });\n\n    canvas.add(newLine);\n    canvas.add(newArrowhead);\n    canvas.add(newTextbox);\n\n    // Enter edit mode\n    canvas.setActiveObject(newTextbox);\n    newTextbox.enterEditing();\n    newTextbox.selectAll();\n\n    // Re-group when done editing\n    const regroup = () => {\n      newTextbox.off('editing:exited', regroup);\n\n      // If text is empty, set placeholder\n      if (!newTextbox.text || newTextbox.text.trim() === '') {\n        newTextbox.set({ text: 'Note...' });\n      }\n\n      canvas.remove(newLine);\n      canvas.remove(newArrowhead);\n      canvas.remove(newTextbox);\n\n      const rebuiltGroup = new Group(\n        [newLine, newArrowhead, newTextbox],\n        {\n          selectable: true,\n          evented: true,\n          hasControls: true,\n          hasBorders: true,\n          customType: 'leaderLine',\n          subTargetCheck: true\n        }\n      );\n\n      canvas.add(rebuiltGroup);\n      canvas.setActiveObject(rebuiltGroup);\n      canvas.renderAll();\n\n      logger.debug('PDF', 'Leader line re-grouped after editing');\n    };\n\n    newTextbox.on('editing:exited', regroup);\n    canvas.renderAll();\n  };\n\n  // ===== WHITEOUT TOOL =====\n\n  // Start drawing whiteout rectangle (mouse down)\n  const startWhiteout = (canvas, x, y) => {\n    const whiteout = whiteoutStateRef.current;\n    whiteout.startX = x;\n    whiteout.startY = y;\n\n    whiteout.tempRect = new Rect({\n      left: x,\n      top: y,\n      width: 1,\n      height: 1,\n      fill: 'var(--text-primary)',\n      stroke: '#CCCCCC', // Light gray border while drawing\n      strokeWidth: 1,\n      selectable: false,\n      evented: false\n    });\n\n    canvas.add(whiteout.tempRect);\n    canvas.renderAll();\n  };\n\n  // Update whiteout rectangle during drawing (mouse move)\n  const updateWhiteout = (canvas, currentX, currentY) => {\n    const whiteout = whiteoutStateRef.current;\n    if (!whiteout.tempRect) return;\n\n    const width = Math.abs(currentX - whiteout.startX);\n    const height = Math.abs(currentY - whiteout.startY);\n    const left = Math.min(currentX, whiteout.startX);\n    const top = Math.min(currentY, whiteout.startY);\n\n    whiteout.tempRect.set({\n      left: left,\n      top: top,\n      width: width,\n      height: height\n    });\n\n    canvas.renderAll();\n  };\n\n  // Finalize whiteout (mouse up) - Auto-enters edit mode\n  const finalizeWhiteout = (canvas) => {\n    const whiteout = whiteoutStateRef.current;\n\n    if (!whiteout.tempRect) {\n      logger.warn('PDF', 'Whiteout finalize ABORTED - missing rect');\n      return null;\n    }\n\n    // Remove drawing border\n    whiteout.tempRect.set({\n      stroke: null,\n      strokeWidth: 0\n    });\n\n    // Get rect dimensions for text positioning\n    const rectLeft = whiteout.tempRect.left;\n    const rectTop = whiteout.tempRect.top;\n    const rectWidth = whiteout.tempRect.width;\n    const rectHeight = whiteout.tempRect.height;\n\n    // Create text box centered in the white rectangle\n    // Font size scales with rectangle height\n    const fontSize = Math.min(Math.max(rectHeight * 0.7, 8), 24);\n\n    const whiteoutText = new Textbox('', {\n      left: rectLeft + 2,\n      top: rectTop + (rectHeight - fontSize) / 2,\n      width: rectWidth - 4,\n      fontSize: fontSize,\n      fontFamily: 'Arial, Helvetica, sans-serif',\n      fill: 'var(--gray-900)',\n      textAlign: 'left',\n      editable: true,\n      selectable: true,\n      evented: true\n    });\n\n    canvas.add(whiteoutText);\n\n    // Store references\n    const rectRef = whiteout.tempRect;\n    const textRef = whiteoutText;\n\n    // Clear temp variable\n    whiteout.tempRect = null;\n\n    // Enter edit mode immediately\n    canvas.setActiveObject(textRef);\n    textRef.enterEditing();\n\n    // Group when done editing\n    const groupAfterEdit = () => {\n      textRef.off('editing:exited', groupAfterEdit);\n\n      canvas.remove(rectRef);\n      canvas.remove(textRef);\n\n      const whiteoutGroup = new Group(\n        [rectRef, textRef],\n        {\n          selectable: true,\n          evented: true,\n          hasControls: true,\n          hasBorders: true,\n          customType: 'whiteout',\n          subTargetCheck: true\n        }\n      );\n\n      canvas.add(whiteoutGroup);\n      canvas.setActiveObject(whiteoutGroup);\n      canvas.renderAll();\n\n      logger.debug('PDF', 'Whiteout grouped after text edit');\n    };\n\n    textRef.on('editing:exited', groupAfterEdit);\n    canvas.renderAll();\n\n    return textRef;\n  };\n\n  // Double-click to re-edit whiteout text\n  const handleWhiteoutDoubleClick = (canvas, opt) => {\n    const target = opt.target;\n    if (!target || target.customType !== 'whiteout') return;\n\n    logger.debug('PDF', 'Double-click on whiteout - entering edit mode');\n\n    const objects = target.getObjects();\n    const rect = objects[0];\n    const textbox = objects[1];\n\n    const groupLeft = target.left || 0;\n    const groupTop = target.top || 0;\n\n    // Remove group\n    canvas.remove(target);\n\n    // Recreate objects at absolute positions\n    const newRect = new Rect({\n      left: groupLeft + (rect.left || 0),\n      top: groupTop + (rect.top || 0),\n      width: rect.width,\n      height: rect.height,\n      fill: 'var(--text-primary)',\n      selectable: false,\n      evented: false\n    });\n\n    const newText = new Textbox(textbox.text || '', {\n      left: groupLeft + (textbox.left || 0),\n      top: groupTop + (textbox.top || 0),\n      width: textbox.width,\n      fontSize: textbox.fontSize,\n      fontFamily: textbox.fontFamily,\n      fill: textbox.fill,\n      textAlign: textbox.textAlign,\n      editable: true,\n      selectable: true,\n      evented: true\n    });\n\n    canvas.add(newRect);\n    canvas.add(newText);\n\n    // Enter edit mode\n    canvas.setActiveObject(newText);\n    newText.enterEditing();\n    newText.selectAll();\n\n    // Re-group when done editing\n    const regroup = () => {\n      newText.off('editing:exited', regroup);\n\n      canvas.remove(newRect);\n      canvas.remove(newText);\n\n      const rebuiltGroup = new Group(\n        [newRect, newText],\n        {\n          selectable: true,\n          evented: true,\n          hasControls: true,\n          hasBorders: true,\n          customType: 'whiteout',\n          subTargetCheck: true\n        }\n      );\n\n      canvas.add(rebuiltGroup);\n      canvas.setActiveObject(rebuiltGroup);\n      canvas.renderAll();\n\n      logger.debug('PDF', 'Whiteout re-grouped after editing');\n    };\n\n    newText.on('editing:exited', regroup);\n    canvas.renderAll();\n  };\n\n  // Handle double-click on Delta symbol to edit text\n  const handleDeltaDoubleClick = (canvas, opt) => {\n    const target = opt.target;\n    if (!target || !target.deltaLetter) return;\n\n    logger.debug('PDF', 'Double-click on delta - entering edit mode');\n\n    const objects = target.getObjects();\n    const triangle = objects[0];\n    const textObj = objects[1];\n\n    const groupLeft = target.left || 0;\n    const groupTop = target.top || 0;\n\n    // Remove group\n    canvas.remove(target);\n\n    // Recreate triangle at absolute position\n    const newTriangle = new Triangle({\n      left: groupLeft + (triangle.left || 0),\n      top: groupTop + (triangle.top || 0),\n      width: triangle.width,\n      height: triangle.height,\n      fill: triangle.fill,\n      stroke: triangle.stroke,\n      strokeWidth: triangle.strokeWidth,\n      originX: 'center',\n      originY: 'center',\n      selectable: false,\n      evented: false\n    });\n\n    // Recreate text as editable Textbox\n    const newText = new Textbox(textObj.text || '', {\n      left: groupLeft + (textObj.left || 0),\n      top: groupTop + (textObj.top || 0) - 5, // Adjust position for editing\n      fontSize: textObj.fontSize,\n      fontFamily: textObj.fontFamily,\n      fontWeight: textObj.fontWeight,\n      fill: textObj.fill,\n      textAlign: 'center',\n      originX: 'center',\n      originY: 'center',\n      editable: true,\n      selectable: true,\n      evented: true,\n      width: 100\n    });\n\n    canvas.add(newTriangle);\n    canvas.add(newText);\n\n    // Enter edit mode\n    canvas.setActiveObject(newText);\n    newText.enterEditing();\n    newText.selectAll();\n\n    // Re-group when done editing\n    const regroup = () => {\n      newText.off('editing:exited', regroup);\n\n      // Convert Textbox back to Text for centered display\n      const finalText = new Text(newText.text || target.deltaLetter, {\n        fontSize: textObj.fontSize,\n        fill: textObj.fill,\n        fontFamily: textObj.fontFamily,\n        fontWeight: textObj.fontWeight,\n        originX: 'center',\n        originY: 'center',\n        top: 3\n      });\n\n      canvas.remove(newTriangle);\n      canvas.remove(newText);\n\n      const rebuiltGroup = new Group(\n        [newTriangle, finalText],\n        {\n          left: groupLeft,\n          top: groupTop,\n          selectable: true,\n          evented: true,\n          hasControls: true,\n          hasBorders: true,\n          customType: 'delta',\n          subTargetCheck: true\n        }\n      );\n\n      rebuiltGroup.deltaLetter = target.deltaLetter; // Preserve letter tracking\n\n      canvas.add(rebuiltGroup);\n      canvas.setActiveObject(rebuiltGroup);\n      canvas.renderAll();\n\n      logger.debug('PDF', 'Delta re-grouped after editing');\n    };\n\n    newText.on('editing:exited', regroup);\n    canvas.renderAll();\n  };\n\n  // ===== LINE TOOL =====\n  const startLine = (canvas, x, y, color) => {\n    const line = new Line([x, y, x, y], {\n      stroke: color,\n      strokeWidth: 2,\n      selectable: false,\n      evented: false\n    });\n\n    canvas.add(line);\n    lineStateRef.current.startX = x;\n    lineStateRef.current.startY = y;\n    lineStateRef.current.tempLine = line;\n  };\n\n  const updateLine = (canvas, x, y) => {\n    const line = lineStateRef.current.tempLine;\n    if (!line) return;\n\n    line.set({\n      x2: x,\n      y2: y\n    });\n    line.setCoords();\n    canvas.renderAll();\n  };\n\n  const finalizeLine = (canvas) => {\n    const line = lineStateRef.current.tempLine;\n    if (!line) return;\n\n    line.set({\n      selectable: true,\n      evented: true,\n      hasControls: true,\n      hasBorders: true\n    });\n\n    lineStateRef.current.tempLine = null;\n    canvas.setActiveObject(line);\n    canvas.renderAll();\n  };\n\n  // ===== SQUARE TOOL =====\n  const startSquare = (canvas, x, y, color) => {\n    const rect = new Rect({\n      left: x,\n      top: y,\n      width: 0,\n      height: 0,\n      fill: 'transparent',\n      stroke: color,\n      strokeWidth: 2,\n      selectable: false,\n      evented: false\n    });\n\n    canvas.add(rect);\n    squareStateRef.current.startX = x;\n    squareStateRef.current.startY = y;\n    squareStateRef.current.tempRect = rect;\n  };\n\n  const updateSquare = (canvas, x, y) => {\n    const rect = squareStateRef.current.tempRect;\n    if (!rect) return;\n\n    const startX = squareStateRef.current.startX;\n    const startY = squareStateRef.current.startY;\n\n    const width = x - startX;\n    const height = y - startY;\n\n    rect.set({\n      left: width < 0 ? x : startX,\n      top: height < 0 ? y : startY,\n      width: Math.abs(width),\n      height: Math.abs(height)\n    });\n    rect.setCoords();\n    canvas.renderAll();\n  };\n\n  const finalizeSquare = (canvas) => {\n    const rect = squareStateRef.current.tempRect;\n    if (!rect) return;\n\n    rect.set({\n      selectable: true,\n      evented: true,\n      hasControls: true,\n      hasBorders: true\n    });\n\n    squareStateRef.current.tempRect = null;\n    canvas.setActiveObject(rect);\n    canvas.renderAll();\n  };\n\n  // ===== CIRCLE TOOL =====\n  const startCircle = (canvas, x, y, color) => {\n    const circle = new Circle({\n      left: x,\n      top: y,\n      radius: 0,\n      fill: 'transparent',\n      stroke: color,\n      strokeWidth: 2,\n      selectable: false,\n      evented: false,\n      originX: 'center',\n      originY: 'center'\n    });\n\n    canvas.add(circle);\n    circleStateRef.current.startX = x;\n    circleStateRef.current.startY = y;\n    circleStateRef.current.tempCircle = circle;\n  };\n\n  const updateCircle = (canvas, x, y) => {\n    const circle = circleStateRef.current.tempCircle;\n    if (!circle) return;\n\n    const startX = circleStateRef.current.startX;\n    const startY = circleStateRef.current.startY;\n\n    const dx = x - startX;\n    const dy = y - startY;\n    const radius = Math.sqrt(dx * dx + dy * dy);\n\n    circle.set({\n      radius: radius\n    });\n    circle.setCoords();\n    canvas.renderAll();\n  };\n\n  const finalizeCircle = (canvas) => {\n    const circle = circleStateRef.current.tempCircle;\n    if (!circle) return;\n\n    circle.set({\n      selectable: true,\n      evented: true,\n      hasControls: true,\n      hasBorders: true\n    });\n\n    circleStateRef.current.tempCircle = null;\n    canvas.setActiveObject(circle);\n    canvas.renderAll();\n  };\n\n  // Start drawing arrow\n  const startArrow = (canvas, x1, y1, color) => {\n    // Create the line\n    const line = new Line([x1, y1, x1, y1], {\n      stroke: color,\n      strokeWidth: 2,\n      selectable: false,\n      evented: false\n    });\n\n    // Create the triangle arrowhead\n    const triangle = new Triangle({\n      left: x1,\n      top: y1,\n      width: 12,\n      height: 12,\n      fill: color,\n      selectable: false,\n      evented: false,\n      originX: 'center',\n      originY: 'center'\n    });\n\n    canvas.add(line);\n    canvas.add(triangle);\n\n    arrowPartsRef.current = { line, triangle };\n    drawingObjectRef.current = { line, triangle };\n  };\n\n  // Update arrow as mouse moves\n  const updateArrow = (parts, x1, y1, x2, y2) => {\n    const { line, triangle } = parts;\n\n    // Update line\n    line.set({ x1, y1, x2, y2 });\n    line.setCoords();\n\n    // Calculate angle for triangle rotation\n    const angle = Math.atan2(y2 - y1, x2 - x1) * (180 / Math.PI);\n\n    // Update triangle position and rotation\n    triangle.set({\n      left: x2,\n      top: y2,\n      angle: angle + 90 // +90 to make triangle point in direction of arrow\n    });\n    triangle.setCoords();\n  };\n\n  // Add delta symbol (isosceles triangle with auto-increment letter)\n  const addDeltaSymbol = (canvas, x, y, color) => {\n    // Count existing deltas on this page to determine next letter\n    const existingDeltas = canvas.getObjects().filter(obj =>\n      obj.type === 'group' && obj.deltaLetter\n    );\n    const nextLetterIndex = existingDeltas.length;\n    const letter = String.fromCharCode(65 + (nextLetterIndex % 26)); // A, B, C, ... Z, then wraps\n\n    // Create isosceles triangle using Triangle object\n    const triangleSize = 30;\n    const triangle = new Triangle({\n      width: triangleSize,\n      height: triangleSize,\n      fill: 'transparent',\n      stroke: color,\n      strokeWidth: 2,\n      originX: 'center',\n      originY: 'center'\n    });\n\n    // Create letter text\n    const deltaText = new Text(letter, {\n      fontSize: 14,\n      fill: color,\n      fontFamily: 'Arial',\n      fontWeight: 'bold',\n      originX: 'center',\n      originY: 'center',\n      top: 3 // Offset slightly down for better centering\n    });\n\n    const group = new Group([triangle, deltaText], {\n      left: x,\n      top: y,\n      selectable: true,\n      hasControls: true,\n      customType: 'delta',\n      subTargetCheck: true\n    });\n\n    group.deltaLetter = letter; // Store for tracking\n\n    canvas.add(group);\n    canvas.renderAll();\n    saveAnnotations(canvas);\n    saveHistory(canvas);\n\n    // Auto-switch back to select mode after adding delta\n    if (onToolChange) {\n      onToolChange('select');\n    }\n  };\n\n  // Start drawing revision cloud\n  const startRevisionCloud = (canvas, x, y, color) => {\n    cloudStartRef.current = { x, y };\n\n    // Initialize with empty path array (Fabric v6 format)\n    const cloud = new Path([['M', 0, 0]], {\n      stroke: color,\n      strokeWidth: 2,\n      fill: 'transparent',\n      selectable: false,\n      evented: false,\n      objectCaching: false, // Disable caching for dynamic updates\n      left: x,\n      top: y\n    });\n\n    canvas.add(cloud);\n    drawingObjectRef.current = cloud;\n  };\n\n  // Update revision cloud path (rectangular with outward arc bulges)\n  const updateRevisionCloud = (cloud, endX, endY) => {\n    const { x: startX, y: startY } = cloudStartRef.current;\n\n    // Calculate rectangle corners (absolute coordinates)\n    const left = Math.min(startX, endX);\n    const right = Math.max(startX, endX);\n    const top = Math.min(startY, endY);\n    const bottom = Math.max(startY, endY);\n\n    const width = right - left;\n    const height = bottom - top;\n\n    // Skip if rectangle too small\n    if (width < 10 || height < 10) {\n      return;\n    }\n\n    // Arc segment size (standard CAD practice: 10-15px arcs)\n    const arcSize = 12;\n\n    // Calculate number of arcs per side\n    const topArcs = Math.max(1, Math.floor(width / arcSize));\n    const bottomArcs = Math.max(1, Math.floor(width / arcSize));\n    const leftArcs = Math.max(1, Math.floor(height / arcSize));\n    const rightArcs = Math.max(1, Math.floor(height / arcSize));\n\n    const topSegment = width / topArcs;\n    const bottomSegment = width / bottomArcs;\n    const leftSegment = height / leftArcs;\n    const rightSegment = height / rightArcs;\n\n    // Build path array with RELATIVE coordinates (relative to left, top)\n    // Fabric.js Path coordinates are relative to the object's position\n    const pathArray = [['M', 0, 0]];\n\n    // Top edge (arcs bulge upward)\n    for (let i = 0; i < topArcs; i++) {\n      const x1 = i * topSegment;\n      const x2 = (i + 1) * topSegment;\n      const midX = (x1 + x2) / 2;\n      const arcY = -6; // Bulge outward (up) relative to top edge\n      pathArray.push(['Q', midX, arcY, x2, 0]);\n    }\n\n    // Right edge (arcs bulge rightward)\n    for (let i = 0; i < rightArcs; i++) {\n      const y1 = i * rightSegment;\n      const y2 = (i + 1) * rightSegment;\n      const midY = (y1 + y2) / 2;\n      const arcX = width + 6; // Bulge outward (right) relative to left edge\n      pathArray.push(['Q', arcX, midY, width, y2]);\n    }\n\n    // Bottom edge (arcs bulge downward)\n    for (let i = bottomArcs - 1; i >= 0; i--) {\n      const x1 = (i + 1) * bottomSegment;\n      const x2 = i * bottomSegment;\n      const midX = (x1 + x2) / 2;\n      const arcY = height + 6; // Bulge outward (down) relative to top edge\n      pathArray.push(['Q', midX, arcY, x2, height]);\n    }\n\n    // Left edge (arcs bulge leftward)\n    for (let i = leftArcs - 1; i >= 0; i--) {\n      const y1 = (i + 1) * leftSegment;\n      const y2 = i * leftSegment;\n      const midY = (y1 + y2) / 2;\n      const arcX = -6; // Bulge outward (left) relative to left edge\n      pathArray.push(['Q', arcX, midY, 0, y2]);\n    }\n\n    pathArray.push(['Z']);\n\n    // Set the path and position the cloud at the absolute position\n    // Account for arc bulges (6px on each side) in the dimensions\n    cloud.set({\n      path: pathArray,\n      left: left - 6,  // Offset for left arc bulge\n      top: top - 6,    // Offset for top arc bulge\n      width: width + 12,   // Add space for left + right bulges\n      height: height + 12, // Add space for top + bottom bulges\n      pathOffset: {\n        x: 6,  // Adjust path offset to compensate for position shift\n        y: 6\n      }\n    });\n    cloud.setCoords();\n  };\n\n  // Save annotations to parent component\n  const saveAnnotations = (canvas) => {\n    if (!onAnnotationsChange) {\n      return;\n    }\n\n    const objects = canvas.getObjects();\n    const annotationsData = objects.map((obj) => ({\n      page: currentPage,\n      object: obj.toJSON(['deltaLetter', 'cloudPath', 'customType']) // Include custom properties\n    }));\n\n    onAnnotationsChange(annotationsData);\n  };\n\n  // Handle object modifications\n  useEffect(() => {\n    const canvas = fabricCanvasRef.current;\n    if (!canvas) {\n      return;\n    }\n\n    const handleObjectModified = () => {\n      saveAnnotations(canvas);\n      saveHistory(canvas);\n    };\n\n    canvas.on('object:modified', handleObjectModified);\n    canvas.on('object:removed', handleObjectModified);\n\n    return () => {\n      canvas.off('object:modified', handleObjectModified);\n      canvas.off('object:removed', handleObjectModified);\n    };\n  }, [currentPage]);\n\n  // Keyboard event handlers (Delete, Undo, Redo)\n  useEffect(() => {\n    if (!isActive) {\n      return;\n    }\n\n    const handleKeyDown = (e) => {\n      const canvas = fabricCanvasRef.current;\n      if (!canvas) return;\n\n      // Delete selected objects\n      if (e.key === 'Delete' || e.key === 'Backspace') {\n        // Only handle if not in text editing mode\n        const activeObject = canvas.getActiveObject();\n        if (activeObject && activeObject.isEditing) {\n          return; // Don't delete while editing text\n        }\n\n        const activeObjects = canvas.getActiveObjects();\n        if (activeObjects.length > 0) {\n          e.preventDefault(); // Prevent browser back navigation on Backspace\n          activeObjects.forEach(obj => canvas.remove(obj));\n          canvas.discardActiveObject();\n          canvas.renderAll();\n          saveAnnotations(canvas);\n          saveHistory(canvas);\n        }\n      }\n\n      // Undo (Ctrl+Z)\n      if (e.ctrlKey && e.key === 'z') {\n        e.preventDefault();\n        undo(canvas);\n      }\n\n      // Redo (Ctrl+Y or Ctrl+Shift+Z)\n      if (e.ctrlKey && (e.key === 'y' || (e.shiftKey && e.key === 'z'))) {\n        e.preventDefault();\n        redo(canvas);\n      }\n    };\n\n    document.addEventListener('keydown', handleKeyDown);\n\n    return () => {\n      document.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [isActive]);\n\n  // Save canvas state to history\n  const saveHistory = (canvas) => {\n    const json = canvas.toJSON(['deltaLetter', 'cloudPath', 'customType']);\n    historyRef.current = historyRef.current.slice(0, historyStepRef.current + 1);\n    historyRef.current.push(json);\n    historyStepRef.current = historyRef.current.length - 1;\n  };\n\n  // Undo function\n  const undo = (canvas) => {\n    if (historyStepRef.current > 0) {\n      historyStepRef.current -= 1;\n      loadCanvasFromHistory(canvas, historyRef.current[historyStepRef.current]);\n    }\n  };\n\n  // Redo function\n  const redo = (canvas) => {\n    if (historyStepRef.current < historyRef.current.length - 1) {\n      historyStepRef.current += 1;\n      loadCanvasFromHistory(canvas, historyRef.current[historyStepRef.current]);\n    }\n  };\n\n  // Load canvas state from history\n  const loadCanvasFromHistory = async (canvas, state) => {\n    if (!state) return;\n\n    canvas.clear();\n    await canvas.loadFromJSON(state);\n    canvas.renderAll();\n    saveAnnotations(canvas);\n  };\n\n  // Delete selected objects function\n  const deleteSelected = (canvas) => {\n    const activeObjects = canvas.getActiveObjects();\n    if (activeObjects.length > 0) {\n      activeObjects.forEach(obj => canvas.remove(obj));\n      canvas.discardActiveObject();\n      canvas.renderAll();\n      saveAnnotations(canvas);\n      saveHistory(canvas);\n    }\n  };\n\n  // Expose undo/redo/delete functions to parent\n  useImperativeHandle(ref, () => ({\n    undo: () => {\n      const canvas = fabricCanvasRef.current;\n      if (canvas) {\n        undo(canvas);\n      }\n    },\n    redo: () => {\n      const canvas = fabricCanvasRef.current;\n      if (canvas) {\n        redo(canvas);\n      }\n    },\n    deleteSelected: () => {\n      const canvas = fabricCanvasRef.current;\n      if (canvas) {\n        deleteSelected(canvas);\n      }\n    }\n  }));\n\n  if (!isActive) {\n    return null;\n  }\n\n  return (\n    <div className={styles.annotationLayerContainer}>\n      <canvas ref={canvasRef} className={styles.annotationCanvas} />\n    </div>\n  );\n});\n\nexport default PdfAnnotationLayer;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\pdf\\PdfFullScreenModal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\pdf\\PdfToolbar.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'useState' is defined but never used.","line":1,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport styles from './PdfToolbar.module.css';\nimport { Button } from '../ui';\n\n/**\n * PdfToolbar - Right-side annotation toolbar\n *\n * Features:\n * - Collapsible panel\n * - Tool selection: Select, Text, Arrow, Delta, Revision Cloud\n * - Color picker with 4 presets: Red, Blue, Green, Yellow\n * - Undo/Redo buttons\n * - Delete Selected button\n * - Save Markup button (Phase 4)\n *\n * @param {string} currentTool - Currently selected tool\n * @param {function} onToolChange - Callback when tool changes\n * @param {string} currentColor - Currently selected color\n * @param {function} onColorChange - Callback when color changes\n * @param {boolean} canSave - Whether save button should be enabled\n * @param {function} onSave - Callback when save is clicked\n * @param {string} statusTab - Current status tab ('draft' or 'published')\n * @param {function} onUndo - Callback when undo is clicked\n * @param {function} onRedo - Callback when redo is clicked\n * @param {function} onDelete - Callback when delete is clicked\n */\nconst PdfToolbar = ({\n  currentTool = 'select',\n  onToolChange,\n  currentColor = 'var(--color-danger)',\n  onColorChange,\n  canSave = false,\n  onSave,\n  statusTab = 'draft'\n}) => {\n  const tools = [\n    {\n      id: 'cloud',\n      label: 'Rev Cloud',\n      icon: (\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n          <path d=\"M3 8 Q2 6 3 5 Q4 4 5 5 Q5 3 7 3 Q9 3 9 5 Q10 4 11 5 Q12 6 11 8 Q13 9 11 11 Q10 12 9 11 Q9 13 7 13 Q5 13 5 11 Q4 12 3 11 Q2 10 3 8 Z\"/>\n        </svg>\n      )\n    },\n    {\n      id: 'delta',\n      label: 'Delta',\n      icon: (\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n          <path d=\"M8 3 L13 13 L3 13 Z\" />\n        </svg>\n      )\n    },\n    {\n      id: 'text',\n      label: 'Text',\n      icon: 'T'\n    },\n    {\n      id: 'whiteout',\n      label: 'Whiteout',\n      icon: (\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\">\n          <rect x=\"2\" y=\"2\" width=\"12\" height=\"12\" fill=\"white\" stroke='var(--gray-400)' strokeWidth=\"1\" />\n        </svg>\n      )\n    },\n    {\n      id: 'leader',\n      label: 'Leader Line',\n      icon: (\n        <svg width=\"28\" height=\"16\" viewBox=\"0 0 28 16\" fill=\"currentColor\">\n          <path d=\"M0 8 L8 8 M5 5 L8 8 L5 11\" stroke=\"currentColor\" strokeWidth=\"1.5\" fill=\"none\"/>\n          <text x=\"10\" y=\"12\" fontSize=\"10\" fontWeight=\"bold\" fill=\"currentColor\">ABC</text>\n        </svg>\n      )\n    },\n    {\n      id: 'line',\n      label: 'Line',\n      icon: (\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" stroke=\"currentColor\" strokeWidth=\"2\">\n          <line x1=\"2\" y1=\"14\" x2=\"14\" y2=\"2\" />\n        </svg>\n      )\n    },\n    {\n      id: 'square',\n      label: 'Square',\n      icon: (\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n          <rect x=\"2\" y=\"2\" width=\"12\" height=\"12\" />\n        </svg>\n      )\n    },\n    {\n      id: 'circle',\n      label: 'Circle',\n      icon: (\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n          <circle cx=\"8\" cy=\"8\" r=\"6\" />\n        </svg>\n      )\n    }\n  ];\n\n  return (\n    <div className={styles.toolbarContainer}>\n      <div className={styles.toolbarContent}>\n        {/* Tools Section */}\n        <div className={styles.section}>\n          <h4 className={styles.sectionTitle}>Tools</h4>\n          <div className={styles.toolsGrid}>\n            {tools.map((tool) => (\n              <button\n                key={tool.id}\n                className={`${styles.toolButton} ${currentTool === tool.id ? styles.active : ''}`}\n                onClick={() => onToolChange(tool.id)}\n                title={tool.label}\n              >\n                <span className={styles.toolIcon}>\n                  {typeof tool.icon === 'string' ? tool.icon : tool.icon}\n                </span>\n                <span className={styles.toolLabel}>{tool.label}</span>\n              </button>\n            ))}\n          </div>\n        </div>\n\n        {/* Color Selector Section */}\n        <div className={styles.section}>\n          <h4 className={styles.sectionTitle}>Color</h4>\n          <div className={styles.colorOptions}>\n            {/* Dynamic color for swatch */}\n            <button\n              className={`${styles.colorSwatch} ${currentColor === 'var(--color-danger)' ? styles.selected : ''}`}\n              style={{ backgroundColor: 'var(--color-danger)' }}\n              onClick={() => onColorChange('var(--color-danger)')}\n              title=\"Red\"\n            />\n            {/* Dynamic color for swatch */}\n            <button\n              className={`${styles.colorSwatch} ${currentColor === 'var(--gray-900)' ? styles.selected : ''}`}\n              style={{ backgroundColor: 'var(--gray-900)' }}\n              onClick={() => onColorChange('var(--gray-900)')}\n              title=\"Black\"\n            />\n          </div>\n        </div>\n\n        {/* Publish Button - Only show on Draft tab */}\n        {statusTab === 'draft' && (\n          <div className={styles.section}>\n            <Button\n              variant=\"outline\"\n              onClick={onSave}\n              disabled={!canSave}\n              fullWidth\n            >\n              Publish\n            </Button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default PdfToolbar;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\pdf\\QCChecklistPanel.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'title' is assigned a value but never used.","line":33,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":14},{"ruleId":"no-unused-vars","severity":1,"message":"'accentColor' is assigned a value but never used.","line":34,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":20},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'checklist'. Either include it or remove the dependency array.","line":84,"column":6,"nodeType":"ArrayExpression","endLine":84,"endColumn":21,"suggestions":[{"desc":"Update the dependencies array to be: [checklist, checklistType]","fix":{"range":[2962,2977],"text":"[checklist, checklistType]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { qcSitePlanChecklist, getSitePlanChecklistTotal } from '../../data/qcSitePlanChecklist';\nimport { qcDesignChecklist, getDesignChecklistTotal } from '../../data/qcDesignChecklist';\nimport styles from './QCChecklistPanel.module.css';\n\n/**\n * QCChecklistPanel - Dual QC checklist for solar PV plan sets\n *\n * Features:\n * - Site Plan QC (~85 items) - physical layout, structural, mounting\n * - Design QC (~95 items) - electrical, calculations, documentation\n * - Collapsible sections and subsections\n * - Progress tracking with percentage\n * - Session-based state persistence\n * - Visual feedback for completed items\n * - Reset functionality\n */\nconst QCChecklistPanel = React.forwardRef(({ isOpen, onClose, projectId, checklistType = 'site', onProgressChange }, ref) => {\n  const [checkedItems, setCheckedItems] = useState({});\n  const [expandedSections, setExpandedSections] = useState({});\n  const [expandedSubsections, setExpandedSubsections] = useState({});\n\n  // Expose reset function to parent via ref\n  React.useImperativeHandle(ref, () => ({\n    reset: () => {\n      setCheckedItems({});\n    }\n  }));\n\n  // Select the appropriate checklist based on type\n  const checklist = checklistType === 'site' ? qcSitePlanChecklist : qcDesignChecklist;\n  const totalItems = checklistType === 'site' ? getSitePlanChecklistTotal() : getDesignChecklistTotal();\n  const title = checklistType === 'site' ? 'Site Plan QC' : 'Design QC';\n  const accentColor = checklistType === 'site' ? 'var(--color-success)' : 'var(--color-info)'; // Green for site, Blue for design\n\n  const checkedCount = Object.values(checkedItems).filter(Boolean).length;\n  const progressPercent = Math.round((checkedCount / totalItems) * 100);\n\n  // Notify parent of progress changes\n  React.useEffect(() => {\n    if (onProgressChange) {\n      onProgressChange(progressPercent);\n    }\n  }, [progressPercent, onProgressChange]);\n\n  // Toggle checkbox\n  const toggleItem = (itemId) => {\n    setCheckedItems(prev => ({\n      ...prev,\n      [itemId]: !prev[itemId]\n    }));\n  };\n\n  // Toggle section expand/collapse\n  const toggleSection = (sectionId) => {\n    setExpandedSections(prev => ({\n      ...prev,\n      [sectionId]: !prev[sectionId]\n    }));\n  };\n\n  // Toggle subsection expand/collapse\n  const toggleSubsection = (subsectionId) => {\n    setExpandedSubsections(prev => ({\n      ...prev,\n      [subsectionId]: !prev[subsectionId]\n    }));\n  };\n\n  // Initialize all sections as collapsed - re-initialize when checklist type changes\n  useEffect(() => {\n    const sections = {};\n    const subsections = {};\n    checklist.forEach(section => {\n      sections[section.id] = false;\n      section.subsections.forEach(sub => {\n        subsections[sub.id] = false;\n      });\n    });\n    setExpandedSections(sections);\n    setExpandedSubsections(subsections);\n    // Reset checked items when switching checklist type\n    setCheckedItems({});\n  }, [checklistType]);\n\n  if (!isOpen) return null;\n\n  return (\n    <div className={styles.container}>\n      {/* Progress Bar - Compact Header */}\n      <div className={styles.progressHeader}>\n        <div className={styles.progressStats}>\n          <span className={styles.progressCount}>\n            {checkedCount} / {totalItems} Complete\n          </span>\n          <span className={`${styles.progressPercent} ${\n            progressPercent === 100\n              ? styles.progressPercentComplete\n              : checklistType === 'site'\n                ? styles.progressPercentSite\n                : styles.progressPercentDesign\n          }`}>\n            {progressPercent}%\n          </span>\n        </div>\n        <div className={styles.progressBar}>\n          <div\n            className={`${styles.progressFill} ${\n              progressPercent === 100\n                ? styles.progressFillComplete\n                : checklistType === 'site'\n                  ? styles.progressFillSite\n                  : styles.progressFillDesign\n            }`}\n            style={{ width: `${progressPercent}%` }}\n          />\n        </div>\n      </div>\n\n      {/* Checklist */}\n      <div className={styles.checklistContainer}>\n        {checklist.map(section => {\n          const sectionExpanded = expandedSections[section.id];\n\n          // Count checked items in this section\n          let sectionTotal = 0;\n          let sectionChecked = 0;\n          section.subsections.forEach(sub => {\n            sub.items.forEach(item => {\n              sectionTotal++;\n              if (checkedItems[item.id]) sectionChecked++;\n            });\n          });\n\n          return (\n            <div key={section.id} className={styles.section}>\n              {/* Section Header */}\n              <button\n                onClick={() => toggleSection(section.id)}\n                className={styles.sectionHeader}\n              >\n                <div className={styles.sectionHeaderContent}>\n                  <span className={`${styles.sectionArrow} ${\n                    sectionExpanded ? styles.sectionArrowExpanded : styles.sectionArrowCollapsed\n                  } ${\n                    checklistType === 'site' ? styles.sectionArrowSite : styles.sectionArrowDesign\n                  }`}>\n                    â–¼\n                  </span>\n                  {section.title}\n                </div>\n                <span className={`${styles.sectionCount} ${\n                  sectionChecked === sectionTotal ? styles.sectionCountComplete : styles.sectionCountIncomplete\n                }`}>\n                  {sectionChecked}/{sectionTotal}\n                </span>\n              </button>\n\n              {/* Subsections */}\n              {sectionExpanded && (\n                <div className={styles.subsectionsContainer}>\n                  {section.subsections.map(subsection => {\n                    const subExpanded = expandedSubsections[subsection.id];\n\n                    // Count checked in subsection\n                    const subChecked = subsection.items.filter(item => checkedItems[item.id]).length;\n\n                    return (\n                      <div key={subsection.id} className={styles.subsection}>\n                        {/* Subsection Header */}\n                        <button\n                          onClick={() => toggleSubsection(subsection.id)}\n                          className={styles.subsectionHeader}\n                        >\n                          <div className={styles.subsectionHeaderContent}>\n                            <span className={`${styles.subsectionArrow} ${\n                              subExpanded ? styles.subsectionArrowExpanded : styles.subsectionArrowCollapsed\n                            }`}>\n                              â–¼\n                            </span>\n                            {subsection.title}\n                          </div>\n                          <span className={`${styles.subsectionCount} ${\n                            subChecked === subsection.items.length ? styles.subsectionCountComplete : styles.subsectionCountIncomplete\n                          }`}>\n                            {subChecked}/{subsection.items.length}\n                          </span>\n                        </button>\n\n                        {/* Checklist Items */}\n                        {subExpanded && (\n                          <div className={styles.itemsContainer}>\n                            {subsection.items.map(item => (\n                              <label\n                                key={item.id}\n                                className={`${styles.itemLabel} ${\n                                  checkedItems[item.id] ? styles.itemLabelChecked : styles.itemLabelUnchecked\n                                }`}\n                                onMouseEnter={(e) => {\n                                  if (!checkedItems[item.id]) {\n                                    e.currentTarget.style.background = 'rgba(255,255,255,0.03)';\n                                  }\n                                }}\n                                onMouseLeave={(e) => {\n                                  e.currentTarget.style.background = checkedItems[item.id]\n                                    ? 'rgba(16, 185, 129, 0.1)'\n                                    : 'transparent';\n                                }}\n                              >\n                                {/* Custom Checkbox */}\n                                <div\n                                  onClick={() => toggleItem(item.id)}\n                                  className={`${styles.checkbox} ${\n                                    checkedItems[item.id] ? styles.checkboxChecked : styles.checkboxUnchecked\n                                  }`}\n                                >\n                                  {checkedItems[item.id] && (\n                                    <span className={styles.checkmark}>âœ“</span>\n                                  )}\n                                </div>\n\n                                <div className={styles.itemContent}>\n                                  <div className={`${styles.itemText} ${\n                                    checkedItems[item.id] ? styles.itemTextChecked : styles.itemTextUnchecked\n                                  }`}>\n                                    {item.label}\n                                  </div>\n                                  <div className={styles.itemDetail}>\n                                    {item.detail}\n                                  </div>\n                                </div>\n                              </label>\n                            ))}\n                          </div>\n                        )}\n                      </div>\n                    );\n                  })}\n                </div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n});\n\nQCChecklistPanel.displayName = 'QCChecklistPanel';\n\nexport default QCChecklistPanel;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\ElectricalForm.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'useState' is defined but never used.","line":1,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":25},{"ruleId":"no-unused-vars","severity":1,"message":"'SectionHeader' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'calculateMaxContinuousOutput' is defined but never used.","line":12,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":38},{"ruleId":"no-unused-vars","severity":1,"message":"'updateFields' is assigned a value but never used.","line":30,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":17},{"ruleId":"no-unused-vars","severity":1,"message":"'handleClearMainCircuitBreakers' is assigned a value but never used.","line":69,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":69,"endColumn":39},{"ruleId":"no-unused-vars","severity":1,"message":"'handleClearMainPanelA' is assigned a value but never used.","line":78,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":78,"endColumn":30},{"ruleId":"no-unused-vars","severity":1,"message":"'handleClearSubPanelB' is assigned a value but never used.","line":94,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":94,"endColumn":29},{"ruleId":"no-unused-vars","severity":1,"message":"'handleClearPOI' is assigned a value but never used.","line":115,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":115,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useMemo } from 'react';\nimport MainCircuitBreakersSection from './electrical/MainCircuitBreakersSection';\nimport MainPanelASection from './electrical/MainPanelASection';\nimport SubPanelBSection from './electrical/SubPanelBSection';\nimport SubPanelCSection from './electrical/SubPanelCSection';\nimport SubPanelDSection from './electrical/SubPanelDSection';\nimport PointOfInterconnectionSection from './electrical/PointOfInterconnectionSection';\nimport FormNavigationFooter from './FormNavigationFooter';\nimport { SectionHeader } from '../ui';\nimport equipStyles from './EquipmentForm.module.css';\nimport { useSystemDetails } from '../../hooks/useSystemDetails';\nimport { calculateMaxContinuousOutput } from '../../utils/pcsUtils';\n\n/**\n * ElectricalForm - Electrical configuration component\n * Handles all electrical panel and POI configurations\n */\nconst ElectricalForm = ({ projectUuid, projectData, onNavigateToTab }) => {\n  console.debug('[ElectricalForm] Rendering with projectUuid:', projectUuid);\n\n  // ============================================\n  // SYSTEM DETAILS HOOK (API INTEGRATION)\n  // ============================================\n\n  const {\n    data: systemDetails,\n    loading,\n    error,\n    updateField,\n    updateFields,\n    clearFields,\n    getField,\n  } = useSystemDetails({ projectUuid });\n\n  // ============================================\n  // NAVIGATION HANDLERS\n  // ============================================\n\n  const handlePrev = () => {\n    if (onNavigateToTab) {\n      onNavigateToTab('equipment', { subTab: 'bos' });\n    }\n  };\n\n  const handleNext = () => {\n    if (onNavigateToTab) {\n      onNavigateToTab('structural');\n    }\n  };\n\n  // ============================================\n  // FIELD CHANGE HANDLER\n  // ============================================\n\n  const handleFieldChange = async (field, value) => {\n    console.debug(`[ElectricalForm] Field change: ${field} =`, value);\n\n    try {\n      await updateField(field, value);\n    } catch (err) {\n      console.error(`[ElectricalForm] Failed to update field ${field}:`, err);\n    }\n  };\n\n  // ============================================\n  // CLEAR HANDLERS\n  // ============================================\n\n  const handleClearMainCircuitBreakers = async () => {\n    console.debug('[ElectricalForm] Clearing Main Circuit Breakers');\n    try {\n      await clearFields(['ele_ses_type', 'ele_main_circuit_breakers_qty']);\n    } catch (err) {\n      console.error('[ElectricalForm] Failed to clear Main Circuit Breakers:', err);\n    }\n  };\n\n  const handleClearMainPanelA = async () => {\n    console.debug('[ElectricalForm] Clearing Main Panel A');\n    try {\n      await clearFields([\n        'ele_bus_bar_rating',\n        'ele_main_circuit_breaker_rating',\n        'ele_feeder_location_on_bus_bar',\n        'el_mpa_derated',\n        'mpa_bus_bar_existing',\n        'mpa_main_circuit_breaker_existing',\n      ]);\n    } catch (err) {\n      console.error('[ElectricalForm] Failed to clear Main Panel A:', err);\n    }\n  };\n\n  const handleClearSubPanelB = async () => {\n    console.debug('[ElectricalForm] Clearing Sub Panel B');\n    try {\n      await clearFields([\n        'show_sub_panel_b',\n        'spb_activated',\n        'spb_subpanel_existing',\n        'spb_subpanelb_mcbexisting',\n        'spb_bus_bar_rating',\n        'spb_main_breaker_rating',\n        'spb_subpanel_b_feeder_location',\n        'spb_upstream_breaker_rating',\n        'spb_conductor_sizing',\n        'spb_tie_in_location',\n        'el_spb_derated',\n      ]);\n    } catch (err) {\n      console.error('[ElectricalForm] Failed to clear Sub Panel B:', err);\n    }\n  };\n\n  const handleClearPOI = async () => {\n    console.debug('[ElectricalForm] Clearing Point of Interconnection');\n    try {\n      await clearFields([\n        'ele_method_of_interconnection',\n        'el_poi_breaker_rating',\n        'el_poi_disconnect_rating',\n        'ele_breaker_location',\n        'sys1_pcs_amps',\n        'sys1_pcs_settings',\n      ]);\n    } catch (err) {\n      console.error('[ElectricalForm] Failed to clear POI:', err);\n    }\n  };\n\n  // ============================================\n  // PCS DATA EXTRACTION (SYSTEM 1)\n  // ============================================\n\n  // Extract battery data for System 1\n  const batteryData = useMemo(() => {\n    if (!systemDetails) return {};\n\n    return {\n      battery1_make: getField('sys1_battery_1_make'), // Fixed: Matches EquipmentForm mapping\n      battery1_model: getField('sys1_battery_1_model'), // Fixed: Matches EquipmentForm mapping\n      battery1_qty: getField('sys1_battery_1_qty'), // Fixed: Matches EquipmentForm mapping\n      battery2_make: getField('sys1_battery_2_make'), // Fixed: Matches EquipmentForm mapping\n      battery2_model: getField('sys1_battery_2_model'), // Fixed: Matches EquipmentForm mapping\n      battery2_qty: getField('sys1_battery_2_qty'), // Fixed: Matches EquipmentForm mapping\n    };\n  }, [systemDetails, getField]);\n\n  // Extract inverter data for System 1\n  const inverterData = useMemo(() => {\n    if (!systemDetails) return {};\n\n    return {\n      inverter_make: getField('sys1_inverter_make'),\n      inverter_model: getField('sys1_inverter_model'),\n      inverter_type: getField('sys1_inverter_type'),\n      microinverter_qty: getField('sys1_inverter_qty'),\n      max_cont_output_amps: getField('sys1_inv_max_continuous_output'), // Fixed: Matches EquipmentForm mapping\n    };\n  }, [systemDetails, getField]);\n\n  // Extract panel data for System 1\n  const panelData = useMemo(() => {\n    if (!systemDetails) return {};\n\n    return {\n      bus_bar_rating: getField('ele_bus_bar_rating'),\n      main_breaker_rating: getField('ele_main_circuit_breaker_rating'),\n    };\n  }, [systemDetails, getField]);\n\n  // Calculate combined system max output (if multiple systems tie into same POI)\n  const combinedSystemMaxOutput = useMemo(() => {\n    // TODO: For now, we only have System 1\n    // In the future, check if sys2/sys3/sys4 tie into the same POI\n    // and sum their max continuous outputs\n\n    console.debug('[ElectricalForm] Combined system max output: N/A (single system)');\n    return null;\n  }, []);\n\n  // Determine if this is a combined system\n  const isCombinedSystem = useMemo(() => {\n    // TODO: For now, always false (single system)\n    // In the future, check if multiple systems share the same POI\n    return false;\n  }, []);\n\n  // ============================================\n  // SUB PANEL VISIBILITY LOGIC\n  // ============================================\n\n  // Sub Panel B visible if user clicked to show it OR if there's any data\n  const subPanelBVisible = useMemo(() => {\n    if (!systemDetails) return false;\n    const showFlag = getField('show_sub_panel_b', false);\n    const hasData = !!(\n      getField('spb_bus_bar_rating') ||\n      getField('spb_subpanel_b_feeder_location') ||\n      getField('spb_upstream_breaker_rating') ||\n      getField('spb_conductor_sizing') ||\n      getField('spb_tie_in_location')\n    );\n    return showFlag || hasData;\n  }, [systemDetails, getField]);\n\n  // Sub Panel C visible if user clicked to show it OR if there's any data\n  const subPanelCVisible = useMemo(() => {\n    if (!systemDetails) return false;\n    const showFlag = getField('show_sub_panel_c', false);\n    const hasData = !!(\n      getField('spc_bus_bar_rating') ||\n      getField('spc_feeder_location') ||\n      getField('spc_upstream_breaker_rating') ||\n      getField('spc_conductor_sizing') ||\n      getField('spc_tie_in_location')\n    );\n    return showFlag || hasData;\n  }, [systemDetails, getField]);\n\n  // Sub Panel D visible if user clicked to show it OR if there's any data\n  const subPanelDVisible = useMemo(() => {\n    if (!systemDetails) return false;\n    const showFlag = getField('show_sub_panel_d', false);\n    const hasData = !!(\n      getField('spd_bus_bar_rating') ||\n      getField('spd_feeder_location') ||\n      getField('spd_upstream_breaker_rating') ||\n      getField('spd_conductor_sizing') ||\n      getField('spd_tie_in_location')\n    );\n    return showFlag || hasData;\n  }, [systemDetails, getField]);\n\n  // ============================================\n  // FORM DATA HELPER (for child components)\n  // ============================================\n\n  // Create formData object for child components that expect it\n  const formData = useMemo(() => {\n    if (!systemDetails) {\n      return {\n        // Default values\n        ele_ses_type: '',\n        ele_main_circuit_breakers_qty: 0,\n        mpa_bus_bar_existing: false,\n        mpa_main_circuit_breaker_existing: false,\n        ele_bus_bar_rating: '',\n        ele_main_circuit_breaker_rating: 'MLO',\n        ele_feeder_location_on_bus_bar: '',\n        el_mpa_derated: false,\n        show_sub_panel_b: false,\n        spb_activated: false,\n        spb_subpanel_existing: false,\n        spb_subpanelb_mcbexisting: false,\n        spb_bus_bar_rating: '',\n        spb_main_breaker_rating: 'MLO',\n        spb_subpanel_b_feeder_location: '',\n        spb_upstream_breaker_rating: '',\n        spb_conductor_sizing: '',\n        spb_tie_in_location: '',\n        el_spb_derated: false,\n        show_sub_panel_c: false,\n        spc_subpanel_existing: false,\n        spc_subpanelc_mcbexisting: false,\n        spc_bus_bar_rating: '',\n        spc_main_breaker_rating: 'MLO',\n        spc_feeder_location: '',\n        spc_upstream_breaker_rating: '',\n        spc_conductor_sizing: '',\n        spc_tie_in_location: '',\n        el_spc_derated: false,\n        show_sub_panel_d: false,\n        spd_subpanel_existing: false,\n        spd_subpaneld_mcbexisting: false,\n        spd_bus_bar_rating: '',\n        spd_main_breaker_rating: 'MLO',\n        spd_feeder_location: '',\n        spd_upstream_breaker_rating: '',\n        spd_conductor_sizing: '',\n        spd_tie_in_location: '',\n        el_spd_derated: false,\n        ele_method_of_interconnection: '',\n        el_poi_breaker_rating: '',\n        el_poi_disconnect_rating: '',\n        ele_breaker_location: '',\n        sys1_pcs_amps: '',\n        sys1_pcs_settings: false,\n      };\n    }\n\n    return {\n      // Main Circuit Breakers\n      ele_ses_type: getField('ele_ses_type', ''),\n      ele_main_circuit_breakers_qty: getField('ele_main_circuit_breakers_qty', 0),\n\n      // Main Panel A\n      mpa_bus_bar_existing: getField('mpa_bus_bar_existing', false),\n      mpa_main_circuit_breaker_existing: getField('mpa_main_circuit_breaker_existing', false),\n      ele_bus_bar_rating: getField('ele_bus_bar_rating', ''),\n      ele_main_circuit_breaker_rating: getField('ele_main_circuit_breaker_rating', 'MLO'),\n      ele_feeder_location_on_bus_bar: getField('ele_feeder_location_on_bus_bar', ''),\n      el_mpa_derated: getField('el_mpa_derated', false),\n\n      // Sub Panel B\n      show_sub_panel_b: getField('show_sub_panel_b', false),\n      spb_activated: getField('spb_activated', false),\n      spb_subpanel_existing: getField('spb_subpanel_existing', false),\n      spb_subpanelb_mcbexisting: getField('spb_subpanelb_mcbexisting', false),\n      spb_bus_bar_rating: getField('spb_bus_bar_rating', ''),\n      spb_main_breaker_rating: getField('spb_main_breaker_rating', 'MLO'),\n      spb_subpanel_b_feeder_location: getField('spb_subpanel_b_feeder_location', ''),\n      spb_upstream_breaker_rating: getField('spb_upstream_breaker_rating', ''),\n      spb_conductor_sizing: getField('spb_conductor_sizing', ''),\n      spb_tie_in_location: getField('spb_tie_in_location', ''),\n      el_spb_derated: getField('el_spb_derated', false),\n\n      // Sub Panel C\n      show_sub_panel_c: getField('show_sub_panel_c', false),\n      spc_subpanel_existing: getField('spc_subpanel_existing', false),\n      spc_subpanelc_mcbexisting: getField('spc_subpanelc_mcbexisting', false),\n      spc_bus_bar_rating: getField('spc_bus_bar_rating', ''),\n      spc_main_breaker_rating: getField('spc_main_breaker_rating', 'MLO'),\n      spc_feeder_location: getField('spc_feeder_location', ''),\n      spc_upstream_breaker_rating: getField('spc_upstream_breaker_rating', ''),\n      spc_conductor_sizing: getField('spc_conductor_sizing', ''),\n      spc_tie_in_location: getField('spc_tie_in_location', ''),\n      el_spc_derated: getField('el_spc_derated', false),\n\n      // Sub Panel D\n      show_sub_panel_d: getField('show_sub_panel_d', false),\n      spd_subpanel_existing: getField('spd_subpanel_existing', false),\n      spd_subpaneld_mcbexisting: getField('spd_subpaneld_mcbexisting', false),\n      spd_bus_bar_rating: getField('spd_bus_bar_rating', ''),\n      spd_main_breaker_rating: getField('spd_main_breaker_rating', 'MLO'),\n      spd_feeder_location: getField('spd_feeder_location', ''),\n      spd_upstream_breaker_rating: getField('spd_upstream_breaker_rating', ''),\n      spd_conductor_sizing: getField('spd_conductor_sizing', ''),\n      spd_tie_in_location: getField('spd_tie_in_location', ''),\n      el_spd_derated: getField('el_spd_derated', false),\n\n      // Point of Interconnection\n      ele_method_of_interconnection: getField('ele_method_of_interconnection', ''),\n      el_poi_breaker_rating: getField('el_poi_breaker_rating', ''),\n      el_poi_disconnect_rating: getField('el_poi_disconnect_rating', ''),\n      ele_breaker_location: getField('ele_breaker_location', ''),\n      sys1_pcs_amps: getField('sys1_pcs_amps', ''),\n      sys1_pcs_settings: getField('sys1_pcs_settings', false),\n    };\n  }, [systemDetails, getField]);\n\n  // ============================================\n  // LOADING & ERROR STATES\n  // ============================================\n\n  if (loading) {\n    return (\n      <div style={{ padding: 'var(--spacing-lg)', textAlign: 'center' }}>\n        Loading electrical data...\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div style={{ padding: 'var(--spacing-lg)', color: 'var(--color-error)' }}>\n        Error loading electrical data: {error}\n      </div>\n    );\n  }\n\n  // ============================================\n  // RENDER\n  // ============================================\n\n  return (\n    <form onSubmit={(e) => e.preventDefault()} style={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\n      {/* Scrollable Content */}\n      <div className={equipStyles.scrollableContent}>\n        {/* Main Circuit Breakers (Electrical Service) */}\n        <MainCircuitBreakersSection\n          formData={formData}\n          onChange={handleFieldChange}\n        />\n\n        {/* Main Panel A */}\n        <MainPanelASection\n          formData={formData}\n          onChange={handleFieldChange}\n          onShowSubPanelB={() => handleFieldChange('show_sub_panel_b', true)}\n          subPanelBVisible={subPanelBVisible}\n        />\n\n        {/* Sub Panel B - Conditionally visible based on data or user action */}\n        {subPanelBVisible && (\n          <SubPanelBSection\n            formData={formData}\n            onChange={handleFieldChange}\n            onShowSubPanelC={() => handleFieldChange('show_sub_panel_c', true)}\n            subPanelCVisible={subPanelCVisible}\n          />\n        )}\n\n        {/* Sub Panel C - Conditionally visible based on data or user action */}\n        {subPanelCVisible && (\n          <SubPanelCSection\n            formData={formData}\n            onChange={handleFieldChange}\n            onShowSubPanelD={() => handleFieldChange('show_sub_panel_d', true)}\n            subPanelDVisible={subPanelDVisible}\n          />\n        )}\n\n        {/* Sub Panel D - Conditionally visible based on data or user action */}\n        {subPanelDVisible && (\n          <SubPanelDSection\n            formData={formData}\n            onChange={handleFieldChange}\n          />\n        )}\n\n        {/* Point of Interconnection */}\n        <PointOfInterconnectionSection\n          formData={formData}\n          onChange={handleFieldChange}\n          systemNumber={1}\n          batteryData={batteryData}\n          inverterData={inverterData}\n          panelData={panelData}\n          isCombinedSystem={isCombinedSystem}\n          combinedSystemMaxOutput={combinedSystemMaxOutput}\n        />\n      </div>\n\n      {/* Footer Navigation */}\n      <FormNavigationFooter\n        onPrev={handlePrev}\n        onNext={handleNext}\n        prevLabel=\"Prev\"\n        nextLabel=\"Next\"\n      />\n    </form>\n  );\n};\n\nexport default ElectricalForm;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\EquipmentForm.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'axios' is defined but never used.","line":2,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":13},{"ruleId":"no-unused-vars","severity":1,"message":"'MainCircuitBreakersSection' is defined but never used.","line":19,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":34},{"ruleId":"no-unused-vars","severity":1,"message":"'MainPanelASection' is defined but never used.","line":20,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":25},{"ruleId":"no-unused-vars","severity":1,"message":"'SubPanelBSection' is defined but never used.","line":21,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":24},{"ruleId":"no-unused-vars","severity":1,"message":"'PointOfInterconnectionSection' is defined but never used.","line":22,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":37},{"ruleId":"no-unused-vars","severity":1,"message":"'Tooltip' is defined but never used.","line":29,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":32},{"ruleId":"no-unused-vars","severity":1,"message":"'isSystemTabVisible' is defined but never used.","line":36,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":21},{"ruleId":"no-unused-vars","severity":1,"message":"'flameIcon' is defined but never used.","line":42,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":42,"endColumn":17},{"ruleId":"no-unused-vars","severity":1,"message":"'systemError' is assigned a value but never used.","line":53,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":53,"endColumn":23},{"ruleId":"no-dupe-keys","severity":1,"message":"Duplicate key 'ele_combine_positions'.","line":265,"column":5,"nodeType":"ObjectExpression","messageId":"unexpected","endLine":265,"endColumn":26},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'visibleSystems'. Either include it or remove the dependency array.","line":705,"column":6,"nodeType":"ArrayExpression","endLine":705,"endColumn":33,"suggestions":[{"desc":"Update the dependencies array to be: [systemDetails, maxSystems, visibleSystems]","fix":{"range":[31009,31036],"text":"[systemDetails, maxSystems, visibleSystems]"}}]},{"ruleId":"no-unused-vars","severity":1,"message":"'suppressESS' is assigned a value but never used.","line":1231,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":1231,"endColumn":20},{"ruleId":"no-unused-vars","severity":1,"message":"'isPW3' is assigned a value but never used.","line":1235,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":1235,"endColumn":14},{"ruleId":"no-unused-vars","severity":1,"message":"'isGateway3SMS' is assigned a value but never used.","line":1240,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":1240,"endColumn":22},{"ruleId":"no-unused-vars","severity":1,"message":"'isEnphaseCombiner6C' is assigned a value but never used.","line":1248,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":1248,"endColumn":28},{"ruleId":"no-unused-vars","severity":1,"message":"'showGatewayConfig' is assigned a value but never used.","line":1254,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":1254,"endColumn":26},{"ruleId":"no-unused-vars","severity":1,"message":"'handleSelectSystem' is assigned a value but never used.","line":1265,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":1265,"endColumn":27},{"ruleId":"no-unused-vars","severity":1,"message":"'handleClearSolarPanel' is assigned a value but never used.","line":1404,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":1404,"endColumn":30},{"ruleId":"no-unused-vars","severity":1,"message":"'handleClearSolarPanel2' is assigned a value but never used.","line":1417,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":1417,"endColumn":31},{"ruleId":"no-unused-vars","severity":1,"message":"'handleClearInverter' is assigned a value but never used.","line":1438,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":1438,"endColumn":28},{"ruleId":"no-unused-vars","severity":1,"message":"'handleClearCombinerPanel' is assigned a value but never used.","line":1555,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":1555,"endColumn":33},{"ruleId":"no-unused-vars","severity":1,"message":"'handleClearEnergyStorage' is assigned a value but never used.","line":1567,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":1567,"endColumn":33},{"ruleId":"no-unused-vars","severity":1,"message":"'handleClearSMS' is assigned a value but never used.","line":1575,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":1575,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'handleClearBattery1' is assigned a value but never used.","line":1588,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":1588,"endColumn":28},{"ruleId":"no-unused-vars","severity":1,"message":"'handleClearBattery2' is assigned a value but never used.","line":1598,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":1598,"endColumn":28},{"ruleId":"no-unused-vars","severity":1,"message":"'handleClearBackupPanel' is assigned a value but never used.","line":1609,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":1609,"endColumn":31},{"ruleId":"no-unused-vars","severity":1,"message":"'getInverterSectionTitle' is assigned a value but never used.","line":1627,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":1627,"endColumn":32},{"ruleId":"no-unused-vars","severity":1,"message":"'checkSystemHasData' is assigned a value but never used.","line":1637,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":1637,"endColumn":27},{"ruleId":"no-unused-vars","severity":1,"message":"'totalSystemKw' is assigned a value but never used.","line":1802,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":1802,"endColumn":22},{"ruleId":"no-unused-vars","severity":1,"message":"'viewSteps' is assigned a value but never used.","line":1807,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":1807,"endColumn":18},{"ruleId":"no-unused-vars","severity":1,"message":"'renderSystemEquipment' is assigned a value but never used.","line":1814,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":1814,"endColumn":30},{"ruleId":"no-unused-vars","severity":1,"message":"'systemPrefix' is assigned a value but never used.","line":1816,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":1816,"endColumn":23}],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'formData.battery1_make', 'formData.battery1_model', 'formData.battery1_quantity', and 'handleBatchFieldChange'. Either include them or remove the dependency array.","line":742,"column":6,"nodeType":"ArrayExpression","endLine":742,"endColumn":80,"suggestions":[{"desc":"Update the dependencies array to be: [formData.inverter_make, formData.inverter_model, formData.expansionPacks, formData.battery1_quantity, formData.battery1_make, formData.battery1_model, handleBatchFieldChange]","fix":{"range":[32308,32382],"text":"[formData.inverter_make, formData.inverter_model, formData.expansionPacks, formData.battery1_quantity, formData.battery1_make, formData.battery1_model, handleBatchFieldChange]"}}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'handleBatchFieldChange'. Either include it or remove the dependency array.","line":786,"column":6,"nodeType":"ArrayExpression","endLine":786,"endColumn":112,"suggestions":[{"desc":"Update the dependencies array to be: [formData.gateway, formData.inverter_make, formData.inverter_model, formData.sms_make, formData.sms_model, handleBatchFieldChange]","fix":{"range":[33735,33841],"text":"[formData.gateway, formData.inverter_make, formData.inverter_model, formData.sms_make, formData.sms_model, handleBatchFieldChange]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":32,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useMemo, useEffect, useRef, useCallback } from 'react';\nimport axios from '../../config/axios';\nimport logger from '../../services/devLogger';\nimport { useSystemDetails } from '../../hooks';\nimport { calculatePanelsRemaining } from '../../utils/stringingUtils';\nimport SolarPanelSection from './equipment/SolarPanelSection';\nimport SolarPanel2Section from './equipment/SolarPanel2Section';\nimport InverterMicroSection from './equipment/InverterMicroSection';\n// import InverterStringingSection from './equipment/InverterStringingSection'; // MOVED INTO InverterMicroSection\nimport StringCombinerPanelSection from './equipment/StringCombinerPanelSection';\n// import MicroinverterStringingSection from './equipment/MicroinverterStringingSection'; // MOVED INTO InverterMicroSection\nimport EnergyStorageSection from './equipment/EnergyStorageSection';\nimport StorageManagementSystemSection from './equipment/StorageManagementSystemSection';\nimport BatteryTypeSection from './equipment/BatteryTypeSection';\nimport BackupLoadSubPanelSection from './equipment/BackupLoadSubPanelSection';\nimport BatteryCombinerPanelSection from './equipment/storage/BatteryCombinerPanelSection';\nimport PowerWallConfigurationSection from './equipment/PowerWallConfigurationSection';\nimport GatewayConfigurationSection from './equipment/GatewayConfigurationSection';\nimport MainCircuitBreakersSection from './electrical/MainCircuitBreakersSection';\nimport MainPanelASection from './electrical/MainPanelASection';\nimport SubPanelBSection from './electrical/SubPanelBSection';\nimport PointOfInterconnectionSection from './electrical/PointOfInterconnectionSection';\nimport CombineSystemsForm from './equipment/CombineSystemsForm';\nimport BOSPanel from './equipment/BOSPanel';\nimport SystemContainer from './equipment/SystemContainer';\nimport FormNavigationFooter from './FormNavigationFooter';\nimport ConfirmDialog from '../ui/ConfirmDialog';\nimport BOSDetectionModal from '../modals/BOSDetectionModal';\nimport { SectionHeader, Tooltip, AddSectionButton, AddButton } from '../ui';\nimport { detectProjectConfiguration } from '../../utils/bosConfigurationSwitchboard';\nimport { prepareBOSPopulation, saveBOSPopulation } from '../../services/bosAutoPopulationService';\nimport { isTeslaPowerWall, shouldSuppressESS, isPowerWall3, isPowerWallPlus } from '../../utils/powerWallDetection';\nimport {\n  SYSTEM_PREFIXES,\n  systemHasData as checkSystemHasDataUtil,\n  isSystemTabVisible,\n  getActiveSystems as getActiveSystemsUtil,\n  getSchemaField,\n} from '../../utils/systemFieldMapping';\nimport equipStyles from './EquipmentForm.module.css';\nimport formStyles from '../../styles/FormSections.module.css';\nimport flameIcon from '../../assets/images/Skyfire Flame Icon.png';\n\n/**\n * EquipmentForm - Main equipment configuration component\n * Modular design: imports section components based on configuration\n */\nconst EquipmentForm = ({ projectUuid, projectData, onNavigateToTab, initialSubTab }) => {\n  // Initialize system details hook for equipment data persistence\n  const {\n    data: systemDetails,\n    loading: systemLoading,\n    error: systemError,\n    updateField,\n    updateFields,\n    refresh: refreshSystemDetails,\n  } = useSystemDetails({ projectUuid });\n\n  const [selectedSystem, setSelectedSystem] = useState(1);\n  const currentSystemPrefix = SYSTEM_PREFIXES[selectedSystem];\n  const [selectedView, setSelectedView] = useState('equipment'); // Keep for repurposing\n  const [showAddSystemModal, setShowAddSystemModal] = useState(false);\n  const [showStringingBlocker, setShowStringingBlocker] = useState(false);\n  const [stringingBlockerMessage, setStringingBlockerMessage] = useState('');\n  const [loading, setLoading] = useState(true);\n  const maxSystems = 4;\n\n  // BOS Detection Modal State\n  const [showBOSDetectionModal, setShowBOSDetectionModal] = useState(false);\n  const [bosDetectionResult, setBosDetectionResult] = useState(null);\n  const [bosDetectionSummary, setBosDetectionSummary] = useState('');\n  const [bosItemCount, setBosItemCount] = useState(0);\n  const [bosDetectionLoading, setBosDetectionLoading] = useState(false);\n  const [bosPayload, setBosPayload] = useState(null);\n\n  // Visible systems state - System 1 always visible\n  const [visibleSystems, setVisibleSystems] = useState([1]);\n\n  // Ref to track previous gateway value for Gateway 3 SMS sync\n  const prevGatewayRef = useRef('');\n\n  // Form state - matches API field names from audit\n  const [formData, setFormData] = useState({\n    // Solar Panel fields\n    solar_panel_isnew: true,\n    solar_panel_make: '',\n    solar_panel_model: '',\n    solar_panel_model_id: '', // Database ID of the solar panel model\n    solar_panel_wattage: '',\n    solar_panel_quantity: '',\n\n    // Inverter/Microinverter fields\n    inverter_isnew: true,\n    inverter_make: '',\n    inverter_model: '',\n    inverter_model_id: '', // Database ID of the inverter model\n    inverter_type: '', // 'inverter' or 'microinverter' - determined from DB\n    inverter_max_cont_output_amps: '',\n    inverter_max_strings_branches: null, // For string inverters only\n\n    // Optimizer fields (for SolarEdge, SOL-ARK, TIGO)\n    optimizer_isnew: true,\n    optimizer_make: '',\n    optimizer_model: '',\n\n    // String Combiner Panel fields (for microinverters)\n    combiner_panel_isnew: true,\n    combiner_panel_make: '',\n    combiner_panel_model: '',\n    combiner_panel_bus_amps: '',\n    combiner_panel_main_breaker: 'MLO',\n    combiner_panel_tie_in_breaker: '',\n\n    // Stringing fields (used for both String Inverters and Microinverters)\n    stringing_type: 'auto', // 'auto' or 'custom'\n    branch_string_1: '',\n    branch_string_2: '',\n    branch_string_3: '',\n    branch_string_4: '',\n    branch_string_5: '',\n    branch_string_6: '',\n    branch_string_7: '',\n    branch_string_8: '',\n    branch_string_9: '',\n    branch_string_10: '',\n\n    // Hoymiles/APSystems Granular Microinverter Panel Tracking (camelCase)\n    micro1Panels: '',\n    micro2Panels: '',\n    micro3Panels: '',\n    micro4Panels: '',\n    micro5Panels: '',\n    micro6Panels: '',\n    micro7Panels: '',\n    micro8Panels: '',\n    micro9Panels: '',\n    micro10Panels: '',\n    micro11Panels: '',\n    micro12Panels: '',\n    micro13Panels: '',\n    micro14Panels: '',\n    micro15Panels: '',\n    micro16Panels: '',\n    micro17Panels: '',\n    micro18Panels: '',\n    micro19Panels: '',\n    micro20Panels: '',\n    micro21Panels: '',\n    micro22Panels: '',\n    micro23Panels: '',\n    micro24Panels: '',\n    micro25Panels: '',\n\n    // Energy Storage System fields\n    backup_option: '', // 'Whole Home', 'Partial Home', or 'No Backup'\n    backup_system_size: '', // Amp rating for backup system\n\n    // Storage Management System (SMS) fields\n    sms_isnew: true,\n    sms_make: '',\n    sms_model: '',\n    sms_main_breaker: 'MLO',\n    sms_pv_breaker: '',\n    sms_ess_breaker: '',\n    sms_tie_in_breaker: '',\n    sms_has_rsd: false,\n    sms_backup_load_sub_panel_breaker_rating: 'MLO',\n    sms_pv_breaker_rating_override: '',\n    sms_ess_breaker_rating_override: '',\n    sms_tie_in_breaker_rating_override: '',\n\n    // Battery Type 1 fields\n    battery1_isnew: true,\n    battery1_quantity: '',\n    battery1_make: '',\n    battery1_model: '',\n    battery1_configuration: '', // 'Daisy Chain', 'Battery Combiner Panel', or 'Inverter'\n    battery1_tie_in_location: '',\n\n    // Battery Type 2 fields (optional)\n    battery2_isnew: true,\n    battery2_quantity: '',\n    battery2_make: '',\n    battery2_model: '',\n    battery2_configuration: '',\n    battery2_tie_in_location: '',\n    show_battery_type_2: false, // Controls whether Battery Type 2 section is shown\n\n    // Combine Systems fields\n    combine_systems: false, // false = do not combine (default), true = combine\n    ele_combine_positions: '', // JSON string of combine configuration\n\n    // Backup Load Sub Panel fields (for Whole Home / Partial Home)\n    backup_panel_isnew: true,\n    backup_panel_make: '',\n    backup_panel_model: '',\n    backup_panel_bus_amps: '',\n    backup_panel_main_breaker: 'MLO',\n    backup_panel_tie_in_breaker: '',\n\n    // Battery Combiner Panel fields\n    battery_combiner_panel_isnew: true,\n    battery_combiner_panel_make: '',\n    battery_combiner_panel_model: '',\n    battery_combiner_panel_bus_amps: '',\n    battery_combiner_panel_main_breaker: 'MLO',\n    battery_combiner_panel_tie_in_breaker: '',\n\n    // Tesla PowerWall Configuration fields\n    expansionPacks: 0, // 0-3 battery expansion packs\n    gateway: '', // 'backup_switch', 'backup_gateway_2', 'gateway_3'\n    teslagatewaytype: '', // Display name for gateway type\n    backupSwitchLocation: '', // 'behind_utility_meter', 'stand_alone_meter_panel'\n    batteryExisting: false, // New or existing battery\n    pcs_settings: false, // Power Control System activation\n\n    // Gateway Configuration fields (for Backup Gateway 2 or Gateway 3)\n    // Note: Gateway Config saves to SMS fields (they're shared in Tesla systems)\n    gatewayConfigIsNew: true,\n    gatewayConfigMainBreaker: '',\n    gatewayConfigBackupPanel: '',\n    gatewayConfigActivatePCS: false,\n    gatewayConfigPVBreaker: '',\n    gatewayConfigESSBreaker: '',\n    gatewayConfigTieInBreaker: '',\n\n    // Electrical Section fields\n    // Main Circuit Breakers (Service Entrance)\n    ele_ses_type: '',\n    ele_main_circuit_breakers_qty: 0,\n\n    // Main Panel A\n    mpa_bus_bar_existing: false,\n    mpa_main_circuit_breaker_existing: false,\n    ele_bus_bar_rating: '',\n    ele_main_circuit_breaker_rating: 'MLO',\n    ele_feeder_location_on_bus_bar: '',\n    el_mpa_derated: false,\n\n    // Sub Panel B\n    show_sub_panel_b: false,\n    spb_activated: false,\n    spb_subpanel_existing: false,\n    spb_bus_bar_rating: '',\n    spb_main_breaker_rating: 'MLO',\n    spb_subpanel_b_feeder_location: '',\n    spb_upstream_breaker_rating: '',\n    spb_conductor_sizing: '',\n    spb_tie_in_location: '',\n    el_spb_derated: false,\n\n    // Point of Interconnection\n    ele_method_of_interconnection: '',\n    el_poi_breaker_rating: '',\n    el_poi_disconnect_rating: '',\n    ele_breaker_location: '',\n    sys1_pcs_amps: '',\n    sys1_pcs_settings: false,\n\n    // System 2 inverter fields (to determine if Combine step is needed)\n    sys2_inverter_make: '',\n    sys2_inverter_model: '',\n\n    // Combine Systems configuration\n    ele_combine_positions: null, // JSON string storing combine configuration\n    has_subpanel_b: false, // Whether Sub Panel B exists\n    ele_subpanel_b_bus_rating: '',\n    ele_subpanel_b_main_breaker: '',\n    ele_subpanel_b_upstream_breaker: '',\n  });\n\n  // Hydrate form data for a specific system\n  const hydrateFormData = useCallback((systemNum) => {\n    const prefix = SYSTEM_PREFIXES[systemNum];\n\n    // Return empty defaults for new projects (systemDetails is null)\n    if (!systemDetails) {\n      return {\n        // Solar Panel defaults\n        solar_panel_isnew: true,\n        solar_panel_make: '',\n        solar_panel_model: '',\n        solar_panel_model_id: '',\n        solar_panel_wattage: '',\n        solar_panel_quantity: '',\n        show_solar_panel_2: false,\n        batteryonly: false,\n\n        // Solar Panel 2 defaults\n        solar_panel_type2_is_new: true,\n        solar_panel_type2_manufacturer: '',\n        solar_panel_type2_model: '',\n        solar_panel_type2_model_id: '',\n        solar_panel_type2_wattage: '',\n        solar_panel_type2_quantity: '',\n\n        // Inverter defaults\n        inverter_isnew: true,\n        inverter_make: '',\n        inverter_model: '',\n        inverter_model_id: '',\n        inverter_type: '',\n        inverter_max_cont_output_amps: '',\n        sys1_ap_hoy_breaker_size: '',\n\n        // Optimizer defaults\n        optimizer_isnew: true,\n        optimizer_make: '',\n        optimizer_model: '',\n\n        // String Combiner Panel defaults\n        combiner_panel_isnew: true,\n        combiner_panel_make: '',\n        combiner_panel_model: '',\n        combiner_panel_bus_amps: '',\n        combiner_panel_main_breaker: 'MLO',\n\n        // Stringing defaults\n        stringing_type: 'auto',\n        branch_string_1: '',\n        branch_string_2: '',\n        branch_string_3: '',\n        branch_string_4: '',\n        branch_string_5: '',\n        branch_string_6: '',\n        branch_string_7: '',\n        branch_string_8: '',\n        branch_string_9: '',\n        branch_string_10: '',\n\n        // Microinverter Panel Tracking defaults\n        micro1Panels: '',\n        micro2Panels: '',\n        micro3Panels: '',\n        micro4Panels: '',\n        micro5Panels: '',\n        micro6Panels: '',\n        micro7Panels: '',\n        micro8Panels: '',\n        micro9Panels: '',\n        micro10Panels: '',\n        micro11Panels: '',\n        micro12Panels: '',\n        micro13Panels: '',\n        micro14Panels: '',\n        micro15Panels: '',\n        micro16Panels: '',\n        micro17Panels: '',\n        micro18Panels: '',\n        micro19Panels: '',\n        micro20Panels: '',\n        micro21Panels: '',\n        micro22Panels: '',\n        micro23Panels: '',\n        micro24Panels: '',\n        micro25Panels: '',\n\n        // Energy Storage defaults\n        backup_option: '',\n        backup_system_size: '',\n\n        // Tesla PowerWall Configuration defaults\n        expansionPacks: 0,\n        gateway: '',\n        teslagatewaytype: '',\n        backupSwitchLocation: '',\n        batteryExisting: false,\n        pcs_settings: false,\n\n        // SMS (Storage Management System) defaults\n        sms_isnew: true,\n        sms_make: '',\n        sms_model: '',\n        sms_main_breaker: '',\n        sms_pv_breaker: '',\n        sms_ess_breaker: '',\n        sms_tie_in_breaker: '',\n        sms_has_rsd: false,\n        sms_backup_load_sub_panel_breaker_rating: '',\n        sms_pv_breaker_rating_override: '',\n        sms_ess_breaker_rating_override: '',\n        sms_tie_in_breaker_rating_override: '',\n\n        // Battery Type 1 defaults\n        battery1_isnew: true,\n        battery1_quantity: '',\n        battery1_make: '',\n        battery1_model: '',\n        battery1_configuration: '',\n        battery1_tie_in_location: '',\n\n        // Battery Type 2 defaults\n        battery2_isnew: true,\n        battery2_quantity: '',\n        battery2_make: '',\n        battery2_model: '',\n        battery2_tie_in_location: '',\n        show_battery_type_2: false,\n\n        // Backup Load Sub Panel defaults\n        backup_panel_isnew: true,\n        backup_panel_make: '',\n        backup_panel_model: '',\n        backup_panel_bus_amps: '',\n        backup_panel_main_breaker: 'MLO',\n        backup_panel_tie_in_breaker: '',\n\n        // Battery Combiner Panel defaults\n        battery_combiner_panel_isnew: true,\n        battery_combiner_panel_make: '',\n        battery_combiner_panel_model: '',\n        battery_combiner_panel_bus_amps: '',\n        battery_combiner_panel_main_breaker: 'MLO',\n        battery_combiner_panel_tie_in_breaker: '',\n\n        // Gateway Configuration defaults\n        gatewayConfigIsNew: true,\n        gatewayConfigMainBreaker: '',\n        gatewayConfigBackupPanel: '',\n        gatewayConfigActivatePCS: false,\n        gatewayConfigPVBreaker: '',\n        gatewayConfigESSBreaker: '',\n        gatewayConfigTieInBreaker: '',\n\n        // ESS Combiner defaults\n        ess_isnew: true,\n        ess_make: '',\n        ess_model: '',\n        ess_main_breaker: '',\n\n        // Electrical defaults (global, not system-specific)\n        ele_ses_type: '',\n        ele_main_circuit_breakers_qty: '',\n        ele_bus_bar_rating: '',\n        ele_main_circuit_breaker_rating: 'MLO',\n\n        // BOS Equipment defaults (6 slots)\n        ...Array.from({ length: 6 }, (_, i) => {\n          const slot = i + 1;\n          const bosPrefix = `bos_${prefix}_type${slot}`;\n          return {\n            [`${bosPrefix}_equipment_type`]: '',\n            [`${bosPrefix}_make`]: '',\n            [`${bosPrefix}_model`]: '',\n            [`${bosPrefix}_amp_rating`]: '',\n            [`${bosPrefix}_is_new`]: true,\n            [`${bosPrefix}_active`]: null,\n            [`${bosPrefix}_trigger`]: null,\n            [`${bosPrefix}_block_name`]: '',\n          };\n        }).reduce((acc, curr) => ({ ...acc, ...curr }), {}),\n\n        // Include site data for utility-specific BOS translations\n        site: projectData?.site || null,\n        // Also pass utility directly for easier access\n        utility: (() => {\n          const utilityValue = projectData?.site?.utility || '';\n          console.log('[EquipmentForm] Hydrating NEW project - projectData:', projectData);\n          console.log('[EquipmentForm] Hydrating NEW project - projectData.site:', projectData?.site);\n          console.log('[EquipmentForm] Hydrating NEW project - utility value:', utilityValue);\n          return utilityValue;\n        })(),\n      };\n    }\n\n    // For existing projects, hydrate from systemDetails\n    return {\n      // Solar Panel (handle schema inconsistencies)\n      solar_panel_isnew: !systemDetails[getSchemaField(systemNum, 'solar_panel_existing')],\n      solar_panel_make: systemDetails[`${prefix}_solar_panel_make`] || '',\n      solar_panel_model: systemDetails[`${prefix}_solar_panel_model`] || '',\n      solar_panel_model_id: systemDetails[getSchemaField(systemNum, 'solarpanel_id')] || '',\n      solar_panel_wattage: systemDetails[`${prefix}_solar_panel_wattage`] || '',\n      solar_panel_quantity: systemDetails[`${prefix}_solar_panel_qty`] || '',\n\n      // Solar Panel Type 2 visibility flag\n      show_solar_panel_2: !!systemDetails[`${prefix}_mixed_panel_system`],\n      batteryonly: !!systemDetails[`${prefix}_batteryonly`],\n\n      // Solar Panel Type 2 fields\n      solar_panel_type2_is_new: !systemDetails[`${prefix}_solar_panel_type2_existing`],\n      solar_panel_type2_manufacturer: systemDetails[`${prefix}_solar_panel_type2_manufacturer`] || '',\n      solar_panel_type2_model: systemDetails[`${prefix}_solar_panel_type2_model`] || '',\n      solar_panel_type2_quantity: systemDetails[`${prefix}_solar_panel_type2_quantity`] || '',\n      solar_panel_type2_wattage: systemDetails[`${prefix}_solar_panel_type2_watts`] || '',\n      solar_panel_type2_model_id: systemDetails[`${prefix}_solar_panel_type2_model_id`] || '',\n      solar_panel_type2_voc: systemDetails[`${prefix}_solar_panel_type2_voc`] || '',\n      solar_panel_type2_isc: systemDetails[`${prefix}_solar_panel_type2_isc`] || '',\n      solar_panel_type2_vmp: systemDetails[`${prefix}_solar_panel_type2_vmp`] || '',\n      solar_panel_type2_imp: systemDetails[`${prefix}_solar_panel_type2_imp`] || '',\n      solar_panel_type2_temp_coeff_voc: systemDetails[`${prefix}_solar_panel_type2_temp_coeff_voc`] || '',\n\n      // Inverter/Microinverter (handle schema inconsistencies)\n      inverter_isnew: !systemDetails[getSchemaField(systemNum, 'micro_inverter_existing')],\n      inverter_make: systemDetails[`${prefix}_micro_inverter_make`] || '',\n      inverter_model: systemDetails[`${prefix}_micro_inverter_model`] || '',\n      inverter_model_id: systemDetails[`${prefix}_micro_inverter_id`] || '',\n      inverter_type: systemDetails[`${prefix}_inverter_type`] || '',\n      inverter_max_cont_output_amps: systemDetails[`${prefix}_inv_max_continuous_output`] || '',\n      sys1_ap_hoy_breaker_size: systemDetails.sys1_ap_hoy_breaker_size || '',\n\n      // Optimizer\n      optimizer_isnew: !systemDetails[`${prefix}_optimizer_existing`],\n      optimizer_make: systemDetails[`${prefix}_optimizer_make`] || '',\n      optimizer_model: systemDetails[`${prefix}_optimizer_model`] || '',\n\n      // String Combiner Panel\n      combiner_panel_isnew: !systemDetails[`${prefix}_combiner_panel_existing`],\n      combiner_panel_make: systemDetails[`${prefix}_combiner_panel_make`] || '',\n      combiner_panel_model: systemDetails[`${prefix}_combiner_panel_model`] || '',\n      combiner_panel_bus_amps: systemDetails[`${prefix}_combinerpanel_bus_rating`] || '',\n      combiner_panel_main_breaker: systemDetails[`${prefix}_combinerpanel_main_breaker_rating`] || 'MLO',\n\n      // Stringing\n      stringing_type: systemDetails[`${prefix}_stringing_type`] || 'auto',\n      branch_string_1: systemDetails[`${prefix}_branch_string_1`] || '',\n      branch_string_2: systemDetails[`${prefix}_branch_string_2`] || '',\n      branch_string_3: systemDetails[`${prefix}_branch_string_3`] || '',\n      branch_string_4: systemDetails[`${prefix}_branch_string_4`] || '',\n      branch_string_5: systemDetails[`${prefix}_branch_string_5`] || '',\n      branch_string_6: systemDetails[`${prefix}_branch_string_6`] || '',\n      branch_string_7: systemDetails[`${prefix}_branch_string_7`] || '',\n      branch_string_8: systemDetails[`${prefix}_branch_string_8`] || '',\n      branch_string_9: systemDetails[`${prefix}_branch_string_9`] || '',\n      branch_string_10: systemDetails[`${prefix}_branch_string_10`] || '',\n\n      // Hoymiles/APSystems Granular Microinverter Panel Tracking\n      micro1Panels: systemDetails[`${prefix}_micro1Panels`] || '',\n      micro2Panels: systemDetails[`${prefix}_micro2Panels`] || '',\n      micro3Panels: systemDetails[`${prefix}_micro3Panels`] || '',\n      micro4Panels: systemDetails[`${prefix}_micro4Panels`] || '',\n      micro5Panels: systemDetails[`${prefix}_micro5Panels`] || '',\n      micro6Panels: systemDetails[`${prefix}_micro6Panels`] || '',\n      micro7Panels: systemDetails[`${prefix}_micro7Panels`] || '',\n      micro8Panels: systemDetails[`${prefix}_micro8Panels`] || '',\n      micro9Panels: systemDetails[`${prefix}_micro9Panels`] || '',\n      micro10Panels: systemDetails[`${prefix}_micro10Panels`] || '',\n      micro11Panels: systemDetails[`${prefix}_micro11Panels`] || '',\n      micro12Panels: systemDetails[`${prefix}_micro12Panels`] || '',\n      micro13Panels: systemDetails[`${prefix}_micro13Panels`] || '',\n      micro14Panels: systemDetails[`${prefix}_micro14Panels`] || '',\n      micro15Panels: systemDetails[`${prefix}_micro15Panels`] || '',\n      micro16Panels: systemDetails[`${prefix}_micro16Panels`] || '',\n      micro17Panels: systemDetails[`${prefix}_micro17Panels`] || '',\n      micro18Panels: systemDetails[`${prefix}_micro18Panels`] || '',\n      micro19Panels: systemDetails[`${prefix}_micro19Panels`] || '',\n      micro20Panels: systemDetails[`${prefix}_micro20Panels`] || '',\n      micro21Panels: systemDetails[`${prefix}_micro21Panels`] || '',\n      micro22Panels: systemDetails[`${prefix}_micro22Panels`] || '',\n      micro23Panels: systemDetails[`${prefix}_micro23Panels`] || '',\n      micro24Panels: systemDetails[`${prefix}_micro24Panels`] || '',\n      micro25Panels: systemDetails[`${prefix}_micro25Panels`] || '',\n\n      // Energy Storage\n      backup_option: systemDetails[`${prefix}_backup_option`] || '',\n      backup_system_size: systemDetails.utility_service_amps || '',\n\n      // Tesla PowerWall Configuration\n      expansionPacks: parseInt(systemDetails[`${prefix}_tesla_extensions`]) || 0,\n      gateway: systemDetails[`${prefix}_teslagatewaytype`] || '',\n      teslagatewaytype: systemDetails[`${prefix}_teslagatewaytype`] || '',\n      backupSwitchLocation: systemDetails[`${prefix}_backupswitch_location`] || '',\n      batteryExisting: !!systemDetails[`${prefix}_battery1_existing`],\n      pcs_settings: !!systemDetails[`${prefix}_pcs_settings`],\n\n      // SMS (Storage Management System)\n      sms_isnew: !systemDetails[`${prefix}_sms_existing`],\n      sms_make: systemDetails[`${prefix}_sms_make`] || '',\n      sms_model: systemDetails[`${prefix}_sms_model`] || '',\n      sms_main_breaker: systemDetails[`${prefix}_sms_breaker_rating`] || '',\n      sms_pv_breaker: systemDetails[`${prefix}_sms_pv_breaker`] || '',\n      sms_ess_breaker: systemDetails[`${prefix}_sms_ess_breaker`] || '',\n      sms_tie_in_breaker: systemDetails[`${prefix}_sms_tie_in_breaker`] || '',\n      sms_has_rsd: !!systemDetails[`${prefix}_sms_rsd_enabled`],\n      sms_backup_load_sub_panel_breaker_rating: systemDetails[`${prefix}_sms_backup_load_sub_panel_breaker_rating`] || '',\n      sms_pv_breaker_rating_override: systemDetails[`${prefix}_sms_pv_breaker_rating_override`] || '',\n      sms_ess_breaker_rating_override: systemDetails[`${prefix}_sms_ess_breaker_rating_override`] || '',\n      sms_tie_in_breaker_rating_override: systemDetails[`${prefix}_sms_tie_in_breaker_rating_override`] || '',\n\n      // Battery Type 1\n      battery1_isnew: !systemDetails[`${prefix}_battery_1_existing`],\n      battery1_quantity: systemDetails[`${prefix}_battery_1_qty`] || '',\n      battery1_make: systemDetails[`${prefix}_battery_1_make`] || '',\n      battery1_model: systemDetails[`${prefix}_battery_1_model`] || '',\n      battery1_configuration: systemDetails[`${prefix}_battery_configuration`] || '',\n      battery1_tie_in_location: systemDetails[`${prefix}_battery1_tie_in_location`] || '',\n\n      // Battery Type 2\n      battery2_isnew: !systemDetails[`${prefix}_battery_2_existing`],\n      battery2_quantity: systemDetails[`${prefix}_battery_2_qty`] || '',\n      battery2_make: systemDetails[`${prefix}_battery_2_make`] || '',\n      battery2_model: systemDetails[`${prefix}_battery_2_model`] || '',\n      battery2_tie_in_location: systemDetails[`${prefix}_battery2_tie_in_location`] || '',\n\n      // Backup Load Sub Panel\n      backup_panel_isnew: !systemDetails[`bls${systemNum}_backuploader_existing`],\n      backup_panel_make: systemDetails[`bls${systemNum}_backup_load_sub_panel_make`] || '',\n      backup_panel_model: systemDetails[`bls${systemNum}_backup_load_sub_panel_model`] || '',\n      backup_panel_bus_amps: systemDetails[`bls${systemNum}_backuploader_bus_bar_rating`] || '',\n      backup_panel_main_breaker: systemDetails[`bls${systemNum}_backuploader_main_breaker_rating`] || 'MLO',\n      backup_panel_tie_in_breaker: systemDetails[`bls${systemNum}_backuploader_upstream_breaker_rating`] || '',\n\n      // Battery Combiner Panel\n      battery_combiner_panel_isnew: !systemDetails[`bcp${systemNum}_existing`],\n      battery_combiner_panel_make: systemDetails[`bcp${systemNum}_make`] || '',\n      battery_combiner_panel_model: systemDetails[`bcp${systemNum}_model`] || '',\n      battery_combiner_panel_bus_amps: systemDetails[`bcp${systemNum}_busbar`] || '',\n      battery_combiner_panel_main_breaker: systemDetails[`bcp${systemNum}_mainbreaker1`] || 'MLO',\n      battery_combiner_panel_tie_in_breaker: systemDetails[`bcp${systemNum}_tieinbreaker`] || '',\n\n      // Gateway Configuration\n      gatewayConfigIsNew: !systemDetails[`${prefix}_sms_existing`],\n      gatewayConfigMainBreaker: systemDetails[`${prefix}_sms_breaker_rating`] || '',\n      gatewayConfigBackupPanel: systemDetails[`${prefix}_sms_backup_load_sub_panel_breaker_rating`] || '',\n      gatewayConfigActivatePCS: !!systemDetails[`${prefix}_pcs_settings`],\n      gatewayConfigPVBreaker: systemDetails[`${prefix}_sms_pv_breaker_rating_override`] || '',\n      gatewayConfigESSBreaker: systemDetails[`${prefix}_sms_ess_breaker_rating_override`] || '',\n      gatewayConfigTieInBreaker: systemDetails[`${prefix}_sms_tie_in_breaker_rating_override`] || '',\n\n      // ESS Combiner\n      ess_isnew: !systemDetails[`${prefix}_ess_existing`],\n      ess_make: systemDetails[`${prefix}_ess_make`] || '',\n      ess_model: systemDetails[`${prefix}_ess_model`] || '',\n      ess_main_breaker: systemDetails[`${prefix}_ess_main_breaker_rating`] || '',\n\n      // Electrical (uses ele_ prefix - not system-specific)\n      ele_ses_type: systemDetails.ele_ses_type || '',\n      ele_main_circuit_breakers_qty: systemDetails.ele_main_circuit_breakers_qty || '',\n      ele_bus_bar_rating: systemDetails.ele_bus_bar_rating || '',\n      ele_main_circuit_breaker_rating: systemDetails.ele_main_circuit_breaker_rating || 'MLO',\n\n      // BOS Equipment - Utility (6 slots)\n      ...Array.from({ length: 6 }, (_, i) => {\n        const slot = i + 1;\n        const bosPrefix = `bos_${prefix}_type${slot}`;\n        return {\n          [`${bosPrefix}_equipment_type`]: systemDetails[`${bosPrefix}_equipment_type`] || '',\n          [`${bosPrefix}_make`]: systemDetails[`${bosPrefix}_make`] || '',\n          [`${bosPrefix}_model`]: systemDetails[`${bosPrefix}_model`] || '',\n          [`${bosPrefix}_amp_rating`]: systemDetails[`${bosPrefix}_amp_rating`] || '',\n          [`${bosPrefix}_is_new`]: systemDetails[`${bosPrefix}_is_new`] !== false,\n          [`${bosPrefix}_active`]: systemDetails[`${bosPrefix}_active`] || null,\n          [`${bosPrefix}_trigger`]: systemDetails[`${bosPrefix}_trigger`] || null,\n          [`${bosPrefix}_block_name`]: systemDetails[`${bosPrefix}_block_name`] || '',\n        };\n      }).reduce((acc, curr) => ({ ...acc, ...curr }), {}),\n\n      // Include site data for utility-specific BOS translations\n      site: projectData?.site || null,\n      // Also pass utility directly for easier access\n      utility: (() => {\n        const utilityValue = projectData?.site?.utility || '';\n        console.log('[EquipmentForm] Hydrating EXISTING project - projectData:', projectData);\n        console.log('[EquipmentForm] Hydrating EXISTING project - projectData.site:', projectData?.site);\n        console.log('[EquipmentForm] Hydrating EXISTING project - utility value:', utilityValue);\n        return utilityValue;\n      })(),\n    };\n  }, [systemDetails, projectData]);\n\n  // Load equipment data from systemDetails hook\n  // Reloads form data when selectedSystem changes\n  useEffect(() => {\n    if (systemDetails) {\n      logger.log('EquipmentForm', `Loading equipment data for System ${selectedSystem}`);\n      const hydratedData = hydrateFormData(selectedSystem);\n      console.log('[EquipmentForm] useEffect - hydratedData:', hydratedData);\n      console.log('[EquipmentForm] useEffect - hydratedData.utility:', hydratedData?.utility);\n      console.log('[EquipmentForm] useEffect - hydratedData.site:', hydratedData?.site);\n      if (hydratedData) {\n        setFormData(prev => ({\n          ...prev,\n          ...hydratedData,\n          // Load global combine systems fields (not system-specific)\n          combine_systems: systemDetails.combine_systems !== undefined ? systemDetails.combine_systems : false,\n          ele_combine_positions: systemDetails.ele_combine_positions || '',\n        }));\n      }\n      setLoading(false);\n    } else if (!systemLoading) {\n      // systemDetails is null and not loading = new project\n      setLoading(false);\n    }\n  }, [systemDetails, systemLoading, selectedSystem, hydrateFormData]);\n\n  // Auto-show systems that have data (on initial load)\n  // IMPORTANT: Only ADD systems with data, never REMOVE manually-added systems\n  useEffect(() => {\n    if (!systemDetails) return;\n\n    const systemsWithData = [];\n    for (let i = 1; i <= maxSystems; i++) {\n      if (checkSystemHasDataUtil(systemDetails, i)) {\n        systemsWithData.push(i);\n      }\n    }\n\n    // Merge: add any systems with data that aren't already visible\n    // Never remove systems - user may have manually added an empty system\n    const systemsToAdd = systemsWithData.filter(s => !visibleSystems.includes(s));\n\n    if (systemsToAdd.length > 0) {\n      setVisibleSystems(prev => [...prev, ...systemsToAdd].sort((a, b) => a - b));\n    }\n  }, [systemDetails, maxSystems]); // REMOVED visibleSystems from dependencies to prevent loop\n\n  // Auto-populate battery fields when PowerWall is detected\n  useEffect(() => {\n    const make = formData.inverter_make;\n    const model = formData.inverter_model;\n    const expansionPacks = formData.expansionPacks ?? 0;\n\n    // Only auto-populate for Tesla PowerWall\n    if (!isTeslaPowerWall(make, model)) {\n      return;\n    }\n\n    const isPW3 = isPowerWall3(model);\n    const isPWPlus = isPowerWallPlus(model);\n    const batteryQty = parseInt(expansionPacks) + 1; // Base battery + expansion packs\n    const batteryModel = isPW3 ? 'PowerWall 3' : isPWPlus ? 'PowerWall+' : 'PowerWall';\n\n    // Batch check what needs updating to avoid unnecessary re-renders\n    const updates = [];\n\n    if (formData.battery1_quantity !== batteryQty) {\n      updates.push(['battery1_quantity', batteryQty]);\n    }\n    if (formData.battery1_make !== 'Tesla') {\n      updates.push(['battery1_make', 'Tesla']);\n    }\n    if (formData.battery1_model !== batteryModel) {\n      updates.push(['battery1_model', batteryModel]);\n    }\n\n    // Apply batch updates if there are any changes\n    if (updates.length > 0) {\n      handleBatchFieldChange(updates);\n    }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [formData.inverter_make, formData.inverter_model, formData.expansionPacks]);\n\n  // Sync Gateway 3 selection with SMS fields\n  // Gateway 3 IS the SMS for PowerWall systems\n  useEffect(() => {\n    const gateway = formData.gateway;\n    const isPowerWall = isTeslaPowerWall(formData.inverter_make, formData.inverter_model);\n    const prevGateway = prevGatewayRef.current;\n\n    // Only relevant for PowerWall systems\n    if (!isPowerWall) {\n      prevGatewayRef.current = gateway;\n      return;\n    }\n\n    // Gateway 3 selected - auto-populate SMS\n    if (gateway === 'gateway_3') {\n      const updates = [];\n      if (formData.sms_make !== 'Tesla') {\n        updates.push(['sms_make', 'Tesla']);\n      }\n      if (formData.sms_model !== 'Gateway 3') {\n        updates.push(['sms_model', 'Gateway 3']);\n      }\n      if (updates.length > 0) {\n        handleBatchFieldChange(updates);\n      }\n    }\n\n    // Changed FROM Gateway 3 to something else - clear SMS if auto-set\n    if (prevGateway === 'gateway_3' && gateway !== 'gateway_3') {\n      // Only clear if SMS was auto-populated by Gateway 3\n      if (formData.sms_make === 'Tesla' && formData.sms_model === 'Gateway 3') {\n        handleBatchFieldChange([\n          ['sms_make', ''],\n          ['sms_model', '']\n        ]);\n      }\n    }\n\n    // Update ref for next render\n    prevGatewayRef.current = gateway;\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [formData.gateway, formData.inverter_make, formData.inverter_model, formData.sms_make, formData.sms_model]);\n\n  // NOTE: Field mapping is now handled dynamically in handleFieldChange()\n  // to avoid async state update issues with multi-system support\n\n  // Batch update multiple fields at once (for auto-population)\n  const handleBatchFieldChange = async (fieldUpdates) => {\n    if (!fieldUpdates || fieldUpdates.length === 0) return;\n\n    // Build field mapping for current system (same as in handleFieldChange)\n    const systemPrefix = SYSTEM_PREFIXES[selectedSystem];\n    const getFieldMapping = (sysNum, sysPrefix) => ({\n      // Solar Panel\n      solar_panel_isnew: getSchemaField(sysNum, 'solar_panel_existing'),\n      solar_panel_make: `${sysPrefix}_solar_panel_make`,\n      solar_panel_model: `${sysPrefix}_solar_panel_model`,\n      solar_panel_quantity: `${sysPrefix}_solar_panel_quantity`,\n      solar_panel_watts: `${sysPrefix}_solar_panel_watts`,\n      solar_panel_vmp: `${sysPrefix}_solar_panel_vmp`,\n      solar_panel_imp: `${sysPrefix}_solar_panel_imp`,\n      solar_panel_voc: `${sysPrefix}_solar_panel_voc`,\n      solar_panel_isc: `${sysPrefix}_solar_panel_isc`,\n\n      // Solar Panel 2 (for mixed systems)\n      solar_panel_type2_is_new: getSchemaField(sysNum, 'solar_panel_type2_existing'),\n      solar_panel_type2_manufacturer: `${sysPrefix}_solar_panel_type2_manufacturer`,\n      solar_panel_type2_model: `${sysPrefix}_solar_panel_type2_model`,\n      solar_panel_type2_quantity: `${sysPrefix}_solar_panel_type2_quantity`,\n      solar_panel_type2_wattage: `${sysPrefix}_solar_panel_type2_watts`,\n      solar_panel_type2_vmp: `${sysPrefix}_solar_panel_type2_vmp`,\n      solar_panel_type2_imp: `${sysPrefix}_solar_panel_type2_imp`,\n      solar_panel_type2_voc: `${sysPrefix}_solar_panel_type2_voc`,\n      solar_panel_type2_isc: `${sysPrefix}_solar_panel_type2_isc`,\n      solar_panel_type2_model_id: `${sysPrefix}_solar_panel_type2_model_id`,\n      solar_panel_type2_temp_coeff_voc: `${sysPrefix}_solar_panel_type2_temp_coeff_voc`,\n      show_solar_panel_2: `${sysPrefix}_mixed_panel_system`,\n      batteryonly: `${sysPrefix}_batteryonly`,\n\n      // Inverter/Microinverter\n      inverter_isnew: getSchemaField(sysNum, 'inverter_existing'),\n      inverter_make: `${sysPrefix}_inverter_make`,\n      inverter_model: `${sysPrefix}_inverter_model`,\n      inverter_type: `${sysPrefix}_inverter_type`,\n      inverter_max_cont_output_amps: `${sysPrefix}_inv_max_continuous_output`,\n      inverter_max_strings_branches: `${sysPrefix}_inv_max_strings_branches`,\n      inverter_max_vdc: `${sysPrefix}_inv_max_vdc`,\n      inverter_min_vdc: `${sysPrefix}_inv_min_vdc`,\n      inverter_max_input_isc: `${sysPrefix}_inv_max_input_isc`,\n      inverter_model_id: `${sysPrefix}_inverter_model_id`,\n\n      // Hoymiles/APSystems Granular Microinverter Panel Tracking\n      micro1Panels: `${sysPrefix}_micro1Panels`,\n      micro2Panels: `${sysPrefix}_micro2Panels`,\n      micro3Panels: `${sysPrefix}_micro3Panels`,\n      micro4Panels: `${sysPrefix}_micro4Panels`,\n      micro5Panels: `${sysPrefix}_micro5Panels`,\n      micro6Panels: `${sysPrefix}_micro6Panels`,\n      micro7Panels: `${sysPrefix}_micro7Panels`,\n      micro8Panels: `${sysPrefix}_micro8Panels`,\n      micro9Panels: `${sysPrefix}_micro9Panels`,\n      micro10Panels: `${sysPrefix}_micro10Panels`,\n      micro11Panels: `${sysPrefix}_micro11Panels`,\n      micro12Panels: `${sysPrefix}_micro12Panels`,\n      micro13Panels: `${sysPrefix}_micro13Panels`,\n      micro14Panels: `${sysPrefix}_micro14Panels`,\n      micro15Panels: `${sysPrefix}_micro15Panels`,\n      micro16Panels: `${sysPrefix}_micro16Panels`,\n      micro17Panels: `${sysPrefix}_micro17Panels`,\n      micro18Panels: `${sysPrefix}_micro18Panels`,\n      micro19Panels: `${sysPrefix}_micro19Panels`,\n      micro20Panels: `${sysPrefix}_micro20Panels`,\n      micro21Panels: `${sysPrefix}_micro21Panels`,\n      micro22Panels: `${sysPrefix}_micro22Panels`,\n      micro23Panels: `${sysPrefix}_micro23Panels`,\n      micro24Panels: `${sysPrefix}_micro24Panels`,\n      micro25Panels: `${sysPrefix}_micro25Panels`,\n\n      // Optimizer\n      optimizer_isnew: getSchemaField(sysNum, 'optimizer_existing'),\n      optimizer_make: `${sysPrefix}_optimizer_make`,\n      optimizer_model: `${sysPrefix}_optimizer_model`,\n\n      // String Combiner Panel\n      combiner_panel_isnew: getSchemaField(sysNum, 'combiner_panel_existing'),\n      combiner_panel_make: `${sysPrefix}_combiner_panel_make`,\n      combiner_panel_model: `${sysPrefix}_combiner_panel_model`,\n      combiner_panel_bus_amps: `${sysPrefix}_combiner_panel_bus_amps`,\n      combiner_panel_main_breaker: `${sysPrefix}_combiner_panel_main_breaker`,\n      combiner_panel_tie_in_breaker: `${sysPrefix}_combiner_panel_tie_in_breaker`,\n\n      // Hoymiles/APSystems breaker size\n      sys1_ap_hoy_breaker_size: 'sys1_ap_hoy_breaker_size',\n\n      // Energy Storage System (ESS)\n      backup_option: 'backup_option',\n      backup_system_size: 'backup_system_size',\n\n      // Storage Management System (SMS)\n      sms_isnew: 'sms_existing',\n      sms_make: 'sms_make',\n      sms_model: 'sms_model',\n      sms_main_breaker: 'sms_main_breaker',\n      sms_pv_breaker: 'sms_pv_breaker',\n      sms_ess_breaker: 'sms_ess_breaker',\n      sms_tie_in_breaker: 'sms_tie_in_breaker',\n      sms_has_rsd: 'sms_has_rsd',\n      sms_pv_breaker_rating_override: 'sms_pv_breaker_rating_override',\n      sms_ess_breaker_rating_override: 'sms_ess_breaker_rating_override',\n      sms_tie_in_breaker_rating_override: 'sms_tie_in_breaker_rating_override',\n      sms_backup_load_sub_panel_breaker_rating: 'sms_backup_load_sub_panel_breaker_rating',\n\n      // Battery Type 1\n      battery1_isnew: 'battery1_existing',\n      battery1_make: 'battery1_make',\n      battery1_model: 'battery1_model',\n      battery1_quantity: 'battery1_quantity',\n      battery1_configuration: 'battery1_configuration',\n      battery1_tie_in_location: 'battery1_tie_in_location',\n\n      // Battery Type 2\n      battery2_isnew: 'battery2_existing',\n      battery2_make: 'battery2_make',\n      battery2_model: 'battery2_model',\n      battery2_quantity: 'battery2_quantity',\n      battery2_tie_in_location: 'battery2_tie_in_location',\n      show_battery_type_2: 'show_battery_type_2',\n\n      // Backup Load Sub Panel\n      backup_panel_isnew: 'backup_panel_existing',\n      backup_panel_make: 'backup_panel_make',\n      backup_panel_model: 'backup_panel_model',\n      backup_panel_bus_amps: 'backup_panel_bus_amps',\n      backup_panel_main_breaker: 'backup_panel_main_breaker',\n      backup_panel_tie_in_breaker: 'backup_panel_tie_in_breaker',\n\n      // Battery Combiner Panel\n      battery_combiner_panel_isnew: 'battery_combiner_panel_existing',\n      battery_combiner_panel_make: 'battery_combiner_panel_make',\n      battery_combiner_panel_model: 'battery_combiner_panel_model',\n      battery_combiner_panel_bus_amps: 'battery_combiner_panel_bus_amps',\n      battery_combiner_panel_main_breaker: 'battery_combiner_panel_main_breaker',\n      battery_combiner_panel_tie_in_breaker: 'battery_combiner_panel_tie_in_breaker',\n\n      // Tesla Gateway Config fields\n      gatewayConfigIsNew: 'sys1_teslagatewayexisting',\n      gatewayConfigMainBreaker: 'sys1_teslagateway_main_breaker',\n      gatewayConfigBackupPanel: 'sys1_teslagatewaybackup',\n      gatewayConfigActivatePCS: 'sys1_activate_pcs',\n      gatewayConfigPVBreaker: 'sys1_teslagateway_pv_breaker',\n      gatewayConfigESSBreaker: 'sys1_teslagateway_ess_breaker',\n      gatewayConfigTieInBreaker: 'sys1_teslagateway_tie_in_breaker',\n      pcs_settings: 'pcs_settings',\n    });\n\n    const fieldMapping = getFieldMapping(selectedSystem, systemPrefix);\n\n    // Build database updates object\n    const dbUpdates = {};\n    const stateUpdates = {};\n\n    fieldUpdates.forEach(([field, value]) => {\n      // Update local state object\n      stateUpdates[field] = value;\n\n      // BOS fields already match database schema - use directly\n      const isBOSField = field.startsWith('bos_sys') || field.startsWith('post_sms_bos_sys') || field.startsWith('postcombine_');\n      const dbFieldName = isBOSField ? field : fieldMapping[field];\n\n      if (!dbFieldName) {\n        logger.warn('EquipmentForm', `No field mapping found for: ${field}`);\n        return;\n      }\n\n      // Handle special value transformations\n      let dbValue = value;\n\n      // Invert \"isNew\" fields to \"existing\" fields\n      if (field.endsWith('_isnew')) {\n        dbValue = !value; // isNew=true means existing=false\n      }\n\n      // Convert empty strings to null for database\n      if (dbValue === '') {\n        dbValue = null;\n      }\n\n      dbUpdates[dbFieldName] = dbValue;\n\n      // No special handling needed for gateway - it now maps directly to sys1_teslagatewaytype\n    });\n\n    // Update local state immediately (optimistic update)\n    setFormData(prev => ({\n      ...prev,\n      ...stateUpdates\n    }));\n\n    // Batch save to database\n    try {\n      if (Object.keys(dbUpdates).length > 0) {\n        await updateFields(dbUpdates);\n        logger.log('EquipmentForm', `Batch saved ${Object.keys(dbUpdates).length} fields:`, dbUpdates);\n      }\n    } catch (error) {\n      logger.error('EquipmentForm', 'Failed to batch save fields:', error);\n    }\n  };\n\n  // Handle field changes and auto-save to system-details endpoint\n  const handleFieldChange = async (field, value, overrideSystemNumber = null) => {\n    // Update local state immediately (optimistic update)\n    setFormData(prev => ({\n      ...prev,\n      [field]: value\n    }));\n\n    // BOS fields already match database schema - save directly without mapping\n    const isBOSField = field.startsWith('bos_sys') || field.startsWith('post_sms_bos_sys') || field.startsWith('postcombine_');\n\n    // Use override system number if provided, otherwise use selected system\n    const systemNum = overrideSystemNumber !== null ? overrideSystemNumber : selectedSystem;\n    const systemPrefix = SYSTEM_PREFIXES[systemNum];\n\n    // Build field mapping for the specific system\n    const getFieldMapping = (sysNum, sysPrefix) => ({\n      // Solar Panel\n      solar_panel_isnew: getSchemaField(sysNum, 'solar_panel_existing'),\n      solar_panel_make: `${sysPrefix}_solar_panel_make`,\n      solar_panel_model: `${sysPrefix}_solar_panel_model`,\n      solar_panel_model_id: getSchemaField(sysNum, 'solarpanel_id'),\n      solar_panel_wattage: `${sysPrefix}_solar_panel_wattage`,\n      solar_panel_quantity: `${sysPrefix}_solar_panel_qty`,\n\n      // Inverter/Microinverter\n      inverter_isnew: getSchemaField(sysNum, 'micro_inverter_existing'),\n      inverter_make: `${sysPrefix}_micro_inverter_make`,\n      inverter_model: `${sysPrefix}_micro_inverter_model`,\n      inverter_model_id: `${sysPrefix}_micro_inverter_id`,\n      inverter_type: `${sysPrefix}_inverter_type`,\n      inverter_max_cont_output_amps: `${sysPrefix}_inv_max_continuous_output`,\n      sys1_ap_hoy_breaker_size: 'sys1_ap_hoy_breaker_size',\n\n      // Optimizer\n      optimizer_isnew: `${sysPrefix}_optimizer_existing`,\n      optimizer_make: `${sysPrefix}_optimizer_make`,\n      optimizer_model: `${sysPrefix}_optimizer_model`,\n\n      // String Combiner Panel\n      combiner_panel_isnew: `${sysPrefix}_combiner_panel_existing`,\n      combiner_panel_make: `${sysPrefix}_combiner_panel_make`,\n      combiner_panel_model: `${sysPrefix}_combiner_panel_model`,\n      combiner_panel_bus_amps: `${sysPrefix}_combinerpanel_bus_rating`,\n      combiner_panel_main_breaker: `${sysPrefix}_combinerpanel_main_breaker_rating`,\n\n      // Stringing\n      stringing_type: `${sysPrefix}_stringing_type`,\n      branch_string_1: `${sysPrefix}_branch_string_1`,\n      branch_string_2: `${sysPrefix}_branch_string_2`,\n      branch_string_3: `${sysPrefix}_branch_string_3`,\n      branch_string_4: `${sysPrefix}_branch_string_4`,\n      branch_string_5: `${sysPrefix}_branch_string_5`,\n      branch_string_6: `${sysPrefix}_branch_string_6`,\n      branch_string_7: `${sysPrefix}_branch_string_7`,\n      branch_string_8: `${sysPrefix}_branch_string_8`,\n      branch_string_9: `${sysPrefix}_branch_string_9`,\n      branch_string_10: `${sysPrefix}_branch_string_10`,\n\n      // Hoymiles/APSystems Granular Microinverter Panel Tracking\n      micro1Panels: `${sysPrefix}_micro1Panels`,\n      micro2Panels: `${sysPrefix}_micro2Panels`,\n      micro3Panels: `${sysPrefix}_micro3Panels`,\n      micro4Panels: `${sysPrefix}_micro4Panels`,\n      micro5Panels: `${sysPrefix}_micro5Panels`,\n      micro6Panels: `${sysPrefix}_micro6Panels`,\n      micro7Panels: `${sysPrefix}_micro7Panels`,\n      micro8Panels: `${sysPrefix}_micro8Panels`,\n      micro9Panels: `${sysPrefix}_micro9Panels`,\n      micro10Panels: `${sysPrefix}_micro10Panels`,\n      micro11Panels: `${sysPrefix}_micro11Panels`,\n      micro12Panels: `${sysPrefix}_micro12Panels`,\n      micro13Panels: `${sysPrefix}_micro13Panels`,\n      micro14Panels: `${sysPrefix}_micro14Panels`,\n      micro15Panels: `${sysPrefix}_micro15Panels`,\n      micro16Panels: `${sysPrefix}_micro16Panels`,\n      micro17Panels: `${sysPrefix}_micro17Panels`,\n      micro18Panels: `${sysPrefix}_micro18Panels`,\n      micro19Panels: `${sysPrefix}_micro19Panels`,\n      micro20Panels: `${sysPrefix}_micro20Panels`,\n      micro21Panels: `${sysPrefix}_micro21Panels`,\n      micro22Panels: `${sysPrefix}_micro22Panels`,\n      micro23Panels: `${sysPrefix}_micro23Panels`,\n      micro24Panels: `${sysPrefix}_micro24Panels`,\n      micro25Panels: `${sysPrefix}_micro25Panels`,\n\n      // Energy Storage\n      backup_option: `${sysPrefix}_backup_option`,\n      backup_system_size: 'utility_service_amps',\n\n      // SMS\n      sms_isnew: `${sysPrefix}_sms_existing`,\n      sms_make: `${sysPrefix}_sms_make`,\n      sms_model: `${sysPrefix}_sms_model`,\n      sms_main_breaker: `${sysPrefix}_sms_breaker_rating`,\n      sms_pv_breaker: `${sysPrefix}_sms_pv_breaker`,\n      sms_ess_breaker: `${sysPrefix}_sms_ess_breaker`,\n      sms_tie_in_breaker: `${sysPrefix}_sms_tie_in_breaker`,\n      sms_has_rsd: `${sysPrefix}_sms_rsd_enabled`,\n      sms_backup_load_sub_panel_breaker_rating: `${sysPrefix}_sms_backup_load_sub_panel_breaker_rating`,\n      sms_pv_breaker_rating_override: `${sysPrefix}_sms_pv_breaker_rating_override`,\n      sms_ess_breaker_rating_override: `${sysPrefix}_sms_ess_breaker_rating_override`,\n      sms_tie_in_breaker_rating_override: `${sysPrefix}_sms_tie_in_breaker_rating_override`,\n\n      // Battery Type 1\n      battery1_isnew: `${sysPrefix}_battery_1_existing`,\n      battery1_quantity: `${sysPrefix}_battery_1_qty`,\n      battery1_make: `${sysPrefix}_battery_1_make`,\n      battery1_model: `${sysPrefix}_battery_1_model`,\n      battery1_configuration: `${sysPrefix}_battery_configuration`,\n      battery1_tie_in_location: `${sysPrefix}_battery1_tie_in_location`,\n\n      // Battery Type 2\n      battery2_isnew: `${sysPrefix}_battery_2_existing`,\n      battery2_quantity: `${sysPrefix}_battery_2_qty`,\n      battery2_make: `${sysPrefix}_battery_2_make`,\n      battery2_model: `${sysPrefix}_battery_2_model`,\n      battery2_tie_in_location: `${sysPrefix}_battery2_tie_in_location`,\n\n      // Backup Load Sub Panel\n      backup_panel_isnew: `bls${sysNum}_backuploader_existing`,\n      backup_panel_make: `bls${sysNum}_backup_load_sub_panel_make`,\n      backup_panel_model: `bls${sysNum}_backup_load_sub_panel_model`,\n      backup_panel_bus_amps: `bls${sysNum}_backuploader_bus_bar_rating`,\n      backup_panel_main_breaker: `bls${sysNum}_backuploader_main_breaker_rating`,\n      backup_panel_tie_in_breaker: `bls${sysNum}_backuploader_upstream_breaker_rating`,\n\n      // Battery Combiner Panel\n      battery_combiner_panel_isnew: `bcp${sysNum}_existing`,\n      battery_combiner_panel_make: `bcp${sysNum}_make`,\n      battery_combiner_panel_model: `bcp${sysNum}_model`,\n      battery_combiner_panel_bus_amps: `bcp${sysNum}_busbar`,\n      battery_combiner_panel_main_breaker: `bcp${sysNum}_mainbreaker1`,\n      battery_combiner_panel_tie_in_breaker: `bcp${sysNum}_tieinbreaker`,\n\n      // Tesla PowerWall Configuration\n      expansionPacks: `${sysPrefix}_tesla_extensions`,\n      gateway: `${sysPrefix}_teslagatewaytype`,\n      teslagatewaytype: `${sysPrefix}_teslagatewaytype`,\n      backupSwitchLocation: `${sysPrefix}_backupswitch_location`,\n      batteryExisting: `${sysPrefix}_battery1_existing`,\n      pcs_settings: `${sysPrefix}_pcs_settings`,\n\n      // Gateway Configuration\n      gatewayConfigIsNew: `${sysPrefix}_sms_existing`,\n      gatewayConfigMainBreaker: `${sysPrefix}_sms_breaker_rating`,\n      gatewayConfigBackupPanel: `${sysPrefix}_sms_backup_load_sub_panel_breaker_rating`,\n      gatewayConfigActivatePCS: `${sysPrefix}_pcs_settings`,\n      gatewayConfigPVBreaker: `${sysPrefix}_sms_pv_breaker_rating_override`,\n      gatewayConfigESSBreaker: `${sysPrefix}_sms_ess_breaker_rating_override`,\n      gatewayConfigTieInBreaker: `${sysPrefix}_sms_tie_in_breaker_rating_override`,\n\n      // ESS Combiner\n      ess_isnew: `${sysPrefix}_ess_existing`,\n      ess_make: `${sysPrefix}_ess_make`,\n      ess_model: `${sysPrefix}_ess_model`,\n      ess_main_breaker: `${sysPrefix}_ess_main_breaker_rating`,\n\n      // Electrical (global, not system-specific)\n      ele_ses_type: 'ele_ses_type',\n      ele_main_circuit_breakers_qty: 'ele_main_circuit_breakers_qty',\n      ele_bus_bar_rating: 'ele_bus_bar_rating',\n      ele_main_circuit_breaker_rating: 'ele_main_circuit_breaker_rating',\n    });\n\n    const fieldMapping = getFieldMapping(systemNum, systemPrefix);\n\n    // Get database field name from mapping or use field directly for BOS\n    const dbFieldName = isBOSField ? field : fieldMapping[field];\n\n    if (!dbFieldName) {\n      logger.warn('EquipmentForm', `No field mapping found for: ${field}`);\n      return;\n    }\n\n    try {\n      // Handle special value transformations\n      let dbValue = value;\n\n      // Invert \"isNew\" fields to \"existing\" fields\n      if (field.endsWith('_isnew')) {\n        dbValue = !value; // isNew=true means existing=false\n      }\n\n      // Convert empty strings to null for database\n      if (dbValue === '') {\n        dbValue = null;\n      }\n\n      // Save to system-details endpoint via hook\n      // The hook automatically handles saving state and deduplication\n      await updateField(dbFieldName, dbValue);\n\n      // No special handling needed for gateway - it now maps directly to sys1_teslagatewaytype\n\n      // Auto-activate system when key equipment is added (isDirty flag pattern)\n      // Set sys{N}_selectedsystem field when user selects inverter model\n      // This marks the system as \"active\" and shows the system button as highlighted\n      if (field === 'inverter_model' && value && value !== '') {\n        const activateSystemPrefix = `sys${systemNum}`;\n        const selectedSystemField = `${activateSystemPrefix}_selectedsystem`;\n\n        // Determine system type from inverter type\n        const inverterType = formData.inverter_type || 'inverter';\n        const systemType = inverterType === 'microinverter' ? 'microinverter' : 'inverter';\n\n        // Only set if not already set\n        if (!systemDetails || !systemDetails[selectedSystemField]) {\n          await updateField(selectedSystemField, systemType);\n          logger.log('EquipmentForm', `Activated system ${systemNum} as ${systemType}`);\n        }\n      }\n\n      logger.log('EquipmentForm', `Saved ${field} (${dbFieldName}) = ${dbValue} for system ${systemNum}`);\n    } catch (error) {\n      logger.error('EquipmentForm', `Failed to save ${field}:`, error);\n    }\n  };\n\n  // Respond to initialSubTab when navigating back from other tabs\n  useEffect(() => {\n    if (initialSubTab) {\n      setSelectedView(initialSubTab);\n    }\n  }, [initialSubTab]);\n\n  // Determine if Combine step should be shown\n  const showCombineStep = useMemo(() => {\n    // Show combine if there are multiple systems with equipment data\n    return formData.sys2_inverter_make && formData.sys2_inverter_model;\n  }, [formData.sys2_inverter_make, formData.sys2_inverter_model]);\n\n  // PowerWall Detection Logic\n  const isPowerWall = useMemo(() => {\n    return isTeslaPowerWall(formData.inverter_make, formData.inverter_model);\n  }, [formData.inverter_make, formData.inverter_model]);\n\n  const suppressESS = useMemo(() => {\n    return shouldSuppressESS(formData.inverter_make, formData.inverter_model);\n  }, [formData.inverter_make, formData.inverter_model]);\n\n  const isPW3 = useMemo(() => {\n    return isPowerWall3(formData.inverter_model);\n  }, [formData.inverter_model]);\n\n  // Check if SMS is auto-populated by Gateway 3\n  const isGateway3SMS = useMemo(() => {\n    return isPowerWall &&\n      formData.gateway === 'gateway_3' &&\n      formData.sms_make === 'Tesla' &&\n      formData.sms_model === 'Gateway 3';\n  }, [isPowerWall, formData.gateway, formData.sms_make, formData.sms_model]);\n\n  // Check if Enphase Combiner 6C (has integrated SMS)\n  const isEnphaseCombiner6C = useMemo(() => {\n    const make = formData.combiner_panel_make?.toLowerCase();\n    const model = formData.combiner_panel_model;\n    return make === 'enphase' && model?.includes('6C');\n  }, [formData.combiner_panel_make, formData.combiner_panel_model]);\n\n  const showGatewayConfig = useMemo(() => {\n    // Gateway Config shows for Tesla PowerWall with Backup Gateway 2 or Gateway 3\n    // Check both gateway field (internal value) and teslagatewaytype (display name)\n    return isPowerWall && (\n      formData.gateway === 'backup_gateway_2' ||\n      formData.gateway === 'gateway_3' ||\n      formData.teslagatewaytype === 'Backup Gateway 2' ||\n      formData.teslagatewaytype === 'Gateway 3'\n    );\n  }, [isPowerWall, formData.gateway, formData.teslagatewaytype]);\n\n  const handleSelectSystem = (systemNumber) => {\n    setSelectedSystem(systemNumber);\n  };\n\n  // Add a new system to visible list\n  const handleAddSystem = (systemNumber) => {\n    if (!visibleSystems.includes(systemNumber) && systemNumber <= maxSystems) {\n      setVisibleSystems([...visibleSystems, systemNumber]);\n      setSelectedSystem(systemNumber);\n    }\n  };\n\n  // Remove a system (only for systems 2+)\n  const handleDeleteSystem = async (systemNumber) => {\n    // CRITICAL: Prevent System 1 deletion - multiple safeguards\n    if (systemNumber === 1) {\n      console.error('âŒ BLOCKED: Cannot delete System 1');\n      alert('System 1 cannot be deleted. You can clear individual sections, but System 1 must always exist.');\n      return;\n    }\n\n    if (systemNumber <= 1 || !systemNumber) {\n      console.error('âŒ BLOCKED: Invalid system number for deletion:', systemNumber);\n      return;\n    }\n\n    // Clear all data for this system in database\n    const prefix = SYSTEM_PREFIXES[systemNumber];\n    const dbFields = {};\n\n    // Build field mapping for this system to get all fields to clear\n    const getFieldMapping = (sysNum, sysPrefix) => ({\n      // Solar Panel\n      solar_panel_isnew: getSchemaField(sysNum, 'solar_panel_existing'),\n      solar_panel_make: `${sysPrefix}_solar_panel_make`,\n      solar_panel_model: `${sysPrefix}_solar_panel_model`,\n      solar_panel_quantity: `${sysPrefix}_solar_panel_quantity`,\n      solar_panel_watts: `${sysPrefix}_solar_panel_watts`,\n      solar_panel_vmp: `${sysPrefix}_solar_panel_vmp`,\n      solar_panel_imp: `${sysPrefix}_solar_panel_imp`,\n      solar_panel_voc: `${sysPrefix}_solar_panel_voc`,\n      solar_panel_isc: `${sysPrefix}_solar_panel_isc`,\n\n      // Solar Panel 2 (for mixed systems)\n      solar_panel_type2_is_new: getSchemaField(sysNum, 'solar_panel_type2_existing'),\n      solar_panel_type2_manufacturer: `${sysPrefix}_solar_panel_type2_manufacturer`,\n      solar_panel_type2_model: `${sysPrefix}_solar_panel_type2_model`,\n      solar_panel_type2_quantity: `${sysPrefix}_solar_panel_type2_quantity`,\n      solar_panel_type2_wattage: `${sysPrefix}_solar_panel_type2_watts`,\n      solar_panel_type2_vmp: `${sysPrefix}_solar_panel_type2_vmp`,\n      solar_panel_type2_imp: `${sysPrefix}_solar_panel_type2_imp`,\n      solar_panel_type2_voc: `${sysPrefix}_solar_panel_type2_voc`,\n      solar_panel_type2_isc: `${sysPrefix}_solar_panel_type2_isc`,\n      solar_panel_type2_model_id: `${sysPrefix}_solar_panel_type2_model_id`,\n      solar_panel_type2_temp_coeff_voc: `${sysPrefix}_solar_panel_type2_temp_coeff_voc`,\n      show_solar_panel_2: `${sysPrefix}_mixed_panel_system`,\n      batteryonly: `${sysPrefix}_batteryonly`,\n\n      // Inverter/Microinverter\n      inverter_isnew: getSchemaField(sysNum, 'inverter_existing'),\n      inverter_make: `${sysPrefix}_inverter_make`,\n      inverter_model: `${sysPrefix}_inverter_model`,\n      inverter_type: `${sysPrefix}_inverter_type`,\n      inverter_max_cont_output_amps: `${sysPrefix}_inv_max_continuous_output`,\n      inverter_max_strings_branches: `${sysPrefix}_inv_max_strings_branches`,\n      inverter_max_vdc: `${sysPrefix}_inv_max_vdc`,\n      inverter_min_vdc: `${sysPrefix}_inv_min_vdc`,\n      inverter_max_input_isc: `${sysPrefix}_inv_max_input_isc`,\n      inverter_model_id: `${sysPrefix}_inverter_model_id`,\n\n      // Hoymiles/APSystems Granular Microinverter Panel Tracking\n      micro1Panels: `${sysPrefix}_micro1Panels`,\n      micro2Panels: `${sysPrefix}_micro2Panels`,\n      micro3Panels: `${sysPrefix}_micro3Panels`,\n      micro4Panels: `${sysPrefix}_micro4Panels`,\n      micro5Panels: `${sysPrefix}_micro5Panels`,\n      micro6Panels: `${sysPrefix}_micro6Panels`,\n      micro7Panels: `${sysPrefix}_micro7Panels`,\n      micro8Panels: `${sysPrefix}_micro8Panels`,\n      micro9Panels: `${sysPrefix}_micro9Panels`,\n      micro10Panels: `${sysPrefix}_micro10Panels`,\n      micro11Panels: `${sysPrefix}_micro11Panels`,\n      micro12Panels: `${sysPrefix}_micro12Panels`,\n      micro13Panels: `${sysPrefix}_micro13Panels`,\n      micro14Panels: `${sysPrefix}_micro14Panels`,\n      micro15Panels: `${sysPrefix}_micro15Panels`,\n      micro16Panels: `${sysPrefix}_micro16Panels`,\n      micro17Panels: `${sysPrefix}_micro17Panels`,\n      micro18Panels: `${sysPrefix}_micro18Panels`,\n      micro19Panels: `${sysPrefix}_micro19Panels`,\n      micro20Panels: `${sysPrefix}_micro20Panels`,\n      micro21Panels: `${sysPrefix}_micro21Panels`,\n      micro22Panels: `${sysPrefix}_micro22Panels`,\n      micro23Panels: `${sysPrefix}_micro23Panels`,\n      micro24Panels: `${sysPrefix}_micro24Panels`,\n      micro25Panels: `${sysPrefix}_micro25Panels`,\n\n      // Optimizer\n      optimizer_isnew: getSchemaField(sysNum, 'optimizer_existing'),\n      optimizer_make: `${sysPrefix}_optimizer_make`,\n      optimizer_model: `${sysPrefix}_optimizer_model`,\n\n      // String Combiner Panel\n      combiner_panel_isnew: getSchemaField(sysNum, 'combiner_panel_existing'),\n      combiner_panel_make: `${sysPrefix}_combiner_panel_make`,\n      combiner_panel_model: `${sysPrefix}_combiner_panel_model`,\n      combiner_panel_bus_amps: `${sysPrefix}_combiner_panel_bus_amps`,\n      combiner_panel_main_breaker: `${sysPrefix}_combiner_panel_main_breaker`,\n      combiner_panel_tie_in_breaker: `${sysPrefix}_combiner_panel_tie_in_breaker`,\n    });\n\n    const fieldMapping = getFieldMapping(systemNumber, prefix);\n\n    // Add all system fields to clear\n    Object.keys(fieldMapping).forEach(key => {\n      const dbField = fieldMapping[key];\n      if (dbField && dbField.includes(prefix)) {\n        dbFields[dbField] = null;\n      }\n    });\n\n    await updateFields(dbFields);\n\n    // Remove from visible systems (with additional System 1 safeguard)\n    setVisibleSystems(prev => {\n      // Double-check: Never allow System 1 to be removed from visibleSystems\n      if (systemNumber === 1) {\n        console.error('âŒ BLOCKED: Attempted to remove System 1 from visibleSystems');\n        return prev;\n      }\n      return prev.filter(s => s !== systemNumber);\n    });\n\n    // Switch to System 1 if we deleted the current system\n    if (selectedSystem === systemNumber) {\n      setSelectedSystem(1);\n    }\n  };\n\n  const handleClearSolarPanel = async () => {\n    // Update local state\n    setFormData(prev => ({\n      ...prev,\n      solar_panel_isnew: true,\n      solar_panel_make: '',\n      solar_panel_model: '',\n      solar_panel_model_id: '',\n      solar_panel_wattage: '',\n      solar_panel_quantity: '',\n    }));\n  };\n\n  const handleClearSolarPanel2 = async () => {\n    // Clear all 2nd solar panel fields\n    setFormData(prev => ({\n      ...prev,\n      solar_panel_type2_is_new: true,\n      solar_panel_type2_manufacturer: '',\n      solar_panel_type2_model: '',\n      solar_panel_type2_model_id: '',\n      solar_panel_type2_wattage: '',\n      solar_panel_type2_quantity: '',\n      solar_panel_type2_voc: '',\n      solar_panel_type2_isc: '',\n      solar_panel_type2_vmp: '',\n      solar_panel_type2_imp: '',\n      solar_panel_type2_temp_coeff_voc: '',\n      show_solar_panel_2: false,\n    }));\n\n    // TODO: Add database update when data connections are configured\n  };\n\n  const handleClearInverter = async () => {\n    // Check if current inverter is PowerWall before clearing\n    const wasPowerWall = isTeslaPowerWall(formData.inverter_make, formData.inverter_model);\n\n    // Update local state\n    setFormData(prev => ({\n      ...prev,\n      inverter_isnew: true,\n      inverter_make: '',\n      inverter_model: '',\n      inverter_model_id: '',\n      inverter_type: '',\n      inverter_max_cont_output_amps: '',\n      inverter_max_strings_branches: null,\n      optimizer_isnew: true,\n      optimizer_make: '',\n      optimizer_model: '',\n      combiner_panel_isnew: true,\n      combiner_panel_make: '',\n      combiner_panel_model: '',\n      combiner_panel_bus_amps: '',\n      combiner_panel_main_breaker: 'MLO',\n      combiner_panel_tie_in_breaker: '',\n      stringing_type: 'auto',\n      branch_string_1: '',\n      branch_string_2: '',\n      branch_string_3: '',\n      branch_string_4: '',\n      branch_string_5: '',\n      branch_string_6: '',\n      mppt_1_isnew: true,\n      mppt_2_isnew: true,\n      mppt_3_isnew: true,\n      mppt_4_isnew: true,\n      mppt_5_isnew: true,\n      mppt_6_isnew: true,\n      micro_stringing_type: 'auto',\n      micro_branch_string_1: '',\n      micro_branch_string_2: '',\n      micro_branch_string_3: '',\n      micro_branch_string_4: '',\n      micro_branch_string_5: '',\n      micro_branch_string_6: '',\n      micro_branch_string_7: '',\n      micro_branch_string_8: '',\n      micro_branch_1_isnew: true,\n      micro_branch_2_isnew: true,\n      micro_branch_3_isnew: true,\n      micro_branch_4_isnew: true,\n      micro_branch_5_isnew: true,\n      micro_branch_6_isnew: true,\n      micro_branch_7_isnew: true,\n      micro_branch_8_isnew: true,\n      // Clear PowerWall-specific fields\n      expansionPacks: 0,\n      gateway: '',\n      backupSwitchLocation: '',\n      batteryExisting: false,\n      // If was PowerWall, also clear auto-populated battery fields\n      ...(wasPowerWall && {\n        battery1_quantity: '',\n        battery1_make: '',\n        battery1_model: '',\n        // Clear SMS if it was Gateway 3 auto-populated\n        ...(formData.sms_make === 'Tesla' && formData.sms_model === 'Gateway 3' && {\n          sms_make: '',\n          sms_model: '',\n        }),\n      }),\n    }));\n\n    // Clear inverter and related fields in database (using dynamic prefix and schema helper)\n    const prefix = currentSystemPrefix;\n    const dbFields = {\n      [getSchemaField(selectedSystem, 'micro_inverter_existing')]: null,\n      [`${prefix}_micro_inverter_make`]: null,\n      [`${prefix}_micro_inverter_model`]: null,\n      [`${prefix}_micro_inverter_id`]: null,\n      [`${prefix}_inv_max_continuous_output`]: null,\n      [`${prefix}_optimizer_existing`]: null,\n      [`${prefix}_optimizer_make`]: null,\n      [`${prefix}_optimizer_model`]: null,\n      [`${prefix}_combiner_panel_existing`]: null,\n      [`${prefix}_combiner_panel_make`]: null,\n      [`${prefix}_combiner_panel_model`]: null,\n      [`${prefix}_combinerpanel_bus_rating`]: null,\n      [`${prefix}_combinerpanel_main_breaker_rating`]: null,\n      [`${prefix}_stringing_type`]: null,\n      [`${prefix}_branch_string_1`]: null,\n      [`${prefix}_branch_string_2`]: null,\n      [`${prefix}_branch_string_3`]: null,\n      [`${prefix}_branch_string_4`]: null,\n      [`${prefix}_branch_string_5`]: null,\n      [`${prefix}_branch_string_6`]: null,\n      // Clear PowerWall-specific fields\n      [`${prefix}_tesla_extensions`]: null,\n      [`${prefix}_teslagatewaytype`]: null,\n      [`${prefix}_backupswitch_location`]: null,\n      [`${prefix}_battery1_existing`]: null,\n    };\n\n    // If was PowerWall, also clear auto-populated battery fields\n    if (wasPowerWall) {\n      dbFields[`${prefix}_battery_1_qty`] = null;\n      dbFields[`${prefix}_battery_1_make`] = null;\n      dbFields[`${prefix}_battery_1_model`] = null;\n\n      // Clear SMS if it was Gateway 3 auto-populated\n      if (formData.sms_make === 'Tesla' && formData.sms_model === 'Gateway 3') {\n        dbFields[`${prefix}_sms_make`] = null;\n        dbFields[`${prefix}_sms_model`] = null;\n      }\n    }\n\n    await updateFields(dbFields);\n  };\n\n  const handleClearCombinerPanel = () => {\n    setFormData(prev => ({\n      ...prev,\n      combiner_panel_isnew: true,\n      combiner_panel_make: '',\n      combiner_panel_model: '',\n      combiner_panel_bus_amps: '',\n      combiner_panel_main_breaker: 'MLO',\n      combiner_panel_tie_in_breaker: '',\n    }));\n  };\n\n  const handleClearEnergyStorage = () => {\n    setFormData(prev => ({\n      ...prev,\n      backup_option: '',\n      backup_system_size: '',\n    }));\n  };\n\n  const handleClearSMS = () => {\n    setFormData(prev => ({\n      ...prev,\n      sms_make: '',\n      sms_model: '',\n      sms_main_breaker: 'MLO',\n      sms_pv_breaker: '',\n      sms_ess_breaker: '',\n      sms_tie_in_breaker: '',\n      sms_has_rsd: false,\n    }));\n  };\n\n  const handleClearBattery1 = () => {\n    setFormData(prev => ({\n      ...prev,\n      battery1_quantity: '',\n      battery1_make: '',\n      battery1_model: '',\n      battery1_configuration: '',\n    }));\n  };\n\n  const handleClearBattery2 = () => {\n    setFormData(prev => ({\n      ...prev,\n      battery2_quantity: '',\n      battery2_make: '',\n      battery2_model: '',\n      battery2_configuration: '',\n      show_battery_type_2: false,\n    }));\n  };\n\n  const handleClearBackupPanel = () => {\n    setFormData(prev => ({\n      ...prev,\n      backup_panel_make: '',\n      backup_panel_model: '',\n      backup_panel_bus_amps: '',\n      backup_panel_main_breaker: 'MLO',\n    }));\n  };\n\n  const handleAddBatteryType2 = () => {\n    setFormData(prev => ({\n      ...prev,\n      show_battery_type_2: true,\n    }));\n  };\n\n  // Get dynamic section title based on inverter type\n  const getInverterSectionTitle = () => {\n    if (formData.inverter_type === 'microinverter') {\n      return 'Microinverter';\n    } else if (formData.inverter_type === 'inverter') {\n      return 'Inverter';\n    }\n    return 'Micro/Inverter'; // Default when no model selected\n  };\n\n  // Check if system has data using utility function\n  const checkSystemHasData = useCallback((systemNumber) => {\n    if (!systemDetails) return false;\n    return checkSystemHasDataUtil(systemDetails, systemNumber);\n  }, [systemDetails]);\n\n  // Get array of active system numbers using utility function\n  const getActiveSystemsList = useCallback(() => {\n    if (!systemDetails) return [];\n    return getActiveSystemsUtil(systemDetails);\n  }, [systemDetails]);\n\n  // Handle saving combine configuration\n  const handleCombineSave = (configData) => {\n    // Save to formData as JSON\n    setFormData(prev => ({\n      ...prev,\n      ele_combine_positions: JSON.stringify(configData),\n    }));\n\n    // TODO: Save to database via API\n    logger.log('Equipment', 'Combine configuration saved');\n  };\n\n  // BOS Detection Handler\n  const handleDetectUtilityBOS = async () => {\n    try {\n      setBosDetectionLoading(true);\n      setShowBOSDetectionModal(true);\n\n      // Detect configurations for all systems\n      const detectionResult = detectProjectConfiguration(systemDetails || {});\n\n      // Prepare BOS population with catalog lookups\n      const populationResult = await prepareBOSPopulation(projectUuid, detectionResult);\n\n      // Update modal state\n      setBosDetectionResult(detectionResult);\n      setBosDetectionSummary(populationResult.summary);\n      setBosItemCount(populationResult.itemCount);\n      setBosPayload(populationResult.payload);\n      setBosDetectionLoading(false);\n\n      logger.log('Equipment', `Detected ${populationResult.itemCount} BOS items`);\n    } catch (error) {\n      logger.error('Equipment', 'BOS detection failed:', error);\n      setBosDetectionLoading(false);\n      alert('Failed to detect BOS configurations. Please try again.');\n      setShowBOSDetectionModal(false);\n    }\n  };\n\n  // BOS Detection Modal Confirm Handler\n  const handleBOSDetectionConfirm = async () => {\n    try {\n      if (!bosPayload) {\n        alert('No BOS data to save');\n        return;\n      }\n\n      // Save BOS to database\n      const saveResult = await saveBOSPopulation(projectUuid, bosPayload);\n\n      if (saveResult.success) {\n        // Refresh system details to show new BOS\n        await refreshSystemDetails();\n        logger.log('Equipment', 'BOS equipment saved successfully');\n        alert(`Successfully added ${bosItemCount} BOS equipment items!`);\n      } else {\n        alert(saveResult.message || 'Failed to save BOS equipment');\n      }\n\n      // Close modal\n      setShowBOSDetectionModal(false);\n      setBosDetectionResult(null);\n      setBosDetectionSummary('');\n      setBosItemCount(0);\n      setBosPayload(null);\n    } catch (error) {\n      logger.error('Equipment', 'BOS save failed:', error);\n      alert('Failed to save BOS equipment. Please try again.');\n    }\n  };\n\n  // Navigation handlers for footer\n  const handlePrev = () => {\n    if (selectedView === 'bos') {\n      // BOS â†’ Combine (if exists) or Equipment\n      if (showCombineStep) {\n        setSelectedView('combine');\n      } else {\n        setSelectedView('equipment');\n      }\n    } else if (selectedView === 'combine') {\n      // Combine â†’ Equipment\n      setSelectedView('equipment');\n    } else if (selectedView === 'equipment') {\n      // Equipment â†’ Previous System's Equipment (if not System 1)\n      if (selectedSystem > 1) {\n        setSelectedSystem(selectedSystem - 1);\n        // Stay on Equipment view of previous system\n      }\n      // If System 1, button is disabled so this won't be called\n    }\n  };\n\n  const handleNext = () => {\n    // BLOCKING VALIDATION: Check custom stringing before allowing navigation\n    if (selectedView === 'equipment') {\n      // Get current system's form data\n      const systemFormData = systemDetails[`system${selectedSystem}`] || {};\n\n      // Only validate if custom stringing mode is active\n      if (systemFormData.stringing_type === 'custom') {\n        const isMicroinverter = systemFormData.inverter_type === 'microinverter';\n        const { panelsRemaining } = calculatePanelsRemaining(systemFormData, isMicroinverter);\n\n        if (panelsRemaining !== 0) {\n          // Block navigation and show modal\n          const absRemaining = Math.abs(panelsRemaining);\n          const message = panelsRemaining > 0\n            ? `You have ${absRemaining} solar panel${absRemaining !== 1 ? 's' : ''} remaining to assign. Please complete stringing configuration or switch to Auto mode.`\n            : `You have ${absRemaining} solar panel${absRemaining !== 1 ? 's' : ''} over-assigned. Please adjust stringing configuration or switch to Auto mode.`;\n\n          setStringingBlockerMessage(message);\n          setShowStringingBlocker(true);\n          return; // Block navigation\n        }\n      }\n\n      // Validation passed, proceed\n      setShowAddSystemModal(true);\n    } else if (selectedView === 'combine') {\n      // From Combine, go to BOS\n      setSelectedView('bos');\n    } else if (selectedView === 'bos') {\n      // From BOS, show modal asking about additional system\n      setShowAddSystemModal(true);\n    }\n  };\n\n  const handleAddSystemConfirm = (addSystem) => {\n    setShowAddSystemModal(false);\n\n    if (addSystem && selectedSystem < maxSystems) {\n      // User wants to add additional system\n      setSelectedSystem(selectedSystem + 1);\n      setSelectedView('equipment');\n    } else {\n      // User doesn't want additional system\n      if (selectedView === 'equipment') {\n        // From Equipment â†’ go to Combine\n        setSelectedView('combine');\n      } else if (selectedView === 'bos') {\n        // From BOS â†’ go to Electrical tab\n        if (onNavigateToTab) {\n          onNavigateToTab('electrical');\n        }\n      }\n    }\n  };\n\n  // Only disable Previous when on System 1 AND Equipment sub-tab\n  const isPrevDisabled = selectedSystem === 1 && selectedView === 'equipment';\n\n  // Calculate total system capacity\n  const totalSystemKw = formData.solar_panel_wattage && formData.solar_panel_quantity\n    ? (parseFloat(formData.solar_panel_wattage) * parseInt(formData.solar_panel_quantity) / 1000).toFixed(2)\n    : null;\n\n  // View configuration - Combine tab always visible\n  const viewSteps = [\n    { key: 'equipment', label: 'Equipment' },\n    { key: 'combine', label: 'Combine' },\n    { key: 'bos', label: 'BOS' },\n  ];\n\n  // Render equipment sections for a specific system\n  const renderSystemEquipment = (systemNumber) => {\n    // Switch context to this system for rendering\n    const systemPrefix = SYSTEM_PREFIXES[systemNumber];\n    const systemFormData = hydrateFormData(systemNumber);\n\n    if (!systemFormData) return null;\n\n    // Merge local formData toggles that may have changed since last database sync\n    const mergedFormData = {\n      ...systemFormData,\n      show_solar_panel_2: formData.show_solar_panel_2 ?? systemFormData.show_solar_panel_2,\n      batteryonly: formData.batteryonly ?? systemFormData.batteryonly,\n    };\n\n    return (\n      <>\n        {/* Solar Panel Section */}\n        <SolarPanelSection\n          formData={mergedFormData}\n          onChange={handleFieldChange}\n          systemNumber={1}\n        />\n\n        {/* 2nd Solar Panel Section */}\n        {mergedFormData.show_solar_panel_2 && !mergedFormData.batteryonly && (\n          <SolarPanel2Section\n            formData={mergedFormData}\n            onChange={handleFieldChange}\n            systemNumber={1}\n          />\n        )}\n\n        {/* Inverter/Microinverter Section */}\n        <InverterMicroSection\n          formData={mergedFormData}\n          onChange={handleFieldChange}\n        />\n\n        {/* Stringing Section - MOVED INTO InverterMicroSection */}\n        {/* {systemFormData.inverter_type === 'inverter' && systemFormData.inverter_model && (\n          <InverterStringingSection\n            formData={systemFormData}\n            onChange={handleFieldChange}\n          />\n        )} */}\n\n        {/* Additional sections based on inverter type... */}\n        {/* TODO: Add all other equipment sections */}\n      </>\n    );\n  };\n\n  return (\n    <form onSubmit={(e) => e.preventDefault()} className={equipStyles.formFullHeight}>\n      {/* Scrollable Content - Full width, breaks out of parent padding */}\n      <div className={equipStyles.scrollableContent}>\n        {/* Loading State */}\n        {loading ? (\n          <div className={equipStyles.loadingContainer}>\n            <div className={equipStyles.loadingContent}>\n              <div className={equipStyles.loadingIcon}>âš™ï¸</div>\n              <div>Loading equipment data...</div>\n            </div>\n          </div>\n        ) : (\n          <>\n        {/* Render all visible systems in SystemContainers */}\n        {visibleSystems.map((systemNumber) => {\n          const systemFormData = hydrateFormData(systemNumber);\n          if (!systemFormData) return null;\n\n          // Merge local formData toggles that may have changed since last database sync\n          const mergedFormData = {\n            ...systemFormData,\n            show_solar_panel_2: formData.show_solar_panel_2 ?? systemFormData.show_solar_panel_2,\n            batteryonly: formData.batteryonly ?? systemFormData.batteryonly,\n          };\n\n          // Calculate PowerWall detection for this system\n          const systemIsPowerWall = isTeslaPowerWall(mergedFormData.inverter_make, mergedFormData.inverter_model);\n          const systemSuppressESS = shouldSuppressESS(mergedFormData.inverter_make, mergedFormData.inverter_model);\n          const systemIsGateway3SMS = systemIsPowerWall &&\n            mergedFormData.gateway === 'gateway_3' &&\n            mergedFormData.sms_make === 'Tesla' &&\n            mergedFormData.sms_model === 'Gateway 3';\n          const systemIsEnphaseCombiner6C = mergedFormData.combiner_panel_make?.toLowerCase() === 'enphase' &&\n            mergedFormData.combiner_panel_model?.includes('6C');\n          const systemShowGatewayConfig = systemIsPowerWall && (\n            mergedFormData.gateway === 'backup_gateway_2' ||\n            mergedFormData.gateway === 'gateway_3' ||\n            mergedFormData.teslagatewaytype === 'Backup Gateway 2' ||\n            mergedFormData.teslagatewaytype === 'Gateway 3'\n          );\n\n          // Create system-specific onChange handler that passes system number\n          const handleSystemFieldChange = async (field, value) => {\n            // Pass systemNumber as override to ensure correct field mapping\n            await handleFieldChange(field, value, systemNumber);\n          };\n\n          return (\n            <SystemContainer\n              key={systemNumber}\n              systemNumber={systemNumber}\n              onDelete={systemNumber > 1 ? () => handleDeleteSystem(systemNumber) : null}\n            >\n              {/* Solar Panel Section */}\n              <SolarPanelSection\n                formData={mergedFormData}\n                onChange={handleSystemFieldChange}\n                systemNumber={systemNumber}\n              />\n\n              {/* 2nd Solar Panel Section */}\n              {mergedFormData.show_solar_panel_2 && !mergedFormData.batteryonly && (\n                <SolarPanel2Section\n                  formData={mergedFormData}\n                  onChange={handleSystemFieldChange}\n                  systemNumber={systemNumber}\n                />\n              )}\n\n              {/* Inverter/Microinverter Section */}\n              <InverterMicroSection\n                formData={mergedFormData}\n                onChange={handleSystemFieldChange}\n              />\n\n              {/* Stringing Section - MOVED INTO InverterMicroSection */}\n              {/* {systemFormData.inverter_type === 'inverter' && systemFormData.inverter_model && (\n                <InverterStringingSection\n                  formData={systemFormData}\n                  onChange={handleSystemFieldChange}\n                />\n              )} */}\n\n              {/* PowerWall Configuration - Only shown for Tesla PowerWall */}\n              {systemIsPowerWall && (\n                <>\n                  <SectionHeader\n                    title=\"PowerWall Configuration\"\n                    onClear={mergedFormData.gateway ? () => {\n                      handleSystemFieldChange('expansionPacks', 0);\n                      handleSystemFieldChange('gateway', '');\n                      handleSystemFieldChange('backupSwitchLocation', '');\n                      handleSystemFieldChange('batteryExisting', false);\n                    } : null}\n                  />\n                  <PowerWallConfigurationSection\n                    formData={mergedFormData}\n                    onChange={handleSystemFieldChange}\n                  />\n                </>\n              )}\n\n              {/* Gateway Configuration - Only shown for Backup Gateway 2 or Gateway 3 */}\n              {systemShowGatewayConfig && (\n                <>\n                  <SectionHeader\n                    title=\"Gateway Configuration\"\n                    onClear={mergedFormData.gatewayConfigMainBreaker ? () => {\n                      handleSystemFieldChange('gatewayConfigIsNew', true);\n                      handleSystemFieldChange('gatewayConfigMainBreaker', '');\n                      handleSystemFieldChange('gatewayConfigBackupPanel', '');\n                      handleSystemFieldChange('gatewayConfigActivatePCS', false);\n                      handleSystemFieldChange('gatewayConfigPVBreaker', '');\n                      handleSystemFieldChange('gatewayConfigESSBreaker', '');\n                      handleSystemFieldChange('gatewayConfigTieInBreaker', '');\n                    } : null}\n                  />\n                  <GatewayConfigurationSection\n                    formData={mergedFormData}\n                    onChange={handleSystemFieldChange}\n                  />\n                </>\n              )}\n\n              {/* Energy Storage System - For String Inverters */}\n              {!systemSuppressESS && mergedFormData.inverter_type === 'inverter' && mergedFormData.inverter_model && (\n                <EnergyStorageSection\n                  formData={mergedFormData}\n                  onChange={handleSystemFieldChange}\n                  onBatchChange={handleBatchFieldChange}\n                />\n              )}\n\n              {/* String Combiner Panel - Only shown for Microinverters */}\n              {mergedFormData.inverter_type === 'microinverter' && (\n                <StringCombinerPanelSection\n                  formData={mergedFormData}\n                  onChange={handleSystemFieldChange}\n                  systemNumber={systemNumber}\n                  // Stringing props\n                  solarPanelQty={parseInt(mergedFormData.solar_panel_quantity) || 0}\n                  solarPanelQty2={parseInt(mergedFormData.solar_panel_type2_quantity) || 0}\n                  inverterMake={mergedFormData.inverter_make || ''}\n                  inverterModel={mergedFormData.inverter_model || ''}\n                  inverterMaxContOutput={parseFloat(mergedFormData.inverter_max_cont_output_amps) || 0}\n                />\n              )}\n\n              {/* Microinverter Stringing - MOVED INTO InverterMicroSection */}\n              {/* {systemFormData.inverter_type === 'microinverter' && (\n                <MicroinverterStringingSection\n                  formData={systemFormData}\n                  onChange={handleSystemFieldChange}\n                />\n              )} */}\n\n              {/* Energy Storage System - For Microinverters */}\n              {!systemSuppressESS && mergedFormData.inverter_type === 'microinverter' && mergedFormData.inverter_model && (\n                <EnergyStorageSection\n                  formData={mergedFormData}\n                  onChange={handleSystemFieldChange}\n                  onBatchChange={handleBatchFieldChange}\n                />\n              )}\n\n              {/* Storage Management System - Show ONLY for Whole/Partial Home backup (NOT PowerWall, NOT Enphase 6C) */}\n              {mergedFormData.inverter_model &&\n               !systemIsEnphaseCombiner6C &&\n               !systemIsPowerWall &&\n               (mergedFormData.backup_option === 'Whole Home' || mergedFormData.backup_option === 'Partial Home') && (\n                <StorageManagementSystemSection\n                  formData={mergedFormData}\n                  onChange={handleSystemFieldChange}\n                  backupOption={mergedFormData.backup_option}\n                />\n              )}\n\n              {/* Gateway 3 SMS Info (PowerWall Only) */}\n              {systemIsGateway3SMS && (\n                <div className={`${formStyles.infoBox} ${equipStyles.infoBoxMarginTight}`}>\n                  <span className={formStyles.infoBoxIcon}>â„¹ï¸</span>\n                  <span className={formStyles.infoBoxContent}>\n                    Gateway 3 is automatically configured as the Storage Management System for this PowerWall installation.\n                  </span>\n                </div>\n              )}\n\n              {/* Battery Type 1 - Show ONLY when backup option selected (NOT PowerWall) */}\n              {systemFormData.backup_option && !systemIsPowerWall && (\n                <BatteryTypeSection\n                  formData={systemFormData}\n                  onChange={handleSystemFieldChange}\n                  batteryNumber={1}\n                  showAddButton={!systemFormData.show_battery_type_2}\n                  onAddBatteryType2={handleAddBatteryType2}\n                />\n              )}\n\n              {/* Battery Type 2 - Show only when user adds it */}\n              {systemFormData.show_battery_type_2 && (\n                <BatteryTypeSection\n                  formData={systemFormData}\n                  onChange={handleSystemFieldChange}\n                  batteryNumber={2}\n                  showAddButton={false}\n                />\n              )}\n\n              {/* Backup Load Sub Panel - Show for Whole/Partial Home (NOT PowerWall) */}\n              {(systemFormData.backup_option === 'Whole Home' || systemFormData.backup_option === 'Partial Home') && !systemIsPowerWall && (\n                <BackupLoadSubPanelSection\n                  formData={systemFormData}\n                  onChange={handleSystemFieldChange}\n                  backupSystemSize={systemFormData.backup_system_size}\n                />\n              )}\n\n              {/* Battery Combiner Panel - Show when battery1 configuration = \"Battery Combiner Panel\" AND (qty > 1 OR battery2 exists) */}\n              {systemFormData.battery1_configuration === 'Battery Combiner Panel' &&\n               (parseInt(systemFormData.battery1_quantity || '0') > 1 || systemFormData.battery2_make) && (\n                <BatteryCombinerPanelSection\n                  formData={systemFormData}\n                  onChange={handleSystemFieldChange}\n                />\n              )}\n            </SystemContainer>\n          );\n        })}\n\n        {/* Add System 2/3/4 Button */}\n        {visibleSystems.length < maxSystems && (\n          <AddSectionButton\n            label={`System ${visibleSystems.length + 1}`}\n            onClick={() => handleAddSystem(visibleSystems.length + 1)}\n          />\n        )}\n\n        {/* BOS Detection Button - Show for 1 system (below Add System button) */}\n        {visibleSystems.length === 1 && (\n          <div className={equipStyles.sectionMarginTop}>\n            <div className={`${formStyles.infoBox} ${equipStyles.infoBoxMarginBase}`}>\n              <span className={formStyles.infoBoxIcon}>âš ï¸</span>\n              <span className={formStyles.infoBoxContent}>\n                Please select all equipment and combination method before detecting utility required BOS.\n              </span>\n            </div>\n            <AddSectionButton\n              label=\"Add Utility Required Equipment\"\n              onClick={handleDetectUtilityBOS}\n            />\n          </div>\n        )}\n\n        {/* Combine Systems Section - Show when there are 2+ systems with data */}\n        {visibleSystems.length >= 2 && (\n          <SystemContainer systemNumber=\"Combine Systems\">\n            <div className={equipStyles.infoBoxMarginTight}>\n              {/* Combine Choice Buttons */}\n              <div className={equipStyles.combineButtonGroup}>\n                <AddButton\n                  label=\"Do Not Combine\"\n                  active={formData.combine_systems === false}\n                  onClick={() => handleFieldChange('combine_systems', false)}\n                  showPlus={false}\n                />\n                <AddButton\n                  label=\"Combine\"\n                  active={formData.combine_systems === true}\n                  onClick={() => handleFieldChange('combine_systems', true)}\n                  showPlus={false}\n                />\n              </div>\n\n              {/* Show landing configuration when Combine is selected */}\n              {formData.combine_systems === true && (\n                <CombineSystemsForm\n                  projectUuid={projectUuid}\n                  activeSystems={visibleSystems}\n                  systemData={systemDetails}\n                  existingConfiguration={{\n                    combine_systems: true, // Force combine mode\n                    ...(formData.ele_combine_positions\n                      ? JSON.parse(formData.ele_combine_positions)\n                      : {})\n                  }}\n                  onSave={handleCombineSave}\n                  hasSubPanelB={formData.has_subpanel_b || false}\n                  subPanelBData={{\n                    busAmps: formData.ele_subpanel_b_bus_rating,\n                    mainBreakerAmps: formData.ele_subpanel_b_main_breaker,\n                    upstreamBreakerAmps: formData.ele_subpanel_b_upstream_breaker,\n                  }}\n                />\n              )}\n            </div>\n          </SystemContainer>\n        )}\n\n        {/* BOS Detection Button - Show for 2+ systems (below Combine UI) */}\n        {visibleSystems.length >= 2 && (\n          <div className={equipStyles.sectionMarginTop}>\n            <div className={`${formStyles.infoBox} ${equipStyles.infoBoxMarginBase}`}>\n              <span className={formStyles.infoBoxIcon}>âš ï¸</span>\n              <span className={formStyles.infoBoxContent}>\n                Please select all equipment and combination method before detecting utility required BOS.\n              </span>\n            </div>\n            <AddSectionButton\n              label=\"Add Utility Required Equipment\"\n              onClick={handleDetectUtilityBOS}\n            />\n          </div>\n        )}\n\n      {/* Combine View */}\n      {selectedView === 'combine' && (\n        <div className={equipStyles.section}>\n          <CombineSystemsForm\n            projectUuid={projectUuid}\n            activeSystems={getActiveSystemsList()}\n            systemData={formData}\n            existingConfiguration={\n              formData.ele_combine_positions\n                ? JSON.parse(formData.ele_combine_positions)\n                : null\n            }\n            onSave={handleCombineSave}\n            hasSubPanelB={formData.has_subpanel_b || false}\n            subPanelBData={{\n              busAmps: formData.ele_subpanel_b_bus_rating,\n              mainBreakerAmps: formData.ele_subpanel_b_main_breaker,\n              upstreamBreakerAmps: formData.ele_subpanel_b_upstream_breaker,\n            }}\n          />\n        </div>\n      )}\n\n      {/* BOS View */}\n      {selectedView === 'bos' && (\n        <div className={equipStyles.section}>\n          <BOSPanel\n            projectUuid={projectUuid}\n            systemNumber={selectedSystem}\n            formData={systemDetails || {}}\n            projectData={projectData}\n            onNavigateToTab={onNavigateToTab}\n          />\n        </div>\n      )}\n          </>\n        )}\n      </div>\n\n      {/* Footer Navigation */}\n      <FormNavigationFooter\n        onPrev={handlePrev}\n        onNext={handleNext}\n        showPrev={true}\n        prevDisabled={isPrevDisabled}\n        nextLabel=\"Next\"\n      />\n\n      {/* Add System Modal */}\n      <ConfirmDialog\n        isOpen={showAddSystemModal}\n        onClose={() => handleAddSystemConfirm(false)}\n        onConfirm={() => handleAddSystemConfirm(true)}\n        title=\"Adding an additional system?\"\n        message=\"Would you like to add another system to this project?\"\n        confirmText=\"Yes\"\n        cancelText=\"No\"\n        variant=\"info\"\n        contained={true}\n      />\n\n      {/* Stringing Blocker Modal - Prevents navigation when custom stringing is incomplete */}\n      <ConfirmDialog\n        isOpen={showStringingBlocker}\n        onClose={() => setShowStringingBlocker(false)}\n        onConfirm={null}\n        title=\"Stringing Configuration Incomplete\"\n        message={stringingBlockerMessage}\n        confirmText={null}\n        cancelText=\"Return to Equipment\"\n        variant=\"warning\"\n        contained={true}\n      />\n\n      {/* BOS Detection Modal */}\n      <BOSDetectionModal\n        isOpen={showBOSDetectionModal}\n        onClose={() => setShowBOSDetectionModal(false)}\n        onConfirm={handleBOSDetectionConfirm}\n        detectionResult={bosDetectionResult}\n        summary={bosDetectionSummary}\n        itemCount={bosItemCount}\n        isLoading={bosDetectionLoading}\n      />\n    </form>\n  );\n};\n\nexport default EquipmentForm;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\EquipmentSectionGroup.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getSectionIcon' is defined but never used.","line":14,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":40}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * EquipmentSectionGroup - Groups notes, photos, and videos by equipment section\n *\n * Displays all content (notes, photos, videos) organized by equipment section\n * instead of separating them by type.\n */\n\nimport React, { useState, useEffect, useMemo } from 'react';\nimport surveyService from '../../services/surveyService';\nimport logger from '../../services/devLogger';\nimport { SectionHeader, Note } from '../ui';\nimport PhotoPlaceholder from './PhotoPlaceholder';\nimport VideoPlaceholder from './VideoPlaceholder';\nimport { PHOTO_SECTIONS, getSectionIcon, formatSectionLabel } from '../../constants/photoSections';\nimport styles from '../../styles/EquipmentSectionGroup.module.css';\n\nconst EquipmentSectionGroup = ({ projectUuid, gridSize = 'medium' }) => {\n  const [notes, setNotes] = useState([]);\n  const [photos, setPhotos] = useState([]);\n  const [videos, setVideos] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  // Fetch all data\n  useEffect(() => {\n    const fetchAllData = async () => {\n      if (!projectUuid) return;\n\n      setLoading(true);\n      try {\n        const [notesData, photosData, videosData] = await Promise.all([\n          surveyService.notes.list(projectUuid).catch(err => {\n            logger.error('EquipmentSectionGroup', 'Failed to fetch notes:', err);\n            return [];\n          }),\n          surveyService.photos.list(projectUuid).catch(err => {\n            logger.error('EquipmentSectionGroup', 'Failed to fetch photos:', err);\n            return [];\n          }),\n          surveyService.videos.list(projectUuid).catch(err => {\n            logger.error('EquipmentSectionGroup', 'Failed to fetch videos:', err);\n            return [];\n          })\n        ]);\n\n        setNotes(notesData);\n        setPhotos(photosData);\n        setVideos(videosData);\n      } catch (err) {\n        logger.error('EquipmentSectionGroup', 'Failed to fetch data:', err);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchAllData();\n  }, [projectUuid]);\n\n  // Group all content by section\n  const groupedBySection = useMemo(() => {\n    const grouped = {};\n\n    // Group notes\n    notes.forEach(note => {\n      const section = note.section || 'general';\n      if (!grouped[section]) {\n        grouped[section] = { notes: [], photos: [], videos: [] };\n      }\n      grouped[section].notes.push(note);\n    });\n\n    // Group photos\n    photos.forEach(photo => {\n      const section = photo.section || 'general';\n      if (!grouped[section]) {\n        grouped[section] = { notes: [], photos: [], videos: [] };\n      }\n      grouped[section].photos.push(photo);\n    });\n\n    // Group videos\n    videos.forEach(video => {\n      const section = video.section || 'general';\n      if (!grouped[section]) {\n        grouped[section] = { notes: [], photos: [], videos: [] };\n      }\n      grouped[section].videos.push(video);\n    });\n\n    // Sort sections by PHOTO_SECTIONS order\n    const sectionOrder = PHOTO_SECTIONS.map(s => s.value);\n    const sortedSections = Object.keys(grouped).sort((a, b) => {\n      const aIndex = sectionOrder.indexOf(a);\n      const bIndex = sectionOrder.indexOf(b);\n      if (aIndex === -1 && bIndex === -1) return a.localeCompare(b);\n      if (aIndex === -1) return 1;\n      if (bIndex === -1) return -1;\n      return aIndex - bIndex;\n    });\n\n    const sortedGrouped = {};\n    sortedSections.forEach(section => {\n      sortedGrouped[section] = grouped[section];\n    });\n\n    return sortedGrouped;\n  }, [notes, photos, videos]);\n\n  if (loading) {\n    return (\n      <div className={styles.container}>\n        <div className={styles.loadingState}>Loading survey data...</div>\n      </div>\n    );\n  }\n\n  const sections = Object.keys(groupedBySection);\n\n  if (sections.length === 0) {\n    return (\n      <div className={styles.container}>\n        <div className={styles.emptyState}>\n          <div className={styles.emptyIcon}>ðŸ“‹</div>\n          <h4 className={styles.emptyTitle}>No Survey Data Yet</h4>\n          <p className={styles.emptyText}>Notes, photos, and videos from the mobile app will appear here.</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={styles.container}>\n      {sections.map(sectionId => {\n        const sectionData = groupedBySection[sectionId];\n        const hasContent = sectionData.notes.length > 0 || sectionData.photos.length > 0 || sectionData.videos.length > 0;\n\n        if (!hasContent) return null;\n\n        return (\n          <div key={sectionId} className={styles.sectionGroup}>\n            <SectionHeader title={formatSectionLabel(sectionId)} />\n\n            {/* Notes */}\n            {sectionData.notes.length > 0 && (\n              <div className={styles.contentBlock}>\n                <h4 className={styles.contentTypeLabel}>Notes ({sectionData.notes.length})</h4>\n                <div className={styles.notesList}>\n                  {sectionData.notes.map(note => (\n                    <Note key={note.id} text={note.content} />\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {/* Photos */}\n            {sectionData.photos.length > 0 && (\n              <div className={styles.contentBlock}>\n                <h4 className={styles.contentTypeLabel}>Photos ({sectionData.photos.length})</h4>\n                <div className={`${styles.mediaGrid} ${styles[`grid-${gridSize}`]}`}>\n                  {sectionData.photos.map(photo => (\n                    <div key={photo.id} className={styles.mediaItem}>\n                      <PhotoPlaceholder\n                        photo={photo}\n                        aspectRatio={photo.aspectRatio || 'landscape'}\n                        selected={false}\n                        showCheckbox={false}\n                      />\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {/* Videos */}\n            {sectionData.videos.length > 0 && (\n              <div className={styles.contentBlock}>\n                <h4 className={styles.contentTypeLabel}>Videos ({sectionData.videos.length})</h4>\n                <div className={`${styles.mediaGrid} ${styles[`grid-${gridSize}`]}`}>\n                  {sectionData.videos.map(video => (\n                    <div key={video.id} className={styles.mediaItem}>\n                      <VideoPlaceholder\n                        video={video}\n                        selected={false}\n                        showCheckbox={false}\n                      />\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n\nexport default EquipmentSectionGroup;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\FilesPanel.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\FilesTab.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\FormNavigationFooter.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\MediaGallery.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'EQUIPMENT_CATEGORIES' is defined but never used.","line":14,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":54},{"ruleId":"no-unused-vars","severity":1,"message":"'uploading' is assigned a value but never used.","line":51,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":51,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'handleSelectAll' is assigned a value but never used.","line":243,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":243,"endColumn":24},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'navigateLightbox'. Either include it or remove the dependency array.","line":431,"column":6,"nodeType":"ArrayExpression","endLine":431,"endColumn":21,"suggestions":[{"desc":"Update the dependencies array to be: [lightboxIndex, navigateLightbox]","fix":{"range":[14292,14307],"text":"[lightboxIndex, navigateLightbox]"}}]},{"ruleId":"no-unused-vars","severity":1,"message":"'gridVariants' is assigned a value but never used.","line":434,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":434,"endColumn":21},{"ruleId":"no-unused-vars","severity":1,"message":"'itemVariants' is assigned a value but never used.","line":439,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":439,"endColumn":21},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'currentItem'. Either include it or remove the dependency array.","line":696,"column":6,"nodeType":"ArrayExpression","endLine":696,"endColumn":23,"suggestions":[{"desc":"Update the dependencies array to be: [currentItem, currentItem.id]","fix":{"range":[23601,23618],"text":"[currentItem, currentItem.id]"}}]},{"ruleId":"no-unused-vars","severity":1,"message":"'PlayIcon' is assigned a value but never used.","line":1149,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":1149,"endColumn":15},{"ruleId":"no-unused-vars","severity":1,"message":"'ZoomIcon' is assigned a value but never used.","line":1155,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":1155,"endColumn":15},{"ruleId":"no-unused-vars","severity":1,"message":"'CloseIcon' is assigned a value but never used.","line":1163,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":1163,"endColumn":16},{"ruleId":"no-unused-vars","severity":1,"message":"'ChevronLeftIcon' is assigned a value but never used.","line":1169,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":1169,"endColumn":22},{"ruleId":"no-unused-vars","severity":1,"message":"'ChevronRightIcon' is assigned a value but never used.","line":1175,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":1175,"endColumn":23}],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchMedia'. Either include it or remove the dependency array.","line":143,"column":6,"nodeType":"ArrayExpression","endLine":143,"endColumn":30,"suggestions":[{"desc":"Update the dependencies array to be: [projectUuid, mediaType, fetchMedia]","fix":{"range":[5510,5534],"text":"[projectUuid, mediaType, fetchMedia]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef, useCallback, useMemo } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { toast } from 'react-toastify';\nimport * as Icons from 'lucide-react';\nimport logger from '../../services/devLogger';\nimport surveyService from '../../services/surveyService';\nimport useMediaSocket from '../../hooks/useMediaSocket';\nimport { Button, SectionHeader, Dropdown } from '../ui';\nimport PhotoPlaceholder from './PhotoPlaceholder';\nimport VideoPlaceholder from './VideoPlaceholder';\nimport PhotoAnnotationLayer from '../survey/PhotoAnnotationLayer';\nimport PhotoToolbar from '../survey/PhotoToolbar';\nimport PerformanceMonitor from '../debug/PerformanceMonitor';\nimport { mockPhotos, mockVideos, EQUIPMENT_CATEGORIES } from '../../mockData/surveyMockData';\nimport { PHOTO_SECTIONS, SECTION_CATEGORIES, formatSectionLabel, getSectionsByCategory } from '../../constants/photoSections';\nimport styles from '../../styles/MediaGallery.module.css';\n\n// Toggle for development - set to false to use real backend data\nconst USE_MOCK_DATA = false;\n\n// Helper function to get friendly label for section type\nconst getSectionTypeLabel = (sectionType) => {\n  return sectionType.split('_').map(\n    word => word.charAt(0).toUpperCase() + word.slice(1)\n  ).join(' ');\n};\n\n// Helper function to get section label from full ID (e.g., \"solar_panel_1\" â†’ \"Solar Panel 1\")\nconst getSectionLabel = (sectionId) => {\n  const match = sectionId.match(/_(\\d+)$/);\n  const number = match ? match[1] : '';\n  const baseName = sectionId.replace(/_\\d+$/, '').split('_').map(\n    word => word.charAt(0).toUpperCase() + word.slice(1)\n  ).join(' ');\n\n  return number ? `${baseName} ${number}` : baseName;\n};\n\nconst MediaGallery = ({\n  projectUuid,\n  mediaType = 'photo',\n  gridSize = 'medium',\n  onCountChange,\n  uploadTrigger = 0,\n  enableUploads = true,\n  onTabSwitch,\n  enableDragReorganize = true,\n}) => {\n  const [media, setMedia] = useState(USE_MOCK_DATA ? (mediaType === 'photo' ? mockPhotos : mockVideos) : []);\n  const [loading, setLoading] = useState(!USE_MOCK_DATA);\n  const [uploading, setUploading] = useState(false);\n  const [selectedIds, setSelectedIds] = useState(new Set());\n  const [activeFilter, setActiveFilter] = useState('all'); // 'all' or section name (e.g., 'solar_panel', 'inverter')\n  const [lightboxIndex, setLightboxIndex] = useState(null);\n  const [dragActive, setDragActive] = useState(false);\n  const [perfMonitorEnabled, setPerfMonitorEnabled] = useState(false);\n\n  const fileInputRef = useRef(null);\n  const lastSelectedRef = useRef(null);\n\n  // Performance Monitor Toggle - Press Ctrl+Shift+P\n  useEffect(() => {\n    const handleKeyDown = (e) => {\n      if (e.ctrlKey && e.shiftKey && e.key === 'P') {\n        e.preventDefault();\n        setPerfMonitorEnabled(prev => !prev);\n        logger.log('MediaGallery', `Performance Monitor ${!perfMonitorEnabled ? 'ENABLED' : 'DISABLED'}`);\n        toast.info(`Performance Monitor ${!perfMonitorEnabled ? 'Enabled' : 'Disabled'} (Ctrl+Shift+P to toggle)`);\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [perfMonitorEnabled]);\n\n  // Trigger upload when uploadTrigger changes (only if uploads are enabled)\n  useEffect(() => {\n    if (enableUploads && uploadTrigger > 0) {\n      fileInputRef.current?.click();\n    }\n  }, [uploadTrigger, enableUploads]);\n\n  // Fetch media function - defined before useEffect to avoid initialization error\n  const fetchMedia = useCallback(async () => {\n    if (!projectUuid) {\n      logger.warn('MediaGallery', 'No projectUuid provided');\n      return;\n    }\n\n    // Use mock data in development mode\n    if (USE_MOCK_DATA) {\n      setLoading(true);\n      // Simulate loading delay for realistic UX\n      setTimeout(() => {\n        if (mediaType === 'both') {\n          setMedia([...mockPhotos, ...mockVideos]);\n        } else {\n          setMedia(mediaType === 'photo' ? mockPhotos : mockVideos);\n        }\n        setLoading(false);\n      }, 500);\n      return;\n    }\n\n    // Real backend data fetch using surveyService\n    setLoading(true);\n    try {\n      logger.log('MediaGallery', `[Fetch] Starting fetch for ProjectUuid: ${projectUuid}, MediaType: ${mediaType}`);\n\n      let data = [];\n\n      if (mediaType === 'both') {\n        // Fetch both photos and videos\n        const [photos, videos] = await Promise.all([\n          surveyService.photos.list(projectUuid),\n          surveyService.videos.list(projectUuid)\n        ]);\n        data = [...photos, ...videos];\n        logger.log('MediaGallery', `[Fetch] SUCCESS - Fetched ${photos.length} photos and ${videos.length} videos`);\n      } else {\n        const api = mediaType === 'photo' ? surveyService.photos : surveyService.videos;\n        logger.log('MediaGallery', `[Fetch] Using API: surveyService.${mediaType}s.list()`);\n        data = await api.list(projectUuid);\n        logger.log('MediaGallery', `[Fetch] SUCCESS - Fetched ${data.length} ${mediaType}s`);\n      }\n\n      setMedia(data);\n    } catch (error) {\n      logger.error('MediaGallery', `[Fetch] ERROR fetching ${mediaType}s:`, error);\n      toast.error(`Failed to load media: ${error.message}`);\n      setMedia([]);\n    } finally {\n      setLoading(false);\n    }\n  }, [projectUuid, mediaType]);\n\n  // Fetch media on mount\n  useEffect(() => {\n    if (projectUuid) {\n      fetchMedia();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [projectUuid, mediaType]);\n\n  // Real-time socket listener for new uploads\n  useMediaSocket(projectUuid, useCallback((data) => {\n    // Add if it matches our current media type, or if we're showing both types\n    const shouldAdd = mediaType === 'both' || data.mediaType === mediaType;\n\n    if (shouldAdd) {\n      logger.log('MediaGallery', `[Socket] New ${data.mediaType} uploaded:`, data.media);\n\n      // Add new media to the beginning of the list\n      setMedia(prev => [data.media, ...prev]);\n\n      // Show toast notification\n      toast.success(`New ${data.mediaType} uploaded by ${data.media.uploadedBy || 'surveyor'}`, {\n        position: 'top-right',\n        autoClose: 3000,\n      });\n    }\n  }, [mediaType]));\n\n  // Get unique section types from media (e.g., \"solar_panel\", \"inverter\", etc.)\n  const sectionTypes = useMemo(() => {\n    const types = new Set();\n    media.forEach(item => {\n      if (item.section) {\n        // Extract base type (e.g., \"solar_panel_1\" -> \"solar_panel\")\n        const baseType = item.section.replace(/_\\d+$/, '');\n        types.add(baseType);\n      }\n    });\n    return Array.from(types).sort();\n  }, [media]);\n\n  // Group photos by full section ID for display\n  const photosBySection = useMemo(() => {\n    const grouped = {};\n\n    media.forEach(item => {\n      if (item.section) {\n        if (!grouped[item.section]) {\n          grouped[item.section] = [];\n        }\n        grouped[item.section].push(item);\n      }\n    });\n\n    return grouped;\n  }, [media]);\n\n  // Get filtered sections based on active filter\n  const filteredSectionIds = useMemo(() => {\n    if (activeFilter === 'all') {\n      return Object.keys(photosBySection).sort();\n    }\n\n    // Filter to sections that start with the selected type\n    return Object.keys(photosBySection)\n      .filter(sectionId => sectionId.startsWith(activeFilter))\n      .sort();\n  }, [activeFilter, photosBySection]);\n\n  // Get filtered media for lightbox\n  const filteredMedia = useMemo(() => {\n    return filteredSectionIds.flatMap(sectionId => photosBySection[sectionId] || []);\n  }, [filteredSectionIds, photosBySection]);\n\n  // Report media count to parent\n  useEffect(() => {\n    if (onCountChange) {\n      onCountChange(media.length);\n    }\n  }, [media.length, onCountChange]);\n\n  // Selection handlers\n  const handleSelect = (id, event) => {\n    const newSelected = new Set(selectedIds);\n\n    // Shift+click for range selection\n    if (event.shiftKey && lastSelectedRef.current !== null) {\n      const currentIndex = media.findIndex(m => m.id === id);\n      const lastIndex = media.findIndex(m => m.id === lastSelectedRef.current);\n      const [start, end] = [Math.min(currentIndex, lastIndex), Math.max(currentIndex, lastIndex)];\n\n      for (let i = start; i <= end; i++) {\n        newSelected.add(media[i].id);\n      }\n    } else {\n      // Toggle selection\n      if (newSelected.has(id)) {\n        newSelected.delete(id);\n      } else {\n        newSelected.add(id);\n      }\n    }\n\n    lastSelectedRef.current = id;\n    setSelectedIds(newSelected);\n  };\n\n  const handleSelectAll = () => {\n    if (selectedIds.size === filteredMedia.length) {\n      setSelectedIds(new Set());\n    } else {\n      setSelectedIds(new Set(filteredMedia.map(m => m.id)));\n    }\n  };\n\n  const clearSelection = () => {\n    setSelectedIds(new Set());\n    lastSelectedRef.current = null;\n  };\n\n  // Bulk delete\n  const handleBulkDelete = async () => {\n    if (selectedIds.size === 0) return;\n\n    const confirmed = window.confirm(\n      `Delete ${selectedIds.size} ${mediaType}${selectedIds.size > 1 ? 's' : ''}?`\n    );\n\n    if (!confirmed) return;\n\n    try {\n      const api = mediaType === 'photo' ? surveyService.photos : surveyService.videos;\n      await api.bulkDelete(projectUuid, Array.from(selectedIds));\n\n      setMedia(prev => prev.filter(m => !selectedIds.has(m.id)));\n      clearSelection();\n      toast.success(`Deleted ${selectedIds.size} ${mediaType}${selectedIds.size > 1 ? 's' : ''}`);\n    } catch (error) {\n      logger.error('MediaGallery', 'Error deleting media:', error);\n      toast.error(`Failed to delete ${mediaType}s. Please try again.`);\n    }\n  };\n\n  // Delete single item\n  const handleDeleteOne = async (itemId) => {\n    const confirmed = window.confirm(\n      `Delete this ${mediaType}?`\n    );\n\n    if (!confirmed) return;\n\n    try {\n      const api = mediaType === 'photo' ? surveyService.photos : surveyService.videos;\n      await api.deleteOne(projectUuid, itemId);\n\n      setMedia(prev => prev.filter(m => m.id !== itemId));\n      setSelectedIds(prev => {\n        const newSet = new Set(prev);\n        newSet.delete(itemId);\n        return newSet;\n      });\n      toast.success(`Deleted ${mediaType}`);\n    } catch (error) {\n      logger.error('MediaGallery', `Error deleting ${mediaType}:`, error);\n      toast.error(`Failed to delete ${mediaType}. Please try again.`);\n    }\n  };\n\n  // Bulk move to section\n  const handleBulkMoveToSection = async (newSection) => {\n    if (selectedIds.size === 0) return;\n\n    const photoIds = Array.from(selectedIds);\n\n    // Optimistic UI update\n    setMedia(prev => prev.map(photo =>\n      selectedIds.has(photo.id) ? { ...photo, section: newSection } : photo\n    ));\n\n    try {\n      // Use bulk update if available, otherwise individual updates\n      await Promise.all(\n        photoIds.map(photoId =>\n          surveyService.photos.updateMetadata(projectUuid, photoId, { section: newSection })\n        )\n      );\n\n      clearSelection();\n      toast.success(`Moved ${photoIds.length} photo${photoIds.length > 1 ? 's' : ''} to ${formatSectionLabel(newSection)}`);\n    } catch (error) {\n      // Revert on failure\n      await fetchMedia();\n      toast.error('Failed to move photos');\n      logger.error('MediaGallery', 'Bulk move failed:', error);\n    }\n  };\n\n  // Update photo metadata (for lightbox edits)\n  const handleUpdatePhoto = (photoId, updates) => {\n    setMedia(prev => prev.map(photo =>\n      photo.id === photoId ? { ...photo, ...updates } : photo\n    ));\n  };\n\n  // Upload handlers (only active if uploads are enabled)\n  const handleUpload = () => {\n    if (enableUploads) {\n      fileInputRef.current?.click();\n    }\n  };\n\n  const handleFileChange = async (e) => {\n    if (!enableUploads) return;\n    const files = Array.from(e.target.files || []);\n    if (files.length === 0) return;\n    await uploadFiles(files);\n    e.target.value = '';\n  };\n\n  const uploadFiles = async (files) => {\n    if (!enableUploads) return;\n    setUploading(true);\n    try {\n      const api = mediaType === 'photo' ? surveyService.photos : surveyService.videos;\n\n      const uploadPromises = files.map(async (file) => {\n        return api.upload(projectUuid, file);\n      });\n\n      const results = await Promise.all(uploadPromises);\n      logger.log('MediaGallery', `Successfully uploaded ${results.length} ${mediaType}s`);\n\n      // Refresh media list (socket will also update, but this ensures consistency)\n      await fetchMedia();\n\n      toast.success(`Uploaded ${results.length} ${mediaType}${results.length > 1 ? 's' : ''}`, {\n        position: 'top-right',\n        autoClose: 2000,\n      });\n    } catch (error) {\n      logger.error('MediaGallery', 'Upload error:', error);\n      toast.error(`Failed to upload ${mediaType}s. Please try again.`);\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  // Drag & drop (only active if uploads are enabled)\n  const handleDragOver = (e) => {\n    e.preventDefault();\n    if (enableUploads) {\n      setDragActive(true);\n    }\n  };\n\n  const handleDragLeave = () => {\n    if (enableUploads) {\n      setDragActive(false);\n    }\n  };\n\n  const handleDrop = (e) => {\n    e.preventDefault();\n    if (!enableUploads) return;\n    setDragActive(false);\n    const files = Array.from(e.dataTransfer.files).filter(\n      f => mediaType === 'video' ? f.type.startsWith('video/') : f.type.startsWith('image/')\n    );\n    if (files.length > 0) uploadFiles(files);\n  };\n\n  // Lightbox navigation\n  const openLightbox = (index) => setLightboxIndex(index);\n  const closeLightbox = () => setLightboxIndex(null);\n\n  const navigateLightbox = (direction) => {\n    setLightboxIndex(prev => {\n      const newIndex = prev + direction;\n      if (newIndex < 0) return filteredMedia.length - 1;\n      if (newIndex >= filteredMedia.length) return 0;\n      return newIndex;\n    });\n  };\n\n  // Keyboard navigation for lightbox\n  useEffect(() => {\n    const handleKeyDown = (e) => {\n      if (lightboxIndex === null) return;\n      if (e.key === 'Escape') closeLightbox();\n      if (e.key === 'ArrowLeft') navigateLightbox(-1);\n      if (e.key === 'ArrowRight') navigateLightbox(1);\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [lightboxIndex]);\n\n  // Animation variants\n  const gridVariants = {\n    hidden: { opacity: 0 },\n    visible: { opacity: 1, transition: { staggerChildren: 0.03 } }\n  };\n\n  const itemVariants = {\n    hidden: { opacity: 0, scale: 0.9 },\n    visible: { opacity: 1, scale: 1 }\n  };\n\n  return (\n    <div className={styles.galleryContainer}>\n      {/* Performance Monitor - Toggle with Ctrl+Shift+P */}\n      <PerformanceMonitor projectUuid={projectUuid} enabled={perfMonitorEnabled} />\n\n      {/* Filter Row - directly below sub-tabs */}\n      <div className={styles.filterRow}>\n        <button\n          className={`${styles.filterBtn} ${activeFilter === 'all' ? styles.active : ''}`}\n          onClick={() => setActiveFilter('all')}\n        >\n          All\n        </button>\n        {sectionTypes.map(sectionType => (\n          <button\n            key={sectionType}\n            className={`${styles.filterBtn} ${activeFilter === sectionType ? styles.active : ''}`}\n            onClick={() => setActiveFilter(sectionType)}\n          >\n            {getSectionTypeLabel(sectionType)}\n          </button>\n        ))}\n      </div>\n\n      {/* Selection toolbar - shown when items are selected */}\n      {selectedIds.size > 0 && (\n        <motion.div\n          className={styles.selectionToolbar}\n          initial={{ y: 20, opacity: 0 }}\n          animate={{ y: 0, opacity: 1 }}\n          exit={{ y: 20, opacity: 0 }}\n        >\n          <span className={styles.selectionCount}>\n            <CheckIcon className={styles.checkIcon} />\n            {selectedIds.size} selected\n          </span>\n\n          <div className={styles.selectionActions}>\n            {/* Move to Section - Grouped Dropdown */}\n            {mediaType === 'photo' && (\n              <Dropdown\n                trigger={\n                  <Button variant=\"secondary\" size=\"sm\">\n                    <Icons.Folder size={14} />\n                    Move to Section\n                    <Icons.ChevronDown size={14} />\n                  </Button>\n                }\n                align=\"left\"\n                closeOnClick={true}\n              >\n                <div className={styles.sectionDropdown}>\n                  {SECTION_CATEGORIES.map(category => (\n                    <div key={category.value}>\n                      <Dropdown.Label>{category.label}</Dropdown.Label>\n                      {getSectionsByCategory(category.value).map(section => {\n                        const IconComponent = Icons[section.icon] || Icons.Folder;\n                        return (\n                          <Dropdown.Item\n                            key={section.value}\n                            icon={<IconComponent size={14} />}\n                            onClick={() => handleBulkMoveToSection(section.value)}\n                          >\n                            {section.label}\n                          </Dropdown.Item>\n                        );\n                      })}\n                    </div>\n                  ))}\n                </div>\n              </Dropdown>\n            )}\n\n            <Button variant=\"secondary\" onClick={clearSelection}>\n              Clear\n            </Button>\n\n            <Button variant=\"danger\" onClick={handleBulkDelete}>\n              <TrashIcon /> Delete ({selectedIds.size})\n            </Button>\n          </div>\n        </motion.div>\n      )}\n\n      {/* Hidden file input (only if uploads enabled) */}\n      {enableUploads && (\n        <input\n          ref={fileInputRef}\n          type=\"file\"\n          accept={mediaType === 'video' ? 'video/*' : 'image/*'}\n          multiple\n          onChange={handleFileChange}\n          style={{ display: 'none' }}\n        />\n      )}\n\n      {/* Content */}\n      {loading ? (\n        <div className={styles.loadingGrid}>\n          {[...Array(8)].map((_, i) => (\n            <div key={i} className={styles.loadingSkeleton} />\n          ))}\n        </div>\n      ) : media.length === 0 ? (\n        enableUploads ? (\n          <div\n            className={`${styles.uploadZone} ${dragActive ? styles.dragActive : ''}`}\n            onDragOver={handleDragOver}\n            onDragLeave={handleDragLeave}\n            onDrop={handleDrop}\n            onClick={handleUpload}\n          >\n            <UploadIcon className={styles.uploadIcon} />\n            <span className={styles.uploadText}>\n              Drag & drop {mediaType}s here, or click to upload\n            </span>\n            <span className={styles.uploadHint}>\n              Supports {mediaType === 'video' ? 'MP4, MOV, WebM' : 'JPG, PNG, WebP'} files\n            </span>\n          </div>\n        ) : (\n          <div className={styles.emptyState}>\n            {mediaType === 'photo' ? <PhotoIcon className={styles.emptyIcon} /> : <VideoIcon className={styles.emptyIcon} />}\n            <h3 className={styles.emptyTitle}>No {mediaType}s yet</h3>\n            <p className={styles.emptyMessage}>\n              Upload {mediaType}s on the{' '}\n              <button\n                className={styles.tabLink}\n                onClick={() => onTabSwitch?.()}\n              >\n                Files\n              </button>\n              {' '}tab\n            </p>\n          </div>\n        )\n      ) : (\n        <div\n          className={styles.sectionList}\n          onDragOver={handleDragOver}\n          onDragLeave={handleDragLeave}\n          onDrop={handleDrop}\n        >\n          {filteredSectionIds.map(sectionId => {\n            const sectionItems = photosBySection[sectionId] || [];\n\n            return (\n              <div key={sectionId} className={styles.section}>\n                {/* Section Header */}\n                <SectionHeader title={getSectionLabel(sectionId)} />\n\n                {/* Photo Grid */}\n                <div className={`${styles.photoGrid} ${styles[`grid-${gridSize}`]}`}>\n                  {sectionItems.map((item) => {\n                    const itemIndex = filteredMedia.findIndex(m => m.id === item.id);\n                    // Determine if this item is a video based on type field or duration presence\n                    const isVideo = item.type === 'video' || item.mediaType === 'video' || (item.duration !== undefined && item.duration !== null);\n\n                    return (\n                      <div key={item.id} className={styles.gridItem}>\n                        {isVideo ? (\n                          <VideoPlaceholder\n                            video={item}\n                            selected={selectedIds.has(item.id)}\n                            onSelect={(id) => handleSelect(id, {})}\n                            onClick={() => openLightbox(itemIndex)}\n                            onDelete={() => handleDeleteOne(item.id)}\n                            showCheckbox={true}\n                          />\n                        ) : (\n                          <PhotoPlaceholder\n                            photo={item}\n                            aspectRatio={item.aspectRatio || 'landscape'}\n                            selected={selectedIds.has(item.id)}\n                            onSelect={(id) => handleSelect(id, {})}\n                            onClick={() => openLightbox(itemIndex)}\n                            onDelete={() => handleDeleteOne(item.id)}\n                            showCheckbox={true}\n                          />\n                        )}\n                      </div>\n                    );\n                  })}\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      )}\n\n      {/* Lightbox */}\n      <AnimatePresence>\n        {lightboxIndex !== null && (\n          <MediaLightbox\n            media={filteredMedia}\n            currentIndex={lightboxIndex}\n            mediaType={mediaType}\n            onClose={closeLightbox}\n            onNavigate={navigateLightbox}\n            onUpdatePhoto={handleUpdatePhoto}\n            projectUuid={projectUuid}\n          />\n        )}\n      </AnimatePresence>\n    </div>\n  );\n};\n\n// Lightbox Component with Enhanced Metadata Panel\nconst MediaLightbox = ({\n  media,\n  currentIndex,\n  mediaType,\n  onClose,\n  onNavigate,\n  onUpdatePhoto,\n  projectUuid\n}) => {\n  const currentItem = media[currentIndex];\n  const [isEditing, setIsEditing] = useState(false);\n  const [editData, setEditData] = useState({\n    section: currentItem?.section || 'general',\n    tag: currentItem?.tag || '',\n    note: currentItem?.originalNotes || ''\n  });\n  const [saving, setSaving] = useState(false);\n\n  // Zoom state\n  const [zoom, setZoom] = useState(1);\n  const [pan, setPan] = useState({ x: 0, y: 0 });\n  const [isPanning, setIsPanning] = useState(false);\n  const panStartRef = useRef({ x: 0, y: 0 });\n  const imageContainerRef = useRef(null);\n\n  // Annotation state\n  const [isAnnotationMode, setIsAnnotationMode] = useState(false);\n  const [currentTool, setCurrentTool] = useState('select');\n  const [currentColor, setCurrentColor] = useState('var(--status-revisions)');\n  const [annotations, setAnnotations] = useState([]);\n  const annotationLayerRef = useRef(null);\n  const imageRef = useRef(null);\n\n  // Reset edit data when photo changes\n  useEffect(() => {\n    if (currentItem) {\n      setEditData({\n        section: currentItem.section || 'general',\n        tag: currentItem.tag || '',\n        note: currentItem.originalNotes || ''\n      });\n      setIsEditing(false);\n    }\n  }, [currentItem?.id]);\n\n  // Reset zoom when photo changes\n  useEffect(() => {\n    setZoom(1);\n    setPan({ x: 0, y: 0 });\n  }, [currentItem?.id]);\n\n  // Reset annotation state when photo changes\n  useEffect(() => {\n    setIsAnnotationMode(false);\n    setAnnotations([]);\n    setCurrentTool('select');\n  }, [currentItem?.id]);\n\n  const handleSave = async () => {\n    setSaving(true);\n    try {\n      await surveyService.photos.updateMetadata(projectUuid, currentItem.id, {\n        section: editData.section,\n        tag: editData.tag,\n        note: editData.note\n      });\n      onUpdatePhoto(currentItem.id, editData);\n      setIsEditing(false);\n      toast.success('Photo updated');\n    } catch (error) {\n      toast.error('Failed to save changes');\n      logger.error('MediaLightbox', 'Save error:', error);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  // Scroll wheel zoom handler\n  const handleWheel = useCallback((e) => {\n    e.preventDefault();\n    const delta = e.deltaY > 0 ? -0.1 : 0.1;\n    setZoom(prev => Math.min(Math.max(prev + delta, 0.5), 5)); // Min 0.5x, max 5x\n  }, []);\n\n  // Zoom button handlers\n  const handleZoomIn = () => setZoom(prev => Math.min(prev + 0.25, 5));\n  const handleZoomOut = () => setZoom(prev => Math.max(prev - 0.25, 0.5));\n  const handleZoomReset = () => { setZoom(1); setPan({ x: 0, y: 0 }); };\n\n  // Pan handlers (when zoomed in and not in annotation mode)\n  const handleMouseDown = (e) => {\n    if (zoom > 1 && !isAnnotationMode) {\n      setIsPanning(true);\n      panStartRef.current = { x: e.clientX - pan.x, y: e.clientY - pan.y };\n    }\n  };\n\n  const handleMouseMove = (e) => {\n    if (isPanning && zoom > 1 && !isAnnotationMode) {\n      setPan({\n        x: e.clientX - panStartRef.current.x,\n        y: e.clientY - panStartRef.current.y\n      });\n    }\n  };\n\n  const handleMouseUp = () => setIsPanning(false);\n\n  // Annotation handlers\n  const handleSaveAsCopy = async () => {\n    try {\n      const canvas = annotationLayerRef.current?.getCanvas();\n      const image = imageRef.current;\n\n      if (!canvas || !image) {\n        toast.error('Unable to save annotated photo');\n        return;\n      }\n\n      // Create a new canvas to merge the image and annotations\n      const mergedCanvas = document.createElement('canvas');\n      const ctx = mergedCanvas.getContext('2d');\n\n      // Set canvas size to match the image\n      mergedCanvas.width = image.naturalWidth;\n      mergedCanvas.height = image.naturalHeight;\n\n      // Draw the original image\n      ctx.drawImage(image, 0, 0);\n\n      // Draw the annotations on top\n      const annotationDataURL = canvas.toDataURL('image/png');\n      const annotationImage = new Image();\n\n      await new Promise((resolve, reject) => {\n        annotationImage.onload = resolve;\n        annotationImage.onerror = reject;\n        annotationImage.src = annotationDataURL;\n      });\n\n      ctx.drawImage(annotationImage, 0, 0, mergedCanvas.width, mergedCanvas.height);\n\n      // Convert to blob and upload\n      mergedCanvas.toBlob(async (blob) => {\n        const formData = new FormData();\n        formData.append('photo', blob, `annotated_${currentItem.filename}`);\n        formData.append('section', currentItem.section || 'general');\n        formData.append('tag', currentItem.tag || '');\n        formData.append('note', `Annotated copy of ${currentItem.filename}`);\n\n        try {\n          await surveyService.photos.upload(projectUuid, formData);\n          toast.success('Annotated photo saved as new copy');\n          setIsAnnotationMode(false);\n          setAnnotations([]);\n          // Note: The new photo will appear when the gallery refreshes via WebSocket\n        } catch (error) {\n          toast.error('Failed to save annotated photo');\n          logger.error('MediaLightbox', 'Save annotation error:', error);\n        }\n      }, 'image/png');\n    } catch (error) {\n      toast.error('Failed to save annotated photo');\n      logger.error('MediaLightbox', 'Annotation save error:', error);\n    }\n  };\n\n  const handleUndo = () => annotationLayerRef.current?.undo();\n  const handleRedo = () => annotationLayerRef.current?.redo();\n  const handleDelete = () => annotationLayerRef.current?.deleteSelected();\n\n  // Add wheel listener to image container\n  useEffect(() => {\n    const container = imageContainerRef.current;\n    if (container && mediaType === 'photo') {\n      container.addEventListener('wheel', handleWheel, { passive: false });\n      return () => container.removeEventListener('wheel', handleWheel);\n    }\n  }, [handleWheel, mediaType]);\n\n  return (\n    <motion.div\n      className={styles.lightboxOverlay}\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      exit={{ opacity: 0 }}\n      onClick={onClose}\n    >\n      <div className={styles.lightboxContainer} onClick={e => e.stopPropagation()}>\n        {/* Clean Header */}\n        <div className={styles.lightboxHeader}>\n          <div className={styles.lightboxNav}>\n            <span className={styles.lightboxCounter}>\n              {currentIndex + 1} / {media.length}\n            </span>\n          </div>\n\n          {/* Zoom Controls - Photos only */}\n          {mediaType === 'photo' && (\n            <div className={styles.zoomControls}>\n              <button onClick={handleZoomOut} title=\"Zoom Out\" className={styles.zoomBtn}>\n                <Icons.ZoomOut size={18} />\n              </button>\n              <span className={styles.zoomLevel}>{Math.round(zoom * 100)}%</span>\n              <button onClick={handleZoomIn} title=\"Zoom In\" className={styles.zoomBtn}>\n                <Icons.ZoomIn size={18} />\n              </button>\n              <button onClick={handleZoomReset} title=\"Reset Zoom\" className={styles.zoomBtn}>\n                <Icons.Maximize2 size={18} />\n              </button>\n            </div>\n          )}\n\n          <div className={styles.lightboxActions}>\n            {mediaType === 'photo' && (\n              <>\n                <button\n                  className={`${styles.iconButton} ${isAnnotationMode ? styles.active : ''}`}\n                  onClick={() => setIsAnnotationMode(!isAnnotationMode)}\n                  title={isAnnotationMode ? \"Exit markup mode\" : \"Enter markup mode\"}\n                >\n                  <Icons.Edit3 size={18} />\n                </button>\n                <button\n                  className={styles.iconButton}\n                  onClick={() => setIsEditing(!isEditing)}\n                  title={isEditing ? \"Cancel editing\" : \"Edit metadata\"}\n                >\n                  <Icons.Edit size={18} />\n                </button>\n              </>\n            )}\n            <button className={styles.iconButton} onClick={onClose} title=\"Close\">\n              <Icons.X size={20} />\n            </button>\n          </div>\n        </div>\n\n        {/* Main Content Area */}\n        <div className={styles.lightboxMain}>\n          {/* Navigation Arrow - Left */}\n          <button\n            className={`${styles.navArrow} ${styles.navPrev}`}\n            onClick={() => onNavigate(-1)}\n            title=\"Previous\"\n          >\n            <Icons.ChevronLeft size={32} />\n          </button>\n\n          {/* Image or Video */}\n          <div\n            ref={imageContainerRef}\n            className={styles.lightboxImageContainer}\n            onMouseDown={handleMouseDown}\n            onMouseMove={handleMouseMove}\n            onMouseUp={handleMouseUp}\n            onMouseLeave={handleMouseUp}\n            style={{ cursor: mediaType === 'photo' && zoom > 1 && !isAnnotationMode ? (isPanning ? 'grabbing' : 'grab') : 'default' }}\n          >\n            {mediaType === 'video' ? (\n              currentItem.url ? (\n                <video\n                  src={currentItem.url}\n                  controls\n                  autoPlay\n                  className={styles.lightboxVideo}\n                />\n              ) : (\n                <div className={styles.lightboxPlaceholder}>\n                  <VideoPlaceholder\n                    video={currentItem}\n                    selected={false}\n                    showCheckbox={false}\n                  />\n                </div>\n              )\n            ) : (\n              currentItem.url ? (\n                <div style={{ position: 'relative', width: '100%', height: '100%', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>\n                  <motion.img\n                    ref={imageRef}\n                    key={currentItem.id}\n                    src={currentItem.url}\n                    alt={currentItem.name}\n                    className={styles.lightboxImage}\n                    style={{\n                      transform: isAnnotationMode ? 'none' : `scale(${zoom}) translate(${pan.x / zoom}px, ${pan.y / zoom}px)`,\n                      transformOrigin: 'center center',\n                    }}\n                    draggable={false}\n                    initial={{ opacity: 0 }}\n                    animate={{ opacity: 1 }}\n                    transition={{ duration: 0.2 }}\n                  />\n\n                  {/* Annotation Layer */}\n                  {isAnnotationMode && (\n                    <PhotoAnnotationLayer\n                      ref={annotationLayerRef}\n                      isActive={isAnnotationMode}\n                      currentTool={currentTool}\n                      currentColor={currentColor}\n                      annotations={annotations}\n                      onAnnotationsChange={setAnnotations}\n                      onToolChange={setCurrentTool}\n                    />\n                  )}\n                </div>\n              ) : (\n                <div className={styles.lightboxPlaceholder}>\n                  <PhotoPlaceholder\n                    photo={currentItem}\n                    aspectRatio={currentItem.aspectRatio || 'landscape'}\n                    selected={false}\n                    showCheckbox={false}\n                  />\n                </div>\n              )\n            )}\n          </div>\n\n          {/* Annotation Toolbar */}\n          {mediaType === 'photo' && isAnnotationMode && (\n            <PhotoToolbar\n              currentTool={currentTool}\n              onToolChange={setCurrentTool}\n              currentColor={currentColor}\n              onColorChange={setCurrentColor}\n              onSaveAsCopy={handleSaveAsCopy}\n              onUndo={handleUndo}\n              onRedo={handleRedo}\n              onDelete={handleDelete}\n              zoom={zoom}\n              onZoomIn={handleZoomIn}\n              onZoomOut={handleZoomOut}\n              onZoomReset={handleZoomReset}\n              hasAnnotations={annotations.length > 0}\n            />\n          )}\n\n          {/* Navigation Arrow - Right */}\n          <button\n            className={`${styles.navArrow} ${styles.navNext}`}\n            onClick={() => onNavigate(1)}\n            title=\"Next\"\n          >\n            <Icons.ChevronRight size={32} />\n          </button>\n\n          {/* Metadata Side Panel (Photos only) */}\n          {mediaType === 'photo' && (\n            <motion.div\n              className={styles.metadataPanel}\n              initial={{ x: 320, opacity: 0 }}\n              animate={{ x: 0, opacity: 1 }}\n              exit={{ x: 320, opacity: 0 }}\n            >\n              <div className={styles.metadataContent}>\n                {/* Section Badge */}\n                <div className={styles.metadataRow}>\n                  <label>Section</label>\n                  {isEditing ? (\n                    <select\n                      value={editData.section}\n                      onChange={(e) => setEditData(prev => ({ ...prev, section: e.target.value }))}\n                      className={styles.metadataSelect}\n                    >\n                      {PHOTO_SECTIONS.map(section => (\n                        <option key={section.value} value={section.value}>\n                          {section.label}\n                        </option>\n                      ))}\n                    </select>\n                  ) : (\n                    <div className={styles.sectionBadge}>\n                      {(() => {\n                        const section = PHOTO_SECTIONS.find(s => s.value === currentItem.section);\n                        const IconComp = section ? Icons[section.icon] : Icons.Folder;\n                        return (\n                          <>\n                            {IconComp && <IconComp size={14} />}\n                            {formatSectionLabel(currentItem.section)}\n                          </>\n                        );\n                      })()}\n                    </div>\n                  )}\n                </div>\n\n                {/* Tags */}\n                <div className={styles.metadataRow}>\n                  <label>Tag</label>\n                  {isEditing ? (\n                    <input\n                      type=\"text\"\n                      value={editData.tag}\n                      onChange={(e) => setEditData(prev => ({ ...prev, tag: e.target.value }))}\n                      className={styles.metadataSelect}\n                      placeholder=\"Add a tag...\"\n                    />\n                  ) : (\n                    <div className={styles.tags}>\n                      {currentItem.tag ? (\n                        <span className={styles.tag}>{currentItem.tag}</span>\n                      ) : (\n                        <span className={styles.noData}>No tag</span>\n                      )}\n                    </div>\n                  )}\n                </div>\n\n                {/* Notes */}\n                <div className={styles.metadataRow}>\n                  <label>Notes</label>\n                  {isEditing ? (\n                    <textarea\n                      value={editData.note}\n                      onChange={(e) => setEditData(prev => ({ ...prev, note: e.target.value }))}\n                      className={styles.metadataTextarea}\n                      placeholder=\"Add notes about this photo...\"\n                      rows={4}\n                    />\n                  ) : (\n                    <p className={styles.notes}>\n                      {currentItem.originalNotes || <span className={styles.noData}>No notes</span>}\n                    </p>\n                  )}\n                </div>\n\n                {/* File Info */}\n                <div className={styles.metadataRow}>\n                  <label>Details</label>\n                  <div className={styles.fileInfo}>\n                    <div><span>Filename:</span> {currentItem.fileName || 'Unknown'}</div>\n                    <div><span>Captured:</span> {currentItem.capturedAt ? new Date(currentItem.capturedAt).toLocaleDateString() : 'Unknown'}</div>\n                    {currentItem.fileSize && (\n                      <div><span>Size:</span> {(currentItem.fileSize / 1024 / 1024).toFixed(2)} MB</div>\n                    )}\n                  </div>\n                </div>\n\n                {/* Save/Cancel buttons when editing */}\n                {isEditing && (\n                  <div className={styles.editActions}>\n                    <Button variant=\"secondary\" onClick={() => setIsEditing(false)}>\n                      Cancel\n                    </Button>\n                    <Button variant=\"primary\" onClick={handleSave} disabled={saving}>\n                      {saving ? 'Saving...' : 'Save Changes'}\n                    </Button>\n                  </div>\n                )}\n              </div>\n            </motion.div>\n          )}\n        </div>\n\n        {/* Thumbnail Strip */}\n        <div className={styles.thumbnailStrip}>\n          {media.map((item, idx) => (\n            <motion.button\n              key={item.id}\n              className={`${styles.thumbnail} ${idx === currentIndex ? styles.active : ''}`}\n              onClick={() => onNavigate(idx - currentIndex)}\n              whileHover={{ scale: 1.1 }}\n              whileTap={{ scale: 0.95 }}\n            >\n              <img src={item.thumbUrl || item.thumbnail_url || item.url} alt=\"\" />\n            </motion.button>\n          ))}\n        </div>\n      </div>\n    </motion.div>\n  );\n};\n\n// Icon Components (inline SVGs)\nconst UploadIcon = ({ className }) => (\n  <svg className={className} width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <path d=\"M10 14V3M10 3L6 7M10 3L14 7\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n    <path d=\"M3 14v2a2 2 0 002 2h10a2 2 0 002-2v-2\" strokeLinecap=\"round\"/>\n  </svg>\n);\n\nconst TrashIcon = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <path d=\"M2 4h12M5.5 4V2.5a1 1 0 011-1h3a1 1 0 011 1V4M13 4v9a2 2 0 01-2 2H5a2 2 0 01-2-2V4\" strokeLinecap=\"round\"/>\n  </svg>\n);\n\nconst CheckIcon = ({ className }) => (\n  <svg className={className} viewBox=\"0 0 16 16\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\">\n    <path d=\"M3 8l3.5 3.5L13 5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n  </svg>\n);\n\nconst PlayIcon = () => (\n  <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n    <path d=\"M8 5v14l11-7z\"/>\n  </svg>\n);\n\nconst ZoomIcon = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <circle cx=\"7\" cy=\"7\" r=\"4\"/>\n    <path d=\"M14 14l-3.5-3.5\" strokeLinecap=\"round\"/>\n    <path d=\"M7 5v4M5 7h4\" strokeLinecap=\"round\"/>\n  </svg>\n);\n\nconst CloseIcon = () => (\n  <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <path d=\"M15 5L5 15M5 5l10 10\" strokeLinecap=\"round\"/>\n  </svg>\n);\n\nconst ChevronLeftIcon = () => (\n  <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <path d=\"M15 18l-6-6 6-6\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n  </svg>\n);\n\nconst ChevronRightIcon = () => (\n  <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <path d=\"M9 18l6-6-6-6\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n  </svg>\n);\n\nconst PhotoIcon = ({ className }) => (\n  <svg className={className} width=\"64\" height=\"64\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n    <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"/>\n    <circle cx=\"8.5\" cy=\"8.5\" r=\"1.5\"/>\n    <polyline points=\"21 15 16 10 5 21\"/>\n  </svg>\n);\n\nconst VideoIcon = ({ className }) => (\n  <svg className={className} width=\"64\" height=\"64\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n    <polygon points=\"23 7 16 12 23 17 23 7\"/>\n    <rect x=\"1\" y=\"5\" width=\"15\" height=\"14\" rx=\"2\" ry=\"2\"/>\n  </svg>\n);\n\nexport default MediaGallery;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\PhotoPlaceholder.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\ProjectDetailsForm.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\ProjectInformationForm.js","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'isFormValid'. Either include it or remove the dependency array.","line":157,"column":6,"nodeType":"ArrayExpression","endLine":157,"endColumn":34,"suggestions":[{"desc":"Update the dependencies array to be: [formData, isFormValid, onValidityChange]","fix":{"range":[5651,5679],"text":"[formData, isFormValid, onValidityChange]"}}]},{"ruleId":"no-unused-vars","severity":1,"message":"'handleUploadDocs' is assigned a value but never used.","line":312,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":312,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, forwardRef, useImperativeHandle } from 'react';\r\nimport styles from './ProjectInformationForm.module.css';\r\nimport axios from '../../config/axios';\r\nimport AddressAutocomplete from '../common/AddressAutocomplete';\r\nimport { toast } from 'react-toastify';\r\nimport { triggerPlanAutomation, fetchTriggerSecret } from '../../utils/triggerPlanAutomation';\r\nimport { EquipmentRow, FormFieldRow, TableDropdown, Button, LoadingSpinner, Alert } from '../ui';\r\nimport logger from '../../services/devLogger';\r\nimport documentService from '../../services/documentService';\r\nimport { isCurrentUserAdminAsync } from '../../utils/adminUtils';\r\n\r\nconst STATUS_OPTIONS = [\r\n  { label: 'Sales', value: '0' },\r\n  { label: 'Survey', value: '1' },\r\n  { label: 'Design', value: '2' },\r\n  { label: 'Revisions', value: '3' },\r\n  { label: 'Permits', value: '4' },\r\n  { label: 'Install', value: '5' },\r\n  { label: 'Commish', value: '6' },\r\n  { label: 'Inspect', value: '7' },\r\n  { label: 'PTO', value: '8' },\r\n];\r\n\r\nconst US_STATES = [\r\n  { label: 'Alabama', value: 'AL' },\r\n  { label: 'Alaska', value: 'AK' },\r\n  { label: 'Arizona', value: 'AZ' },\r\n  { label: 'Arkansas', value: 'AR' },\r\n  { label: 'California', value: 'CA' },\r\n  { label: 'Colorado', value: 'CO' },\r\n  { label: 'Connecticut', value: 'CT' },\r\n  { label: 'Delaware', value: 'DE' },\r\n  { label: 'Florida', value: 'FL' },\r\n  { label: 'Georgia', value: 'GA' },\r\n  { label: 'Hawaii', value: 'HI' },\r\n  { label: 'Idaho', value: 'ID' },\r\n  { label: 'Illinois', value: 'IL' },\r\n  { label: 'Indiana', value: 'IN' },\r\n  { label: 'Iowa', value: 'IA' },\r\n  { label: 'Kansas', value: 'KS' },\r\n  { label: 'Kentucky', value: 'KY' },\r\n  { label: 'Louisiana', value: 'LA' },\r\n  { label: 'Maine', value: 'ME' },\r\n  { label: 'Maryland', value: 'MD' },\r\n  { label: 'Massachusetts', value: 'MA' },\r\n  { label: 'Michigan', value: 'MI' },\r\n  { label: 'Minnesota', value: 'MN' },\r\n  { label: 'Mississippi', value: 'MS' },\r\n  { label: 'Missouri', value: 'MO' },\r\n  { label: 'Montana', value: 'MT' },\r\n  { label: 'Nebraska', value: 'NE' },\r\n  { label: 'Nevada', value: 'NV' },\r\n  { label: 'New Hampshire', value: 'NH' },\r\n  { label: 'New Jersey', value: 'NJ' },\r\n  { label: 'New Mexico', value: 'NM' },\r\n  { label: 'New York', value: 'NY' },\r\n  { label: 'North Carolina', value: 'NC' },\r\n  { label: 'North Dakota', value: 'ND' },\r\n  { label: 'Ohio', value: 'OH' },\r\n  { label: 'Oklahoma', value: 'OK' },\r\n  { label: 'Oregon', value: 'OR' },\r\n  { label: 'Pennsylvania', value: 'PA' },\r\n  { label: 'Rhode Island', value: 'RI' },\r\n  { label: 'South Carolina', value: 'SC' },\r\n  { label: 'South Dakota', value: 'SD' },\r\n  { label: 'Tennessee', value: 'TN' },\r\n  { label: 'Texas', value: 'TX' },\r\n  { label: 'Utah', value: 'UT' },\r\n  { label: 'Vermont', value: 'VT' },\r\n  { label: 'Virginia', value: 'VA' },\r\n  { label: 'Washington', value: 'WA' },\r\n  { label: 'West Virginia', value: 'WV' },\r\n  { label: 'Wisconsin', value: 'WI' },\r\n  { label: 'Wyoming', value: 'WY' },\r\n];\r\n\r\nconst ProjectInformationForm = forwardRef(({ onNext, hideSubmitButton = false, onValidityChange }, ref) => {\r\n  const [formData, setFormData] = useState({\r\n    installer: '',\r\n    projectID: `SFSD${Math.floor(Date.now() / 1000)}`,\r\n    firstName: '',\r\n    lastName: '',\r\n    address: '',\r\n    city: '',\r\n    state: '',\r\n    zip: '',\r\n    status: '2',\r\n  });\r\n\r\n  const [errors, setErrors] = useState({});\r\n  const [loading, setLoading] = useState(false);\r\n  const [installersList, setInstallersList] = useState([]);\r\n  const [isAdmin, setIsAdmin] = useState(false);\r\n\r\n  // Upload states\r\n  const [salesProposal, setSalesProposal] = useState(null);\r\n  const [supportingDocs, setSupportingDocs] = useState([]);\r\n  const [uploadingProposal, setUploadingProposal] = useState(false);\r\n  const [uploadingDocs, setUploadingDocs] = useState(false);\r\n\r\n  // EquipmentRow expansion states\r\n  const [proposalExpanded, setProposalExpanded] = useState(false);\r\n  const [projectInfoExpanded, setProjectInfoExpanded] = useState(true);\r\n  const [customerExpanded, setCustomerExpanded] = useState(true);\r\n  const [locationExpanded, setLocationExpanded] = useState(false);\r\n  const [documentsExpanded, setDocumentsExpanded] = useState(false);\r\n\r\n  // Check if form is valid\r\n  const isFormValid = () => {\r\n    return (\r\n      formData.installer?.trim() &&\r\n      formData.projectID?.trim() &&\r\n      formData.firstName?.trim() &&\r\n      formData.lastName?.trim() &&\r\n      formData.address?.trim() &&\r\n      formData.city?.trim() &&\r\n      formData.state &&\r\n      formData.zip?.trim()\r\n    );\r\n  };\r\n\r\n  // Expose submit function and validation to parent via ref\r\n  useImperativeHandle(ref, () => ({\r\n    submitForm: () => {\r\n      handleSubmit(new Event('submit'));\r\n    },\r\n    isValid: isFormValid\r\n  }));\r\n\r\n  useEffect(() => {\r\n    // Check admin status and initialize form\r\n    const initializeForm = async () => {\r\n      // Verify admin status with backend\r\n      const isAdminUser = await isCurrentUserAdminAsync();\r\n      setIsAdmin(isAdminUser);\r\n\r\n      // Fetch companies for admin users\r\n      if (isAdminUser) {\r\n        fetchCompanies();\r\n      } else {\r\n        // For regular users, set their company as installer\r\n        const companyData = JSON.parse(sessionStorage.getItem('companyData') || '{}');\r\n        if (companyData.name) {\r\n          setFormData(prev => ({ ...prev, installer: companyData.name }));\r\n        }\r\n      }\r\n    };\r\n\r\n    initializeForm();\r\n  }, []);\r\n\r\n  // Track form validity and notify parent\r\n  useEffect(() => {\r\n    if (onValidityChange) {\r\n      onValidityChange(isFormValid());\r\n    }\r\n  }, [formData, onValidityChange]);\r\n\r\n  const fetchCompanies = async () => {\r\n    try {\r\n      const response = await axios.get('/companies/list-active');\r\n      if (response.data.status === 'SUCCESS' && Array.isArray(response.data.data)) {\r\n        const companies = response.data.data.map(company => ({\r\n          label: company.name,\r\n          value: company.name,\r\n          uuid: company.uuid,\r\n        }));\r\n        setInstallersList(companies);\r\n      }\r\n    } catch (error) {\r\n      logger.error('Project', 'Error fetching companies:', error);\r\n    }\r\n  };\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setFormData(prev => ({ ...prev, [name]: value }));\r\n\r\n    // Clear error for this field if it has a value\r\n    if (errors[name] && value.trim()) {\r\n      setErrors(prev => {\r\n        const newErrors = { ...prev };\r\n        delete newErrors[name];\r\n        return newErrors;\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleAddressSelect = (details) => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      address: details.address || '',\r\n      city: details.city || '',\r\n      state: details.state || '',\r\n      zip: details.zip || '',\r\n    }));\r\n\r\n    // Clear errors for address fields that have values\r\n    setErrors(prev => {\r\n      const newErrors = { ...prev };\r\n      if (details.address) delete newErrors.address;\r\n      if (details.city) delete newErrors.city;\r\n      if (details.state) delete newErrors.state;\r\n      if (details.zip) delete newErrors.zip;\r\n      return newErrors;\r\n    });\r\n  };\r\n\r\n  // Handle sales proposal file selection\r\n  const handleSalesProposalSelect = (e) => {\r\n    const file = e.target.files[0];\r\n    if (file) {\r\n      logger.log('Project', 'Sales proposal selected:', file.name, file.type);\r\n      setSalesProposal(file);\r\n      setTimeout(() => {\r\n        e.target.value = '';\r\n      }, 100);\r\n    }\r\n  };\r\n\r\n  // Handle supporting documents selection\r\n  const handleSupportingDocsSelect = (e) => {\r\n    const files = Array.from(e.target.files);\r\n    setSupportingDocs(prev => [...prev, ...files]);\r\n    e.target.value = '';\r\n  };\r\n\r\n  // Remove sales proposal\r\n  const handleRemoveSalesProposal = () => {\r\n    setSalesProposal(null);\r\n    const fileInput = document.getElementById('salesProposalInput');\r\n    if (fileInput) {\r\n      fileInput.value = '';\r\n    }\r\n  };\r\n\r\n  // Remove supporting document\r\n  const handleRemoveSupportingDoc = (index) => {\r\n    setSupportingDocs(prev => prev.filter((_, i) => i !== index));\r\n  };\r\n\r\n  // Drag and drop handlers for sales proposal\r\n  const handleSalesProposalDragOver = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n  };\r\n\r\n  const handleSalesProposalDrop = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    const file = e.dataTransfer.files[0];\r\n    logger.log('Project', 'File dropped:', file?.name, file?.type);\r\n    if (file && file.type === 'application/pdf') {\r\n      logger.log('Project', 'Valid PDF dropped:', file.name);\r\n      setSalesProposal(file);\r\n    } else {\r\n      logger.log('Project', 'Invalid file type - only PDF accepted');\r\n    }\r\n  };\r\n\r\n  // Drag and drop handlers for supporting documents\r\n  const handleSupportingDocsDragOver = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n  };\r\n\r\n  const handleSupportingDocsDrop = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    const files = Array.from(e.dataTransfer.files);\r\n    setSupportingDocs(prev => [...prev, ...files]);\r\n  };\r\n\r\n  // Upload sales proposal\r\n  const handleUploadProposal = async () => {\r\n    if (!salesProposal) return;\r\n\r\n    if (!formData.uuid) {\r\n      toast.info('Sales proposal will be uploaded after project creation', {\r\n        position: 'top-right',\r\n        autoClose: 3000,\r\n      });\r\n      return;\r\n    }\r\n\r\n    setUploadingProposal(true);\r\n    try {\r\n      logger.log('Project', 'Uploading sales proposal:', salesProposal.name);\r\n\r\n      await documentService.documents.upload(formData.uuid, salesProposal, {\r\n        documentType: 'sales_proposal'\r\n      });\r\n\r\n      toast.success('Sales proposal uploaded successfully!', {\r\n        position: 'top-right',\r\n        autoClose: 3000,\r\n      });\r\n\r\n      setSalesProposal(null);\r\n    } catch (error) {\r\n      logger.error('Project', 'Error uploading sales proposal:', error);\r\n      toast.error('Failed to upload sales proposal: ' + error.message, {\r\n        position: 'top-right',\r\n        autoClose: 3000,\r\n      });\r\n    } finally {\r\n      setUploadingProposal(false);\r\n    }\r\n  };\r\n\r\n  // Upload supporting documents\r\n  const handleUploadDocs = async () => {\r\n    if (supportingDocs.length === 0) return;\r\n\r\n    if (!formData.uuid) {\r\n      toast.info('Supporting documents will be uploaded after project creation', {\r\n        position: 'top-right',\r\n        autoClose: 3000,\r\n      });\r\n      return;\r\n    }\r\n\r\n    setUploadingDocs(true);\r\n    try {\r\n      logger.log('Project', 'Uploading supporting documents:', supportingDocs.map(d => d.name));\r\n\r\n      await documentService.documents.uploadBulk(formData.uuid, supportingDocs, {\r\n        documentType: 'supporting'\r\n      });\r\n\r\n      toast.success('Supporting documents uploaded successfully!', {\r\n        position: 'top-right',\r\n        autoClose: 3000,\r\n      });\r\n\r\n      setSupportingDocs([]);\r\n    } catch (error) {\r\n      logger.error('Project', 'Error uploading documents:', error);\r\n      toast.error('Failed to upload documents: ' + error.message, {\r\n        position: 'top-right',\r\n        autoClose: 3000,\r\n      });\r\n    } finally {\r\n      setUploadingDocs(false);\r\n    }\r\n  };\r\n\r\n  const validate = () => {\r\n    const newErrors = {};\r\n\r\n    if (!formData.installer.trim()) newErrors.installer = 'Installer is required';\r\n    if (!formData.projectID.trim()) newErrors.projectID = 'Project ID is required';\r\n    if (!formData.firstName.trim()) newErrors.firstName = 'First name is required';\r\n    if (!formData.lastName.trim()) newErrors.lastName = 'Last name is required';\r\n    if (!formData.address.trim()) newErrors.address = 'Address is required';\r\n    if (!formData.city.trim()) newErrors.city = 'City is required';\r\n    if (!formData.state) newErrors.state = 'State is required';\r\n    if (!formData.zip.trim()) newErrors.zip = 'ZIP code is required';\r\n\r\n    setErrors(newErrors);\r\n    return Object.keys(newErrors).length === 0;\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    if (!validate()) {\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n\r\n    try {\r\n      // Get company UUID\r\n      const companyData = JSON.parse(sessionStorage.getItem('companyData') || '{}');\r\n      let companyUuid = companyData.uuid;\r\n\r\n      // For admin users, get selected company UUID\r\n      if (isAdmin) {\r\n        const selectedCompany = installersList.find(c => c.value === formData.installer);\r\n        if (selectedCompany) {\r\n          companyUuid = selectedCompany.uuid;\r\n        }\r\n      }\r\n\r\n      if (!companyUuid) {\r\n        throw new Error('Company information not found');\r\n      }\r\n\r\n      // Create project\r\n      const createResponse = await axios.post('/project', {\r\n        company_id: companyUuid,\r\n        installer_name: formData.installer,\r\n        installer_project_id: formData.projectID,\r\n        customer_first_name: formData.firstName,\r\n        customer_last_name: formData.lastName,\r\n        completed_step: parseInt(formData.status, 10),\r\n      });\r\n\r\n      if (createResponse.data.status === 'SUCCESS' && createResponse.data.project) {\r\n        const projectUuid = createResponse.data.project.uuid;\r\n\r\n        // Save site information\r\n        try {\r\n          const sitePayload = {\r\n            companyId: companyUuid,\r\n            address: formData.address || '',\r\n            city: formData.city || '',\r\n            state: formData.state || '',\r\n            zipCode: formData.zip || '',\r\n            apn: formData.apn || '',\r\n            ahj: formData.jurisdiction || '',\r\n            utility: formData.utility || '',\r\n          };\r\n\r\n          await axios.put(`/project/${projectUuid}/site-info`, sitePayload);\r\n        } catch (siteError) {\r\n          logger.error('Project', 'Failed to save site information:', siteError);\r\n\r\n          // Show warning but don't block project creation\r\n          toast.warning('Project created, but address could not be saved. Please update it in the project details.', {\r\n            position: 'top-right',\r\n            autoClose: 5000,\r\n          });\r\n        }\r\n\r\n        toast.success('Project created successfully!', {\r\n          position: 'top-right',\r\n          autoClose: 3000,\r\n        });\r\n\r\n        // Trigger automations (non-blocking)\r\n        const triggerAutomations = async () => {\r\n          try {\r\n            const secretToken = await fetchTriggerSecret();\r\n            const userData = JSON.parse(sessionStorage.getItem('userData') || '{}');\r\n            const userUuid = userData.uuid || userData.id;\r\n\r\n            const automationOptions = {\r\n              companyUuid,\r\n              userUuid,\r\n              computerName: 'ServerComputer2',\r\n            };\r\n\r\n            try {\r\n              logger.log('Project', 'ðŸš€ Triggering NewProject automation for project:', projectUuid);\r\n              await triggerPlanAutomation(\r\n                projectUuid,\r\n                secretToken,\r\n                'NewProject',\r\n                automationOptions\r\n              );\r\n              logger.log('Project', 'âœ… NewProject automation triggered successfully');\r\n              toast.info('Project automation started', {\r\n                position: 'top-right',\r\n                autoClose: 2000,\r\n              });\r\n            } catch (err) {\r\n              logger.warn('Project', 'âš ï¸ NewProject trigger failed (non-blocking):', err);\r\n              toast.warning('Project automation could not be started', {\r\n                position: 'top-right',\r\n                autoClose: 3000,\r\n              });\r\n            }\r\n\r\n            try {\r\n              logger.log('Project', 'ðŸš€ Triggering AHJ Lookup for project:', projectUuid);\r\n              await triggerPlanAutomation(\r\n                projectUuid,\r\n                secretToken,\r\n                'AHJLookup',\r\n                automationOptions\r\n              );\r\n              logger.log('Project', 'âœ… AHJ Lookup triggered successfully');\r\n            } catch (err) {\r\n              logger.warn('Project', 'âš ï¸ AHJ Lookup trigger failed (non-blocking):', err);\r\n            }\r\n          } catch (error) {\r\n            logger.error('Project', 'âŒ Failed to trigger automations:', error);\r\n          }\r\n        };\r\n\r\n        triggerAutomations();\r\n\r\n        // Reset form\r\n        const resetInstaller = isAdmin ? '' : (companyData.name || '');\r\n\r\n        setFormData({\r\n          installer: resetInstaller,\r\n          projectID: `SFSD${Math.floor(Date.now() / 1000)}`,\r\n          firstName: '',\r\n          lastName: '',\r\n          address: '',\r\n          city: '',\r\n          state: '',\r\n          zip: '',\r\n          status: '0',\r\n        });\r\n\r\n        setErrors({});\r\n\r\n        if (onNext) {\r\n          onNext(projectUuid);\r\n        }\r\n      } else {\r\n        throw new Error('Failed to create project');\r\n      }\r\n    } catch (error) {\r\n      logger.error('Project', 'Error creating project:', error);\r\n\r\n      if (error.response?.status === 409) {\r\n        toast.error('A project with this Installer Project ID already exists. Please use a unique ID.', {\r\n          position: 'top-center',\r\n          autoClose: 5000,\r\n        });\r\n      } else {\r\n        toast.error(error.response?.data?.message || 'Failed to create project. Please try again.', {\r\n          position: 'top-center',\r\n          autoClose: 4000,\r\n        });\r\n      }\r\n      return;\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Generate subtitles for collapsed state\r\n  const getProposalSubtitle = () => {\r\n    if (salesProposal) return salesProposal.name;\r\n    return 'Optional';\r\n  };\r\n\r\n  const getProjectInfoSubtitle = () => {\r\n    const parts = [];\r\n    if (formData.installer) parts.push(formData.installer);\r\n    if (formData.projectID) parts.push(formData.projectID);\r\n    return parts.length > 0 ? parts.join(' â€¢ ') : null;\r\n  };\r\n\r\n  const getCustomerSubtitle = () => {\r\n    const parts = [];\r\n    if (formData.firstName) parts.push(formData.firstName);\r\n    if (formData.lastName) parts.push(formData.lastName);\r\n    return parts.length > 0 ? parts.join(' ') : null;\r\n  };\r\n\r\n  const getLocationSubtitle = () => {\r\n    const parts = [];\r\n    if (formData.address) parts.push(formData.address);\r\n    if (formData.city) parts.push(formData.city);\r\n    if (formData.state) parts.push(formData.state);\r\n    if (formData.zip) parts.push(formData.zip);\r\n    return parts.length > 0 ? parts.join(', ') : null;\r\n  };\r\n\r\n  const getDocumentsSubtitle = () => {\r\n    if (supportingDocs.length > 0) {\r\n      return `${supportingDocs.length} file${supportingDocs.length !== 1 ? 's' : ''}`;\r\n    }\r\n    return 'Optional';\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} className={styles.form}>\r\n      {/* Upload Sales Proposal Section */}\r\n      <EquipmentRow\r\n        title=\"Upload Sales Proposal\"\r\n        subtitle={getProposalSubtitle()}\r\n        initiallyExpanded={proposalExpanded}\r\n        expanded={proposalExpanded}\r\n        onToggle={() => setProposalExpanded(!proposalExpanded)}\r\n      >\r\n        <div className={styles.uploadSection}>\r\n          <input\r\n            type=\"file\"\r\n            id=\"salesProposalInput\"\r\n            accept=\".pdf\"\r\n            onChange={handleSalesProposalSelect}\r\n            className={styles.hiddenInput}\r\n          />\r\n\r\n          <label\r\n            htmlFor=\"salesProposalInput\"\r\n            className={styles.uploadArea}\r\n            onDragOver={handleSalesProposalDragOver}\r\n            onDrop={handleSalesProposalDrop}\r\n          >\r\n            <span className={styles.uploadText}>\r\n              {salesProposal ? salesProposal.name : 'Click to Upload PDF'}\r\n            </span>\r\n            {salesProposal && (\r\n              <button\r\n                type=\"button\"\r\n                onClick={(e) => {\r\n                  e.preventDefault();\r\n                  handleRemoveSalesProposal();\r\n                }}\r\n                className={styles.removeButton}\r\n              >\r\n                âœ•\r\n              </button>\r\n            )}\r\n          </label>\r\n\r\n          <Button\r\n            variant={salesProposal ? 'primary' : 'secondary'}\r\n            onClick={handleUploadProposal}\r\n            disabled={!salesProposal || uploadingProposal}\r\n            loading={uploadingProposal}\r\n          >\r\n            Autofill from Proposal\r\n          </Button>\r\n\r\n          {uploadingProposal && (\r\n            <div className={styles.loadingRow}>\r\n              <LoadingSpinner size=\"md\" />\r\n              <span className={styles.loadingText}>Scraping proposal data...</span>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </EquipmentRow>\r\n\r\n      {/* OR Divider */}\r\n      <div className={styles.divider}>\r\n        <div className={styles.dividerLine} />\r\n        <span className={styles.dividerText}>OR</span>\r\n        <div className={styles.dividerLine} />\r\n      </div>\r\n\r\n      {/* Project Information Section */}\r\n      <EquipmentRow\r\n        title=\"Project Information\"\r\n        subtitle={getProjectInfoSubtitle()}\r\n        initiallyExpanded={projectInfoExpanded}\r\n        expanded={projectInfoExpanded}\r\n        onToggle={() => setProjectInfoExpanded(!projectInfoExpanded)}\r\n      >\r\n        {isAdmin ? (\r\n          <TableDropdown\r\n            label=\"Installer\"\r\n            value={formData.installer}\r\n            onChange={(value) => handleChange({ target: { name: 'installer', value } })}\r\n            options={installersList}\r\n            placeholder=\"Select Installer\"\r\n          />\r\n        ) : (\r\n          <FormFieldRow label=\"Installer\">\r\n            <input\r\n              type=\"text\"\r\n              name=\"installer\"\r\n              value={formData.installer}\r\n              readOnly\r\n              className={styles.inputReadOnly}\r\n            />\r\n          </FormFieldRow>\r\n        )}\r\n\r\n        <FormFieldRow label=\"Installer Project ID\">\r\n          <input\r\n            type=\"text\"\r\n            name=\"projectID\"\r\n            value={formData.projectID}\r\n            onChange={handleChange}\r\n            className={styles.input}\r\n          />\r\n        </FormFieldRow>\r\n\r\n        <TableDropdown\r\n          label=\"Set Status To\"\r\n          value={formData.status}\r\n          onChange={(value) => handleChange({ target: { name: 'status', value } })}\r\n          options={STATUS_OPTIONS}\r\n        />\r\n      </EquipmentRow>\r\n\r\n      {/* Customer Section */}\r\n      <EquipmentRow\r\n        title=\"Customer\"\r\n        subtitle={getCustomerSubtitle()}\r\n        initiallyExpanded={customerExpanded}\r\n        expanded={customerExpanded}\r\n        onToggle={() => setCustomerExpanded(!customerExpanded)}\r\n      >\r\n        <FormFieldRow label=\"First Name\">\r\n          <input\r\n            type=\"text\"\r\n            name=\"firstName\"\r\n            value={formData.firstName}\r\n            onChange={handleChange}\r\n            placeholder=\"First Name...\"\r\n            className={styles.input}\r\n          />\r\n        </FormFieldRow>\r\n\r\n        <FormFieldRow label=\"Last Name\" noBorder>\r\n          <input\r\n            type=\"text\"\r\n            name=\"lastName\"\r\n            value={formData.lastName}\r\n            onChange={handleChange}\r\n            placeholder=\"Last Name...\"\r\n            className={styles.input}\r\n          />\r\n        </FormFieldRow>\r\n      </EquipmentRow>\r\n\r\n      {/* Location Section */}\r\n      <EquipmentRow\r\n        title=\"Location\"\r\n        subtitle={getLocationSubtitle()}\r\n        initiallyExpanded={locationExpanded}\r\n        expanded={locationExpanded}\r\n        onToggle={() => setLocationExpanded(!locationExpanded)}\r\n      >\r\n        <FormFieldRow label=\"Address\">\r\n          <AddressAutocomplete\r\n            value={formData.address}\r\n            onChange={(value) => setFormData(prev => ({ ...prev, address: value }))}\r\n            onAddressSelect={handleAddressSelect}\r\n            error={errors.address}\r\n            className={styles.input}\r\n          />\r\n        </FormFieldRow>\r\n\r\n        <FormFieldRow label=\"City\">\r\n          <input\r\n            type=\"text\"\r\n            name=\"city\"\r\n            value={formData.city}\r\n            onChange={handleChange}\r\n            placeholder=\"City...\"\r\n            className={styles.input}\r\n          />\r\n        </FormFieldRow>\r\n\r\n        <TableDropdown\r\n          label=\"State\"\r\n          value={formData.state}\r\n          onChange={(value) => handleChange({ target: { name: 'state', value } })}\r\n          options={US_STATES}\r\n          placeholder=\"State\"\r\n        />\r\n\r\n        <FormFieldRow label=\"ZIP\" noBorder>\r\n          <input\r\n            type=\"text\"\r\n            name=\"zip\"\r\n            value={formData.zip}\r\n            onChange={handleChange}\r\n            placeholder=\"ZIP...\"\r\n            className={styles.input}\r\n          />\r\n        </FormFieldRow>\r\n      </EquipmentRow>\r\n\r\n      {/* Documents Section */}\r\n      <EquipmentRow\r\n        title=\"Documents\"\r\n        subtitle={getDocumentsSubtitle()}\r\n        initiallyExpanded={documentsExpanded}\r\n        expanded={documentsExpanded}\r\n        onToggle={() => setDocumentsExpanded(!documentsExpanded)}\r\n      >\r\n        <div className={styles.uploadSection}>\r\n          <input\r\n            type=\"file\"\r\n            id=\"supportingDocsInput\"\r\n            accept=\".pdf,.doc,.docx,.jpg,.jpeg,.png\"\r\n            multiple\r\n            onChange={handleSupportingDocsSelect}\r\n            className={styles.hiddenInput}\r\n          />\r\n\r\n          {supportingDocs.length === 0 ? (\r\n            <label\r\n              htmlFor=\"supportingDocsInput\"\r\n              className={styles.uploadArea}\r\n              onDragOver={handleSupportingDocsDragOver}\r\n              onDrop={handleSupportingDocsDrop}\r\n            >\r\n              <span className={styles.uploadText}>Click to Upload</span>\r\n            </label>\r\n          ) : (\r\n            <div className={styles.fileList}>\r\n              {supportingDocs.map((doc, index) => (\r\n                <div key={index} className={styles.fileRow}>\r\n                  <span className={styles.fileName}>{doc.name}</span>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={(e) => {\r\n                      e.preventDefault();\r\n                      e.stopPropagation();\r\n                      handleRemoveSupportingDoc(index);\r\n                    }}\r\n                    className={styles.removeButton}\r\n                  >\r\n                    âœ•\r\n                  </button>\r\n                </div>\r\n              ))}\r\n              <label htmlFor=\"supportingDocsInput\" className={styles.addMore}>\r\n                + Add More\r\n              </label>\r\n            </div>\r\n          )}\r\n\r\n          {uploadingDocs && (\r\n            <div className={styles.loadingRow}>\r\n              <LoadingSpinner size=\"md\" />\r\n              <span className={styles.loadingText}>Uploading documents...</span>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </EquipmentRow>\r\n\r\n      {/* Error Message */}\r\n      {Object.keys(errors).length > 0 && (\r\n        <Alert variant=\"error\" className={styles.errorAlert}>\r\n          Fill Required Fields\r\n        </Alert>\r\n      )}\r\n\r\n      {/* Submit Button */}\r\n      {!hideSubmitButton && (\r\n        <div className={styles.submitSection}>\r\n          <Button\r\n            type=\"submit\"\r\n            variant=\"primary\"\r\n            disabled={loading}\r\n            loading={loading}\r\n          >\r\n            {loading ? 'Creating...' : '+ Create Project'}\r\n          </Button>\r\n        </div>\r\n      )}\r\n    </form>\r\n  );\r\n});\r\n\r\nProjectInformationForm.displayName = 'ProjectInformationForm';\r\n\r\nexport default ProjectInformationForm;\r\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\ProjectOverview.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16},{"ruleId":"no-unused-vars","severity":1,"message":"'customerName' is assigned a value but never used.","line":483,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":483,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { Button, FormFieldRow, TableDropdown, EquipmentRow } from '../ui';\nimport SystemContainer from './equipment/SystemContainer';\nimport axios from '../../config/axios';\nimport logger from '../../services/devLogger';\nimport { toast } from 'react-toastify';\n\n// Common jurisdictions (AHJs)\nconst JURISDICTIONS = [\n  // Arizona\n  'Phoenix',\n  'Tucson',\n  'Mesa',\n  'Chandler',\n  'Scottsdale',\n  'Glendale',\n  'Gilbert',\n  'Tempe',\n  'Peoria',\n  'Surprise',\n  'Maricopa County',\n  'Pima County',\n  // California\n  'Los Angeles County',\n  'San Diego County',\n  'Orange County',\n  'Riverside County',\n  'San Bernardino County',\n  'Sacramento County',\n  'Alameda County',\n  'Santa Clara County',\n  'Contra Costa County',\n  'Fresno County',\n];\n\n// Common utilities\nconst UTILITIES = [\n  // Arizona\n  'Arizona Public Service (APS)',\n  'Salt River Project (SRP)',\n  'Tucson Electric Power (TEP)',\n  'Trico Electric Cooperative (TRICO)',\n  'UniSource Energy Services (UniSource)',\n  'Sulphur Springs Valley Electric Cooperative',\n  // California\n  'Pacific Gas & Electric (PG&E)',\n  'Southern California Edison (SCE)',\n  'San Diego Gas & Electric (SDG&E)',\n  'Los Angeles Department of Water and Power (LADWP)',\n  'Sacramento Municipal Utility District (SMUD)',\n  'Imperial Irrigation District (IID)',\n  'Anaheim Public Utilities',\n  'Riverside Public Utilities',\n  'Pasadena Water and Power',\n  'Glendale Water & Power',\n];\n\n/**\n * DisplayRow - Read-only row for displaying data\n */\nconst DisplayRow = ({ label, value }) => {\n  if (!value || value.trim() === '' || value === '-') return null;\n  return (\n    <FormFieldRow label={label}>\n      <div style={{ padding: '0.5rem', color: 'var(--text-primary)' }}>\n        {value}\n      </div>\n    </FormFieldRow>\n  );\n};\n\n/**\n * ProjectOverview - Reusable project overview component\n * Shows site information (editable) and system details (read-only)\n *\n * @param {object} projectData - Full project data object\n * @param {object} systemDetails - System details from useSystemDetails hook\n * @param {boolean} readOnly - If true, site fields are read-only (default: false)\n */\nconst ProjectOverview = ({ projectData, systemDetails, readOnly = false }) => {\n  // Safe defaults\n  const site = projectData?.site || {};\n  const details = projectData?.details || {};\n  const projectUuid = projectData?.uuid;\n\n  // Site form state\n  const [siteFormData, setSiteFormData] = useState({\n    jurisdiction: '',\n    utility: '',\n    apn: '',\n    squareFootage: '',\n  });\n\n  // Customer form state\n  const [customerFormData, setCustomerFormData] = useState({\n    firstName: '',\n    lastName: '',\n  });\n\n  const [saveStatus, setSaveStatus] = useState('idle'); // 'idle', 'saving', 'saved', 'error'\n  const [customerSaveStatus, setCustomerSaveStatus] = useState('idle');\n  const [isHydrating, setIsHydrating] = useState(true);\n\n  // Lookup states\n  const [jurisdictions, setJurisdictions] = useState([]);\n  const [utilities, setUtilities] = useState([]);\n  const [jurisdictionLoading, setJurisdictionLoading] = useState(false);\n  const [utilityLoading, setUtilityLoading] = useState(false);\n  const [jurisdictionError, setJurisdictionError] = useState(null);\n  const [utilityError, setUtilityError] = useState(null);\n\n  const saveTimeoutRef = useRef(null);\n  const lastSavedDataRef = useRef(null);\n  const currentFormValuesRef = useRef(siteFormData);\n\n  // Auto-save function\n  const saveData = useCallback(async (data) => {\n    if (!projectUuid || isHydrating || readOnly) {\n      return;\n    }\n\n    // Check if data actually changed\n    const dataString = JSON.stringify(data);\n    if (dataString === lastSavedDataRef.current) {\n      return; // No changes, skip save\n    }\n\n    try {\n      setSaveStatus('saving');\n\n      const userData = JSON.parse(sessionStorage.getItem('userData') || '{}');\n      const companyId = userData?.company?.uuid;\n\n      if (!companyId) {\n        throw new Error('Company information not found');\n      }\n\n      // Build payload matching working SiteForm.js format\n      await axios.put(`/project/${projectUuid}/site-info`, {\n        companyId: companyId,\n        ahj: data.jurisdiction,\n        utility: data.utility,\n        apn: data.apn,\n        squareFootage: data.squareFootage ? parseFloat(data.squareFootage) : null,\n      });\n\n      lastSavedDataRef.current = dataString;\n      setSaveStatus('saved');\n\n      // Reset to idle after 2 seconds\n      setTimeout(() => setSaveStatus('idle'), 2000);\n    } catch (error) {\n      // Silently fail - validation errors expected for new projects\n      setSaveStatus('idle');\n\n      setTimeout(() => setSaveStatus('idle'), 3000);\n    }\n  }, [projectUuid, isHydrating, readOnly]);\n\n  // Save customer data function\n  const saveCustomerData = useCallback(async (data) => {\n    if (!projectUuid || isHydrating || readOnly) {\n      return;\n    }\n\n    try {\n      setCustomerSaveStatus('saving');\n\n      const userData = JSON.parse(sessionStorage.getItem('userData') || '{}');\n      const companyId = userData?.company?.uuid;\n\n      if (!companyId) {\n        throw new Error('Company information not found');\n      }\n\n      await axios.put(`/project/${projectUuid}`, {\n        companyId: companyId,\n        customer_first_name: data.firstName,\n        customer_last_name: data.lastName,\n      });\n\n      setCustomerSaveStatus('saved');\n      setTimeout(() => setCustomerSaveStatus('idle'), 2000);\n    } catch (error) {\n      logger.error('Project', 'Error saving customer information:', error);\n      setCustomerSaveStatus('error');\n      toast.error(`Failed to save customer: ${error.response?.data?.message || error.message}`, {\n        position: 'top-right',\n        autoClose: 3000,\n      });\n      setTimeout(() => setCustomerSaveStatus('idle'), 3000);\n    }\n  }, [projectUuid, isHydrating, readOnly]);\n\n  // Initialize form data from project data\n  useEffect(() => {\n    if (projectData?.site) {\n      setIsHydrating(true);\n\n      const initialData = {\n        jurisdiction: projectData.site.ahj || '',\n        utility: projectData.site.utility || '',\n        apn: projectData.site.apn || '',\n        squareFootage: projectData.site.squareFootage || '',\n      };\n\n      setSiteFormData(initialData);\n      currentFormValuesRef.current = initialData;\n      lastSavedDataRef.current = JSON.stringify(initialData);\n\n      // Allow saves after hydration completes\n      setTimeout(() => setIsHydrating(false), 250);\n    }\n\n    // Hydrate customer data\n    if (projectData?.details) {\n      setCustomerFormData({\n        firstName: projectData.details.customer_first_name || '',\n        lastName: projectData.details.customer_last_name || '',\n      });\n    }\n  }, [projectData]);\n\n  // Fetch utilities by zip code\n  useEffect(() => {\n    if (readOnly) {\n      return; // Skip API calls in read-only mode\n    }\n\n    const zipCode = site.zip_code;\n    if (!zipCode) {\n      setUtilities([]);\n      setUtilityError('Enter ZIP to load utilities');\n      return;\n    }\n\n    let isCancelled = false;\n\n    const fetchUtilities = async () => {\n      setUtilityLoading(true);\n      setUtilityError(null);\n\n      try {\n        const userData = JSON.parse(sessionStorage.getItem('userData') || '{}');\n        const companyId = userData?.company?.uuid;\n\n        const response = await axios.get(`/utility-zipcodes/zips/${zipCode}/utilities`, {\n          headers: companyId ? { 'X-Company-ID': companyId } : {},\n        });\n\n        if (isCancelled) return;\n\n        const utilityData = response.data?.data || response.data || [];\n\n        // Remove duplicates and sort\n        const uniqueUtilities = [...new Set(utilityData)].sort();\n\n        setUtilities(uniqueUtilities);\n\n        // Auto-select if only one utility and no current value (only in edit mode)\n        if (!readOnly) {\n          const currentUtility = currentFormValuesRef.current.utility;\n          if (uniqueUtilities.length === 1 && !currentUtility) {\n            const onlyUtility = uniqueUtilities[0];\n\n            // Update ref immediately to prevent loss during saves\n            currentFormValuesRef.current = {\n              ...currentFormValuesRef.current,\n              utility: onlyUtility,\n            };\n\n            setSiteFormData(prev => ({\n              ...prev,\n              utility: onlyUtility,\n            }));\n          }\n        }\n\n        if (uniqueUtilities.length === 0) {\n          setUtilityError(`No utilities for ${zipCode}`);\n        }\n      } catch (error) {\n        if (isCancelled) return;\n\n        console.error('[Site] Error fetching utilities:', error);\n        setUtilityError('Failed to load utilities');\n        setUtilities([]);\n      } finally {\n        if (!isCancelled) {\n          setUtilityLoading(false);\n        }\n      }\n    };\n\n    fetchUtilities();\n\n    return () => {\n      isCancelled = true;\n    };\n  }, [site.zip_code, readOnly]);\n\n  // Fetch jurisdictions by zip code\n  useEffect(() => {\n    if (readOnly) return; // Skip API calls in read-only mode\n\n    const zipCode = site.zip_code;\n    const state = site.state;\n\n    if (!zipCode) {\n      setJurisdictions([]);\n      setJurisdictionError('Enter ZIP to load jurisdictions');\n      return;\n    }\n\n    let isCancelled = false;\n\n    const getHardcodedJurisdictions = (zip) => {\n      // Arizona zip codes\n      if (zip.startsWith('850') || zip.startsWith('852') || zip.startsWith('853') ||\n          zip.startsWith('855') || zip.startsWith('856') || zip.startsWith('857') ||\n          zip.startsWith('859') || zip.startsWith('860') || zip.startsWith('863') ||\n          zip.startsWith('864')) {\n        return ['Phoenix', 'Scottsdale', 'Tempe', 'Mesa', 'Chandler', 'Glendale', 'Gilbert'];\n      }\n\n      // California zip codes (900-961)\n      if (zip.startsWith('90') || zip.startsWith('91') || zip.startsWith('92') ||\n          zip.startsWith('93') || zip.startsWith('94') || zip.startsWith('95') ||\n          zip.startsWith('96')) {\n        return ['Los Angeles', 'San Diego', 'San Francisco', 'San Jose', 'Sacramento'];\n      }\n\n      // Default fallback\n      return ['County Jurisdiction', 'City Jurisdiction'];\n    };\n\n    const fetchJurisdictions = async () => {\n      setJurisdictionLoading(true);\n      setJurisdictionError(null);\n\n      try {\n        const userData = JSON.parse(sessionStorage.getItem('userData') || '{}');\n        const companyId = userData?.company?.uuid;\n\n        // Try zip code lookup first\n        const response = await axios.get('/ahj/by-zip', {\n          params: { zip_code: zipCode },\n          headers: companyId ? { 'X-Company-ID': companyId } : {},\n        });\n\n        if (isCancelled) return;\n\n        const ahjData = response.data?.data || [];\n\n        if (ahjData.length > 0) {\n          // Remove duplicates by ahj_name and sort\n          const uniqueAhjs = [...new Map(ahjData.map(ahj => [ahj.ahj_name, ahj])).values()]\n            .map(ahj => ahj.ahj_name)\n            .sort();\n\n          setJurisdictions(uniqueAhjs);\n        } else {\n          // Fallback to state-level lookup\n\n          if (state) {\n            try {\n              const stateResponse = await axios.get('/ahj', {\n                params: { state: state },\n                headers: companyId ? { 'X-Company-ID': companyId } : {},\n              });\n\n              if (!isCancelled) {\n                const stateAhjData = stateResponse.data?.data || [];\n                const uniqueAhjs = [...new Map(stateAhjData.map(ahj => [ahj.ahj_name, ahj])).values()]\n                  .map(ahj => ahj.ahj_name)\n                  .sort();\n\n                setJurisdictions(uniqueAhjs.length > 0 ? uniqueAhjs : getHardcodedJurisdictions(zipCode));\n              }\n            } catch (stateError) {\n              if (!isCancelled) {\n                setJurisdictions(getHardcodedJurisdictions(zipCode));\n              }\n            }\n          } else {\n            setJurisdictions(getHardcodedJurisdictions(zipCode));\n          }\n        }\n      } catch (error) {\n        if (isCancelled) return;\n\n        console.error('[Site] Error fetching jurisdictions:', error);\n        setJurisdictions(getHardcodedJurisdictions(zipCode));\n      } finally {\n        if (!isCancelled) {\n          setJurisdictionLoading(false);\n        }\n      }\n    };\n\n    fetchJurisdictions();\n\n    return () => {\n      isCancelled = true;\n    };\n  }, [site.zip_code, site.state, readOnly]);\n\n  // Debounced auto-save effect\n  useEffect(() => {\n    // CRITICAL: Skip all save logic in read-only mode\n    if (readOnly) {\n      return;\n    }\n\n    if (isHydrating) {\n      return;\n    }\n\n    // Clear existing timeout\n    if (saveTimeoutRef.current) {\n      clearTimeout(saveTimeoutRef.current);\n    }\n\n    // Set new timeout for auto-save (800ms debounce)\n    saveTimeoutRef.current = setTimeout(() => {\n      saveData(siteFormData);\n    }, 800);\n\n    // Cleanup on unmount\n    return () => {\n      if (saveTimeoutRef.current) {\n        clearTimeout(saveTimeoutRef.current);\n      }\n    };\n  }, [siteFormData, isHydrating, saveData, readOnly]);\n\n  // Handle change for regular text inputs\n  const handleSiteChange = (e) => {\n    if (readOnly) return;\n    const { name, value } = e.target;\n    const newData = { ...currentFormValuesRef.current, [name]: value };\n    currentFormValuesRef.current = newData;\n    setSiteFormData(newData);\n  };\n\n  // Handle change for TableDropdown components (receives value directly)\n  const handleJurisdictionChange = (value) => {\n    if (readOnly) return;\n    const newData = { ...currentFormValuesRef.current, jurisdiction: value };\n    currentFormValuesRef.current = newData;\n    setSiteFormData(newData);\n  };\n\n  const handleUtilityChange = (value) => {\n    if (readOnly) return;\n    const newData = { ...currentFormValuesRef.current, utility: value };\n    currentFormValuesRef.current = newData;\n    setSiteFormData(newData);\n  };\n\n  // Save on blur (when user leaves a field)\n  const handleSiteBlur = () => {\n    if (readOnly) return;\n    if (saveTimeoutRef.current) {\n      clearTimeout(saveTimeoutRef.current);\n    }\n    saveData(siteFormData);\n  };\n\n  // Customer change handlers\n  const handleCustomerChange = (e) => {\n    if (readOnly) return;\n    const { name, value } = e.target;\n    setCustomerFormData(prev => ({ ...prev, [name]: value }));\n  };\n\n  const handleCustomerBlur = () => {\n    if (readOnly) return;\n    saveCustomerData(customerFormData);\n  };\n\n  // Customer & Address\n  const customerName = details.customer_first_name && details.customer_last_name\n    ? `${details.customer_first_name} ${details.customer_last_name}`\n    : null;\n\n  const address = site.address\n    ? `${site.address}, ${site.city || ''} ${site.state || ''} ${site.zip_code || ''}`.trim()\n    : null;\n\n  // ===== REUSABLE EQUIPMENT FORMATTERS (Per-System) =====\n\n  // Solar Panel - Primary\n  const formatSolarForSystem = (prefix) => {\n    const make = systemDetails?.[`${prefix}_solar_panel_make`];\n    if (!make) return null;\n    if (systemDetails?.[`${prefix}_batteryonly`] === true) return 'Battery Only';\n\n    const qty = systemDetails?.[`${prefix}_solar_panel_quantity`] || '';\n    const make_val = make || '';\n    const model = systemDetails?.[`${prefix}_solar_panel_model`] || '';\n    const wattage = systemDetails?.[`${prefix}_solar_panel_wattage`];\n    return `${qty} - ${make_val} ${model}${wattage ? ` ${wattage}W` : ''}`.replace(/\\s+/g, ' ').trim();\n  };\n\n  // Solar Panel - Type 2 (for mixed panel systems)\n  const formatSolarPanel2ForSystem = (prefix) => {\n    if (!systemDetails?.[`${prefix}_mixed_panel_system`]) return null;\n    const make = systemDetails?.[`${prefix}_solar_panel_type2_manufacturer`];\n    if (!make) return null;\n\n    const qty = systemDetails?.[`${prefix}_solar_panel_type2_quantity`] || '';\n    const model = systemDetails?.[`${prefix}_solar_panel_type2_model`] || '';\n    return `${qty} - ${make} ${model}`.replace(/\\s+/g, ' ').trim();\n  };\n\n  // Inverter\n  const formatInverterForSystem = (prefix) => {\n    const make = systemDetails?.[`${prefix}_inverter_make`];\n    if (!make) return null;\n\n    const type = systemDetails?.[`${prefix}_inverter_type`] === 'microinverter' ? 'Micro' : 'String';\n    const model = systemDetails?.[`${prefix}_inverter_model`] || '';\n    const qty = systemDetails?.[`${prefix}_inverter_quantity`] || '';\n    return `${qty ? qty + ' - ' : ''}${type}: ${make} ${model}`.replace(/\\s+/g, ' ').trim();\n  };\n\n  // Optimizer\n  const formatOptimizerForSystem = (prefix) => {\n    const make = systemDetails?.[`${prefix}_optimizer_make`];\n    if (!make) return null;\n    const model = systemDetails?.[`${prefix}_optimizer_model`] || '';\n    return `${make} ${model}`.trim();\n  };\n\n  // String Combiner Panel\n  const formatCombinerForSystem = (prefix) => {\n    const make = systemDetails?.[`${prefix}_combiner_panel_make`];\n    if (!make) return null;\n    const model = systemDetails?.[`${prefix}_combiner_panel_model`] || '';\n    return `${make} ${model}`.trim();\n  };\n\n  // ===== SHARED EQUIPMENT FORMATTERS (NOT per-system) =====\n\n  // SMS (Storage Management System)\n  const formatSMS = () => {\n    const make = systemDetails?.sms_make;\n    if (!make) return null;\n    const model = systemDetails?.sms_model || '';\n    return `${make} ${model}`.trim();\n  };\n\n  // Battery Type 1\n  const formatBattery1 = () => {\n    const make = systemDetails?.battery1_make;\n    if (!make) return null;\n    const qty = systemDetails?.battery1_quantity || 1;\n    const model = systemDetails?.battery1_model || '';\n    return `${qty} - ${make} ${model}`.trim();\n  };\n\n  // Battery Type 2\n  const formatBattery2 = () => {\n    if (!systemDetails?.show_battery_type_2) return null;\n    const make = systemDetails?.battery2_make;\n    if (!make) return null;\n    const qty = systemDetails?.battery2_quantity || 1;\n    const model = systemDetails?.battery2_model || '';\n    return `${qty} - ${make} ${model}`.trim();\n  };\n\n  // Backup Load Subpanel\n  const formatBackupSubpanel = () => {\n    const make = systemDetails?.backup_panel_make;\n    if (!make) return null;\n    const model = systemDetails?.backup_panel_model || '';\n    return `${make} ${model}`.trim();\n  };\n\n  // Battery Combiner Panel\n  const formatBatteryCombiner = () => {\n    const make = systemDetails?.battery_combiner_panel_make;\n    if (!make) return null;\n    const model = systemDetails?.battery_combiner_panel_model || '';\n    return `${make} ${model}`.trim();\n  };\n\n  // ===== MULTI-SYSTEM SUPPORT =====\n\n  // Check if a system has any equipment data\n  const systemHasEquipment = (sysNum) => {\n    const prefix = `sys${sysNum}`;\n    return !!(\n      systemDetails?.[`${prefix}_solar_panel_make`] ||\n      systemDetails?.[`${prefix}_inverter_make`] ||\n      systemDetails?.[`${prefix}_batteryonly`]\n    );\n  };\n\n  // Get list of systems that should be displayed\n  const getVisibleSystems = () => {\n    const systems = [];\n    for (let i = 1; i <= 4; i++) {\n      if (systemHasEquipment(i)) {\n        systems.push(i);\n      }\n    }\n    return systems.length > 0 ? systems : [1]; // Always show at least System 1\n  };\n\n  // Prepare options for dropdowns from dynamically loaded data\n  const jurisdictionOptions = jurisdictions.length > 0\n    ? jurisdictions.map(j => ({ value: j, label: j }))\n    : JURISDICTIONS.map(j => ({ value: j, label: j })); // Fallback to hardcoded list\n\n  const utilityOptions = utilities.length > 0\n    ? utilities.map(u => ({ value: u, label: u }))\n    : UTILITIES.map(u => ({ value: u, label: u })); // Fallback to hardcoded list\n\n  // Helper text for dropdowns\n  const jurisdictionHelper = (() => {\n    if (!site?.zip_code) return 'Enter ZIP to load jurisdictions';\n    if (jurisdictionLoading) return 'Loading jurisdictions...';\n    if (jurisdictionError) return jurisdictionError;\n    return '';\n  })();\n\n  const utilityHelper = (() => {\n    if (!site?.zip_code) return 'Enter ZIP to load utilities';\n    if (utilityLoading) return 'Loading utilities...';\n    if (utilityError) return utilityError;\n    return '';\n  })();\n\n  return (\n    <div>\n      {/* ===== PROJECT INFO CONTAINER ===== */}\n      <SystemContainer systemNumber=\"Project Info\">\n        {/* Customer Save Status */}\n        {!readOnly && customerSaveStatus !== 'idle' && (\n          <div style={{\n            padding: '0.5rem 1rem',\n            marginBottom: '1rem',\n            borderRadius: '0.375rem',\n            fontSize: '0.875rem',\n            display: 'flex',\n            alignItems: 'center',\n            gap: '0.5rem',\n            backgroundColor: customerSaveStatus === 'saving' ? '#FEF3C7' :\n                            customerSaveStatus === 'saved' ? '#D1FAE5' :\n                            '#FEE2E2',\n            color: customerSaveStatus === 'saving' ? '#92400E' :\n                   customerSaveStatus === 'saved' ? '#065F46' :\n                   '#991B1B'\n          }}>\n            {customerSaveStatus === 'saving' && 'ðŸ’¾ Saving customer...'}\n            {customerSaveStatus === 'saved' && 'âœ“ Customer saved'}\n            {customerSaveStatus === 'error' && 'âš  Customer save failed'}\n          </div>\n        )}\n\n        {/* Customer Section */}\n        <div style={{ marginBottom: '1rem' }}>\n          <EquipmentRow\n            title=\"Customer\"\n            subtitle={`${customerFormData.firstName} ${customerFormData.lastName}`.trim() || 'Empty'}\n            showNewExistingToggle={false}\n            initiallyExpanded={false}\n          >\n          {readOnly ? (\n            <>\n              <DisplayRow label=\"First Name\" value={customerFormData.firstName} />\n              <DisplayRow label=\"Last Name\" value={customerFormData.lastName} />\n            </>\n          ) : (\n            <>\n              <FormFieldRow label=\"First Name\">\n                <input\n                  type=\"text\"\n                  name=\"firstName\"\n                  value={customerFormData.firstName}\n                  onChange={handleCustomerChange}\n                  onBlur={handleCustomerBlur}\n                  placeholder=\"First Name...\"\n                />\n              </FormFieldRow>\n\n              <FormFieldRow label=\"Last Name\">\n                <input\n                  type=\"text\"\n                  name=\"lastName\"\n                  value={customerFormData.lastName}\n                  onChange={handleCustomerChange}\n                  onBlur={handleCustomerBlur}\n                  placeholder=\"Last Name...\"\n                />\n              </FormFieldRow>\n            </>\n          )}\n        </EquipmentRow>\n        </div>\n\n        {/* Site Save Status */}\n        {!readOnly && saveStatus !== 'idle' && (\n          <div style={{\n            padding: '0.5rem 1rem',\n            marginBottom: '1rem',\n            marginTop: 'var(--spacing)',\n            borderRadius: '0.375rem',\n            fontSize: '0.875rem',\n            display: 'flex',\n            alignItems: 'center',\n            gap: '0.5rem',\n            backgroundColor: saveStatus === 'saving' ? '#FEF3C7' :\n                            saveStatus === 'saved' ? '#D1FAE5' :\n                            '#FEE2E2',\n            color: saveStatus === 'saving' ? '#92400E' :\n                   saveStatus === 'saved' ? '#065F46' :\n                   '#991B1B'\n          }}>\n            {saveStatus === 'saving' && 'ðŸ’¾ Saving site...'}\n            {saveStatus === 'saved' && 'âœ“ Site saved'}\n            {saveStatus === 'error' && 'âš  Site save failed'}\n          </div>\n        )}\n\n        {/* Site Information Section */}\n        <EquipmentRow\n          title=\"Site Information\"\n          subtitle={address || `${site.city || ''} ${site.state || ''}`.trim() || 'Empty'}\n          showNewExistingToggle={false}\n          initiallyExpanded={true}\n        >\n          {/* Address - Read Only */}\n          <DisplayRow label=\"Address\" value={address} />\n\n          {/* Editable Fields */}\n          {readOnly ? (\n            <>\n              <DisplayRow label=\"Jurisdiction\" value={siteFormData.jurisdiction} />\n              <DisplayRow label=\"Utility\" value={siteFormData.utility} />\n              <DisplayRow label=\"APN\" value={siteFormData.apn} />\n              <DisplayRow label=\"Square Footage\" value={siteFormData.squareFootage} />\n            </>\n          ) : (\n            <>\n              <TableDropdown\n                label=\"Jurisdiction\"\n                value={siteFormData.jurisdiction}\n                onChange={handleJurisdictionChange}\n                options={jurisdictionOptions}\n                placeholder={jurisdictionHelper || \"Select Jurisdiction...\"}\n                disabled={jurisdictionLoading || !site?.zip_code}\n              />\n\n              <TableDropdown\n                label=\"Utility\"\n                value={siteFormData.utility}\n                onChange={handleUtilityChange}\n                options={utilityOptions}\n                placeholder={utilityHelper || \"Select Utility...\"}\n                disabled={utilityLoading || !site?.zip_code || utilities.length === 0}\n              />\n\n              <FormFieldRow label=\"APN\">\n                <input\n                  type=\"text\"\n                  name=\"apn\"\n                  value={siteFormData.apn}\n                  onChange={handleSiteChange}\n                  onBlur={handleSiteBlur}\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter') {\n                      e.preventDefault();\n                    }\n                  }}\n                  placeholder=\"APN...\"\n                />\n              </FormFieldRow>\n\n              <FormFieldRow label=\"Square Footage\">\n                <input\n                  type=\"text\"\n                  name=\"squareFootage\"\n                  value={siteFormData.squareFootage}\n                  onChange={handleSiteChange}\n                  onBlur={handleSiteBlur}\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter') {\n                      e.preventDefault();\n                    }\n                  }}\n                  placeholder=\"Square Footage...\"\n                />\n              </FormFieldRow>\n            </>\n          )}\n        </EquipmentRow>\n      </SystemContainer>\n\n      {/* ===== SYSTEMS (Dynamic - 1 to 4) ===== */}\n      {getVisibleSystems().map((sysNum) => {\n        const prefix = `sys${sysNum}`;\n\n        // Get formatted values\n        const solarPanel = formatSolarForSystem(prefix);\n        const solarPanel2 = formatSolarPanel2ForSystem(prefix);\n        const inverter = formatInverterForSystem(prefix);\n        const optimizer = formatOptimizerForSystem(prefix);\n        const stringCombiner = formatCombinerForSystem(prefix);\n        const sms = formatSMS();\n        const battery1 = formatBattery1();\n        const battery2 = formatBattery2();\n        const backupSubpanel = formatBackupSubpanel();\n        const batteryCombiner = formatBatteryCombiner();\n\n        return (\n          <SystemContainer key={sysNum} systemNumber={sysNum}>\n            {/* Per-System Equipment */}\n            {solarPanel && (\n              <EquipmentRow\n                title=\"Solar Panel\"\n                subtitle={solarPanel}\n                showNewExistingToggle={false}\n                initiallyExpanded={false}\n              />\n            )}\n\n            {solarPanel2 && (\n              <EquipmentRow\n                title=\"Solar Panel 2\"\n                subtitle={solarPanel2}\n                showNewExistingToggle={false}\n                initiallyExpanded={false}\n              />\n            )}\n\n            {inverter && (\n              <EquipmentRow\n                title=\"Inverter\"\n                subtitle={inverter}\n                showNewExistingToggle={false}\n                initiallyExpanded={false}\n              />\n            )}\n\n            {optimizer && (\n              <EquipmentRow\n                title=\"Optimizer\"\n                subtitle={optimizer}\n                showNewExistingToggle={false}\n                initiallyExpanded={false}\n              />\n            )}\n\n            {stringCombiner && (\n              <EquipmentRow\n                title=\"String Combiner\"\n                subtitle={stringCombiner}\n                showNewExistingToggle={false}\n                initiallyExpanded={false}\n              />\n            )}\n\n            {/* Shared Equipment (only show in System 1) */}\n            {sysNum === 1 && (\n              <>\n                {sms && (\n                  <EquipmentRow\n                    title=\"SMS\"\n                    subtitle={sms}\n                    showNewExistingToggle={false}\n                    initiallyExpanded={false}\n                  />\n                )}\n\n                {battery1 && (\n                  <EquipmentRow\n                    title=\"Battery\"\n                    subtitle={battery1}\n                    showNewExistingToggle={false}\n                    initiallyExpanded={false}\n                  />\n                )}\n\n                {battery2 && (\n                  <EquipmentRow\n                    title=\"Battery 2\"\n                    subtitle={battery2}\n                    showNewExistingToggle={false}\n                    initiallyExpanded={false}\n                  />\n                )}\n\n                {backupSubpanel && (\n                  <EquipmentRow\n                    title=\"Backup Subpanel\"\n                    subtitle={backupSubpanel}\n                    showNewExistingToggle={false}\n                    initiallyExpanded={false}\n                  />\n                )}\n\n                {batteryCombiner && (\n                  <EquipmentRow\n                    title=\"Battery Combiner\"\n                    subtitle={batteryCombiner}\n                    showNewExistingToggle={false}\n                    initiallyExpanded={false}\n                  />\n                )}\n              </>\n            )}\n          </SystemContainer>\n        );\n      })}\n    </div>\n  );\n};\n\nexport default ProjectOverview;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\ProjectPhotoGallery.js","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchPhotos'. Either include it or remove the dependency array.","line":19,"column":6,"nodeType":"ArrayExpression","endLine":19,"endColumn":19,"suggestions":[{"desc":"Update the dependencies array to be: [fetchPhotos, projectUuid]","fix":{"range":[673,686],"text":"[fetchPhotos, projectUuid]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef } from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport styles from '../../styles/ProjectAdd.module.css';\r\nimport axios from '../../config/axios';\r\nimport logger from '../services/devLogger';\r\nimport PhotoModal from '../ui/PhotoModal';\r\n\r\nconst ProjectPhotoGallery = ({ projectUuid }) => {\r\n  const [photos, setPhotos] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [uploading, setUploading] = useState(false);\r\n  const [selectedPhoto, setSelectedPhoto] = useState(null);\r\n  const fileInputRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    if (projectUuid) {\r\n      fetchPhotos();\r\n    }\r\n  }, [projectUuid]);\r\n\r\n  const fetchPhotos = async () => {\r\n    if (!projectUuid) return;\r\n\r\n    setLoading(true);\r\n    try {\r\n      const companyData = JSON.parse(sessionStorage.getItem('companyData') || '{}');\r\n      const response = await axios.get(`/project/${projectUuid}/photos`, {\r\n        params: { companyId: companyData.uuid }\r\n      });\r\n\r\n      if (response.data.status === 'SUCCESS' && Array.isArray(response.data.data)) {\r\n        setPhotos(response.data.data);\r\n      }\r\n    } catch (error) {\r\n      logger.error('Project', 'Error fetching photos:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleUploadClick = () => {\r\n    fileInputRef.current?.click();\r\n  };\r\n\r\n  const handleFileChange = async (e) => {\r\n    const files = Array.from(e.target.files || []);\r\n    if (files.length === 0) return;\r\n\r\n    if (!projectUuid) {\r\n      alert('Please create the project first before uploading photos.');\r\n      return;\r\n    }\r\n\r\n    setUploading(true);\r\n\r\n    try {\r\n      const companyData = JSON.parse(sessionStorage.getItem('companyData') || '{}');\r\n\r\n      // Upload files one by one or in parallel\r\n      const uploadPromises = files.map(async (file) => {\r\n        const formData = new FormData();\r\n        formData.append('photo', file);\r\n\r\n        return axios.post(`/project/${projectUuid}/photos?companyId=${companyData.uuid}`, formData, {\r\n          headers: {\r\n            'Content-Type': 'multipart/form-data',\r\n          },\r\n        });\r\n      });\r\n\r\n      await Promise.all(uploadPromises);\r\n\r\n      // Refresh photo list\r\n      await fetchPhotos();\r\n\r\n      // Clear input\r\n      if (fileInputRef.current) {\r\n        fileInputRef.current.value = '';\r\n      }\r\n    } catch (error) {\r\n      logger.error('Project', 'Error uploading photos:', error);\r\n      alert('Failed to upload photos. Please try again.');\r\n    } finally {\r\n      setUploading(false);\r\n    }\r\n  };\r\n\r\n  const handlePhotoClick = (photo) => {\r\n    // Open photo in modal viewer\r\n    setSelectedPhoto(photo);\r\n  };\r\n\r\n  const containerVariants = {\r\n    hidden: { opacity: 0 },\r\n    visible: {\r\n      opacity: 1,\r\n      transition: {\r\n        staggerChildren: 0.05,\r\n      },\r\n    },\r\n  };\r\n\r\n  const itemVariants = {\r\n    hidden: { opacity: 0, scale: 0.8 },\r\n    visible: { opacity: 1, scale: 1 },\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      {/* Gallery Header */}\r\n      <div className={styles.galleryHeader}>\r\n        <h2 className={styles.galleryTitle}>\r\n          Photo Gallery & Files {photos.length > 0 && `(${photos.length})`}\r\n        </h2>\r\n        <button\r\n          type=\"button\"\r\n          onClick={handleUploadClick}\r\n          disabled={uploading || !projectUuid}\r\n          className={styles.uploadButton}\r\n        >\r\n          {uploading ? 'Uploading...' : 'Upload'}\r\n        </button>\r\n        <input\r\n          ref={fileInputRef}\r\n          type=\"file\"\r\n          accept=\"image/*\"\r\n          multiple\r\n          onChange={handleFileChange}\r\n          style={{ display: 'none' }}\r\n        />\r\n      </div>\r\n\r\n      {/* Photo Grid */}\r\n      {loading ? (\r\n        <div className={styles.loading}>\r\n          <p>Loading photos...</p>\r\n        </div>\r\n      ) : photos.length === 0 ? (\r\n        <div className={styles.photoGrid}>\r\n          <div className={styles.photoCard}>\r\n            <div className={styles.photoPlaceholder}>\r\n              <div className={styles.photoPlaceholderIcon}>ðŸ“·</div>\r\n              <div className={styles.photoPlaceholderText}>\r\n                {projectUuid ? 'No photos yet' : 'Create project to upload'}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      ) : (\r\n        <motion.div\r\n          className={styles.photoGrid}\r\n          variants={containerVariants}\r\n          initial=\"hidden\"\r\n          animate=\"visible\"\r\n        >\r\n          {photos.map((photo, index) => (\r\n            <motion.div\r\n              key={photo.id || index}\r\n              className={styles.photoCard}\r\n              variants={itemVariants}\r\n              whileHover={{ scale: 1.05 }}\r\n              onClick={() => handlePhotoClick(photo)}\r\n            >\r\n              <img\r\n                src={photo.thumbnail_url || photo.url}\r\n                alt={photo.name || `Photo ${index + 1}`}\r\n                className={styles.photoImage}\r\n              />\r\n            </motion.div>\r\n          ))}\r\n        </motion.div>\r\n      )}\r\n\r\n      {/* Photo Modal */}\r\n      {selectedPhoto && (\r\n        <PhotoModal\r\n          photo={selectedPhoto}\r\n          onClose={() => setSelectedPhoto(null)}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProjectPhotoGallery;\r\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\SiteForm.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\StructuralForm.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'loading' is assigned a value but never used.","line":20,"column":72,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":79},{"ruleId":"no-unused-vars","severity":1,"message":"'saving' is assigned a value but never used.","line":20,"column":81,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":87},{"ruleId":"no-mixed-operators","severity":1,"message":"Unexpected mix of '||' and '&&'. Use parentheses to clarify the intended order of operations.","line":99,"column":43,"nodeType":"LogicalExpression","messageId":"unexpectedMixedOperator","endLine":99,"endColumn":45},{"ruleId":"no-mixed-operators","severity":1,"message":"Unexpected mix of '||' and '&&'. Use parentheses to clarify the intended order of operations.","line":100,"column":101,"nodeType":"LogicalExpression","messageId":"unexpectedMixedOperator","endLine":100,"endColumn":103},{"ruleId":"no-mixed-operators","severity":1,"message":"Unexpected mix of '||' and '&&'. Use parentheses to clarify the intended order of operations.","line":100,"column":143,"nodeType":"LogicalExpression","messageId":"unexpectedMixedOperator","endLine":100,"endColumn":145},{"ruleId":"no-mixed-operators","severity":1,"message":"Unexpected mix of '||' and '&&'. Use parentheses to clarify the intended order of operations.","line":101,"column":97,"nodeType":"LogicalExpression","messageId":"unexpectedMixedOperator","endLine":101,"endColumn":99},{"ruleId":"no-mixed-operators","severity":1,"message":"Unexpected mix of '||' and '&&'. Use parentheses to clarify the intended order of operations.","line":101,"column":137,"nodeType":"LogicalExpression","messageId":"unexpectedMixedOperator","endLine":101,"endColumn":139},{"ruleId":"no-mixed-operators","severity":1,"message":"Unexpected mix of '||' and '&&'. Use parentheses to clarify the intended order of operations.","line":102,"column":101,"nodeType":"LogicalExpression","messageId":"unexpectedMixedOperator","endLine":102,"endColumn":103},{"ruleId":"no-unused-vars","severity":1,"message":"'clearFields' is assigned a value but never used.","line":524,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":524,"endColumn":22},{"ruleId":"no-unused-vars","severity":1,"message":"'hasHardwareAData' is assigned a value but never used.","line":598,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":598,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport RoofingSection from './structural/RoofingSection';\nimport RailsSection from './structural/RailsSection';\nimport MountingHardwareSection from './structural/MountingHardwareSection';\nimport MountingPlaneSection from './structural/MountingPlaneSection';\nimport RoofContainer from './structural/RoofContainer';\nimport MountingPlanesContainer from './structural/MountingPlanesContainer';\nimport FormNavigationFooter from './FormNavigationFooter';\nimport { AddSectionButton, SectionClearModal, ConfirmActionModal } from '../ui';\nimport equipStyles from './EquipmentForm.module.css';\nimport { useSystemDetails } from '../../hooks/useSystemDetails';\n\n/**\n * StructuralForm - Structural configuration component\n * Handles roofing types, mounting hardware, and mounting planes\n * Now connected to backend via useSystemDetails hook\n */\nconst StructuralForm = ({ projectUuid, projectData, onNavigateToTab }) => {\n  // Backend integration\n  const { data: systemDetails, updateField, updateFields, clearFields, loading, saving } = useSystemDetails({\n    projectUuid,\n    autoFetch: true\n  });\n  // Navigation handlers\n  const handlePrev = () => {\n    if (onNavigateToTab) {\n      onNavigateToTab('electrical');\n    }\n  };\n\n  const handleNext = () => {\n    if (onNavigateToTab) {\n      onNavigateToTab('submit');\n    }\n  };\n  const maxPlanes = 15;\n\n  // Track last clear click for double-click detection\n  const lastClearRef = React.useRef({ planeNumber: null, timestamp: 0 });\n\n  // Track \"Keep Same\" state for Mounting Plane 1\n  const [keepSameActive, setKeepSameActive] = useState(false);\n\n  // Track which mounting plane's clear modal is open (null = none)\n  const [clearModalPlaneNumber, setClearModalPlaneNumber] = useState(null);\n\n  // Track clear modals for other sections\n  const [showClearRoofingA, setShowClearRoofingA] = useState(false);\n  const [showClearHardwareA, setShowClearHardwareA] = useState(false);\n  const [showClearRoofingB, setShowClearRoofingB] = useState(false);\n  const [showClearHardwareB, setShowClearHardwareB] = useState(false);\n\n  // Track Keep Same confirmation modal\n  const [showKeepSameConfirm, setShowKeepSameConfirm] = useState(false);\n\n  // Form state - matches API field names\n  const [formData, setFormData] = useState({\n    // Roofing Type A\n    rta_roofing_material: '',\n    rta_framing_size: '',\n    st_roof_a_area_sqft: '',\n    rta_framing_spacing: '',\n    st_roof_a_framing_type: '',\n    rta_ground_mount: false,\n\n    // Mounting Hardware A\n    rta_rail_make: '',\n    rta_rail_model: '',\n    rta_attachment_make: '',\n    rta_attachment_model: '',\n\n    // Roofing Type B\n    show_roof_b: false,\n    rtb_roofing_material: '',\n    rtb_framing_size: '',\n    st_roof_b_area_sqft: '',\n    rtb_framing_spacing: '',\n    st_roof_b_framing_type: '',\n    rtb_ground_mount: false,\n\n    // Mounting Hardware B\n    rtb_rail_make: '',\n    rtb_rail_model: '',\n    rtb_attachment_make: '',\n    rtb_attachment_model: '',\n\n    // Mounting Planes (1-10)\n    visible_planes: 1, // Number of visible mounting planes\n    ...generatePlaneFields(1) // Start with plane 1\n  });\n\n  // Hydrate form from backend data\n  useEffect(() => {\n    if (systemDetails) {\n      // Count visible planes (check which planes have data)\n      let maxVisiblePlane = 1;\n      for (let i = 1; i <= maxPlanes; i++) {\n        const hasData = !!(\n          systemDetails[`st_mp${i}_mode`] ||\n          systemDetails[`mp${i}_stories`] !== null && systemDetails[`mp${i}_stories`] !== undefined && systemDetails[`mp${i}_stories`] !== '' ||\n          systemDetails[`mp${i}_pitch`] !== null && systemDetails[`mp${i}_pitch`] !== undefined && systemDetails[`mp${i}_pitch`] !== '' ||\n          systemDetails[`mp${i}_azimuth`] !== null && systemDetails[`mp${i}_azimuth`] !== undefined && systemDetails[`mp${i}_azimuth`] !== ''\n        );\n        if (hasData) {\n          maxVisiblePlane = i;\n        }\n      }\n\n      const hydratedData = {\n        // Roofing Type A\n        rta_roofing_material: systemDetails.rta_roofing_material || '',\n        rta_framing_size: systemDetails.rta_framing_size || '',\n        st_roof_a_area_sqft: systemDetails.st_roof_a_area_sqft || '',\n        rta_framing_spacing: systemDetails.rta_framing_spacing || '',\n        st_roof_a_framing_type: systemDetails.st_roof_a_framing_type || '',\n        rta_ground_mount: systemDetails.rta_ground_mount === true,\n\n        // Mounting Hardware A\n        rta_rail_make: systemDetails.rta_rail_make || '',\n        rta_rail_model: systemDetails.rta_rail_model || '',\n        rta_attachment_make: systemDetails.rta_attachment_make || '',\n        rta_attachment_model: systemDetails.rta_attachment_model || '',\n\n        // Roofing Type B\n        show_roof_b: !!(systemDetails.rtb_roofing_material || systemDetails.rtb_framing_size),\n        rtb_roofing_material: systemDetails.rtb_roofing_material || '',\n        rtb_framing_size: systemDetails.rtb_framing_size || '',\n        st_roof_b_area_sqft: systemDetails.st_roof_b_area_sqft || '',\n        rtb_framing_spacing: systemDetails.rtb_framing_spacing || '',\n        st_roof_b_framing_type: systemDetails.st_roof_b_framing_type || '',\n        rtb_ground_mount: systemDetails.rtb_ground_mount === true,\n\n        // Mounting Hardware B\n        rtb_rail_make: systemDetails.rtb_rail_make || '',\n        rtb_rail_model: systemDetails.rtb_rail_model || '',\n        rtb_attachment_make: systemDetails.rtb_attachment_make || '',\n        rtb_attachment_model: systemDetails.rtb_attachment_model || '',\n\n        // Mounting Planes\n        visible_planes: maxVisiblePlane,\n      };\n\n      // Hydrate all visible planes\n      for (let i = 1; i <= maxVisiblePlane; i++) {\n        const prefix = `mp${i}`;\n        hydratedData[`st_${prefix}_mode`] = systemDetails[`st_${prefix}_mode`] || '';\n        // Convert numbers to strings for dropdown compatibility\n        hydratedData[`${prefix}_stories`] = systemDetails[`${prefix}_stories`] != null ? String(systemDetails[`${prefix}_stories`]) : '';\n        hydratedData[`${prefix}_pitch`] = systemDetails[`${prefix}_pitch`] != null ? String(systemDetails[`${prefix}_pitch`]) : '';\n        hydratedData[`${prefix}_azimuth`] = systemDetails[`${prefix}_azimuth`] ?? '';\n        hydratedData[`${prefix}_roof_type`] = systemDetails[`${prefix}_roof_type`] || 'A';\n\n        for (let j = 1; j <= 8; j++) {\n          hydratedData[`st_${prefix}_arrayqty_${j}`] = systemDetails[`st_${prefix}_arrayqty_${j}`] || '';\n          hydratedData[`st_${prefix}_array${j}_orientation`] = systemDetails[`st_${prefix}_array${j}_orientation`] || '';\n        }\n      }\n\n      setFormData(hydratedData);\n    }\n  }, [systemDetails]);\n\n  const handleFieldChange = async (field, value) => {\n    // Optimistic UI update\n    setFormData(prev => ({\n      ...prev,\n      [field]: value\n    }));\n\n    // If Keep Same is active and this is Stories/Pitch on Plane 1, sync to all other planes\n    if (keepSameActive && (field === 'mp1_stories' || field === 'mp1_pitch')) {\n      const fieldType = field === 'mp1_stories' ? 'stories' : 'pitch';\n      const updates = {};\n\n      for (let i = 2; i <= formData.visible_planes; i++) {\n        const targetField = `mp${i}_${fieldType}`;\n        updates[targetField] = value;\n      }\n\n      setFormData(prev => ({\n        ...prev,\n        ...updates\n      }));\n\n      // Save all updates to backend\n      try {\n        await updateFields(updates);\n      } catch (error) {\n        console.error('Failed to save synced fields:', error);\n      }\n    }\n\n    // Save to backend\n    try {\n      await updateField(field, value);\n    } catch (error) {\n      console.error('Failed to save field:', field, error);\n      // Error is already logged by useSystemDetails, UI will revert on next fetch\n    }\n  };\n\n  // Handler for Keep Same toggle\n  const handleKeepSameToggle = () => {\n    const newKeepSameState = !keepSameActive;\n\n    // If turning ON Keep Same and there are multiple planes, show confirmation\n    if (newKeepSameState && formData.visible_planes > 1) {\n      setShowKeepSameConfirm(true);\n    } else {\n      // If turning OFF or only 1 plane exists, no confirmation needed\n      setKeepSameActive(newKeepSameState);\n    }\n  };\n\n  // Confirm and execute Keep Same activation\n  const handleConfirmKeepSame = () => {\n    setShowKeepSameConfirm(false);\n    setKeepSameActive(true);\n\n    // Sync current Plane 1 values to all other planes\n    const plane1Stories = formData.mp1_stories;\n    const plane1Pitch = formData.mp1_pitch;\n    const updates = {};\n\n    for (let i = 2; i <= formData.visible_planes; i++) {\n      updates[`mp${i}_stories`] = plane1Stories;\n      updates[`mp${i}_pitch`] = plane1Pitch;\n    }\n\n    setFormData(prev => ({\n      ...prev,\n      ...updates\n    }));\n\n    // Save all updates to backend\n    if (Object.keys(updates).length > 0) {\n      updateFields(updates).catch(error => {\n        console.error('Failed to sync Keep Same values:', error);\n      });\n    }\n  };\n\n  // Clear handlers that reset UI and save null values to database\n  const handleClearRoofingA = async () => {\n    setShowClearRoofingA(false);\n\n    const fieldsToClear = [\n      'rta_roofing_material',\n      'rta_framing_size',\n      'st_roof_a_area_sqft',\n      'rta_framing_spacing',\n      'st_roof_a_framing_type',\n    ];\n\n    // Optimistic UI update\n    setFormData(prev => ({\n      ...prev,\n      rta_roofing_material: '',\n      rta_framing_size: '',\n      st_roof_a_area_sqft: '',\n      rta_framing_spacing: '',\n      st_roof_a_framing_type: '',\n    }));\n\n    // Save null values to database\n    try {\n      await clearFields(fieldsToClear);\n    } catch (error) {\n      console.error('Failed to clear Roofing A fields:', error);\n    }\n  };\n\n  const handleClearMountingHardwareA = async () => {\n    setShowClearHardwareA(false);\n\n    const fieldsToClear = [\n      'rta_rail_make',\n      'rta_rail_model',\n      'rta_attachment_make',\n      'rta_attachment_model',\n    ];\n\n    // Optimistic UI update\n    setFormData(prev => ({\n      ...prev,\n      rta_rail_make: '',\n      rta_rail_model: '',\n      rta_attachment_make: '',\n      rta_attachment_model: '',\n    }));\n\n    // Save null values to database\n    try {\n      await clearFields(fieldsToClear);\n    } catch (error) {\n      console.error('Failed to clear Mounting Hardware A fields:', error);\n    }\n  };\n\n  const handleClearRoofingB = async () => {\n    setShowClearRoofingB(false);\n\n    const fieldsToClear = [\n      'rtb_roofing_material',\n      'rtb_framing_size',\n      'st_roof_b_area_sqft',\n      'rtb_framing_spacing',\n      'st_roof_b_framing_type',\n    ];\n\n    // Optimistic UI update\n    setFormData(prev => ({\n      ...prev,\n      rtb_roofing_material: '',\n      rtb_framing_size: '',\n      st_roof_b_area_sqft: '',\n      rtb_framing_spacing: '',\n      st_roof_b_framing_type: '',\n    }));\n\n    // Save null values to database\n    try {\n      await clearFields(fieldsToClear);\n    } catch (error) {\n      console.error('Failed to clear Roofing B fields:', error);\n    }\n  };\n\n  const handleClearMountingHardwareB = async () => {\n    setShowClearHardwareB(false);\n\n    const fieldsToClear = [\n      'rtb_rail_make',\n      'rtb_rail_model',\n      'rtb_attachment_make',\n      'rtb_attachment_model',\n    ];\n\n    // Optimistic UI update\n    setFormData(prev => ({\n      ...prev,\n      rtb_rail_make: '',\n      rtb_rail_model: '',\n      rtb_attachment_make: '',\n      rtb_attachment_model: '',\n    }));\n\n    // Save null values to database\n    try {\n      await clearFields(fieldsToClear);\n    } catch (error) {\n      console.error('Failed to clear Mounting Hardware B fields:', error);\n    }\n  };\n\n  const handleOpenClearModal = (planeNumber) => {\n    setClearModalPlaneNumber(planeNumber);\n  };\n\n  const handleClearMountingPlane = async (planeNumber) => {\n    // Close the modal\n    setClearModalPlaneNumber(null);\n\n    // Turn off Keep Same when any plane is cleared\n    setKeepSameActive(false);\n\n    const now = Date.now();\n    const lastClear = lastClearRef.current;\n\n    // Check if this is a double-click (within 500ms) on the same plane\n    const isDoubleClick =\n      lastClear.planeNumber === planeNumber &&\n      (now - lastClear.timestamp) < 500;\n\n    // Update last clear tracking\n    lastClearRef.current = { planeNumber, timestamp: now };\n\n    // If double-click and not plane 1, remove the plane\n    if (isDoubleClick && planeNumber > 1) {\n      // Collect fields to clear from this plane onwards\n      const fieldsToClear = [];\n\n      // Get current visible planes count before updating\n      const currentVisiblePlanes = formData.visible_planes;\n\n      for (let i = planeNumber; i <= currentVisiblePlanes; i++) {\n        const prefix = `mp${i}`;\n        fieldsToClear.push(\n          `st_${prefix}_mode`,\n          `${prefix}_stories`,\n          `${prefix}_pitch`,\n          `${prefix}_azimuth`,\n          `${prefix}_roof_type`,\n          `st_${prefix}_arrayqty_1`,\n          `st_${prefix}_arrayqty_2`,\n          `st_${prefix}_arrayqty_3`,\n          `st_${prefix}_arrayqty_4`,\n          `st_${prefix}_arrayqty_5`,\n          `st_${prefix}_arrayqty_6`,\n          `st_${prefix}_arrayqty_7`,\n          `st_${prefix}_arrayqty_8`,\n          `st_${prefix}_array1_orientation`,\n          `st_${prefix}_array2_orientation`,\n          `st_${prefix}_array3_orientation`,\n          `st_${prefix}_array4_orientation`,\n          `st_${prefix}_array5_orientation`,\n          `st_${prefix}_array6_orientation`,\n          `st_${prefix}_array7_orientation`,\n          `st_${prefix}_array8_orientation`\n        );\n      }\n\n      // Optimistic UI update - remove this plane and all after it\n      setFormData(prev => {\n        const newVisiblePlanes = planeNumber - 1;\n        const updates = { visible_planes: newVisiblePlanes };\n\n        for (let i = planeNumber; i <= prev.visible_planes; i++) {\n          const prefix = `mp${i}`;\n          updates[`st_${prefix}_mode`] = '';\n          updates[`${prefix}_stories`] = '';\n          updates[`${prefix}_pitch`] = '';\n          updates[`${prefix}_azimuth`] = '';\n          updates[`${prefix}_roof_type`] = 'A';\n          updates[`st_${prefix}_arrayqty_1`] = '';\n          updates[`st_${prefix}_arrayqty_2`] = '';\n          updates[`st_${prefix}_arrayqty_3`] = '';\n          updates[`st_${prefix}_arrayqty_4`] = '';\n          updates[`st_${prefix}_arrayqty_5`] = '';\n          updates[`st_${prefix}_arrayqty_6`] = '';\n          updates[`st_${prefix}_arrayqty_7`] = '';\n          updates[`st_${prefix}_arrayqty_8`] = '';\n          updates[`st_${prefix}_array1_orientation`] = '';\n          updates[`st_${prefix}_array2_orientation`] = '';\n          updates[`st_${prefix}_array3_orientation`] = '';\n          updates[`st_${prefix}_array4_orientation`] = '';\n          updates[`st_${prefix}_array5_orientation`] = '';\n          updates[`st_${prefix}_array6_orientation`] = '';\n          updates[`st_${prefix}_array7_orientation`] = '';\n          updates[`st_${prefix}_array8_orientation`] = '';\n        }\n\n        return { ...prev, ...updates };\n      });\n\n      // Save null values to database\n      try {\n        await clearFields(fieldsToClear);\n      } catch (error) {\n        console.error(`Failed to clear mounting plane ${planeNumber} and onwards:`, error);\n      }\n\n      return;\n    }\n\n    // Single click - just clear the data\n    const prefix = `mp${planeNumber}`;\n    const fieldsToClear = [\n      `st_${prefix}_mode`,\n      `${prefix}_stories`,\n      `${prefix}_pitch`,\n      `${prefix}_azimuth`,\n      `${prefix}_roof_type`,\n      `st_${prefix}_arrayqty_1`,\n      `st_${prefix}_arrayqty_2`,\n      `st_${prefix}_arrayqty_3`,\n      `st_${prefix}_arrayqty_4`,\n      `st_${prefix}_arrayqty_5`,\n      `st_${prefix}_arrayqty_6`,\n      `st_${prefix}_arrayqty_7`,\n      `st_${prefix}_arrayqty_8`,\n      `st_${prefix}_array1_orientation`,\n      `st_${prefix}_array2_orientation`,\n      `st_${prefix}_array3_orientation`,\n      `st_${prefix}_array4_orientation`,\n      `st_${prefix}_array5_orientation`,\n      `st_${prefix}_array6_orientation`,\n      `st_${prefix}_array7_orientation`,\n      `st_${prefix}_array8_orientation`,\n    ];\n\n    // Optimistic UI update\n    setFormData(prev => ({\n      ...prev,\n      [`st_${prefix}_mode`]: '',\n      [`${prefix}_stories`]: '',\n      [`${prefix}_pitch`]: '',\n      [`${prefix}_azimuth`]: '',\n      [`${prefix}_roof_type`]: 'A',\n      [`st_${prefix}_arrayqty_1`]: '',\n      [`st_${prefix}_arrayqty_2`]: '',\n      [`st_${prefix}_arrayqty_3`]: '',\n      [`st_${prefix}_arrayqty_4`]: '',\n      [`st_${prefix}_arrayqty_5`]: '',\n      [`st_${prefix}_arrayqty_6`]: '',\n      [`st_${prefix}_arrayqty_7`]: '',\n      [`st_${prefix}_arrayqty_8`]: '',\n      [`st_${prefix}_array1_orientation`]: '',\n      [`st_${prefix}_array2_orientation`]: '',\n      [`st_${prefix}_array3_orientation`]: '',\n      [`st_${prefix}_array4_orientation`]: '',\n      [`st_${prefix}_array5_orientation`]: '',\n      [`st_${prefix}_array6_orientation`]: '',\n      [`st_${prefix}_array7_orientation`]: '',\n      [`st_${prefix}_array8_orientation`]: '',\n    }));\n\n    // Save null values to database\n    try {\n      await clearFields(fieldsToClear);\n    } catch (error) {\n      console.error(`Failed to clear mounting plane ${planeNumber}:`, error);\n    }\n  };\n\n  const handleShowRoofB = () => {\n    setFormData(prev => ({\n      ...prev,\n      show_roof_b: true\n    }));\n  };\n\n  const handleCancelRoofB = () => {\n    const clearFields = {\n      show_roof_b: null,\n      rtb_roofing_material: null,\n      rtb_framing_size: null,\n      st_roof_b_area_sqft: null,\n      rtb_framing_spacing: null,\n      st_roof_b_framing_type: null,\n      rtb_rail_make: null,\n      rtb_rail_model: null,\n      rtb_attachment_make: null,\n      rtb_attachment_model: null,\n    };\n\n    // Update UI state\n    setFormData(prev => ({\n      ...prev,\n      show_roof_b: false,\n      // Clear Roof B data\n      rtb_roofing_material: '',\n      rtb_framing_size: '',\n      st_roof_b_area_sqft: '',\n      rtb_framing_spacing: '',\n      st_roof_b_framing_type: '',\n      // Clear Mounting Hardware B data\n      rtb_rail_make: '',\n      rtb_rail_model: '',\n      rtb_attachment_make: '',\n      rtb_attachment_model: '',\n      // Reset all planes to roof type A\n      ...resetPlanesRoofType(prev.visible_planes)\n    }));\n\n    // TODO: When database is connected, send null values to clear these fields\n    // await updateProjectFields(projectUuid, clearFields);\n  };\n\n  const handleShowNextPlane = async () => {\n    if (formData.visible_planes < maxPlanes) {\n      const nextPlane = formData.visible_planes + 1;\n      const newPlaneFields = generatePlaneFields(nextPlane);\n\n      // Prepare fields to save to backend\n      const fieldsToSave = {\n        [`st_mp${nextPlane}_mode`]: 'Flush', // Save default Flush mode\n      };\n\n      // If Keep Same is active, inherit Stories and Pitch from Plane 1\n      if (keepSameActive) {\n        const plane1Stories = formData.mp1_stories;\n        const plane1Pitch = formData.mp1_pitch;\n\n        newPlaneFields[`mp${nextPlane}_stories`] = plane1Stories;\n        newPlaneFields[`mp${nextPlane}_pitch`] = plane1Pitch;\n\n        fieldsToSave[`mp${nextPlane}_stories`] = plane1Stories;\n        fieldsToSave[`mp${nextPlane}_pitch`] = plane1Pitch;\n      }\n\n      // Save default values and any Keep Same values to backend\n      try {\n        await updateFields(fieldsToSave);\n      } catch (error) {\n        console.error('Failed to save new plane defaults:', error);\n      }\n\n      setFormData(prev => ({\n        ...prev,\n        visible_planes: nextPlane,\n        ...newPlaneFields\n      }));\n    }\n  };\n\n  // Check if Mounting Hardware A has data (required for showing Roof B button)\n  const hasHardwareAData = formData.rta_rail_make && formData.rta_rail_model;\n\n  return (\n    <form onSubmit={(e) => e.preventDefault()} style={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\n      {/* Scrollable Content */}\n      <div className={equipStyles.scrollableContent}>\n        {/* Roof (A) Container */}\n        <RoofContainer roofType=\"A\">\n          {/* Roofing (A) */}\n          <RoofingSection\n            formData={formData}\n            onChange={handleFieldChange}\n            roofType=\"A\"\n            onClear={() => setShowClearRoofingA(true)}\n          />\n\n          {/* Rails (A) - Hidden when Ground Mount is active */}\n          {!formData.rta_ground_mount && (\n            <RailsSection\n              formData={formData}\n              onChange={handleFieldChange}\n              railType=\"A\"\n              onClear={() => setShowClearHardwareA(true)}\n            />\n          )}\n\n          {/* Attachment (A) - Hidden when Ground Mount is active */}\n          {!formData.rta_ground_mount && (\n            <MountingHardwareSection\n              formData={formData}\n              onChange={handleFieldChange}\n              hardwareType=\"A\"\n              onClear={() => setShowClearHardwareA(true)}\n            />\n          )}\n        </RoofContainer>\n\n        {/* + Roof (B) Button - Only show when Roof B is not visible */}\n        {!formData.show_roof_b && (\n          <AddSectionButton\n            label=\"Roof (B)\"\n            onClick={handleShowRoofB}\n          />\n        )}\n\n        {/* Roof (B) Container - Conditionally visible */}\n        {formData.show_roof_b && (\n          <RoofContainer roofType=\"B\" onDelete={handleCancelRoofB}>\n            {/* Roofing (B) */}\n            <RoofingSection\n              formData={formData}\n              onChange={handleFieldChange}\n              roofType=\"B\"\n              onClear={() => setShowClearRoofingB(true)}\n              onCancel={handleCancelRoofB}\n            />\n\n            {/* Rails (B) - Hidden when Ground Mount is active */}\n            {!formData.rtb_ground_mount && (\n              <RailsSection\n                formData={formData}\n                onChange={handleFieldChange}\n                railType=\"B\"\n                onClear={() => setShowClearHardwareB(true)}\n              />\n            )}\n\n            {/* Attachment (B) - Hidden when Ground Mount is active */}\n            {!formData.rtb_ground_mount && (\n              <MountingHardwareSection\n                formData={formData}\n                onChange={handleFieldChange}\n                hardwareType=\"B\"\n                onClear={() => setShowClearHardwareB(true)}\n              />\n            )}\n          </RoofContainer>\n        )}\n\n        {/* Mounting Planes Container */}\n        <MountingPlanesContainer>\n          {Array.from({ length: formData.visible_planes }, (_, index) => {\n            const planeNumber = index + 1;\n            const isLastPlane = planeNumber === formData.visible_planes;\n\n            // Check if Roofing B exists based on rtb_roofing_material value\n            const hasRoofTypeB = !!(formData.rtb_roofing_material);\n\n            return (\n              <MountingPlaneSection\n                key={planeNumber}\n                formData={formData}\n                onChange={handleFieldChange}\n                planeNumber={planeNumber}\n                hasRoofTypeB={hasRoofTypeB}\n                onClear={() => handleOpenClearModal(planeNumber)}\n                onShowNextPlane={isLastPlane && planeNumber < maxPlanes ? handleShowNextPlane : null}\n                showNextPlane={isLastPlane && planeNumber < maxPlanes}\n                keepSameActive={planeNumber === 1 ? keepSameActive : undefined}\n                onKeepSameToggle={planeNumber === 1 ? handleKeepSameToggle : undefined}\n              />\n            );\n          })}\n        </MountingPlanesContainer>\n      </div>\n\n      {/* Clear Modals for all sections */}\n      <SectionClearModal\n        isOpen={showClearRoofingA}\n        onClose={() => setShowClearRoofingA(false)}\n        onConfirm={handleClearRoofingA}\n        sectionName=\"Roofing (A)\"\n      />\n\n      <SectionClearModal\n        isOpen={showClearHardwareA}\n        onClose={() => setShowClearHardwareA(false)}\n        onConfirm={handleClearMountingHardwareA}\n        sectionName=\"Mounting Hardware (A)\"\n      />\n\n      <SectionClearModal\n        isOpen={showClearRoofingB}\n        onClose={() => setShowClearRoofingB(false)}\n        onConfirm={handleClearRoofingB}\n        sectionName=\"Roofing (B)\"\n      />\n\n      <SectionClearModal\n        isOpen={showClearHardwareB}\n        onClose={() => setShowClearHardwareB(false)}\n        onConfirm={handleClearMountingHardwareB}\n        sectionName=\"Mounting Hardware (B)\"\n      />\n\n      <SectionClearModal\n        isOpen={clearModalPlaneNumber !== null}\n        onClose={() => setClearModalPlaneNumber(null)}\n        onConfirm={() => handleClearMountingPlane(clearModalPlaneNumber)}\n        sectionName={`Mounting Plane ${clearModalPlaneNumber}`}\n      />\n\n      {/* Keep Same Confirmation Modal */}\n      <ConfirmActionModal\n        isOpen={showKeepSameConfirm}\n        onClose={() => setShowKeepSameConfirm(false)}\n        onConfirm={handleConfirmKeepSame}\n        title=\"Overwrite Stories & Pitch?\"\n        message={\n          <>\n            This will overwrite <strong>Stories</strong> and <strong>Pitch</strong> values for all mounting planes (2-{formData.visible_planes}) with the values from Mounting Plane 1.\n          </>\n        }\n        confirmText=\"Overwrite All\"\n        cancelText=\"Cancel\"\n        scopedToPanel={true}\n      />\n\n      {/* Footer Navigation */}\n      <FormNavigationFooter\n        onPrev={handlePrev}\n        onNext={handleNext}\n        prevLabel=\"Prev\"\n        nextLabel=\"Next\"\n      />\n    </form>\n  );\n};\n\n// Helper function to generate empty plane fields\nfunction generatePlaneFields(planeNumber) {\n  const prefix = `mp${planeNumber}`;\n  return {\n    [`st_${prefix}_mode`]: 'Flush', // Default to Flush mode\n    [`${prefix}_stories`]: '',\n    [`${prefix}_pitch`]: '',\n    [`${prefix}_azimuth`]: '',\n    [`${prefix}_roof_type`]: 'A',\n    [`st_${prefix}_arrayqty_1`]: '',\n    [`st_${prefix}_arrayqty_2`]: '',\n    [`st_${prefix}_arrayqty_3`]: '',\n    [`st_${prefix}_arrayqty_4`]: '',\n    [`st_${prefix}_arrayqty_5`]: '',\n    [`st_${prefix}_arrayqty_6`]: '',\n    [`st_${prefix}_arrayqty_7`]: '',\n    [`st_${prefix}_arrayqty_8`]: '',\n    [`st_${prefix}_array1_orientation`]: '',\n    [`st_${prefix}_array2_orientation`]: '',\n    [`st_${prefix}_array3_orientation`]: '',\n    [`st_${prefix}_array4_orientation`]: '',\n    [`st_${prefix}_array5_orientation`]: '',\n    [`st_${prefix}_array6_orientation`]: '',\n    [`st_${prefix}_array7_orientation`]: '',\n    [`st_${prefix}_array8_orientation`]: '',\n  };\n}\n\n// Helper function to reset all plane roof types to A\nfunction resetPlanesRoofType(visiblePlanes) {\n  const updates = {};\n  for (let i = 1; i <= visiblePlanes; i++) {\n    updates[`mp${i}_roof_type`] = 'A';\n  }\n  return updates;\n}\n\nexport default StructuralForm;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\SubmitForm.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'useRef' is defined but never used.","line":1,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":44},{"ruleId":"no-unused-vars","severity":1,"message":"'useCallback' is defined but never used.","line":1,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":57},{"ruleId":"no-unused-vars","severity":1,"message":"'AttestationModal' is defined but never used.","line":4,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":24},{"ruleId":"no-unused-vars","severity":1,"message":"'GenerateStatusModal' is defined but never used.","line":5,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":27},{"ruleId":"no-unused-vars","severity":1,"message":"'TableDropdown' is defined but never used.","line":8,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":45},{"ruleId":"no-unused-vars","severity":1,"message":"'EquipmentRow' is defined but never used.","line":8,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":59},{"ruleId":"no-unused-vars","severity":1,"message":"'ConfirmActionModal' is defined but never used.","line":9,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":26},{"ruleId":"no-unused-vars","severity":1,"message":"'SystemContainer' is defined but never used.","line":10,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'projectStyles' is defined but never used.","line":15,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":21},{"ruleId":"no-unused-vars","severity":1,"message":"'validateForGeneration' is defined but never used.","line":17,"column":53,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":74},{"ruleId":"no-unused-vars","severity":1,"message":"'PROCESS_NAMES' is defined but never used.","line":18,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'GENERATION_STATUS' is defined but never used.","line":18,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":42},{"ruleId":"no-unused-vars","severity":1,"message":"'DOCUMENT_TYPES' is defined but never used.","line":18,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":58},{"ruleId":"no-unused-vars","severity":1,"message":"'handlePrev' is assigned a value but never used.","line":32,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'handlePrintDraft' is assigned a value but never used.","line":56,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":56,"endColumn":25},{"ruleId":"jsx-a11y/anchor-is-valid","severity":1,"message":"The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/anchor-is-valid.md","line":171,"column":13,"nodeType":"JSXOpeningElement","endLine":179,"endColumn":14},{"ruleId":"no-unused-vars","severity":1,"message":"'DisplayRow' is assigned a value but never used.","line":294,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":294,"endColumn":17},{"ruleId":"no-unused-vars","severity":1,"message":"'orderStatusLoading' is assigned a value but never used.","line":316,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":316,"endColumn":28},{"ruleId":"no-unused-vars","severity":1,"message":"'InfoField' is assigned a value but never used.","line":1007,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":1007,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":19,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport QCChecklistPanel from '../pdf/QCChecklistPanel';\r\nimport FormNavigationFooter from './FormNavigationFooter';\r\nimport AttestationModal from '../modals/AttestationModal';\r\nimport GenerateStatusModal from '../modals/GenerateStatusModal';\r\nimport UtilityValidationModal from '../modals/UtilityValidationModal';\r\nimport ProjectOverview from './ProjectOverview';\r\nimport { Button, FormFieldRow, TableDropdown, EquipmentRow, Alert } from '../ui';\r\nimport ConfirmActionModal from '../ui/ConfirmActionModal';\r\nimport SystemContainer from './equipment/SystemContainer';\r\nimport OrderContainer from './submit/OrderContainer';\r\nimport { getStampPermitOrders, createStampPermitOrders, formatOrderInfo } from '../../services/stampPermitService';\r\nimport equipStyles from './EquipmentForm.module.css';\r\nimport styles from './SubmitForm.module.css';\r\nimport projectStyles from '../../styles/ProjectAdd.module.css';\r\nimport { updateProjectStatus } from '../../services/projectService';\r\nimport { triggerPlanAutomation, fetchTriggerSecret, validateForGeneration } from '../../utils/triggerPlanAutomation';\r\nimport { PROCESS_NAMES, GENERATION_STATUS, DOCUMENT_TYPES } from '../../constants/generationConstants';\r\nimport { toast } from 'react-toastify';\r\nimport logger from '../../services/devLogger';\r\nimport { useSystemDetails } from '../../hooks';\r\nimport axios from '../../config/axios';\r\n\r\n/**\r\n * SubmitForm - Submission workflow component with sub-tabs\r\n * Replaces the Print tab with Overview, QC, and Print sub-tabs\r\n */\r\nconst SubmitForm = ({ projectUuid, projectData, onNavigateToTab }) => {\r\n  // Get system details for Overview tab\r\n  const { data: systemDetails } = useSystemDetails({ projectUuid });\r\n  // Navigation handlers\r\n  const handlePrev = () => {\r\n    if (onNavigateToTab) {\r\n      onNavigateToTab('structural');\r\n    }\r\n  };\r\n\r\n  const handleNext = () => {\r\n    // Navigate through sub-tabs: Overview â†’ QC â†’ Order & Print\r\n    if (selectedView === 'overview') {\r\n      setSelectedView('qc');\r\n    } else if (selectedView === 'qc') {\r\n      setSelectedView('print');\r\n    }\r\n    // On 'print' tab, Next does nothing (last tab)\r\n  };\r\n\r\n  const [selectedView, setSelectedView] = useState('overview');\r\n  const [activeQCType, setActiveQCType] = useState(null); // null, 'site', or 'design'\r\n  const [siteQcProgress, setSiteQcProgress] = useState(0);\r\n  const [designQcProgress, setDesignQcProgress] = useState(0);\r\n  const [isPublishing, setIsPublishing] = useState(false);\r\n  const [showGenerateConfirm, setShowGenerateConfirm] = useState(false);\r\n  const [isGenerating, setIsGenerating] = useState(false);\r\n\r\n  const handlePrintDraft = () => {\r\n    logger.log('Project', 'Generate Plan Set clicked');\r\n    setShowGenerateConfirm(true);\r\n  };\r\n\r\n  const handleConfirmGenerate = async () => {\r\n    setShowGenerateConfirm(false);\r\n    setIsGenerating(true);\r\n\r\n    try {\r\n      logger.log('Project', 'ðŸš€ Triggering GenerateProjects_Mobile automation for project:', projectUuid);\r\n\r\n      toast.info('Triggering plan set generation...', {\r\n        position: 'top-center',\r\n        autoClose: 2000,\r\n      });\r\n\r\n      // Fetch the secret token\r\n      const secretToken = await fetchTriggerSecret();\r\n\r\n      // Get user data from session\r\n      const userData = JSON.parse(sessionStorage.getItem('userData') || '{}');\r\n      const userUuid = userData.uuid || userData.id;\r\n      const companyUuid = userData?.company?.uuid || projectData?.company_id;\r\n\r\n      if (!companyUuid) {\r\n        throw new Error('Company ID not found');\r\n      }\r\n\r\n      const automationOptions = {\r\n        companyUuid,\r\n        userUuid,\r\n        computerName: 'ServerComputer2',\r\n      };\r\n\r\n      // Trigger the plan set generation automation\r\n      await triggerPlanAutomation(\r\n        projectUuid,\r\n        secretToken,\r\n        'GenerateProjects_Mobile',\r\n        automationOptions\r\n      );\r\n\r\n      logger.success('Project', 'âœ… Plan set generation triggered successfully');\r\n      toast.success('Plan set generation triggered successfully', {\r\n        position: 'top-center',\r\n        autoClose: 3000,\r\n      });\r\n\r\n    } catch (error) {\r\n      logger.error('Project', 'âŒ Failed to trigger plan set generation:', error);\r\n      toast.error(error.response?.data?.message || error.message || 'Failed to trigger plan set generation. Please try again.', {\r\n        position: 'top-center',\r\n        autoClose: 5000,\r\n      });\r\n    } finally {\r\n      setIsGenerating(false);\r\n    }\r\n  };\r\n\r\n  // Calculate total QC progress (average of both)\r\n  const totalQcProgress = Math.round((siteQcProgress + designQcProgress) / 2);\r\n\r\n  // View configuration\r\n  const viewSteps = [\r\n    { key: 'overview', label: 'Overview' },\r\n    { key: 'qc', label: 'QC' },\r\n    { key: 'print', label: 'Order & Print' },\r\n  ];\r\n\r\n  // Handle publish to permitting\r\n  const handlePublish = async () => {\r\n    if (siteQcProgress < 100 || designQcProgress < 100) {\r\n      alert('Please complete both Site QC and Design QC checklists before publishing.');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsPublishing(true);\r\n      const userData = JSON.parse(sessionStorage.getItem('userData') || '{}');\r\n      const companyId = userData?.company?.uuid;\r\n\r\n      if (!companyId) {\r\n        throw new Error('Company ID not found');\r\n      }\r\n\r\n      // Update project status to permitting (completed_step progression)\r\n      await updateProjectStatus(projectUuid, companyId, 5); // Assuming 5 = permitting stage\r\n\r\n      alert('Project successfully published to permitting!');\r\n      // Optionally refresh or navigate\r\n    } catch (error) {\r\n      logger.error('Project', 'Error publishing project:', error);\r\n      alert('Failed to publish project. Please try again.');\r\n    } finally {\r\n      setIsPublishing(false);\r\n    }\r\n  };\r\n\r\n  // Handle QC progress changes\r\n  const handleSiteQCProgress = (progress) => {\r\n    setSiteQcProgress(progress);\r\n  };\r\n\r\n  const handleDesignQCProgress = (progress) => {\r\n    setDesignQcProgress(progress);\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={(e) => e.preventDefault()} className={styles.formContainer}>\r\n      {/* Sticky Header Section - Sub-tab Navigation */}\r\n      <div className={equipStyles.stickyHeader}>\r\n        {/* View Navigation - Overview, Draft, QC, Spec Sheets */}\r\n        <div className={`${styles.viewNavigation} ${selectedView === 'qc' ? styles.viewNavigationWithQC : ''}`}>\r\n          {viewSteps.map((view, index) => (\r\n            <a\r\n              key={view.key}\r\n              href=\"#\"\r\n              onClick={(e) => {\r\n                e.preventDefault();\r\n                setSelectedView(view.key);\r\n              }}\r\n              className={`${styles.viewLink} ${index === 0 ? styles.viewLinkFirst : ''} ${selectedView === view.key ? styles.viewLinkActive : ''}`}\r\n            >\r\n              {view.label}\r\n              {selectedView === view.key && (\r\n                <span className={`${styles.viewLinkIndicator} ${index === 0 ? styles.viewLinkIndicatorFirst : styles.viewLinkIndicatorCenter}`} />\r\n              )}\r\n            </a>\r\n          ))}\r\n        </div>\r\n\r\n        {/* QC Pill Buttons - Show only when QC tab is selected */}\r\n        {selectedView === 'qc' && (\r\n          <div className={styles.qcPillButtons}>\r\n            {/* Site QC Button */}\r\n            <button\r\n              onClick={() => {\r\n                const newType = activeQCType === 'site' ? null : 'site';\r\n                setActiveQCType(newType);\r\n              }}\r\n              className={`${styles.qcPillButton} ${activeQCType === 'site' ? styles.qcPillButtonSiteActive : styles.qcPillButtonSite}`}\r\n            >\r\n              Site Plan QC\r\n            </button>\r\n\r\n            {/* Design QC Button */}\r\n            <button\r\n              onClick={() => {\r\n                const newType = activeQCType === 'design' ? null : 'design';\r\n                setActiveQCType(newType);\r\n              }}\r\n              className={`${styles.qcPillButton} ${activeQCType === 'design' ? styles.qcPillButtonDesignActive : styles.qcPillButtonDesign}`}\r\n            >\r\n              Design QC\r\n            </button>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Scrollable Content */}\r\n      <div className={equipStyles.scrollableContent}>\r\n        {/* Overview View */}\r\n        {selectedView === 'overview' && (\r\n          <ProjectOverview projectData={projectData} systemDetails={systemDetails} readOnly={false} />\r\n        )}\r\n\r\n        {/* QC View */}\r\n        {selectedView === 'qc' && (\r\n          <QCSubTab\r\n            projectUuid={projectUuid}\r\n            siteQcProgress={siteQcProgress}\r\n            designQcProgress={designQcProgress}\r\n            totalQcProgress={totalQcProgress}\r\n            onSiteProgressChange={handleSiteQCProgress}\r\n            onDesignProgressChange={handleDesignQCProgress}\r\n            onPublish={handlePublish}\r\n            isPublishing={isPublishing}\r\n            activeQCType={activeQCType}\r\n            onQCTypeChange={setActiveQCType}\r\n          />\r\n        )}\r\n\r\n        {/* Print View */}\r\n        {selectedView === 'print' && (\r\n          <PrintSubTab projectUuid={projectUuid} projectData={projectData} />\r\n        )}\r\n      </div>\r\n\r\n      {/* Footer Navigation */}\r\n      <FormNavigationFooter\r\n        onPrev={null}\r\n        onNext={handleNext}\r\n        showNext={selectedView !== 'print'}\r\n        showPrev={false}\r\n        nextLabel=\"Next\"\r\n        centerButton={null}\r\n      />\r\n\r\n      {/* Generate Plan Set Confirmation Modal - Inline, contained within panel */}\r\n      {showGenerateConfirm && (\r\n        <div className={styles.modalOverlay}>\r\n          <div className={styles.modalDialog}>\r\n            <div className={styles.modalHeader}>\r\n              <h3 className={styles.modalTitle}>Generate Plan Set</h3>\r\n            </div>\r\n            <div className={styles.modalBody}>\r\n              <p className={styles.modalMessage}>\r\n                Please confirm that all project data has been entered correctly and completely.\r\n                This will trigger the plan set generation automation.\r\n              </p>\r\n            </div>\r\n            <div className={styles.modalFooter}>\r\n              <Button\r\n                variant=\"secondary\"\r\n                onClick={() => setShowGenerateConfirm(false)}\r\n                disabled={isGenerating}\r\n              >\r\n                Cancel\r\n              </Button>\r\n              <Button\r\n                variant=\"primary\"\r\n                onClick={handleConfirmGenerate}\r\n                loading={isGenerating}\r\n              >\r\n                Confirm & Generate\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </form>\r\n  );\r\n};\r\n\r\n/**\r\n * Helper component for read-only display rows\r\n */\r\nconst DisplayRow = ({ label, value }) => {\r\n  // Only render if value exists\r\n  if (!value) return null;\r\n  return (\r\n    <FormFieldRow label={label}>\r\n      <div className={styles.displayRowValue}>\r\n        {value}\r\n      </div>\r\n    </FormFieldRow>\r\n  );\r\n};\r\n\r\n/**\r\n * Print Sub-Tab - Draft printing, PE stamps, and permit ordering\r\n */\r\nconst PrintSubTab = ({ projectUuid, projectData }) => {\r\n  // Draft version state\r\n  const [draftVersion, setDraftVersion] = useState(1);\r\n  const [isGenerating, setIsGenerating] = useState(false);\r\n\r\n  // ORDER STATUS from API (what's already been ordered)\r\n  const [orderStatus, setOrderStatus] = useState(null);\r\n  const [orderStatusLoading, setOrderStatusLoading] = useState(true);\r\n\r\n  // PE Stamps - SELECTION state (what user wants to order)\r\n  const [structuralStampSelected, setStructuralStampSelected] = useState(false);\r\n  const [electricalStampSelected, setElectricalStampSelected] = useState(false);\r\n  const [selectedPublishedVersion, setSelectedPublishedVersion] = useState(null);\r\n\r\n  // Permits - SELECTION state (what user wants to order)\r\n  const [buildingPermitSelected, setBuildingPermitSelected] = useState(false);\r\n  const [interconnectionSelected, setInterconnectionSelected] = useState(false);\r\n\r\n  // Confirmation dialogs\r\n  const [showPrintDraftConfirm, setShowPrintDraftConfirm] = useState(false);\r\n  const [showPEStampConfirm, setShowPEStampConfirm] = useState(false);\r\n  const [showPermitConfirm, setShowPermitConfirm] = useState(false);\r\n  const [showUtilityModal, setShowUtilityModal] = useState(false);\r\n\r\n  // Ordering state\r\n  const [isOrderingStamps, setIsOrderingStamps] = useState(false);\r\n  const [isOrderingPermits, setIsOrderingPermits] = useState(false);\r\n\r\n  // Mock published versions (TODO: fetch from API)\r\n  const publishedVersions = [\r\n    { value: 1, label: 'V1' },\r\n    { value: 2, label: 'V2' },\r\n    { value: 3, label: 'V3 (Latest)' },\r\n  ];\r\n\r\n  // Derived: check if each type is already ordered\r\n  const structuralAlreadyOrdered = orderStatus?.structural_pe_stamp?.ordered || false;\r\n  const electricalAlreadyOrdered = orderStatus?.electrical_pe_stamp?.ordered || false;\r\n  const buildingAlreadyOrdered = orderStatus?.building_permit?.ordered || false;\r\n  const interconnectionAlreadyOrdered = orderStatus?.interconnection_application?.ordered || false;\r\n\r\n  // Fetch order status on mount\r\n  useEffect(() => {\r\n    const fetchOrderStatus = async () => {\r\n      if (!projectUuid) return;\r\n\r\n      try {\r\n        setOrderStatusLoading(true);\r\n        const data = await getStampPermitOrders(projectUuid);\r\n        setOrderStatus(data);\r\n      } catch (error) {\r\n        console.error('Failed to fetch stamp/permit order status:', error);\r\n      } finally {\r\n        setOrderStatusLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchOrderStatus();\r\n  }, [projectUuid]);\r\n\r\n  // Handle Print Draft click - Check utility first\r\n  const handlePrintDraft = () => {\r\n    // Check if utility is filled\r\n    const utility = projectData?.site?.utility;\r\n\r\n    if (!utility || utility.trim() === '') {\r\n      logger.warn('Project', 'Utility missing, showing validation modal');\r\n      setShowUtilityModal(true);\r\n      return;\r\n    }\r\n\r\n    // Utility is present, proceed with print confirmation\r\n    setShowPrintDraftConfirm(true);\r\n  };\r\n\r\n  // Handle utility save from modal\r\n  const handleUtilitySave = async (selectedUtility) => {\r\n    try {\r\n      console.log('[UtilitySave] ========== START ==========');\r\n      console.log('[UtilitySave] Selected utility:', selectedUtility);\r\n      console.log('[UtilitySave] projectData.site:', projectData?.site);\r\n\r\n      const userData = JSON.parse(sessionStorage.getItem('userData') || '{}');\r\n      const companyId = userData?.company?.uuid;\r\n\r\n      if (!companyId) {\r\n        throw new Error('Company ID not found');\r\n      }\r\n\r\n      // Build payload - API requires ALL address fields + apn/ahj must be strings\r\n      const payload = {\r\n        companyId,\r\n        address: projectData?.site?.address,\r\n        city: projectData?.site?.city,\r\n        state: projectData?.site?.state,\r\n        zipCode: projectData?.site?.zip_code, // API expects zipCode, data has zip_code\r\n        ahj: projectData?.site?.ahj || '', // Must be string, not null\r\n        utility: selectedUtility,\r\n        apn: projectData?.site?.apn || '', // Must be string, not null\r\n        squareFootage: projectData?.site?.squareFootage ? parseFloat(projectData.site.squareFootage) : null\r\n      };\r\n\r\n      console.log('[UtilitySave] Payload to send:', JSON.stringify(payload, null, 2));\r\n\r\n      const response = await axios.put(`/project/${projectUuid}/site-info`, payload);\r\n\r\n      console.log('[UtilitySave] Success! Response:', response.data);\r\n      toast.success('Utility saved successfully', {\r\n        position: 'top-center',\r\n        autoClose: 2000\r\n      });\r\n\r\n      // Update local projectData to reflect the change\r\n      if (projectData && projectData.site) {\r\n        projectData.site.utility = selectedUtility;\r\n      }\r\n\r\n      // Close utility modal and proceed with print\r\n      setShowUtilityModal(false);\r\n      setShowPrintDraftConfirm(true);\r\n\r\n    } catch (error) {\r\n      console.error('[UtilitySave] ========== ERROR ==========');\r\n      console.error('[UtilitySave] Error:', error);\r\n      console.error('[UtilitySave] Error response data:', error.response?.data);\r\n      console.error('[UtilitySave] Error status:', error.response?.status);\r\n      console.error('[UtilitySave] Error response:', error.response);\r\n      toast.error(`Failed to save utility: ${error.response?.data?.message || error.message}`, {\r\n        position: 'top-center',\r\n        autoClose: 3000\r\n      });\r\n    }\r\n  };\r\n\r\n  // Confirm Print Draft\r\n  const handleConfirmPrintDraft = async () => {\r\n    setShowPrintDraftConfirm(false);\r\n    setIsGenerating(true);\r\n\r\n    try {\r\n      logger.log('Project', 'ðŸ–¨ï¸ Printing draft version:', draftVersion);\r\n\r\n      // TODO: Trigger actual print automation\r\n      const secretToken = await fetchTriggerSecret();\r\n      const userData = JSON.parse(sessionStorage.getItem('userData') || '{}');\r\n      const companyData = JSON.parse(sessionStorage.getItem('companyData') || '{}');\r\n\r\n      const options = {\r\n        companyUuid: companyData.uuid,\r\n        userUuid: userData.uuid,\r\n        computerName: 'ServerComputer2',\r\n      };\r\n\r\n      await triggerPlanAutomation(projectUuid, secretToken, 'GenerateProjects_Mobile', options);\r\n\r\n      // Increment draft version\r\n      setDraftVersion(prev => prev + 1);\r\n\r\n      toast.success(`Draft ${draftVersion} printed successfully!`, {\r\n        position: 'top-center',\r\n        autoClose: 3000,\r\n      });\r\n\r\n      logger.success('Project', 'âœ… Draft printed successfully');\r\n    } catch (error) {\r\n      logger.error('Project', 'âŒ Failed to print draft:', error);\r\n      toast.error('Failed to print draft. Please try again.', {\r\n        position: 'top-center',\r\n        autoClose: 5000,\r\n      });\r\n    } finally {\r\n      setIsGenerating(false);\r\n    }\r\n  };\r\n\r\n  // Handle Order PE Stamps\r\n  const handleOrderPEStamps = () => {\r\n    if (!structuralStampSelected && !electricalStampSelected) {\r\n      toast.warning('Please select at least one PE stamp to order', {\r\n        position: 'top-center',\r\n        autoClose: 3000,\r\n      });\r\n      return;\r\n    }\r\n    setShowPEStampConfirm(true);\r\n  };\r\n\r\n  // Confirm Order PE Stamps\r\n  const handleConfirmPEStamps = async () => {\r\n    setShowPEStampConfirm(false);\r\n    setIsOrderingStamps(true);\r\n\r\n    try {\r\n      const orderTypes = [];\r\n      if (structuralStampSelected) orderTypes.push('structural_pe_stamp');\r\n      if (electricalStampSelected) orderTypes.push('electrical_pe_stamp');\r\n\r\n      logger.log('Project', 'ðŸ“‹ Ordering PE stamps:', orderTypes, 'for version:', selectedPublishedVersion);\r\n\r\n      await createStampPermitOrders({\r\n        projectUuid,\r\n        orderTypes,\r\n        address: {\r\n          address: projectData?.site?.address,\r\n          city: projectData?.site?.city,\r\n          state: projectData?.site?.state,\r\n          zip_code: projectData?.site?.zip_code\r\n        }\r\n      });\r\n\r\n      // Refresh order status\r\n      const data = await getStampPermitOrders(projectUuid);\r\n      setOrderStatus(data);\r\n\r\n      // Clear selections\r\n      setStructuralStampSelected(false);\r\n      setElectricalStampSelected(false);\r\n\r\n      toast.success(`PE stamp order placed successfully!`, {\r\n        position: 'top-center',\r\n        autoClose: 3000,\r\n      });\r\n\r\n      logger.success('Project', 'âœ… PE stamps ordered successfully');\r\n    } catch (error) {\r\n      logger.error('Project', 'âŒ Failed to order PE stamps:', error);\r\n      toast.error('Failed to place order. Please try again.', {\r\n        position: 'top-center',\r\n        autoClose: 5000,\r\n      });\r\n    } finally {\r\n      setIsOrderingStamps(false);\r\n    }\r\n  };\r\n\r\n  // Handle Order Permits\r\n  const handleOrderPermits = () => {\r\n    if (!buildingPermitSelected && !interconnectionSelected) {\r\n      toast.warning('Please select at least one permit to order', {\r\n        position: 'top-center',\r\n        autoClose: 3000,\r\n      });\r\n      return;\r\n    }\r\n    setShowPermitConfirm(true);\r\n  };\r\n\r\n  // Confirm Order Permits\r\n  const handleConfirmPermits = async () => {\r\n    setShowPermitConfirm(false);\r\n    setIsOrderingPermits(true);\r\n\r\n    try {\r\n      const orderTypes = [];\r\n      if (buildingPermitSelected) orderTypes.push('building_permit');\r\n      if (interconnectionSelected) orderTypes.push('interconnection_application');\r\n\r\n      logger.log('Project', 'ðŸ“ Ordering permits:', orderTypes);\r\n\r\n      await createStampPermitOrders({\r\n        projectUuid,\r\n        orderTypes,\r\n        address: {\r\n          address: projectData?.site?.address,\r\n          city: projectData?.site?.city,\r\n          state: projectData?.site?.state,\r\n          zip_code: projectData?.site?.zip_code\r\n        }\r\n      });\r\n\r\n      // Refresh order status\r\n      const data = await getStampPermitOrders(projectUuid);\r\n      setOrderStatus(data);\r\n\r\n      // Clear selections\r\n      setBuildingPermitSelected(false);\r\n      setInterconnectionSelected(false);\r\n\r\n      toast.success(`Permit order placed successfully!`, {\r\n        position: 'top-center',\r\n        autoClose: 3000,\r\n      });\r\n\r\n      logger.success('Project', 'âœ… Permits ordered successfully');\r\n    } catch (error) {\r\n      logger.error('Project', 'âŒ Failed to order permits:', error);\r\n      toast.error('Failed to place order. Please try again.', {\r\n        position: 'top-center',\r\n        autoClose: 5000,\r\n      });\r\n    } finally {\r\n      setIsOrderingPermits(false);\r\n    }\r\n  };\r\n\r\n  // Handle eye icon - navigate to Plan Set tab\r\n  const handleViewVersion = () => {\r\n    if (selectedPublishedVersion) {\r\n      logger.log('Project', 'ðŸ‘ï¸ Viewing plan set version:', selectedPublishedVersion);\r\n      // TODO: Navigate to Plan Set tab with selected version\r\n      // This may require updating the parent component to support version navigation\r\n      toast.info(`Navigate to Plan Set V${selectedPublishedVersion}`, {\r\n        position: 'top-center',\r\n        autoClose: 2000,\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      {/* Section A: Print Draft */}\r\n      <OrderContainer title=\"Print Draft\">\r\n        <Button\r\n          variant=\"primary\"\r\n          onClick={handlePrintDraft}\r\n          loading={isGenerating}\r\n          size=\"lg\"\r\n          className={styles.printDraftButton}\r\n        >\r\n          Print Draft {draftVersion}\r\n        </Button>\r\n\r\n        <Alert variant=\"info\" collapsible={false}>\r\n          <strong>Note:</strong> Only printed drafts can be converted into a published plan set.\r\n        </Alert>\r\n      </OrderContainer>\r\n\r\n      {/* Section B: Order PE Stamps */}\r\n      <OrderContainer title=\"Order PE Stamps\">\r\n\r\n        <div className={styles.orderSectionContent}>\r\n          {/* Checkboxes */}\r\n          <div className={styles.orderCheckboxGroup}>\r\n            {/* Structural PE Stamp */}\r\n            {structuralAlreadyOrdered ? (\r\n              <div className={styles.checkboxOrdered}>\r\n                <span className={styles.checkboxCheckmark}>âœ“</span>\r\n                <div>\r\n                  <div>Structural PE Stamp</div>\r\n                  <div className={styles.checkboxOrderInfo}>\r\n                    {formatOrderInfo(orderStatus.structural_pe_stamp)}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <label className={styles.checkboxLabel}>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={structuralStampSelected}\r\n                  onChange={(e) => setStructuralStampSelected(e.target.checked)}\r\n                  className={styles.checkboxInput}\r\n                />\r\n                + Structural PE Stamp\r\n              </label>\r\n            )}\r\n\r\n            {/* Electrical PE Stamp */}\r\n            {electricalAlreadyOrdered ? (\r\n              <div className={styles.checkboxOrderedLast}>\r\n                <span className={styles.checkboxCheckmark}>âœ“</span>\r\n                <div>\r\n                  <div>Electrical PE Stamp</div>\r\n                  <div className={styles.checkboxOrderInfo}>\r\n                    {formatOrderInfo(orderStatus.electrical_pe_stamp)}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <label className={styles.checkboxLabelLast}>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={electricalStampSelected}\r\n                  onChange={(e) => setElectricalStampSelected(e.target.checked)}\r\n                  className={styles.checkboxInput}\r\n                />\r\n                + Electrical PE Stamp\r\n              </label>\r\n            )}\r\n          </div>\r\n\r\n          {/* Published Version Dropdown with Eye Icon */}\r\n          <div className={styles.versionSelectorRow}>\r\n            <label className={styles.versionLabel}>\r\n              Published Plan Set:\r\n            </label>\r\n\r\n            <select\r\n              value={selectedPublishedVersion || ''}\r\n              onChange={(e) => setSelectedPublishedVersion(Number(e.target.value))}\r\n              className={styles.versionSelect}\r\n            >\r\n              <option value=\"\">Select version...</option>\r\n              {publishedVersions.map(v => (\r\n                <option key={v.value} value={v.value}>{v.label}</option>\r\n              ))}\r\n            </select>\r\n\r\n            {/* Eye Icon Button */}\r\n            <button\r\n              onClick={handleViewVersion}\r\n              disabled={!selectedPublishedVersion}\r\n              className={selectedPublishedVersion ? styles.versionViewButton : styles.versionViewButtonDisabled}\r\n              title=\"View selected version\"\r\n            >\r\n              ðŸ‘ï¸\r\n            </button>\r\n          </div>\r\n\r\n          {/* Order Button or All Ordered Message */}\r\n          {structuralAlreadyOrdered && electricalAlreadyOrdered ? (\r\n            <Alert variant=\"success\" collapsible={false}>\r\n              All PE stamps have been ordered.\r\n            </Alert>\r\n          ) : (\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={handleOrderPEStamps}\r\n              disabled={!structuralStampSelected && !electricalStampSelected}\r\n              loading={isOrderingStamps}\r\n            >\r\n              Order PE Stamps\r\n            </Button>\r\n          )}\r\n        </div>\r\n      </OrderContainer>\r\n\r\n      {/* Section C: Order Permits */}\r\n      <OrderContainer title=\"Order Permits\">\r\n\r\n        <div className={styles.orderSectionContent}>\r\n          {/* Checkboxes */}\r\n          <div className={styles.orderCheckboxGroup}>\r\n            {/* Building Permit */}\r\n            {buildingAlreadyOrdered ? (\r\n              <div className={styles.checkboxOrdered}>\r\n                <span className={styles.checkboxCheckmark}>âœ“</span>\r\n                <div>\r\n                  <div>Building Permit Application</div>\r\n                  <div className={styles.checkboxOrderInfo}>\r\n                    {formatOrderInfo(orderStatus.building_permit)}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <label className={styles.checkboxLabel}>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={buildingPermitSelected}\r\n                  onChange={(e) => setBuildingPermitSelected(e.target.checked)}\r\n                  className={styles.checkboxInput}\r\n                />\r\n                Building Permit Application\r\n              </label>\r\n            )}\r\n\r\n            {/* Interconnection Application */}\r\n            {interconnectionAlreadyOrdered ? (\r\n              <div className={styles.checkboxOrderedLast}>\r\n                <span className={styles.checkboxCheckmark}>âœ“</span>\r\n                <div>\r\n                  <div>Interconnection Application</div>\r\n                  <div className={styles.checkboxOrderInfo}>\r\n                    {formatOrderInfo(orderStatus.interconnection_application)}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <label className={styles.checkboxLabelLast}>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={interconnectionSelected}\r\n                  onChange={(e) => setInterconnectionSelected(e.target.checked)}\r\n                  className={styles.checkboxInput}\r\n                />\r\n                Interconnection Application\r\n              </label>\r\n            )}\r\n          </div>\r\n\r\n          {/* Order Button or All Ordered Message */}\r\n          {buildingAlreadyOrdered && interconnectionAlreadyOrdered ? (\r\n            <Alert variant=\"success\" collapsible={false}>\r\n              All permits have been ordered.\r\n            </Alert>\r\n          ) : (\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={handleOrderPermits}\r\n              disabled={!buildingPermitSelected && !interconnectionSelected}\r\n              loading={isOrderingPermits}\r\n            >\r\n              Order Permits\r\n            </Button>\r\n          )}\r\n        </div>\r\n      </OrderContainer>\r\n\r\n      {/* Print Draft Confirmation Modal */}\r\n      {showPrintDraftConfirm && (\r\n        <div className={styles.modalOverlay}>\r\n          <div className={styles.modalDialog}>\r\n            <div className={styles.modalHeader}>\r\n              <h3 className={styles.modalTitle}>Print Draft {draftVersion}</h3>\r\n            </div>\r\n            <div className={styles.modalBody}>\r\n              <p className={styles.modalMessage}>\r\n                Confirm that you want to print Draft {draftVersion}. This will trigger the plan set generation automation.\r\n              </p>\r\n            </div>\r\n            <div className={styles.modalFooter}>\r\n              <Button\r\n                variant=\"secondary\"\r\n                onClick={() => setShowPrintDraftConfirm(false)}\r\n                disabled={isGenerating}\r\n              >\r\n                Cancel\r\n              </Button>\r\n              <Button\r\n                variant=\"primary\"\r\n                onClick={handleConfirmPrintDraft}\r\n                loading={isGenerating}\r\n              >\r\n                Confirm & Print\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* PE Stamp Confirmation Modal */}\r\n      {showPEStampConfirm && (\r\n        <div className={styles.modalOverlay}>\r\n          <div className={styles.modalDialog}>\r\n            <div className={styles.modalHeader}>\r\n              <h3 className={styles.modalTitle}>Order PE Stamps</h3>\r\n            </div>\r\n            <div className={styles.modalBody}>\r\n              <p className={styles.modalMessage}>\r\n                Confirm PE stamp order for Plan Set V{selectedPublishedVersion}:\r\n              </p>\r\n              <ul className={styles.modalList}>\r\n                {structuralStampSelected && <li>Structural PE Stamp</li>}\r\n                {electricalStampSelected && <li>Electrical PE Stamp</li>}\r\n              </ul>\r\n            </div>\r\n            <div className={styles.modalFooter}>\r\n              <Button\r\n                variant=\"secondary\"\r\n                onClick={() => setShowPEStampConfirm(false)}\r\n              >\r\n                Cancel\r\n              </Button>\r\n              <Button\r\n                variant=\"primary\"\r\n                onClick={handleConfirmPEStamps}\r\n              >\r\n                Confirm Order\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Permit Confirmation Modal */}\r\n      {showPermitConfirm && (\r\n        <div className={styles.modalOverlay}>\r\n          <div className={styles.modalDialog}>\r\n            <div className={styles.modalHeader}>\r\n              <h3 className={styles.modalTitle}>Order Permits</h3>\r\n            </div>\r\n            <div className={styles.modalBody}>\r\n              <p className={styles.modalMessage}>\r\n                Confirm permit order:\r\n              </p>\r\n              <ul className={styles.modalList}>\r\n                {buildingPermitSelected && <li>Building Permit Application</li>}\r\n                {interconnectionSelected && <li>Interconnection Application</li>}\r\n              </ul>\r\n            </div>\r\n            <div className={styles.modalFooter}>\r\n              <Button\r\n                variant=\"secondary\"\r\n                onClick={() => setShowPermitConfirm(false)}\r\n              >\r\n                Cancel\r\n              </Button>\r\n              <Button\r\n                variant=\"primary\"\r\n                onClick={handleConfirmPermits}\r\n              >\r\n                Confirm Order\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Utility Validation Modal */}\r\n      <UtilityValidationModal\r\n        isOpen={showUtilityModal}\r\n        onClose={() => setShowUtilityModal(false)}\r\n        onSave={handleUtilitySave}\r\n        zipCode={projectData?.site?.zip_code}\r\n        projectUuid={projectUuid}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\n/**\r\n * QC Sub-Tab - Quality control checklist panel area\r\n */\r\nconst QCSubTab = ({\r\n  projectUuid,\r\n  siteQcProgress,\r\n  designQcProgress,\r\n  totalQcProgress,\r\n  onSiteProgressChange,\r\n  onDesignProgressChange,\r\n  onPublish,\r\n  isPublishing,\r\n  activeQCType,\r\n  onQCTypeChange\r\n}) => {\r\n  const qcPanelRef = React.useRef(null);\r\n  const containerRef = React.useRef(null);\r\n\r\n  const handleReset = () => {\r\n    if (qcPanelRef.current) {\r\n      qcPanelRef.current.reset();\r\n    }\r\n  };\r\n\r\n  const progressPercent = activeQCType === 'site' ? siteQcProgress : designQcProgress;\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      className={styles.qcContainer}>\r\n      {/* QC Panel - Embedded directly in scrollable area */}\r\n      {activeQCType && (\r\n        <>\r\n          <div className={styles.qcPanelWrapper}>\r\n            <QCChecklistPanel\r\n              ref={qcPanelRef}\r\n              isOpen={true}\r\n              onClose={() => onQCTypeChange(null)}\r\n              projectId={projectUuid}\r\n              checklistType={activeQCType}\r\n              onProgressChange={activeQCType === 'site' ? onSiteProgressChange : onDesignProgressChange}\r\n            />\r\n          </div>\r\n\r\n          {/* Fixed Footer Actions */}\r\n          <div className={styles.qcFooter}>\r\n            <button\r\n              onClick={handleReset}\r\n              className={styles.resetButton}\r\n            >\r\n              Reset All\r\n            </button>\r\n            <button\r\n              onClick={() => onQCTypeChange(null)}\r\n              className={`${styles.saveButton} ${progressPercent === 100 ? styles.saveButtonSuccess : styles.saveButtonPrimary}`}\r\n            >\r\n              {progressPercent === 100 ? 'âœ“ Save & Close' : 'Save & Close'}\r\n            </button>\r\n          </div>\r\n        </>\r\n      )}\r\n\r\n      {/* Publish Button - Show when both complete */}\r\n      {!activeQCType && totalQcProgress === 100 && (\r\n        <div className={styles.publishCenter}>\r\n          <button\r\n            type=\"button\"\r\n            onClick={onPublish}\r\n            disabled={isPublishing}\r\n            className={`${styles.publishButton} ${isPublishing ? styles.publishButtonDisabled : styles.publishButtonEnabled}`}\r\n          >\r\n            {isPublishing ? 'Publishing...' : 'âœ“ Publish to Permitting'}\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Warning message when incomplete and no panel open */}\r\n      {!activeQCType && totalQcProgress < 100 && (\r\n        <div className={styles.warningAlert}>\r\n          Complete both Site QC and Design QC checklists to enable publishing to permitting.\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n/**\r\n * Helper component for displaying info fields\r\n */\r\nconst InfoField = ({ label, value }) => (\r\n  <div className={styles.infoField}>\r\n    <div className={styles.infoLabel}>\r\n      {label}\r\n    </div>\r\n    <div className={styles.infoValue}>\r\n      {value}\r\n    </div>\r\n  </div>\r\n);\r\n\r\nexport default SubmitForm;\r\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\SurveyNotesGallery.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\SurveyNotesPanel.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\SurveyPanel.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'UploadIcon' is assigned a value but never used.","line":54,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":54,"endColumn":17},{"ruleId":"no-unused-vars","severity":1,"message":"'videoCount' is assigned a value but never used.","line":79,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":79,"endColumn":20},{"ruleId":"no-unused-vars","severity":1,"message":"'setVideoCount' is assigned a value but never used.","line":79,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":79,"endColumn":35},{"ruleId":"no-unused-vars","severity":1,"message":"'handleUploadClick' is assigned a value but never used.","line":87,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":87,"endColumn":26}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport CompactTabs from '../common/CompactTabs';\nimport SurveyNotesPanel from './SurveyNotesPanel';\nimport MediaGallery from './MediaGallery';\nimport EquipmentSectionGroup from './EquipmentSectionGroup';\nimport SiteSurveyReportPanel from './survey/SiteSurveyReportPanel';\nimport styles from '../../styles/SurveyPanel.module.css';\n\n// Simple SVG icons for grid toggle\nconst GridIcon2x2 = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"currentColor\">\n    <rect x=\"1\" y=\"1\" width=\"6\" height=\"6\" rx=\"1\" />\n    <rect x=\"9\" y=\"1\" width=\"6\" height=\"6\" rx=\"1\" />\n    <rect x=\"1\" y=\"9\" width=\"6\" height=\"6\" rx=\"1\" />\n    <rect x=\"9\" y=\"9\" width=\"6\" height=\"6\" rx=\"1\" />\n  </svg>\n);\n\nconst GridIcon3x3 = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"currentColor\">\n    <rect x=\"1\" y=\"1\" width=\"4\" height=\"4\" rx=\"0.5\" />\n    <rect x=\"6\" y=\"1\" width=\"4\" height=\"4\" rx=\"0.5\" />\n    <rect x=\"11\" y=\"1\" width=\"4\" height=\"4\" rx=\"0.5\" />\n    <rect x=\"1\" y=\"6\" width=\"4\" height=\"4\" rx=\"0.5\" />\n    <rect x=\"6\" y=\"6\" width=\"4\" height=\"4\" rx=\"0.5\" />\n    <rect x=\"11\" y=\"6\" width=\"4\" height=\"4\" rx=\"0.5\" />\n    <rect x=\"1\" y=\"11\" width=\"4\" height=\"4\" rx=\"0.5\" />\n    <rect x=\"6\" y=\"11\" width=\"4\" height=\"4\" rx=\"0.5\" />\n    <rect x=\"11\" y=\"11\" width=\"4\" height=\"4\" rx=\"0.5\" />\n  </svg>\n);\n\nconst GridIcon4x4 = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"currentColor\">\n    <rect x=\"1\" y=\"1\" width=\"2.5\" height=\"2.5\" rx=\"0.3\" />\n    <rect x=\"4.5\" y=\"1\" width=\"2.5\" height=\"2.5\" rx=\"0.3\" />\n    <rect x=\"8\" y=\"1\" width=\"2.5\" height=\"2.5\" rx=\"0.3\" />\n    <rect x=\"11.5\" y=\"1\" width=\"2.5\" height=\"2.5\" rx=\"0.3\" />\n    <rect x=\"1\" y=\"4.5\" width=\"2.5\" height=\"2.5\" rx=\"0.3\" />\n    <rect x=\"4.5\" y=\"4.5\" width=\"2.5\" height=\"2.5\" rx=\"0.3\" />\n    <rect x=\"8\" y=\"4.5\" width=\"2.5\" height=\"2.5\" rx=\"0.3\" />\n    <rect x=\"11.5\" y=\"4.5\" width=\"2.5\" height=\"2.5\" rx=\"0.3\" />\n    <rect x=\"1\" y=\"8\" width=\"2.5\" height=\"2.5\" rx=\"0.3\" />\n    <rect x=\"4.5\" y=\"8\" width=\"2.5\" height=\"2.5\" rx=\"0.3\" />\n    <rect x=\"8\" y=\"8\" width=\"2.5\" height=\"2.5\" rx=\"0.3\" />\n    <rect x=\"11.5\" y=\"8\" width=\"2.5\" height=\"2.5\" rx=\"0.3\" />\n    <rect x=\"1\" y=\"11.5\" width=\"2.5\" height=\"2.5\" rx=\"0.3\" />\n    <rect x=\"4.5\" y=\"11.5\" width=\"2.5\" height=\"2.5\" rx=\"0.3\" />\n    <rect x=\"8\" y=\"11.5\" width=\"2.5\" height=\"2.5\" rx=\"0.3\" />\n    <rect x=\"11.5\" y=\"11.5\" width=\"2.5\" height=\"2.5\" rx=\"0.3\" />\n  </svg>\n);\n\nconst UploadIcon = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n    <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" />\n    <polyline points=\"17 8 12 3 7 8\" />\n    <line x1=\"12\" y1=\"3\" x2=\"12\" y2=\"15\" />\n  </svg>\n);\n\n/**\n * SurveyPanel - Parent container for survey-related content with sub-tabs\n * Replaces the old Gallery tab with organized survey data\n *\n * Sub-tabs: Notes, Photos, Videos, SS Report\n *\n * @param {string} projectUuid - Project UUID for fetching survey data\n * @param {function} onSwitchToFilesTab - Callback to switch to main Files tab\n */\nconst SurveyPanel = ({ projectUuid, onSwitchToFilesTab }) => {\n  const [activeTab, setActiveTab] = useState(() => {\n    return localStorage.getItem('surveyPanelTab') || 'photos';\n  });\n  const [gridSize, setGridSize] = useState(() => {\n    return localStorage.getItem('surveyGalleryGridSize') || 'medium';\n  });\n  const [photoCount, setPhotoCount] = useState(0);\n  const [videoCount, setVideoCount] = useState(0);\n  const [uploadTrigger, setUploadTrigger] = useState({ type: null, timestamp: 0 });\n\n  const handleGridSizeChange = (size) => {\n    setGridSize(size);\n    localStorage.setItem('surveyGalleryGridSize', size);\n  };\n\n  const handleUploadClick = (mediaType) => {\n    setUploadTrigger({ type: mediaType, timestamp: Date.now() });\n  };\n\n  const renderControls = (activeTab) => {\n    if (activeTab === 'photos' || activeTab === 'all') {\n      const count = activeTab === 'photos' ? photoCount : null;\n\n      return (\n        <React.Fragment>\n          {count !== null && (\n            <span className={styles.mediaCount}>\n              {count} items\n            </span>\n          )}\n\n          <div className={styles.gridToggle}>\n            <button\n              type=\"button\"\n              className={`${styles.gridBtn} ${gridSize === 'large' ? styles.active : ''}`}\n              onClick={() => handleGridSizeChange('large')}\n              title=\"Large thumbnails\"\n            >\n              <GridIcon2x2 />\n            </button>\n            <button\n              type=\"button\"\n              className={`${styles.gridBtn} ${gridSize === 'medium' ? styles.active : ''}`}\n              onClick={() => handleGridSizeChange('medium')}\n              title=\"Medium thumbnails\"\n            >\n              <GridIcon3x3 />\n            </button>\n            <button\n              type=\"button\"\n              className={`${styles.gridBtn} ${gridSize === 'small' ? styles.active : ''}`}\n              onClick={() => handleGridSizeChange('small')}\n              title=\"Small thumbnails\"\n            >\n              <GridIcon4x4 />\n            </button>\n          </div>\n        </React.Fragment>\n      );\n    }\n    return null;\n  };\n\n  const tabContent = {\n    all: <EquipmentSectionGroup projectUuid={projectUuid} gridSize={gridSize} />,\n    photos: (\n      <MediaGallery\n        projectUuid={projectUuid}\n        mediaType=\"both\"\n        gridSize={gridSize}\n        onCountChange={setPhotoCount}\n        uploadTrigger={uploadTrigger.type === 'photos' ? uploadTrigger.timestamp : 0}\n        enableUploads={false}\n        onTabSwitch={onSwitchToFilesTab}\n      />\n    ),\n    notes: (\n      <SurveyNotesPanel projectUuid={projectUuid} compact={false} />\n    ),\n    report: (\n      <SiteSurveyReportPanel projectUuid={projectUuid} />\n    ),\n  };\n\n  return (\n    <div className={styles.surveyPanel}>\n      <CompactTabs\n        tabs={[\n          { id: 'all', label: 'All' },\n          { id: 'photos', label: 'Photos' },\n          { id: 'notes', label: 'Notes' },\n          { id: 'report', label: 'SS Report' },\n        ]}\n        defaultTab=\"photos\"\n        storageKey=\"surveyPanelTab\"\n        renderControls={renderControls}\n        tabContent={tabContent}\n        activeTab={activeTab}\n        onTabChange={setActiveTab}\n      />\n    </div>\n  );\n};\n\nexport default SurveyPanel;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\UploadZone.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\VideoPlaceholder.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\electrical\\MainCircuitBreakersSection.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\electrical\\MainPanelASection.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\electrical\\PointOfInterconnectionSection.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'BREAKER_RATING_OPTIONS' is defined but never used.","line":2,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":50},{"ruleId":"no-unused-vars","severity":1,"message":"'FormFieldRow' is defined but never used.","line":4,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":58},{"ruleId":"no-unused-vars","severity":1,"message":"'TableRowButton' is defined but never used.","line":4,"column":60,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":74}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { POI_TYPE_OPTIONS, BREAKER_RATING_OPTIONS } from '../../../utils/constants';\nimport { usePCSCalculations } from '../../../hooks/usePCSCalculations';\nimport { Alert, EquipmentRow, TableDropdown, FormFieldRow, TableRowButton, SectionClearModal } from '../../ui';\nimport equipStyles from '../EquipmentForm.module.css';\n\n/**\n * Point of Interconnection Section\n * Defines how solar/battery system connects to electrical service\n * Includes Power Control System (PCS) for battery-backed systems\n *\n * @param {Object} formData - Form state containing all field values\n * @param {Function} onChange - Handler for field changes\n * @param {number} systemNumber - System number (1-4)\n * @param {Object} batteryData - Battery configuration from equipment form\n * @param {Object} inverterData - Inverter configuration from equipment form\n * @param {Object} panelData - Electrical panel data (bus bar, main breaker)\n * @param {boolean} isCombinedSystem - Whether this is a combined system\n * @param {number} combinedSystemMaxOutput - Max output for combined systems\n */\nconst PointOfInterconnectionSection = ({\n  formData,\n  onChange,\n  systemNumber = 1,\n  batteryData = {},\n  inverterData = {},\n  panelData = {},\n  isCombinedSystem = false,\n  combinedSystemMaxOutput = null,\n}) => {\n  // ============================================\n  // LOCAL STATE\n  // ============================================\n\n  const [showClearConfirm, setShowClearConfirm] = useState(false);\n\n  // ============================================\n  // FIELD NAMES\n  // ============================================\n\n  const pcsFieldName = `sys${systemNumber}_pcs_amps`;\n  const pcsSettingsFieldName = `sys${systemNumber}_pcs_settings`; // Syncs with GatewayConfigurationSection\n  const locationFieldName = systemNumber === 1 ? 'ele_breaker_location' : `sys${systemNumber}_ele_breaker_location`;\n\n  // ============================================\n  // PCS ACTIVATION STATE (from formData)\n  // ============================================\n\n  // Read manual PCS activation from formData instead of local state\n  // This syncs with gatewayConfigActivatePCS in Equipment form\n  const manualPcsActivated = formData[pcsSettingsFieldName] === true || formData[pcsSettingsFieldName] === 'true';\n\n  // ============================================\n  // CURRENT FORM VALUES\n  // ============================================\n\n  const poiType = formData.ele_method_of_interconnection || '';\n\n  // ============================================\n  // PCS CALCULATIONS HOOK\n  // ============================================\n\n  const pcsCalculations = usePCSCalculations({\n    systemNumber,\n    batteryMake1: batteryData.battery1_make,\n    batteryModel1: batteryData.battery1_model,\n    batteryQty1: batteryData.battery1_qty, // Fixed: Use battery1_qty (not battery1_quantity)\n    batteryMake2: batteryData.battery2_make,\n    batteryModel2: batteryData.battery2_model,\n    batteryQty2: batteryData.battery2_qty, // Fixed: Use battery2_qty (not battery2_quantity)\n    inverterMake: inverterData.inverter_make,\n    inverterModel: inverterData.inverter_model,\n    inverterType: inverterData.inverter_type,\n    microinverterQty: inverterData.microinverter_qty,\n    maxContOutputAmps: inverterData.max_cont_output_amps, // Fixed: Use max_cont_output_amps (not inverter_max_cont_output_amps)\n    busBarRating: panelData.bus_bar_rating ? parseFloat(panelData.bus_bar_rating) : null, // Fixed: Use bus_bar_rating\n    mainBreakerRating: panelData.main_breaker_rating, // Fixed: Use main_breaker_rating\n    currentPcsAmps: formData[pcsFieldName],\n    isCombinedSystem,\n    combinedSystemMaxOutput,\n  });\n\n  console.debug('[POI] PCS Calculations:', {\n    systemNumber,\n    hasBattery: pcsCalculations.hasBattery,\n    maxContinuousOutputAmps: pcsCalculations.maxContinuousOutputAmps,\n    maxContinuousOutput125: pcsCalculations.maxContinuousOutput125,\n    allowableBackfeed: pcsCalculations.allowableBackfeed,\n    shouldAutoTriggerPCS: pcsCalculations.shouldAutoTriggerPCS,\n    canManualTriggerPCS: pcsCalculations.canManualTriggerPCS,\n    violates120Rule: pcsCalculations.violates120Rule,\n  });\n\n  // ============================================\n  // DERIVED STATE\n  // ============================================\n\n  const showPowerControl = pcsCalculations.shouldAutoTriggerPCS || manualPcsActivated;\n  const showBreakerRating = poiType === 'PV Breaker (OCPD)' || poiType === 'Lug Kit';\n  const showDisconnectRating = poiType === 'Line (Supply) Side Tap' || poiType === 'Load Side Tap' || poiType === 'Meter Collar Adapter';\n\n  // ============================================\n  // POI LOCATION OPTIONS\n  // ============================================\n\n  const getLocationOptions = () => {\n    const baseOptions = [\n      { label: 'Main Panel (A) Bus', value: 'Main Panel (A) Bus' },\n      { label: 'Sub Panel (B) Bus', value: 'Sub Panel (B) Bus' },\n    ];\n\n    if (poiType === 'Line (Supply) Side Tap') {\n      return [{ label: 'Between Main Panel (A) MCB & Utility Meter', value: 'Between Main Panel (A) MCB & Utility Meter' }];\n    }\n\n    if (poiType === 'Load Side Tap') {\n      return [\n        { label: 'Between Main Panel (A) Bus & MCB', value: 'Between Main Panel (A) Bus & MCB' },\n        { label: 'Between Main Panel (A) & Sub Panel (B)', value: 'Between Main Panel (A) & Sub Panel (B)' },\n      ];\n    }\n\n    if (poiType === 'Meter Collar Adapter') {\n      return [\n        { label: 'Utility Meter', value: 'Utility Meter' },\n        { label: 'Detached Meter Enclosure', value: 'Detached Meter Enclosure' },\n      ];\n    }\n\n    if (poiType === 'Solar Ready') {\n      return [\n        { label: '60A Dedicated PV Input', value: '60A Dedicated PV Input' },\n        { label: '100A Dedicated PV Input', value: '100A Dedicated PV Input' },\n        { label: '200A Dedicated PV Input', value: '200A Dedicated PV Input' },\n      ];\n    }\n\n    return baseOptions;\n  };\n\n  const locationOptions = getLocationOptions();\n\n  // ============================================\n  // FILTERED POI OPTIONS (120% RULE)\n  // ============================================\n\n  const getFilteredPoiOptions = () => {\n    if (pcsCalculations.violates120Rule) {\n      return POI_TYPE_OPTIONS.filter(opt => opt.value !== 'PV Breaker (OCPD)');\n    }\n    return POI_TYPE_OPTIONS;\n  };\n\n  const filteredPoiOptions = getFilteredPoiOptions();\n\n  // ============================================\n  // AUTO-CLEAR POI TYPE IF VIOLATES 120% RULE\n  // ============================================\n\n  useEffect(() => {\n    if (pcsCalculations.violates120Rule && poiType === 'PV Breaker (OCPD)') {\n      console.debug('[POI] Clearing PV Breaker (OCPD) due to 120% rule violation');\n      onChange('ele_method_of_interconnection', '');\n    }\n  }, [pcsCalculations.violates120Rule, poiType, onChange]);\n\n  // ============================================\n  // AUTO-CLEAR PCS WHEN CONDITIONS NO LONGER MET\n  // ============================================\n\n  useEffect(() => {\n    // Clear PCS data when power control is deactivated\n    if (!showPowerControl && formData[pcsFieldName]) {\n      console.debug('[POI] Power Control no longer active - clearing PCS Amps');\n      onChange(pcsFieldName, '');\n    }\n  }, [showPowerControl, formData, pcsFieldName, onChange]);\n\n  // ============================================\n  // AUTO-SELECT RECOMMENDED PCS VALUE\n  // ============================================\n\n  useEffect(() => {\n    if (showPowerControl && pcsCalculations.recommendedPcsAmps) {\n      const currentPcsAmps = parseInt(formData[pcsFieldName]) || 0;\n      const recommended = parseInt(pcsCalculations.recommendedPcsAmps) || 0;\n\n      // Auto-select if not set or exceeds allowable\n      if (currentPcsAmps === 0 || currentPcsAmps > (pcsCalculations.allowableBackfeed ?? 0)) {\n        console.debug('[POI] Auto-selecting recommended PCS amps:', recommended);\n        onChange(pcsFieldName, pcsCalculations.recommendedPcsAmps);\n      }\n    }\n  }, [showPowerControl, pcsCalculations.recommendedPcsAmps, pcsCalculations.allowableBackfeed, formData, pcsFieldName, onChange]);\n\n  // ============================================\n  // HANDLERS\n  // ============================================\n\n  const handleActivatePcs = () => {\n    console.debug('[POI] Manually activating PCS');\n    onChange(pcsSettingsFieldName, true);\n  };\n\n  const handleDeactivatePcs = () => {\n    console.debug('[POI] Deactivating PCS');\n    onChange(pcsSettingsFieldName, false);\n    onChange(pcsFieldName, '');\n  };\n\n  // ============================================\n  // EXPANDED STATE\n  // ============================================\n\n  const [isExpanded, setIsExpanded] = useState(false);\n\n  // ============================================\n  // DELETE HANDLER\n  // ============================================\n\n  const handleDelete = () => {\n    setShowClearConfirm(true);\n  };\n\n  const handleConfirmClear = () => {\n    onChange('ele_method_of_interconnection', '');\n    onChange('el_poi_breaker_rating', '');\n    onChange('el_poi_disconnect_rating', '');\n    onChange(locationFieldName, '');\n    onChange(pcsFieldName, '');\n    onChange(pcsSettingsFieldName, false); // Clear PCS settings to sync with Gateway Config\n    setShowClearConfirm(false);\n  };\n\n  // ============================================\n  // DERIVED VALUES FOR EQUIPMENT ROW\n  // ============================================\n\n  const isComplete = !!(poiType && formData[locationFieldName]);\n\n  const subtitle = poiType || undefined;\n\n  const fields = [\n    { label: 'Method', value: poiType },\n    showBreakerRating && { label: 'Breaker Rating', value: formData.el_poi_breaker_rating },\n    showDisconnectRating && { label: 'Disconnect Rating', value: formData.el_poi_disconnect_rating },\n    { label: 'Location', value: formData[locationFieldName] },\n    pcsCalculations.maxContinuousOutputAmps !== null && {\n      label: 'Max Output (125%)',\n      value: pcsCalculations.maxContinuousOutput125 ? `${pcsCalculations.maxContinuousOutput125.toFixed(1)} Amps` : 'â€”'\n    },\n    showPowerControl && { label: 'PCS Setting', value: formData[pcsFieldName] },\n  ].filter(Boolean);\n\n  // ============================================\n  // RENDER\n  // ============================================\n\n  return (\n    <>\n    <EquipmentRow\n      title=\"Point of Interconnection\"\n      subtitle={subtitle}\n      isComplete={isComplete}\n      expanded={isExpanded}\n      onToggle={() => setIsExpanded(!isExpanded)}\n      fields={fields}\n      onDelete={handleDelete}\n    >\n      {/* POI Type */}\n      <TableDropdown\n        label=\"POI Type\"\n        value={poiType}\n        onChange={(value) => onChange('ele_method_of_interconnection', value)}\n        options={filteredPoiOptions}\n        placeholder=\"Select type...\"\n      />\n\n      {/* Fused AC Disconnect - For Tap types and Meter Collar */}\n      {showDisconnectRating && (\n        <TableDropdown\n          label=\"Fused AC Disconnect (Amps)\"\n          value={formData.el_poi_disconnect_rating || ''}\n          onChange={(value) => onChange('el_poi_disconnect_rating', value)}\n          options={[20, 30, 40, 50, 60, 80, 100, 125, 150, 175, 200].map(v => ({ value: v.toString(), label: v.toString() }))}\n          placeholder=\"Select rating...\"\n        />\n      )}\n\n      {/* POI Location */}\n      {poiType && (\n        <TableDropdown\n          label=\"POI Location\"\n          value={formData[locationFieldName] || ''}\n          onChange={(value) => onChange(locationFieldName, value)}\n          options={locationOptions}\n          placeholder=\"Select location...\"\n        />\n      )}\n\n      {/* 120% Rule Violation Warning (Non-Battery Systems) */}\n      {pcsCalculations.violates120Rule && (\n        <div style={{ padding: '0 var(--spacing) var(--spacing)' }}>\n          <Alert variant=\"warning\" collapsible={false}>\n            <strong>120% Rule Violation:</strong> PV Breaker violates the 120% rule.\n            Derate the main breaker to activate PV Breaker as an option.\n          </Alert>\n        </div>\n      )}\n\n      {/* Manual PCS Activation Button */}\n      {pcsCalculations.canManualTriggerPCS && !showPowerControl && (\n        <div style={{ padding: '0 var(--spacing) var(--spacing)' }}>\n          <button\n            type=\"button\"\n            onClick={handleActivatePcs}\n            className={equipStyles.stringingButton}\n            style={{ width: '100%' }}\n          >\n            Activate PCS\n          </button>\n        </div>\n      )}\n\n      {/* PCS Active State (Auto-triggered or Manual) */}\n      {showPowerControl && (\n        <>\n          {/* Alert Message */}\n          <div style={{ padding: '0 var(--spacing) var(--spacing-tight)' }}>\n            {pcsCalculations.shouldAutoTriggerPCS ? (\n              <Alert variant=\"warning\" collapsible={false}>\n                <strong>Power Control System Activated:</strong> System output exceeds\n                allowable backfeed. PCS will throttle current to {pcsCalculations.allowableBackfeed} Amps.\n              </Alert>\n            ) : (\n              <Alert variant=\"info\" collapsible={false}>\n                <strong>Power Control System Active:</strong> Manual activation enabled.\n              </Alert>\n            )}\n          </div>\n\n          {/* PCS Amps Dropdown */}\n          <TableDropdown\n            label=\"PCS Setting (Amps)\"\n            value={formData[pcsFieldName] || pcsCalculations.recommendedPcsAmps || ''}\n            onChange={(value) => onChange(pcsFieldName, value)}\n            options={pcsCalculations.filteredPcsAmpsOptions}\n            placeholder=\"Select amps...\"\n          />\n\n          {/* PCS Note */}\n          <div style={{\n            padding: 'var(--spacing-tight) var(--spacing)',\n            color: 'var(--text-muted)',\n            fontSize: 'var(--text-xs)',\n          }}>\n            PCS Settings only throttle the current (amps). To change the SMS breaker\n            rating, see the SMS Section.\n          </div>\n\n          {/* Deactivate Button (Manual PCS only) */}\n          {manualPcsActivated && !pcsCalculations.shouldAutoTriggerPCS && (\n            <div style={{ padding: '0 var(--spacing) var(--spacing)' }}>\n              <button\n                type=\"button\"\n                onClick={handleDeactivatePcs}\n                style={{\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  width: '100%',\n                  padding: 'var(--spacing-tight)',\n                  background: 'transparent',\n                  border: 'var(--border-thin) solid var(--color-error)',\n                  borderRadius: 'var(--radius-md)',\n                  color: 'var(--color-error)',\n                  fontSize: 'var(--text-sm)',\n                  cursor: 'pointer',\n                  transition: 'var(--transition-base)',\n                }}\n                onMouseOver={(e) => e.currentTarget.style.background = 'var(--color-error-light)'}\n                onMouseOut={(e) => e.currentTarget.style.background = 'transparent'}\n              >\n                Deactivate Power Control System\n              </button>\n            </div>\n          )}\n        </>\n      )}\n    </EquipmentRow>\n\n    <SectionClearModal\n      isOpen={showClearConfirm}\n      onClose={() => setShowClearConfirm(false)}\n      onConfirm={handleConfirmClear}\n      sectionName=\"Point of Interconnection\"\n      fieldCount={5}\n    />\n    </>\n  );\n};\n\nexport default PointOfInterconnectionSection;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\electrical\\SubPanelBSection.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'isMLO' is assigned a value but never used.","line":31,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useMemo } from 'react';\nimport { BUS_BAR_RATING, MAIN_CIRCUIT_BREAKER_RATINGS, FEEDER_LOCATIONS, CONDUCTOR_SIZING_OPTIONS, SPB_TIE_IN_LOCATIONS } from '../../../utils/constants';\nimport { AddSectionButton, EquipmentRow, FormFieldRow, TableDropdown, TableRowButton } from '../../ui';\nimport styles from './SubPanelBSection.module.css';\n\n/**\n * Sub Panel B Section\n * Optional sub-panel configuration\n */\nconst SubPanelBSection = ({ formData, onChange, onShowSubPanelC, subPanelCVisible = false }) => {\n  // Sub Panel B Main Circuit Breaker options - max 225A\n  const SUB_PANEL_B_BREAKER_OPTIONS = useMemo(() => {\n    return MAIN_CIRCUIT_BREAKER_RATINGS.filter(option => {\n      if (option.value === 'MLO') return true;\n      const ampValue = parseInt(option.value);\n      return ampValue <= 225;\n    });\n  }, []);\n\n  // Calculate allowable backfeed: (Bus Ã— 1.2) - Main Breaker\n  const allowableBackfeed = useMemo(() => {\n    const bus = parseInt(formData.spb_bus_bar_rating) || 0;\n    const mainBreaker = formData.spb_main_breaker_rating === 'MLO'\n      ? 0\n      : parseInt(formData.spb_main_breaker_rating) || 0;\n\n    if (bus === 0) return null;\n    return (bus * 1.2 - mainBreaker).toFixed(0);\n  }, [formData.spb_bus_bar_rating, formData.spb_main_breaker_rating]);\n\n  const isMLO = formData.spb_main_breaker_rating === 'MLO';\n\n  // Determine current toggle states\n  const isNew = formData.spb_subpanel_existing === false;\n  const isExisting = formData.spb_subpanel_existing === true || formData.spb_subpanel_existing === undefined;\n  const isDerate = formData.el_spb_derated === true;\n\n  const handleNewClick = () => {\n    if (isNew) {\n      // Turn off New â†’ default to Existing\n      onChange('spb_subpanel_existing', true);\n      onChange('spb_subpanelb_mcbexisting', true);\n    } else {\n      // Turn on New â†’ turn off Derate\n      onChange('spb_subpanel_existing', false);\n      onChange('spb_subpanelb_mcbexisting', false);\n      onChange('el_spb_derated', false);\n    }\n  };\n\n  const handleExistingClick = () => {\n    if (isExisting && !isNew) {\n      // Already existing and not New, do nothing\n      return;\n    }\n    onChange('spb_subpanel_existing', true);\n    onChange('spb_subpanelb_mcbexisting', true);\n    // Don't touch el_spb_derated - Existing and Derate CAN coexist\n  };\n\n  const handleDerateClick = () => {\n    if (isDerate) {\n      // Turn off Derate\n      onChange('el_spb_derated', false);\n      onChange('spb_subpanelb_mcbexisting', true);\n    } else {\n      // Turn on Derate\n      if (isNew) {\n        // Can't have New + Derate, so switch to Existing first\n        onChange('spb_subpanel_existing', true);\n      }\n      onChange('el_spb_derated', true);\n      onChange('spb_subpanelb_mcbexisting', false);\n    }\n  };\n\n  // Wrapper to save toggle defaults when any field changes\n  const handleFieldChange = (fieldName, value) => {\n    onChange(fieldName, value);\n    // Note: Sub panels do NOT auto-default to a panel type selection\n    // User must explicitly choose New, Existing, or Derate\n  };\n\n  // Check if there's any data in Sub Panel B (excluding MLO which is the default)\n  const hasData = useMemo(() => {\n    return !!(\n      formData.spb_bus_bar_rating ||\n      formData.spb_subpanel_b_feeder_location ||\n      formData.spb_upstream_breaker_rating ||\n      formData.spb_conductor_sizing ||\n      formData.spb_tie_in_location\n    );\n  }, [\n    formData.spb_bus_bar_rating,\n    formData.spb_subpanel_b_feeder_location,\n    formData.spb_upstream_breaker_rating,\n    formData.spb_conductor_sizing,\n    formData.spb_tie_in_location,\n  ]);\n\n  const getSubtitle = () => {\n    const parts = [];\n    if (formData.spb_main_breaker_rating) {\n      parts.push(`Breaker: ${formData.spb_main_breaker_rating}`);\n    }\n    if (formData.spb_bus_bar_rating) {\n      parts.push(`Bus: ${formData.spb_bus_bar_rating}A`);\n    }\n    return parts.join(' | ');\n  };\n\n  const handleDelete = () => {\n    onChange('spb_bus_bar_rating', null);\n    onChange('spb_main_breaker_rating', null);\n    onChange('spb_subpanel_b_feeder_location', null);\n    onChange('spb_upstream_breaker_rating', null);\n    onChange('spb_conductor_sizing', null);\n    onChange('spb_tie_in_location', null);\n    onChange('spb_subpanel_existing', null);\n    onChange('el_spb_derated', null);\n    onChange('spb_subpanelb_mcbexisting', null);\n  };\n\n  return (\n    <div className={styles.sectionWrapper}>\n      <EquipmentRow\n        title=\"Sub Panel (B)\"\n        subtitle={getSubtitle()}\n        onDelete={handleDelete}\n        initiallyExpanded={hasData}\n      >\n        {/* Panel Type Toggle - New / Existing / Derate - No label, left-justified */}\n        <div className={styles.panelTypeToggle}>\n          <TableRowButton\n            label=\"New\"\n            variant=\"outline\"\n            active={isNew}\n            onClick={handleNewClick}\n          />\n          <TableRowButton\n            label=\"Existing\"\n            variant=\"outline\"\n            active={isExisting && !isNew}\n            onClick={handleExistingClick}\n          />\n          <TableRowButton\n            label=\"Derate\"\n            variant=\"outline\"\n            active={isDerate}\n            onClick={handleDerateClick}\n          />\n        </div>\n        {/* Bus (Amps) */}\n        <TableDropdown\n          label=\"Bus (Amps)\"\n          value={formData.spb_bus_bar_rating || ''}\n          onChange={(value) => handleFieldChange('spb_bus_bar_rating', value)}\n          options={BUS_BAR_RATING}\n          placeholder=\"Select amps...\"\n        />\n\n        {/* Main Circuit Breaker */}\n        <TableDropdown\n          label=\"Main Circuit Breaker\"\n          value={formData.spb_main_breaker_rating || 'MLO'}\n          onChange={(value) => handleFieldChange('spb_main_breaker_rating', value)}\n          options={SUB_PANEL_B_BREAKER_OPTIONS}\n          placeholder=\"Select breaker...\"\n        />\n\n        {/* Feeder Location on Bus Bar */}\n        <FormFieldRow label=\"Feeder Location\">\n          {FEEDER_LOCATIONS.map((location) => (\n            <TableRowButton\n              key={location.value}\n              label={location.label}\n              variant=\"outline\"\n              active={formData.spb_subpanel_b_feeder_location === location.value}\n              onClick={() => handleFieldChange('spb_subpanel_b_feeder_location', location.value)}\n            />\n          ))}\n        </FormFieldRow>\n\n        {/* Tie-In Breaker Rating */}\n        <TableDropdown\n          label=\"Tie-In Breaker\"\n          value={formData.spb_upstream_breaker_rating || ''}\n          onChange={(value) => handleFieldChange('spb_upstream_breaker_rating', value)}\n          options={MAIN_CIRCUIT_BREAKER_RATINGS}\n          placeholder=\"Select rating...\"\n        />\n\n        {/* Conductor Sizing - Only for existing panels */}\n        {isExisting && (\n          <TableDropdown\n            label=\"Conductor Sizing\"\n            value={formData.spb_conductor_sizing || ''}\n            onChange={(value) => handleFieldChange('spb_conductor_sizing', value)}\n            options={CONDUCTOR_SIZING_OPTIONS}\n            placeholder=\"Select size...\"\n          />\n        )}\n\n        {/* Tie-In Location */}\n        <TableDropdown\n          label=\"Tie-In Location\"\n          value={formData.spb_tie_in_location || ''}\n          onChange={(value) => handleFieldChange('spb_tie_in_location', value)}\n          options={SPB_TIE_IN_LOCATIONS}\n          placeholder=\"Select location...\"\n        />\n\n        {/* Allowable Backfeed Display */}\n        {allowableBackfeed !== null && (\n          <div className={styles.allowableBackfeed}>\n            Allowable Backfeed: {allowableBackfeed} Amps\n          </div>\n        )}\n\n      </EquipmentRow>\n\n      {/* Sub Panel (C) Button - Only show if not already visible */}\n      {!subPanelCVisible && (\n        <AddSectionButton\n          label=\"Sub Panel (C)\"\n          onClick={onShowSubPanelC}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default SubPanelBSection;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\electrical\\SubPanelCSection.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'isMLO' is assigned a value but never used.","line":22,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useMemo } from 'react';\nimport { BUS_BAR_RATING, MAIN_CIRCUIT_BREAKER_RATINGS, FEEDER_LOCATIONS, CONDUCTOR_SIZING_OPTIONS } from '../../../utils/constants';\nimport { AddSectionButton, EquipmentRow, FormFieldRow, TableDropdown, TableRowButton } from '../../ui';\nimport styles from './SubPanelCSection.module.css';\n\n/**\n * Sub Panel C Section\n * Optional sub-panel configuration\n */\nconst SubPanelCSection = ({ formData, onChange, onShowSubPanelD, subPanelDVisible = false }) => {\n  // Calculate allowable backfeed: (Bus Ã— 1.2) - Main Breaker\n  const allowableBackfeed = useMemo(() => {\n    const bus = parseInt(formData.spc_bus_bar_rating) || 0;\n    const mainBreaker = formData.spc_main_breaker_rating === 'MLO'\n      ? 0\n      : parseInt(formData.spc_main_breaker_rating) || 0;\n\n    if (bus === 0) return null;\n    return (bus * 1.2 - mainBreaker).toFixed(0);\n  }, [formData.spc_bus_bar_rating, formData.spc_main_breaker_rating]);\n\n  const isMLO = formData.spc_main_breaker_rating === 'MLO';\n  const isExisting = formData.spc_subpanel_existing;\n\n  // Determine current panel type value\n  const getPanelTypeValue = () => {\n    if (formData.el_spc_derated) return 'derate';\n    if (formData.spc_subpanel_existing === false) return 'new';\n    return 'existing'; // Default to existing\n  };\n\n  const handlePanelTypeChange = (value) => {\n    if (value === 'new') {\n      // New: Bus = New, MCB = New\n      onChange('spc_subpanel_existing', false);\n      onChange('spc_subpanelc_mcbexisting', false);\n      onChange('el_spc_derated', false);\n    } else if (value === 'existing') {\n      // Existing: Bus = Existing, MCB = Existing\n      onChange('spc_subpanel_existing', true);\n      onChange('spc_subpanelc_mcbexisting', true);\n      onChange('el_spc_derated', false);\n    } else if (value === 'derate') {\n      // Derate: Bus = Existing, MCB = New\n      onChange('spc_subpanel_existing', true);\n      onChange('spc_subpanelc_mcbexisting', false);\n      onChange('el_spc_derated', true);\n    }\n  };\n\n  // Wrapper to save toggle defaults when any field changes\n  const handleFieldChange = (fieldName, value) => {\n    onChange(fieldName, value);\n    // Note: Sub panels do NOT auto-default to a panel type selection\n    // User must explicitly choose New, Existing, or Derate\n  };\n\n  // Check if there's any data in Sub Panel C (excluding MLO which is the default)\n  const hasData = useMemo(() => {\n    return !!(\n      formData.spc_bus_bar_rating ||\n      formData.spc_feeder_location ||\n      formData.spc_upstream_breaker_rating ||\n      formData.spc_conductor_sizing ||\n      formData.spc_tie_in_location\n    );\n  }, [\n    formData.spc_bus_bar_rating,\n    formData.spc_feeder_location,\n    formData.spc_upstream_breaker_rating,\n    formData.spc_conductor_sizing,\n    formData.spc_tie_in_location,\n  ]);\n\n  const getSubtitle = () => {\n    const parts = [];\n    if (formData.spc_main_breaker_rating) {\n      parts.push(`Breaker: ${formData.spc_main_breaker_rating}`);\n    }\n    if (formData.spc_bus_bar_rating) {\n      parts.push(`Bus: ${formData.spc_bus_bar_rating}A`);\n    }\n    return parts.join(' | ');\n  };\n\n  const handleDelete = () => {\n    onChange('spc_bus_bar_rating', null);\n    onChange('spc_main_breaker_rating', null);\n    onChange('spc_feeder_location', null);\n    onChange('spc_upstream_breaker_rating', null);\n    onChange('spc_conductor_sizing', null);\n    onChange('spc_tie_in_location', null);\n    onChange('spc_subpanel_existing', null);\n    onChange('spc_subpanelc_mcbexisting', null);\n    onChange('el_spc_derated', null);\n  };\n\n  // Tie-In Location options for Sub Panel C\n  const tieInLocationOptions = [\n    { label: 'Main Panel (A) Bus', value: 'Main Panel (A) Bus' },\n    { label: 'Sub Panel (B) Bus', value: 'Sub Panel (B) Bus' },\n  ];\n\n  return (\n    <div className={styles.sectionWrapper}>\n      <EquipmentRow\n        title=\"Sub Panel (C)\"\n        subtitle={getSubtitle()}\n        onDelete={handleDelete}\n        initiallyExpanded={hasData}\n      >\n        {/* Panel Type Toggle - New / Existing / Derate - No label, left-justified */}\n        <div className={styles.panelTypeToggle}>\n          <TableRowButton\n            label=\"New\"\n            variant=\"outline\"\n            active={getPanelTypeValue() === 'new'}\n            onClick={() => handlePanelTypeChange('new')}\n          />\n          <TableRowButton\n            label=\"Existing\"\n            variant=\"outline\"\n            active={getPanelTypeValue() === 'existing'}\n            onClick={() => handlePanelTypeChange('existing')}\n          />\n          <TableRowButton\n            label=\"Derate\"\n            variant=\"outline\"\n            active={getPanelTypeValue() === 'derate'}\n            onClick={() => handlePanelTypeChange('derate')}\n          />\n        </div>\n        {/* Bus (Amps) */}\n        <TableDropdown\n          label=\"Bus (Amps)\"\n          value={formData.spc_bus_bar_rating || ''}\n          onChange={(value) => handleFieldChange('spc_bus_bar_rating', value)}\n          options={BUS_BAR_RATING}\n          placeholder=\"Select amps...\"\n        />\n\n        {/* Main Circuit Breaker */}\n        <TableDropdown\n          label=\"Main Circuit Breaker\"\n          value={formData.spc_main_breaker_rating || 'MLO'}\n          onChange={(value) => handleFieldChange('spc_main_breaker_rating', value)}\n          options={MAIN_CIRCUIT_BREAKER_RATINGS}\n          placeholder=\"Select breaker...\"\n        />\n\n        {/* Feeder Location on Bus Bar */}\n        <FormFieldRow label=\"Feeder Location\">\n          {FEEDER_LOCATIONS.map((location) => (\n            <TableRowButton\n              key={location.value}\n              label={location.label}\n              variant=\"outline\"\n              active={formData.spc_feeder_location === location.value}\n              onClick={() => handleFieldChange('spc_feeder_location', location.value)}\n            />\n          ))}\n        </FormFieldRow>\n\n        {/* Tie-In Breaker Rating */}\n        <TableDropdown\n          label=\"Tie-In Breaker\"\n          value={formData.spc_upstream_breaker_rating || ''}\n          onChange={(value) => handleFieldChange('spc_upstream_breaker_rating', value)}\n          options={MAIN_CIRCUIT_BREAKER_RATINGS}\n          placeholder=\"Select rating...\"\n        />\n\n        {/* Conductor Sizing - Only for existing panels */}\n        {isExisting && (\n          <TableDropdown\n            label=\"Conductor Sizing\"\n            value={formData.spc_conductor_sizing || ''}\n            onChange={(value) => handleFieldChange('spc_conductor_sizing', value)}\n            options={CONDUCTOR_SIZING_OPTIONS}\n            placeholder=\"Select size...\"\n          />\n        )}\n\n        {/* Tie-In Location */}\n        <TableDropdown\n          label=\"Tie-In Location\"\n          value={formData.spc_tie_in_location || ''}\n          onChange={(value) => handleFieldChange('spc_tie_in_location', value)}\n          options={tieInLocationOptions}\n          placeholder=\"Select location...\"\n        />\n\n        {/* Allowable Backfeed Display */}\n        {allowableBackfeed !== null && (\n          <div className={styles.allowableBackfeedContainer}>\n            <div className={styles.allowableBackfeedValue}>\n              Allowable Backfeed: {allowableBackfeed} Amps\n            </div>\n            <div className={styles.allowableBackfeedFormula}>\n              (Bus Ã— 1.2) - Main Breaker\n            </div>\n          </div>\n        )}\n\n      </EquipmentRow>\n\n      {/* Sub Panel (D) Button - Only show if not already visible */}\n      {!subPanelDVisible && (\n        <AddSectionButton\n          label=\"Sub Panel (D)\"\n          onClick={onShowSubPanelD}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default SubPanelCSection;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\electrical\\SubPanelDSection.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'isMLO' is assigned a value but never used.","line":22,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useMemo } from 'react';\nimport { BUS_BAR_RATING, MAIN_CIRCUIT_BREAKER_RATINGS, FEEDER_LOCATIONS, CONDUCTOR_SIZING_OPTIONS } from '../../../utils/constants';\nimport { EquipmentRow, FormFieldRow, TableDropdown, TableRowButton } from '../../ui';\nimport styles from './SubPanelDSection.module.css';\n\n/**\n * Sub Panel D Section\n * Optional sub-panel configuration\n */\nconst SubPanelDSection = ({ formData, onChange }) => {\n  // Calculate allowable backfeed: (Bus Ã— 1.2) - Main Breaker\n  const allowableBackfeed = useMemo(() => {\n    const bus = parseInt(formData.spd_bus_bar_rating) || 0;\n    const mainBreaker = formData.spd_main_breaker_rating === 'MLO'\n      ? 0\n      : parseInt(formData.spd_main_breaker_rating) || 0;\n\n    if (bus === 0) return null;\n    return (bus * 1.2 - mainBreaker).toFixed(0);\n  }, [formData.spd_bus_bar_rating, formData.spd_main_breaker_rating]);\n\n  const isMLO = formData.spd_main_breaker_rating === 'MLO';\n  const isExisting = formData.spd_subpanel_existing;\n\n  // Determine current panel type value\n  const getPanelTypeValue = () => {\n    if (formData.el_spd_derated) return 'derate';\n    if (formData.spd_subpanel_existing === false) return 'new';\n    return 'existing'; // Default to existing\n  };\n\n  const handlePanelTypeChange = (value) => {\n    if (value === 'new') {\n      // New: Bus = New, MCB = New\n      onChange('spd_subpanel_existing', false);\n      onChange('spd_subpaneld_mcbexisting', false);\n      onChange('el_spd_derated', false);\n    } else if (value === 'existing') {\n      // Existing: Bus = Existing, MCB = Existing\n      onChange('spd_subpanel_existing', true);\n      onChange('spd_subpaneld_mcbexisting', true);\n      onChange('el_spd_derated', false);\n    } else if (value === 'derate') {\n      // Derate: Bus = Existing, MCB = New\n      onChange('spd_subpanel_existing', true);\n      onChange('spd_subpaneld_mcbexisting', false);\n      onChange('el_spd_derated', true);\n    }\n  };\n\n  // Wrapper to save toggle defaults when any field changes\n  const handleFieldChange = (fieldName, value) => {\n    onChange(fieldName, value);\n    // Note: Sub panels do NOT auto-default to a panel type selection\n    // User must explicitly choose New, Existing, or Derate\n  };\n\n  // Check if there's any data in Sub Panel D (excluding MLO which is the default)\n  const hasData = useMemo(() => {\n    return !!(\n      formData.spd_bus_bar_rating ||\n      formData.spd_feeder_location ||\n      formData.spd_upstream_breaker_rating ||\n      formData.spd_conductor_sizing ||\n      formData.spd_tie_in_location\n    );\n  }, [\n    formData.spd_bus_bar_rating,\n    formData.spd_feeder_location,\n    formData.spd_upstream_breaker_rating,\n    formData.spd_conductor_sizing,\n    formData.spd_tie_in_location,\n  ]);\n\n  const getSubtitle = () => {\n    const parts = [];\n    if (formData.spd_main_breaker_rating) {\n      parts.push(`Breaker: ${formData.spd_main_breaker_rating}`);\n    }\n    if (formData.spd_bus_bar_rating) {\n      parts.push(`Bus: ${formData.spd_bus_bar_rating}A`);\n    }\n    return parts.join(' | ');\n  };\n\n  const handleDelete = () => {\n    onChange('spd_bus_bar_rating', null);\n    onChange('spd_main_breaker_rating', null);\n    onChange('spd_feeder_location', null);\n    onChange('spd_upstream_breaker_rating', null);\n    onChange('spd_conductor_sizing', null);\n    onChange('spd_tie_in_location', null);\n    onChange('spd_subpanel_existing', null);\n    onChange('spd_subpaneld_mcbexisting', null);\n    onChange('el_spd_derated', null);\n  };\n\n  // Tie-In Location options for Sub Panel D\n  const tieInLocationOptions = [\n    { label: 'Main Panel (A) Bus', value: 'Main Panel (A) Bus' },\n    { label: 'Sub Panel (B) Bus', value: 'Sub Panel (B) Bus' },\n    { label: 'Sub Panel (C) Bus', value: 'Sub Panel (C) Bus' },\n  ];\n\n  return (\n    <div className={styles.sectionWrapper}>\n      <EquipmentRow\n        title=\"Sub Panel (D)\"\n        subtitle={getSubtitle()}\n        onDelete={handleDelete}\n        initiallyExpanded={hasData}\n      >\n        {/* Panel Type Toggle - New / Existing / Derate - No label, left-justified */}\n        <div className={styles.panelTypeToggle}>\n          <TableRowButton\n            label=\"New\"\n            variant=\"outline\"\n            active={getPanelTypeValue() === 'new'}\n            onClick={() => handlePanelTypeChange('new')}\n          />\n          <TableRowButton\n            label=\"Existing\"\n            variant=\"outline\"\n            active={getPanelTypeValue() === 'existing'}\n            onClick={() => handlePanelTypeChange('existing')}\n          />\n          <TableRowButton\n            label=\"Derate\"\n            variant=\"outline\"\n            active={getPanelTypeValue() === 'derate'}\n            onClick={() => handlePanelTypeChange('derate')}\n          />\n        </div>\n        {/* Bus (Amps) */}\n        <TableDropdown\n          label=\"Bus (Amps)\"\n          value={formData.spd_bus_bar_rating || ''}\n          onChange={(value) => handleFieldChange('spd_bus_bar_rating', value)}\n          options={BUS_BAR_RATING}\n          placeholder=\"Select amps...\"\n        />\n\n        {/* Main Circuit Breaker */}\n        <TableDropdown\n          label=\"Main Circuit Breaker\"\n          value={formData.spd_main_breaker_rating || 'MLO'}\n          onChange={(value) => handleFieldChange('spd_main_breaker_rating', value)}\n          options={MAIN_CIRCUIT_BREAKER_RATINGS}\n          placeholder=\"Select breaker...\"\n        />\n\n        {/* Feeder Location on Bus Bar */}\n        <FormFieldRow label=\"Feeder Location\">\n          {FEEDER_LOCATIONS.map((location) => (\n            <TableRowButton\n              key={location.value}\n              label={location.label}\n              variant=\"outline\"\n              active={formData.spd_feeder_location === location.value}\n              onClick={() => handleFieldChange('spd_feeder_location', location.value)}\n            />\n          ))}\n        </FormFieldRow>\n\n        {/* Tie-In Breaker Rating */}\n        <TableDropdown\n          label=\"Tie-In Breaker\"\n          value={formData.spd_upstream_breaker_rating || ''}\n          onChange={(value) => handleFieldChange('spd_upstream_breaker_rating', value)}\n          options={MAIN_CIRCUIT_BREAKER_RATINGS}\n          placeholder=\"Select rating...\"\n        />\n\n        {/* Conductor Sizing - Only for existing panels */}\n        {isExisting && (\n          <TableDropdown\n            label=\"Conductor Sizing\"\n            value={formData.spd_conductor_sizing || ''}\n            onChange={(value) => handleFieldChange('spd_conductor_sizing', value)}\n            options={CONDUCTOR_SIZING_OPTIONS}\n            placeholder=\"Select size...\"\n          />\n        )}\n\n        {/* Tie-In Location */}\n        <TableDropdown\n          label=\"Tie-In Location\"\n          value={formData.spd_tie_in_location || ''}\n          onChange={(value) => handleFieldChange('spd_tie_in_location', value)}\n          options={tieInLocationOptions}\n          placeholder=\"Select location...\"\n        />\n\n        {/* Allowable Backfeed Display */}\n        {allowableBackfeed !== null && (\n          <div className={styles.allowableBackfeedContainer}>\n            <div className={styles.allowableBackfeedValue}>\n              Allowable Backfeed: {allowableBackfeed} Amps\n            </div>\n            <div className={styles.allowableBackfeedFormula}>\n              (Bus Ã— 1.2) - Main Breaker\n            </div>\n          </div>\n        )}\n\n      </EquipmentRow>\n    </div>\n  );\n};\n\nexport default SubPanelDSection;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\BOSEquipmentModal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\BOSEquipmentSection.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":1,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":36}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo } from 'react';\nimport { EquipmentRow, TableDropdown, Button } from '../../ui';\nimport { BOS_FIELD_PATTERNS } from '../../../constants/bosFieldPatterns';\nimport {\n  getUtilityEquipmentTypeOptions,\n  translateToStandardName,\n  getAvailableMakes as getUtilityMakes,\n  getAvailableModels as getUtilityModels,\n} from '../../../utils/bosEquipmentUtils';\nimport { BOS_EQUIPMENT_CATALOG } from '../../../constants/bosEquipmentCatalog';\nimport { AMP_RATING_OPTIONS } from '../../../constants/bosConstants';\n\n/**\n * BOS Equipment Section\n * Renders inline BOS equipment slots with dropdowns (just like Solar Panel/Battery/Inverter)\n *\n * Usage: Place after trigger equipment (String Combiner, Battery, SMS, Backup Panel)\n */\nconst BOSEquipmentSection = ({ formData, onChange, section, systemNumber = 1 }) => {\n  const pattern = BOS_FIELD_PATTERNS[section];\n\n  // Track which slots are visible (start with slot 1 always visible)\n  const [visibleSlots, setVisibleSlots] = useState([1]);\n\n  // Get utility from multiple sources (fallback chain)\n  const utility = useMemo(() => {\n    // Try formData.site.utility first\n    if (formData.site?.utility) {\n      return formData.site.utility;\n    }\n\n    // Try formData.utility (passed directly)\n    if (formData.utility) {\n      return formData.utility;\n    }\n\n    // Try projectUtility prop (fallback)\n    if (formData.projectUtility) {\n      return formData.projectUtility;\n    }\n\n    return 'Gen';\n  }, [formData.site?.utility, formData.utility, formData.projectUtility]);\n\n  // Check if inverter is Hoymiles or APSystems (requires breaker rating)\n  const inverterMake = formData.inverter_make || formData[`sys${systemNumber}_inverter_make`] || '';\n  const isHoymilesOrApsystems = inverterMake === 'Hoymiles' || inverterMake === 'APSystems';\n\n  // Breaker size options for Hoymiles/APSystems\n  const breakerSizeOptions = [\n    { label: '20', value: '20' },\n    { label: '30', value: '30' },\n  ];\n\n  // Get utility-specific equipment types\n  const equipmentTypes = useMemo(() => {\n    return getUtilityEquipmentTypeOptions(utility);\n  }, [utility]);\n\n  // Get available makes for a given equipment type (translate to standard name for lookup)\n  const getAvailableMakes = (equipmentType) => {\n    if (!equipmentType) return [];\n    const standardType = translateToStandardName(equipmentType);\n    const makes = getUtilityMakes(standardType);\n    return makes.map(make => ({ label: make, value: make }));\n  };\n\n  // Get available models for a given type and make (translate to standard name for lookup)\n  const getAvailableModels = (equipmentType, make) => {\n    if (!equipmentType || !make) return [];\n    const standardType = translateToStandardName(equipmentType);\n    const models = getUtilityModels(standardType, make);\n    return models.map(m => ({\n      label: `${m.model} (${m.amp})`,\n      value: m.model,\n      amp: m.amp,\n    }));\n  };\n\n  // Amp rating options\n  const ampOptions = useMemo(() => {\n    return AMP_RATING_OPTIONS.map(amp => ({ label: amp, value: amp }));\n  }, []);\n\n  // Handle delete for a slot\n  const handleDeleteSlot = (slotNumber) => {\n    // Don't allow deleting if it's the only visible slot\n    if (visibleSlots.length <= 1) {\n      console.log('[BOS Equipment] Cannot delete last visible slot');\n      return;\n    }\n\n    const prefix = pattern.slotPattern(systemNumber, slotNumber);\n    onChange(`${prefix}_equipment_type`, '');\n    onChange(`${prefix}_make`, '');\n    onChange(`${prefix}_model`, '');\n    onChange(`${prefix}_amp_rating`, '');\n    onChange(`${prefix}_is_new`, true);\n    if (pattern.hasTrigger) {\n      onChange(`${prefix}_trigger`, null);\n    }\n    if (pattern.hasActive) {\n      onChange(`${prefix}_active`, null);\n    }\n\n    // Remove slot from visibleSlots array\n    setVisibleSlots(visibleSlots.filter(slot => slot !== slotNumber));\n  };\n\n  // Handle equipment type change - also set trigger/active if needed\n  const handleEquipmentTypeChange = (slot, value) => {\n    const prefix = pattern.slotPattern(systemNumber, slot);\n    onChange(`${prefix}_equipment_type`, value);\n\n    // Auto-set trigger and active when equipment type is selected\n    if (value && pattern.hasTrigger) {\n      onChange(`${prefix}_trigger`, true);\n    }\n    if (value && pattern.hasActive) {\n      onChange(`${prefix}_active`, true);\n    }\n  };\n\n  // Handle model change - auto-fill amp rating\n  const handleModelChange = (slot, equipmentType, make, modelValue) => {\n    const prefix = pattern.slotPattern(systemNumber, slot);\n    onChange(`${prefix}_model`, modelValue);\n\n    // Auto-fill amp rating from selected model (translate to standard type for lookup)\n    const standardType = translateToStandardName(equipmentType);\n    const selectedModel = BOS_EQUIPMENT_CATALOG.find(\n      item => item.type === standardType && item.make === make && item.model === modelValue\n    );\n    if (selectedModel && selectedModel.amp) {\n      onChange(`${prefix}_amp_rating`, selectedModel.amp);\n    }\n  };\n\n  // Build list of slots to render based on visibleSlots\n  const slotsToRender = visibleSlots.map(slotNumber => {\n    const prefix = pattern.slotPattern(systemNumber, slotNumber);\n    const equipmentType = formData[`${prefix}_equipment_type`];\n    const make = formData[`${prefix}_make`];\n    const model = formData[`${prefix}_model`];\n    const ampRating = formData[`${prefix}_amp_rating`];\n    const isNew = formData[`${prefix}_is_new`] !== false;\n\n    return {\n      slotNumber,\n      prefix,\n      equipmentType: equipmentType || '',\n      make: make || '',\n      model: model || '',\n      ampRating: ampRating || '',\n      isNew,\n    };\n  });\n\n  // Determine next slot number and if we can add more\n  const nextSlot = visibleSlots.length === 0 ? 1 : Math.max(...visibleSlots) + 1;\n  const canAddMore = nextSlot <= pattern.maxSlots;\n\n  // Handle adding a new slot\n  const handleAddSlot = () => {\n    if (canAddMore) {\n      setVisibleSlots([...visibleSlots, nextSlot]);\n    }\n  };\n\n  return (\n    <div style={{ marginTop: 'var(--spacing)', marginBottom: 'var(--spacing)' }}>\n      {slotsToRender.map((slot, index) => {\n        const availableMakes = getAvailableMakes(slot.equipmentType);\n        const availableModels = getAvailableModels(slot.equipmentType, slot.make);\n        const isLastSlot = index === slotsToRender.length - 1;\n\n        // Subtitle shows make/model if available\n        const getSubtitle = () => {\n          const parts = [];\n          if (slot.make && slot.model) {\n            parts.push(`${slot.make} ${slot.model}`);\n          }\n          if (slot.ampRating) {\n            parts.push(`${slot.ampRating}`);\n          }\n          return parts.join(' - ');\n        };\n\n        return (\n          <EquipmentRow\n            key={slot.slotNumber}\n            title={slot.equipmentType || `BOS Equipment Type ${slot.slotNumber}`}\n            subtitle={getSubtitle()}\n            showNewExistingToggle={true}\n            isNew={slot.isNew}\n            onNewExistingChange={(isNew) => onChange(`${slot.prefix}_is_new`, isNew)}\n            onDelete={visibleSlots.length > 1 ? () => handleDeleteSlot(slot.slotNumber) : undefined}\n            style={{ marginBottom: 'var(--spacing)' }}\n          >\n            <TableDropdown\n              label=\"Equipment Type\"\n              value={slot.equipmentType || ''}\n              onChange={(value) => handleEquipmentTypeChange(slot.slotNumber, value)}\n              options={equipmentTypes}\n              placeholder=\"Select equipment type...\"\n            />\n\n            <TableDropdown\n              label=\"Make\"\n              value={slot.make || ''}\n              onChange={(value) => onChange(`${slot.prefix}_make`, value)}\n              options={availableMakes}\n              placeholder={!slot.equipmentType ? 'Select type first' : 'Select make...'}\n              disabled={!slot.equipmentType}\n            />\n\n            <TableDropdown\n              label=\"Model\"\n              value={slot.model || ''}\n              onChange={(value) => handleModelChange(slot.slotNumber, slot.equipmentType, slot.make, value)}\n              options={availableModels}\n              placeholder={!slot.make ? 'Select make first' : 'Select model...'}\n              disabled={!slot.make}\n            />\n\n            <TableDropdown\n              label=\"Amp Rating\"\n              value={slot.ampRating || ''}\n              onChange={(value) => onChange(`${slot.prefix}_amp_rating`, value)}\n              options={ampOptions}\n              placeholder=\"Select amp rating...\"\n            />\n\n            {/* Breaker Size - Only for Hoymiles/APSystems */}\n            {isHoymilesOrApsystems && (\n              <TableDropdown\n                label=\"Breaker Size\"\n                value={formData[`sys${systemNumber}_ap_hoy_breaker_size`] || ''}\n                onChange={(value) => onChange(`sys${systemNumber}_ap_hoy_breaker_size`, value)}\n                options={breakerSizeOptions}\n                placeholder=\"Select breaker size...\"\n              />\n            )}\n\n            {/* Add Next BOS Button - Only in the LAST visible slot */}\n            {isLastSlot && canAddMore && (\n              <div style={{\n                marginTop: 'var(--spacing-tight)',\n                paddingTop: 0,\n                paddingLeft: '1rem',\n                borderTop: '1px solid var(--border-color)'\n              }}>\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={handleAddSlot}\n                  style={{ borderRadius: '9999px' }}\n                >\n                  + BOS Equipment Type {nextSlot}\n                </Button>\n              </div>\n            )}\n          </EquipmentRow>\n        );\n      })}\n    </div>\n  );\n};\n\nexport default BOSEquipmentSection;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\BOSPanel.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'shouldShowBOSSection' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":30},{"ruleId":"no-unused-vars","severity":1,"message":"'getTriggerEquipment' is assigned a value but never used.","line":28,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":26},{"ruleId":"no-unused-vars","severity":1,"message":"'saving' is assigned a value but never used.","line":142,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":142,"endColumn":11},{"ruleId":"no-unused-vars","severity":1,"message":"'refresh' is assigned a value but never used.","line":152,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":152,"endColumn":12}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useMemo } from 'react';\nimport useBOSData from '../../../hooks/useBOSData';\nimport { shouldShowBOSSection } from '../../../utils/bosTriggerUtils';\nimport { BOS_FIELD_PATTERNS } from '../../../constants/bosFieldPatterns';\nimport EquipmentRow from '../../ui/EquipmentRow';\nimport BOSEquipmentModal from './BOSEquipmentModal';\nimport LoadingSpinner from '../../ui/LoadingSpinner';\nimport ConfirmDialog from '../../ui/ConfirmDialog';\nimport styles from './BOSPanel.module.css';\n\n// Icons\nconst BoltIcon = () => (\n  <svg width=\"12\" height=\"12\" viewBox=\"0 0 16 16\" fill=\"currentColor\">\n    <path d=\"M5.52.359A.5.5 0 0 1 6 0h4a.5.5 0 0 1 .474.658L8.694 6H12.5a.5.5 0 0 1 .395.807l-7 9a.5.5 0 0 1-.873-.454L6.823 9.5H3.5a.5.5 0 0 1-.48-.641l2.5-8.5z\"/>\n  </svg>\n);\n\nconst PlusIcon = () => (\n  <svg width=\"12\" height=\"12\" viewBox=\"0 0 16 16\" fill=\"currentColor\">\n    <path d=\"M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2z\"/>\n  </svg>\n);\n\n// ============================================\n// HELPER: Get trigger equipment as individual items\n// ============================================\n\nconst getTriggerEquipment = (section, triggers) => {\n  if (!triggers) return [];\n  const items = [];\n\n  switch (section) {\n    case 'utility':\n      // Solar Panel\n      if (triggers.solarPanel?.present) {\n        items.push({\n          label: 'Solar Panel',\n          quantity: triggers.solarPanel.quantity,\n          make: triggers.solarPanel.make,\n          model: triggers.solarPanel.model,\n          isNew: triggers.solarPanel.isNew,\n        });\n      }\n      // Inverter/Microinverter\n      if (triggers.inverter?.present) {\n        items.push({\n          label: triggers.inverter.type === 'microinverter' ? 'Microinverter' : 'Inverter',\n          quantity: triggers.inverter.quantity,\n          make: triggers.inverter.make,\n          model: triggers.inverter.model,\n          isNew: triggers.inverter.isNew,\n        });\n      }\n      // String Combiner\n      if (triggers.stringCombiner?.present) {\n        items.push({\n          label: 'String Combiner',\n          quantity: null,\n          make: triggers.stringCombiner.make,\n          model: triggers.stringCombiner.model,\n          isNew: triggers.stringCombiner.isNew,\n        });\n      }\n      break;\n\n    case 'battery1':\n      if (triggers.battery1?.present) {\n        items.push({\n          label: 'Battery Type 1',\n          quantity: triggers.battery1.quantity,\n          make: triggers.battery1.make,\n          model: triggers.battery1.model,\n          isNew: triggers.battery1.isNew,\n        });\n      }\n      break;\n\n    case 'battery2':\n      if (triggers.battery2?.present) {\n        items.push({\n          label: 'Battery Type 2',\n          quantity: triggers.battery2.quantity,\n          make: triggers.battery2.make,\n          model: triggers.battery2.model,\n          isNew: triggers.battery2.isNew,\n        });\n      }\n      break;\n\n    case 'backup':\n      if (triggers.backupPanel?.present) {\n        items.push({\n          label: 'Backup Panel',\n          quantity: null,\n          make: triggers.backupPanel.make,\n          model: triggers.backupPanel.model,\n          isNew: triggers.backupPanel.isNew,\n        });\n      }\n      break;\n\n    case 'postSMS':\n      if (triggers.sms?.present) {\n        items.push({\n          label: 'SMS',\n          quantity: null,\n          make: triggers.sms.make,\n          model: triggers.sms.model,\n          isNew: triggers.sms.isNew,\n        });\n      }\n      break;\n\n    default:\n      break;\n  }\n\n  return items;\n};\n\n// ============================================\n// MAIN COMPONENT\n// ============================================\n\nconst BOSPanel = ({ projectUuid, systemNumber = 1, formData = {}, projectData = {}, onNavigateToTab }) => {\n  const [showModal, setShowModal] = useState(false);\n  const [editingSlot, setEditingSlot] = useState(null);\n  const [activeSection, setActiveSection] = useState(null);\n  const [deletingSlot, setDeletingSlot] = useState(null);\n  const [expandedSlots, setExpandedSlots] = useState({});\n  const [isAutoPopulating, setIsAutoPopulating] = useState(false);\n  const [autoPopulateResult, setAutoPopulateResult] = useState(null);\n\n  // Extract utility from projectData.site (the correct source!)\n  const utilityName = projectData?.site?.utility || null;\n\n  // Extract zip code from projectData.site\n  const zipCode = projectData?.site?.zip || null;\n\n  const {\n    loading,\n    saving,\n    error,\n    triggerEquipment,\n    systems,\n    equipmentCatalog,\n    addEquipment,\n    updateSlot,\n    removeEquipment,\n    calculateMinAmp,\n    findEquipment,\n    refresh,\n    autoPopulateBOS,\n    canAutoPopulate,\n  } = useBOSData({ projectUuid });\n\n  const systemTriggers = triggerEquipment[systemNumber];\n  const systemBOS = systems[systemNumber];\n\n  // Always show all BOS sections for manual entry\n  const visibleSections = useMemo(() => {\n    return ['utility', 'battery1', 'battery2', 'backup', 'postSMS'];\n  }, []);\n\n  const autoPopulateStatus = useMemo(\n    () => canAutoPopulate(systemNumber, utilityName),\n    [canAutoPopulate, systemNumber, utilityName]\n  );\n\n  // Toggle slot expansion\n  const toggleSlot = (slotKey) => {\n    setExpandedSlots(prev => ({ ...prev, [slotKey]: !prev[slotKey] }));\n  };\n\n  const handleAddClick = (section) => {\n    setActiveSection(section);\n    setEditingSlot(null);\n    setShowModal(true);\n  };\n\n  const handleEditClick = (slot) => {\n    setActiveSection(slot.section);\n    setEditingSlot(slot);\n    setShowModal(true);\n  };\n\n  const handleDeleteClick = (slot) => {\n    setDeletingSlot(slot);\n  };\n\n  const handleModalSave = async (equipmentData) => {\n    try {\n      if (editingSlot) {\n        await updateSlot(editingSlot, equipmentData);\n      } else {\n        await addEquipment(activeSection, systemNumber, equipmentData);\n      }\n      setShowModal(false);\n      setEditingSlot(null);\n      setActiveSection(null);\n    } catch (err) {\n      console.error('Failed to save:', err);\n    }\n  };\n\n  const handleDeleteConfirm = async () => {\n    if (deletingSlot) {\n      try {\n        await removeEquipment(deletingSlot);\n      } catch (err) {\n        console.error('Failed:', err);\n      }\n    }\n    setDeletingSlot(null);\n  };\n\n  const handleCameraClick = (slot) => {\n    if (onNavigateToTab) {\n      onNavigateToTab('survey', 'photos');\n    }\n  };\n\n  const handleAutoPopulate = async () => {\n    setIsAutoPopulating(true);\n    setAutoPopulateResult(null);\n\n    try {\n      const { added, errors } = await autoPopulateBOS(systemNumber, utilityName);\n      setAutoPopulateResult({\n        success: errors.length === 0,\n        added,\n        message: added > 0 ? `Added ${added}` : 'All set',\n      });\n      setTimeout(() => setAutoPopulateResult(null), 3000);\n    } catch (err) {\n      setAutoPopulateResult({ success: false, message: 'Failed' });\n    } finally {\n      setIsAutoPopulating(false);\n    }\n  };\n\n  const getSlotsForSection = (section) => {\n    const map = {\n      utility: 'utilitySlots',\n      battery1: 'battery1Slots',\n      battery2: 'battery2Slots',\n      backup: 'backupSlots',\n      postSMS: 'postSMSSlots',\n    };\n    return systemBOS?.[map[section]] || [];\n  };\n\n  if (loading) {\n    return (\n      <div className={styles.centered}>\n        <LoadingSpinner size=\"medium\" />\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className={styles.centered}>\n        <p className={styles.error}>{error}</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className={styles.container}>\n      {/* Utility Bar - Now properly displays utility from projectData */}\n      <div className={styles.utilityBar}>\n        <div className={styles.utilityInfo}>\n          <span className={styles.utilityLabel}>Utility:</span>\n          <span className={styles.utilityValue}>{utilityName || 'Not selected'}</span>\n          {zipCode && (\n            <>\n              <span className={styles.utilityLabel} style={{ marginLeft: '16px' }}>Zip:</span>\n              <span className={styles.utilityValue}>{zipCode}</span>\n            </>\n          )}\n        </div>\n\n        {autoPopulateResult ? (\n          <span className={autoPopulateResult.success ? styles.successBadge : styles.errorBadge}>\n            {autoPopulateResult.message}\n          </span>\n        ) : autoPopulateStatus.canPopulate ? (\n          <button className={styles.autoBtn} onClick={handleAutoPopulate} disabled={isAutoPopulating}>\n            {isAutoPopulating ? <span className={styles.spinner} /> : <BoltIcon />}\n            <span>{isAutoPopulating ? 'Adding...' : `Add Required (${autoPopulateStatus.count})`}</span>\n          </button>\n        ) : utilityName ? (\n          <span className={styles.allSet}>All requirements met</span>\n        ) : null}\n      </div>\n\n      {/* BOS Equipment List with Section Headers */}\n      <div className={styles.equipmentList}>\n        {visibleSections.map(section => {\n          const pattern = BOS_FIELD_PATTERNS[section];\n          const slots = getSlotsForSection(section);\n\n          // Section labels\n          const sectionLabels = {\n            utility: 'Utility BOS',\n            battery1: 'Battery Type 1 BOS',\n            battery2: 'Battery Type 2 BOS',\n            backup: 'Backup BOS',\n            postSMS: 'Post-SMS BOS',\n          };\n\n          return (\n            <div key={section} className={styles.bosSection}>\n              {/* Section Header */}\n              <div className={styles.sectionHeader}>\n                <h3 className={styles.sectionTitle}>{sectionLabels[section]}</h3>\n                <span className={styles.slotCount}>\n                  {slots.length}/{pattern.maxSlots}\n                </span>\n              </div>\n\n              {/* BOS Slots - Each is an EquipmentRow */}\n              {slots.map(slot => {\n                const slotKey = `${slot.fieldPrefix}-${slot.slotNumber}`;\n                const isExpanded = expandedSlots[slotKey] || false;\n\n                return (\n                  <EquipmentRow\n                    key={slotKey}\n                    title={slot.equipment_type || 'BOS Equipment'}\n                    subtitle={`${slot.make || ''} ${slot.model || ''}`.trim() || undefined}\n                    badge={slot.amp_rating}\n                    isComplete={!!(slot.make && slot.model)}\n                    expanded={isExpanded}\n                    onToggle={() => toggleSlot(slotKey)}\n                    fields={[\n                      { label: 'Type', value: slot.equipment_type },\n                      { label: 'Make', value: slot.make },\n                      { label: 'Model', value: slot.model },\n                      { label: 'Amp Rating', value: slot.amp_rating },\n                      { label: 'Status', value: slot.isNew ? 'New' : 'Existing' },\n                    ]}\n                    onCamera={() => handleCameraClick(slot)}\n                    onEdit={() => handleEditClick(slot)}\n                    onDelete={() => handleDeleteClick(slot)}\n                  />\n                );\n              })}\n\n              {/* Add Button */}\n              {slots.length < pattern.maxSlots && (\n                <button type=\"button\" className={styles.addBtn} onClick={() => handleAddClick(section)}>\n                  <PlusIcon /> Add BOS Equipment\n                </button>\n              )}\n            </div>\n          );\n        })}\n      </div>\n\n      {/* Modals */}\n      <BOSEquipmentModal\n        isOpen={showModal}\n        onClose={() => {\n          setShowModal(false);\n          setEditingSlot(null);\n        }}\n        onSave={handleModalSave}\n        section={activeSection}\n        systemNumber={systemNumber}\n        existingSlot={editingSlot}\n        equipmentCatalog={equipmentCatalog}\n        findEquipment={findEquipment}\n        calculateMinAmp={calculateMinAmp}\n        triggerEquipment={systemTriggers}\n      />\n\n      <ConfirmDialog\n        isOpen={!!deletingSlot}\n        onClose={() => setDeletingSlot(null)}\n        onConfirm={handleDeleteConfirm}\n        title=\"Remove Equipment\"\n        message={deletingSlot ? `Remove ${deletingSlot.make} ${deletingSlot.model}?` : ''}\n        confirmText=\"Remove\"\n        variant=\"danger\"\n      />\n    </div>\n  );\n};\n\nexport default BOSPanel;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\BackupLoadSubPanelSection.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'AddSectionButton' is defined but never used.","line":2,"column":76,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":92},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadModels'. Either include it or remove the dependency array.","line":34,"column":6,"nodeType":"ArrayExpression","endLine":34,"endColumn":34,"suggestions":[{"desc":"Update the dependencies array to be: [formData.backup_panel_make, loadModels]","fix":{"range":[1209,1237],"text":"[formData.backup_panel_make, loadModels]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Alert, EquipmentRow, FormFieldRow, TableDropdown, TableRowButton, AddSectionButton } from '../../ui';\nimport BOSEquipmentSection from './BOSEquipmentSection';\nimport {\n  getCombinerPanelManufacturers,\n  getCombinerPanelModels,\n} from '../../../services/equipmentService';\nimport logger from '../../../services/devLogger';\nimport styles from './BackupLoadSubPanelSection.module.css';\n\n/**\n * Backup Load Sub Panel Section\n * Shown when backup option is \"Whole Home\" or \"Partial Home\"\n */\nconst BackupLoadSubPanelSection = ({ formData, onChange, backupSystemSize, systemNumber = 1 }) => {\n  const [manufacturers, setManufacturers] = useState([]);\n  const [models, setModels] = useState([]);\n  const [loadingManufacturers, setLoadingManufacturers] = useState(false);\n  const [loadingModels, setLoadingModels] = useState(false);\n  const [editTieInBreaker, setEditTieInBreaker] = useState(false);\n\n  // Load manufacturers on mount\n  useEffect(() => {\n    loadManufacturers();\n  }, []);\n\n  // Load models when manufacturer changes\n  useEffect(() => {\n    if (formData.backup_panel_make) {\n      loadModels();\n    } else {\n      setModels([]);\n    }\n  }, [formData.backup_panel_make]);\n\n  const loadManufacturers = async () => {\n    setLoadingManufacturers(true);\n    try {\n      const response = await getCombinerPanelManufacturers();\n      const manufacturerList = response?.data || [];\n      // Normalize data to { label, value } format\n      const normalized = manufacturerList.map(item => {\n        if (typeof item === 'string') {\n          return { label: item, value: item };\n        }\n        const name = item.manufacturer || item.name || item.label || String(item);\n        return { label: name, value: name };\n      });\n      // Filter out Enphase from backup panel manufacturers\n      const filtered = normalized.filter(m =>\n        m.label !== 'Enphase' && m.value !== 'Enphase'\n      );\n      setManufacturers(filtered);\n    } catch (error) {\n      logger.error('Equipment', 'Error loading backup panel manufacturers:', error);\n    } finally {\n      setLoadingManufacturers(false);\n    }\n  };\n\n  const loadModels = async () => {\n    setLoadingModels(true);\n    try {\n      const response = await getCombinerPanelModels(formData.backup_panel_make);\n      const modelList = response?.data || [];\n      // Normalize data to { label, value } format\n      const normalized = modelList.map(item => {\n        if (typeof item === 'string') {\n          return { label: item, value: item };\n        }\n        const modelName = item.model || item.model_number || item.name || item.label || String(item);\n        return { label: modelName, value: modelName };\n      });\n      setModels(normalized);\n    } catch (error) {\n      logger.error('Equipment', 'Error loading backup panel models:', error);\n    } finally {\n      setLoadingModels(false);\n    }\n  };\n\n  const handleMakeChange = (value) => {\n    onChange('backup_panel_make', value);\n    onChange('backup_panel_model', '');\n  };\n\n  const handleClearTieInBreaker = () => {\n    onChange('backup_panel_tie_in_breaker', '');\n    setEditTieInBreaker(false);\n  };\n\n  // Breaker rating options (15-600)\n  const breakerOptions = [\n    '15', '20', '25', '30', '35', '40', '45', '50', '60', '70', '80', '90', '100',\n    '110', '125', '150', '175', '200', '225', '250', '300', '350', '400', '450', '500', '600'\n  ];\n\n  // Bus amp options (40 to 250 in increments of 10)\n  const busAmpOptions = Array.from({ length: 22 }, (_, i) => {\n    const value = 40 + i * 10;\n    return { label: value.toString(), value: value.toString() };\n  });\n\n  // Main breaker options\n  const mainBreakerOptions = [\n    { label: 'MLO', value: 'MLO' },\n    { label: '100', value: '100' },\n    { label: '110', value: '110' },\n    { label: '125', value: '125' },\n    { label: '150', value: '150' },\n    { label: '175', value: '175' },\n    { label: '200', value: '200' },\n    { label: '225', value: '225' },\n    { label: '250', value: '250' },\n    { label: '300', value: '300' },\n    { label: '350', value: '350' },\n    { label: '400', value: '400' },\n    { label: '450', value: '450' },\n    { label: '500', value: '500' },\n    { label: '600', value: '600' },\n  ];\n\n  const isComplete = formData.backup_panel_make && formData.backup_panel_model;\n\n  const getSubtitle = () => {\n    if (formData.backup_panel_make && formData.backup_panel_model) {\n      return `${formData.backup_panel_make} ${formData.backup_panel_model}`;\n    }\n    return '';\n  };\n\n  const handleDelete = () => {\n    onChange('backup_panel_make', '');\n    onChange('backup_panel_model', '');\n    onChange('backup_panel_bus_amps', '');\n    onChange('backup_panel_main_breaker', 'MLO');\n    onChange('backup_panel_tie_in_breaker', '');\n    onChange('backup_panel_isnew', true);\n    setEditTieInBreaker(false);\n  };\n\n  return (\n    <div className={styles.sectionWrapper}>\n      <EquipmentRow\n        title=\"Backup Load Sub Panel\"\n        subtitle={getSubtitle()}\n        showNewExistingToggle={true}\n        isNew={formData.backup_panel_isnew !== false}\n        onNewExistingChange={(isNew) => onChange('backup_panel_isnew', isNew)}\n        onDelete={handleDelete}\n      >\n        <TableDropdown\n          label=\"Make\"\n          value={formData.backup_panel_make || ''}\n          onChange={handleMakeChange}\n          options={manufacturers}\n          placeholder={loadingManufacturers ? 'Loading...' : 'Select make...'}\n          disabled={loadingManufacturers}\n        />\n\n        <TableDropdown\n          label=\"Model\"\n          value={formData.backup_panel_model || ''}\n          onChange={(value) => onChange('backup_panel_model', value)}\n          options={models}\n          placeholder={!formData.backup_panel_make ? 'Select make' : loadingModels ? 'Loading...' : 'Select model'}\n          disabled={!formData.backup_panel_make || loadingModels}\n        />\n\n        <TableDropdown\n          label=\"Bus (Amps)\"\n          value={formData.backup_panel_bus_amps || ''}\n          onChange={(value) => onChange('backup_panel_bus_amps', value)}\n          options={busAmpOptions}\n          placeholder=\"Select amps...\"\n        />\n\n        <TableDropdown\n          label=\"Main Circuit Breaker\"\n          value={formData.backup_panel_main_breaker || 'MLO'}\n          onChange={(value) => onChange('backup_panel_main_breaker', value)}\n          options={mainBreakerOptions}\n          placeholder=\"Select breaker...\"\n        />\n\n        {/* Tie-in Breaker */}\n        <FormFieldRow label=\"Tie-in Breaker\">\n          <TableRowButton\n            label=\"Auto\"\n            variant=\"outline\"\n            active={!editTieInBreaker}\n            onClick={() => {\n              handleClearTieInBreaker();\n            }}\n          />\n          <TableRowButton\n            label=\"Custom\"\n            variant=\"outline\"\n            active={editTieInBreaker}\n            onClick={() => setEditTieInBreaker(true)}\n          />\n        </FormFieldRow>\n        {!editTieInBreaker ? (\n          <div className={styles.alertContainer}>\n            <Alert variant=\"info\">\n              A minimum SMS Tie-in Breaker will be added in Main Panel (A). If you are landing in another location and/or using alternate Tie-in method you can edit it in the Electrical Section.\n            </Alert>\n          </div>\n        ) : (\n          <TableDropdown\n            label=\"Breaker Rating\"\n            value={formData.backup_panel_tie_in_breaker || ''}\n            onChange={(value) => onChange('backup_panel_tie_in_breaker', value)}\n            options={breakerOptions.map(rating => ({ label: rating, value: rating }))}\n            placeholder=\"Select rating...\"\n          />\n        )}\n      </EquipmentRow>\n\n      {/* BOS Equipment */}\n      {isComplete && (\n        <BOSEquipmentSection\n          formData={formData}\n          onChange={onChange}\n          section=\"backup\"\n          systemNumber={systemNumber}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default BackupLoadSubPanelSection;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\BatteryTypeSection.js","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'formData', 'loadModels', and 'prefix'. Either include them or remove the dependency array.","line":43,"column":6,"nodeType":"ArrayExpression","endLine":43,"endColumn":34,"suggestions":[{"desc":"Update the dependencies array to be: [formData, loadModels, prefix]","fix":{"range":[1305,1333],"text":"[formData, loadModels, prefix]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a complex expression in the dependency array. Extract it to a separate variable so it can be statically checked.","line":43,"column":7,"nodeType":"MemberExpression","endLine":43,"endColumn":33},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'formData', 'onChange', and 'prefix'. Either include them or remove the dependency array. If 'onChange' changes too often, find the parent component that defines it and wrap that definition in useCallback.","line":121,"column":6,"nodeType":"ArrayExpression","endLine":121,"endColumn":61,"suggestions":[{"desc":"Update the dependencies array to be: [formData, isFranklinAPower, onChange, prefix]","fix":{"range":[4026,4081],"text":"[formData, isFranklinAPower, onChange, prefix]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a complex expression in the dependency array. Extract it to a separate variable so it can be statically checked.","line":121,"column":25,"nodeType":"MemberExpression","endLine":121,"endColumn":60}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { EquipmentRow, FormFieldRow, TableDropdown, AddSectionButton, PreferredButton } from '../../ui';\nimport { PreferredEquipmentModal } from '../../equipment';\nimport BOSEquipmentSection from './BOSEquipmentSection';\nimport {\n  getBatteryManufacturers,\n  getBatteryModels,\n} from '../../../services/equipmentService';\nimport logger from '../../../services/devLogger';\n\n/**\n * Battery Type Section\n * Handles battery configuration with optional Battery Type 2\n */\nconst BatteryTypeSection = ({\n  formData,\n  onChange,\n  batteryNumber = 1,\n  showAddButton = false,\n  onAddBatteryType2 = null,\n  systemNumber = 1,\n}) => {\n  const [manufacturers, setManufacturers] = useState([]);\n  const [models, setModels] = useState([]);\n  const [loadingManufacturers, setLoadingManufacturers] = useState(false);\n  const [loadingModels, setLoadingModels] = useState(false);\n  const [showPreferredModal, setShowPreferredModal] = useState(false);\n\n  const prefix = batteryNumber === 1 ? 'battery1' : 'battery2';\n\n  // Load manufacturers on mount\n  useEffect(() => {\n    loadManufacturers();\n  }, []);\n\n  // Load models when manufacturer changes\n  useEffect(() => {\n    if (formData[`${prefix}_make`]) {\n      loadModels();\n    } else {\n      setModels([]);\n    }\n  }, [formData[`${prefix}_make`]]);\n\n  const loadManufacturers = async () => {\n    setLoadingManufacturers(true);\n    try {\n      const response = await getBatteryManufacturers();\n      const manufacturerList = response?.data || [];\n      // Normalize data to { label, value } format\n      const normalized = manufacturerList.map(item => {\n        if (typeof item === 'string') {\n          return { label: item, value: item };\n        }\n        const name = item.manufacturer || item.name || item.label || String(item);\n        return { label: name, value: name };\n      });\n      setManufacturers(normalized);\n    } catch (error) {\n      logger.error('Equipment', 'Error loading battery manufacturers:', error);\n    } finally {\n      setLoadingManufacturers(false);\n    }\n  };\n\n  const loadModels = async () => {\n    setLoadingModels(true);\n    try {\n      const response = await getBatteryModels(formData[`${prefix}_make`]);\n      const modelList = response?.data || [];\n      // Normalize data to { label, value } format\n      const normalized = modelList.map(item => {\n        if (typeof item === 'string') {\n          return { label: item, value: item };\n        }\n        const modelName = item.model || item.model_number || item.name || item.label || String(item);\n        return { label: modelName, value: modelName };\n      });\n      setModels(normalized);\n    } catch (error) {\n      logger.error('Equipment', 'Error loading battery models:', error);\n    } finally {\n      setLoadingModels(false);\n    }\n  };\n\n  const handleToggle = (isNew) => {\n    onChange(`${prefix}_isnew`, isNew);\n  };\n\n  const handleMakeChange = (value) => {\n    onChange(`${prefix}_make`, value);\n    onChange(`${prefix}_model`, '');\n  };\n\n  const handleQuantityChange = (e) => {\n    const value = e.target.value.replace(/[^0-9]/g, '');\n    onChange(`${prefix}_quantity`, value);\n  };\n\n  const configOptions = [\n    { label: 'Daisy Chain', value: 'Daisy Chain' },\n    { label: 'Battery Combiner Panel', value: 'Battery Combiner Panel' },\n    { label: 'Inverter', value: 'Inverter' },\n  ];\n\n  const quantity = parseInt(formData[`${prefix}_quantity`] || 0);\n  const showConfiguration = quantity > 1 && showAddButton;\n\n  // Check if Franklin aPower battery with qty > 1 (requires Battery Combiner Panel)\n  const isFranklinAPower =\n    formData[`${prefix}_make`]?.toLowerCase().includes('franklin') &&\n    formData[`${prefix}_model`]?.toLowerCase().includes('apower') &&\n    quantity > 1;\n\n  // Auto-select Battery Combiner Panel for Franklin aPower\n  useEffect(() => {\n    if (isFranklinAPower && formData[`${prefix}_configuration`] !== 'Battery Combiner Panel') {\n      onChange(`${prefix}_configuration`, 'Battery Combiner Panel');\n    }\n  }, [isFranklinAPower, formData[`${prefix}_configuration`]]);\n\n  const isComplete = formData[`${prefix}_make`] && formData[`${prefix}_model`] && formData[`${prefix}_quantity`];\n\n  const getSubtitle = () => {\n    const parts = [];\n    if (formData[`${prefix}_quantity`]) {\n      parts.push(`Qty: ${formData[`${prefix}_quantity`]}`);\n    }\n    if (formData[`${prefix}_make`] && formData[`${prefix}_model`]) {\n      parts.push(`${formData[`${prefix}_make`]} ${formData[`${prefix}_model`]}`);\n    }\n    return parts.join(' - ');\n  };\n\n  const handleDelete = () => {\n    onChange(`${prefix}_make`, '');\n    onChange(`${prefix}_model`, '');\n    onChange(`${prefix}_quantity`, '');\n    onChange(`${prefix}_configuration`, '');\n  };\n\n  const handlePreferredSelect = (selected) => {\n    onChange(`${prefix}_make`, selected.make);\n    onChange(`${prefix}_model`, selected.model);\n  };\n\n  const handleSelectOther = () => {\n    onChange(`${prefix}_make`, '');\n    onChange(`${prefix}_model`, '');\n  };\n\n  return (\n    <div style={{ marginBottom: 'var(--spacing)' }}>\n      <EquipmentRow\n        title={`Battery Type ${batteryNumber}`}\n        subtitle={getSubtitle()}\n        showNewExistingToggle={true}\n        isNew={formData[`${prefix}_isnew`] !== false}\n        onNewExistingChange={handleToggle}\n        onDelete={handleDelete}\n        headerRightContent={\n          <PreferredButton onClick={() => setShowPreferredModal(true)} />\n        }\n      >\n        {/* Quantity */}\n        <FormFieldRow label=\"Quantity\">\n          <input\n            type=\"text\"\n            inputMode=\"numeric\"\n            placeholder=\"00\"\n            value={formData[`${prefix}_quantity`] || ''}\n            onChange={handleQuantityChange}\n            maxLength={2}\n          />\n        </FormFieldRow>\n\n        <TableDropdown\n          label=\"Make\"\n          value={formData[`${prefix}_make`] || ''}\n          onChange={handleMakeChange}\n          options={manufacturers}\n          placeholder={loadingManufacturers ? 'Loading...' : 'Select make...'}\n          disabled={loadingManufacturers}\n        />\n\n        <TableDropdown\n          label=\"Model\"\n          value={formData[`${prefix}_model`] || ''}\n          onChange={(value) => onChange(`${prefix}_model`, value)}\n          options={models}\n          placeholder={!formData[`${prefix}_make`] ? 'Select make' : loadingModels ? 'Loading...' : 'Select model'}\n          disabled={!formData[`${prefix}_make`] || loadingModels}\n        />\n\n        {/* Configuration - Only show if qty > 1 and Battery Type 2 hasn't been added */}\n        {showConfiguration && (\n          <TableDropdown\n            label=\"Configuration\"\n            value={formData[`${prefix}_configuration`] || ''}\n            onChange={(value) => onChange(`${prefix}_configuration`, value)}\n            options={isFranklinAPower ? [{ label: 'Battery Combiner Panel', value: 'Battery Combiner Panel' }] : configOptions}\n            placeholder=\"Select configuration...\"\n            disabled={isFranklinAPower}\n          />\n        )}\n      </EquipmentRow>\n\n      {/* BOS Equipment */}\n      {isComplete && (\n        <BOSEquipmentSection\n          formData={formData}\n          onChange={onChange}\n          section={batteryNumber === 1 ? 'battery1' : 'battery2'}\n          systemNumber={systemNumber}\n        />\n      )}\n\n      {/* Battery Type 2 Button - Show when Battery Type 1 is complete and BT2 hasn't been added */}\n      {batteryNumber === 1 && showAddButton && (\n        <AddSectionButton\n          label=\"Battery Type 2\"\n          onClick={onAddBatteryType2}\n          disabled={!isComplete}\n        />\n      )}\n\n      {/* Preferred Equipment Modal */}\n      <PreferredEquipmentModal\n        isOpen={showPreferredModal}\n        onClose={() => setShowPreferredModal(false)}\n        onSelect={handlePreferredSelect}\n        onSelectOther={handleSelectOther}\n        equipmentType=\"batteries\"\n        title=\"Select Battery\"\n      />\n    </div>\n  );\n};\n\nexport default BatteryTypeSection;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\CombineBOSSection.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getPopulatedSlots' is defined but never used.","line":16,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":27},{"ruleId":"no-unused-vars","severity":1,"message":"'getNextSlotNumber' is defined but never used.","line":16,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":46},{"ruleId":"no-unused-vars","severity":1,"message":"'buildSlotPayload' is defined but never used.","line":16,"column":48,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":64},{"ruleId":"no-unused-vars","severity":1,"message":"'buildClearPayload' is defined but never used.","line":16,"column":66,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":83}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * CombineBOSSection - Multi-System Combination BOS\n *\n * CRITICAL differences from other BOS types:\n * - NO system prefix (applies to all combined systems)\n * - NO _trigger field\n * - NO _active field\n * - Uses _existing instead of _is_new\n * - Has _position field\n * - Uses postcombine_{position}_{slot} pattern\n * - Only shows when 2+ active systems\n */\n\nimport React, { useState, useMemo } from 'react';\nimport { BOS_FIELD_PATTERNS } from '../../../constants/bosFieldPatterns';\nimport { getPopulatedSlots, getNextSlotNumber, buildSlotPayload, buildClearPayload } from '../../../utils/bosFieldUtils';\nimport EquipmentRow from '../../ui/EquipmentRow';\nimport BOSEquipmentModal from './BOSEquipmentModal';\nimport ConfirmDialog from '../../ui/ConfirmDialog';\nimport api from '../../../config/axios';\nimport logger from '../../../services/devLogger';\nimport styles from './CombineBOSSection.module.css';\n\nconst PlusIcon = () => (\n  <svg width=\"12\" height=\"12\" viewBox=\"0 0 16 16\" fill=\"currentColor\">\n    <path d=\"M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2z\"/>\n  </svg>\n);\n\nconst CombineBOSSection = ({\n  projectUuid,\n  systemDetails,\n  activeSystemCount,\n  onNavigateToTab,\n  onRefresh,\n}) => {\n  const [showModal, setShowModal] = useState(false);\n  const [editingSlot, setEditingSlot] = useState(null);\n  const [deletingSlot, setDeletingSlot] = useState(null);\n  const [activePosition, setActivePosition] = useState(1);\n  const [expandedSlots, setExpandedSlots] = useState({});\n  const [saving, setSaving] = useState(false);\n\n  const pattern = BOS_FIELD_PATTERNS.combine;\n\n  // Extract all combine BOS slots organized by position\n  const combineSlots = useMemo(() => {\n    const result = { 1: [], 2: [], 3: [] };\n\n    for (let pos = 1; pos <= pattern.maxPositions; pos++) {\n      for (let slot = 1; slot <= pattern.maxSlotsPerPosition; slot++) {\n        const prefix = `postcombine_${pos}_${slot}`;\n        const equipmentType = systemDetails?.[`${prefix}_equipment_type`];\n\n        if (equipmentType) {\n          result[pos].push({\n            fieldPrefix: prefix,\n            position: pos,\n            slotNumber: slot,\n            section: 'combine',\n            equipment_type: equipmentType,\n            make: systemDetails?.[`${prefix}_make`],\n            model: systemDetails?.[`${prefix}_model`],\n            amp_rating: systemDetails?.[`${prefix}_amp_rating`],\n            existing: systemDetails?.[`${prefix}_existing`],\n            isNew: !systemDetails?.[`${prefix}_existing`],\n          });\n        }\n      }\n    }\n\n    return result;\n  }, [systemDetails, pattern]);\n\n  // Position labels\n  const positionLabels = useMemo(() => ({\n    1: 'DER Disconnect',\n    2: 'Meter',\n    3: 'Utility Disconnect',\n  }), []);\n\n  const toggleSlot = (slotKey) => {\n    setExpandedSlots(prev => ({ ...prev, [slotKey]: !prev[slotKey] }));\n  };\n\n  const handleAddClick = (position) => {\n    setActivePosition(position);\n    setEditingSlot(null);\n    setShowModal(true);\n  };\n\n  const handleEditClick = (slot) => {\n    setActivePosition(slot.position);\n    setEditingSlot(slot);\n    setShowModal(true);\n  };\n\n  const handleDeleteClick = (slot) => {\n    setDeletingSlot(slot);\n  };\n\n  const handleModalSave = async (equipmentData) => {\n    setSaving(true);\n\n    try {\n      // Find next available slot for the position\n      let slotNumber = 1;\n      if (!editingSlot) {\n        const positionSlots = combineSlots[activePosition];\n        slotNumber = positionSlots.length + 1;\n        if (slotNumber > pattern.maxSlotsPerPosition) {\n          logger.error('BOS', 'Position is full');\n          return;\n        }\n      } else {\n        slotNumber = editingSlot.slotNumber;\n      }\n\n      const prefix = `postcombine_${activePosition}_${slotNumber}`;\n      const payload = {\n        [`${prefix}_equipment_type`]: equipmentData.equipmentType,\n        [`${prefix}_make`]: equipmentData.make,\n        [`${prefix}_model`]: equipmentData.model,\n        [`${prefix}_amp_rating`]: equipmentData.ampRating,\n        [`${prefix}_existing`]: !equipmentData.isNew,\n        [`${prefix}_position`]: 'POST COMBINE',\n      };\n\n      await api.patch(`/project/${projectUuid}/system-details`, payload);\n\n      setShowModal(false);\n      setEditingSlot(null);\n\n      if (onRefresh) {\n        onRefresh();\n      }\n    } catch (err) {\n      logger.error('BOS', 'Failed to save combine BOS:', err);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleDeleteConfirm = async () => {\n    if (deletingSlot) {\n      setSaving(true);\n\n      try {\n        const prefix = deletingSlot.fieldPrefix;\n        const payload = {\n          [`${prefix}_equipment_type`]: null,\n          [`${prefix}_make`]: null,\n          [`${prefix}_model`]: null,\n          [`${prefix}_amp_rating`]: null,\n          [`${prefix}_existing`]: null,\n          [`${prefix}_position`]: null,\n        };\n\n        await api.patch(`/project/${projectUuid}/system-details`, payload);\n\n        if (onRefresh) {\n          onRefresh();\n        }\n      } catch (err) {\n        logger.error('BOS', 'Failed to delete combine BOS:', err);\n      } finally {\n        setSaving(false);\n        setDeletingSlot(null);\n      }\n    }\n  };\n\n  const handleCameraClick = () => {\n    if (onNavigateToTab) {\n      onNavigateToTab('survey', 'photos');\n    }\n  };\n\n  // Don't render if less than 2 active systems\n  if (activeSystemCount < 2) {\n    return null;\n  }\n\n  return (\n    <div className={styles.container}>\n      <div className={styles.header}>\n        <div className={styles.headerContent}>\n          <h3 className={styles.title}>Post-Combine BOS</h3>\n          <span className={styles.subtitle}>\n            Multi-system equipment ({activeSystemCount} systems combined)\n          </span>\n        </div>\n      </div>\n\n      {/* Position Sections */}\n      {[1, 2, 3].map(position => {\n        const slots = combineSlots[position];\n        const isFull = slots.length >= pattern.maxSlotsPerPosition;\n\n        return (\n          <div key={position} className={styles.positionSection}>\n            <div className={styles.positionHeader}>\n              <span className={styles.positionLabel}>\n                Position {position}: {positionLabels[position]}\n              </span>\n              <span className={styles.slotCount}>\n                {slots.length}/{pattern.maxSlotsPerPosition}\n              </span>\n            </div>\n\n            {/* Equipment Slots */}\n            {slots.map(slot => {\n              const slotKey = slot.fieldPrefix;\n              const isExpanded = expandedSlots[slotKey] || false;\n\n              return (\n                <EquipmentRow\n                  key={slotKey}\n                  title={slot.equipment_type || 'BOS Equipment'}\n                  subtitle={`${slot.make || ''} ${slot.model || ''}`.trim() || undefined}\n                  badge={slot.amp_rating}\n                  isComplete={!!(slot.make && slot.model)}\n                  expanded={isExpanded}\n                  onToggle={() => toggleSlot(slotKey)}\n                  fields={[\n                    { label: 'Type', value: slot.equipment_type },\n                    { label: 'Make', value: slot.make },\n                    { label: 'Model', value: slot.model },\n                    { label: 'Amp Rating', value: slot.amp_rating },\n                    { label: 'Status', value: slot.existing ? 'Existing' : 'New' },\n                  ]}\n                  onCamera={handleCameraClick}\n                  onEdit={() => handleEditClick(slot)}\n                  onDelete={() => handleDeleteClick(slot)}\n                />\n              );\n            })}\n\n            {/* Add Button */}\n            {!isFull && (\n              <button\n                type=\"button\"\n                className={styles.addButton}\n                onClick={() => handleAddClick(position)}\n                disabled={saving}\n              >\n                <PlusIcon /> Add to Position {position}\n              </button>\n            )}\n          </div>\n        );\n      })}\n\n      {/* Modal */}\n      <BOSEquipmentModal\n        isOpen={showModal}\n        onClose={() => {\n          setShowModal(false);\n          setEditingSlot(null);\n        }}\n        onSave={handleModalSave}\n        section=\"combine\"\n        systemNumber={null}\n        existingSlot={editingSlot}\n        equipmentCatalog={[]} // Combine uses same catalog as other BOS\n      />\n\n      {/* Delete Confirmation */}\n      <ConfirmDialog\n        isOpen={!!deletingSlot}\n        onClose={() => setDeletingSlot(null)}\n        onConfirm={handleDeleteConfirm}\n        title=\"Remove Equipment\"\n        message={deletingSlot ? `Remove ${deletingSlot.make} ${deletingSlot.model} from Position ${deletingSlot.position}?` : ''}\n        confirmText=\"Remove\"\n        variant=\"danger\"\n      />\n    </div>\n  );\n};\n\nexport default CombineBOSSection;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\CombineSystemsForm.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'handleModeToggle' is assigned a value but never used.","line":55,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":55,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport CombinerPanelForm from './CombinerPanelForm';\nimport WarningModal from '../../ui/WarningModal';\nimport {\n  getLandingOptions,\n  generateConfigurationData,\n  isConfigurationComplete,\n} from '../../../utils/combineSystemsHelpers';\nimport styles from './CombineSystemsForm.module.css';\n\n/**\n * CombineSystemsForm - Refactored with expandable row pattern\n * All systems visible at once, inline summary, tight spacing\n */\nconst CombineSystemsForm = ({\n  projectUuid,\n  activeSystems = [],\n  systemData = {},\n  existingConfiguration = null,\n  onSave,\n  hasSubPanelB = false,\n  subPanelBData = null,\n}) => {\n  const [combineSystems, setCombineSystems] = useState(null);\n  const [systemLandings, setSystemLandings] = useState({});\n  const [expandedSystem, setExpandedSystem] = useState(null);\n  const [combinerPanelData, setCombinerPanelData] = useState(null);\n  const [showWarningModal, setShowWarningModal] = useState(false);\n  const [pendingChoice, setPendingChoice] = useState(null);\n\n  // Load existing configuration if available\n  useEffect(() => {\n    if (existingConfiguration) {\n      setCombineSystems(existingConfiguration.combine_systems);\n      setSystemLandings(existingConfiguration.system_landings || {});\n\n      if (existingConfiguration.combiner_panel_data) {\n        setCombinerPanelData(existingConfiguration.combiner_panel_data);\n      }\n    }\n  }, [existingConfiguration]);\n\n  // Auto-expand first unconfigured system when \"Combine\" is selected\n  useEffect(() => {\n    if (combineSystems === true && expandedSystem === null) {\n      const firstUnconfigured = activeSystems.find(\n        sys => !systemLandings[`system${sys}`]\n      );\n      if (firstUnconfigured) {\n        setExpandedSystem(firstUnconfigured);\n      }\n    }\n  }, [combineSystems, activeSystems, systemLandings, expandedSystem]);\n\n  const handleModeToggle = (choice) => {\n    // If switching from Combine to Do Not Combine and there's config, show warning\n    if (combineSystems === true && choice === false && Object.keys(systemLandings).length > 0) {\n      setPendingChoice(choice);\n      setShowWarningModal(true);\n      return;\n    }\n\n    setCombineSystems(choice);\n    if (choice === false) {\n      // Clear configuration when switching to \"Do Not Combine\"\n      setSystemLandings({});\n      setExpandedSystem(null);\n      setCombinerPanelData(null);\n    }\n  };\n\n  const handleConfirmSwitch = () => {\n    setSystemLandings({});\n    setExpandedSystem(null);\n    setCombinerPanelData(null);\n    setCombineSystems(pendingChoice);\n    setShowWarningModal(false);\n    setPendingChoice(null);\n  };\n\n  const handleCancelSwitch = () => {\n    setShowWarningModal(false);\n    setPendingChoice(null);\n  };\n\n  const handleToggleRow = (systemNum) => {\n    setExpandedSystem(expandedSystem === systemNum ? null : systemNum);\n  };\n\n  const handleLandingSelect = (systemNum, landing) => {\n    const newLandings = {\n      ...systemLandings,\n      [`system${systemNum}`]: landing,\n    };\n    setSystemLandings(newLandings);\n\n    // Collapse current row\n    setExpandedSystem(null);\n\n    // Find next unconfigured system and expand it\n    const nextSystem = activeSystems.find(\n      s => s > systemNum && !newLandings[`system${s}`]\n    );\n    if (nextSystem) {\n      setExpandedSystem(nextSystem);\n    }\n\n    // Auto-save configuration\n    if (onSave) {\n      const configData = generateConfigurationData(\n        true,\n        newLandings,\n        activeSystems,\n        systemData,\n        hasSubPanelB,\n        subPanelBData,\n        combinerPanelData\n      );\n      onSave(configData);\n    }\n  };\n\n  const handleCombinerPanelDataSave = (data) => {\n    setCombinerPanelData(data);\n\n    // Auto-save configuration\n    if (onSave) {\n      const configData = generateConfigurationData(\n        combineSystems,\n        systemLandings,\n        activeSystems,\n        systemData,\n        hasSubPanelB,\n        subPanelBData,\n        data\n      );\n      onSave(configData);\n    }\n  };\n\n  // Check if we need at least 2 systems\n  if (activeSystems.length < 2) {\n    return (\n      <div className={styles.container}>\n        <div className={styles.messageBox}>\n          <span className={`${styles.messageIcon} ${styles.info}`}>â„¹ï¸</span>\n          <p className={styles.messageText}>\n            The Combine feature requires at least 2 systems with equipment data.\n            Please add equipment for System 2 or higher to use this feature.\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  // Get landing options for a specific system\n  const getLandingOptionsForSystem = (systemNum) => {\n    return getLandingOptions(\n      systemNum,\n      activeSystems,\n      systemData,\n      systemLandings,\n      hasSubPanelB\n    );\n  };\n\n  // Check if a landing is taken by another system\n  // Combiner Panel can be SHARED - it's not exclusive\n  const isLandingTaken = (systemNum, landing) => {\n    // Combiner Panel can be shared by multiple systems - that's what combiners do!\n    if (landing.includes('Combiner Panel')) return false;\n\n    // All other landings are EXCLUSIVE (one system only)\n    return Object.entries(systemLandings).some(\n      ([key, value]) => key !== `system${systemNum}` && value === landing\n    );\n  };\n\n  // Check if Combiner Panel is being shared with other systems\n  const isCombinerShared = (currentSystemNum, landingValue) => {\n    if (!landingValue?.includes('Combiner Panel')) return false;\n\n    return Object.entries(systemLandings).some(\n      ([key, value]) => key !== `system${currentSystemNum}` && value?.includes('Combiner Panel')\n    );\n  };\n\n  // Check if configuration is complete\n  const configComplete = isConfigurationComplete(activeSystems, systemLandings);\n\n  // Check if any system has selected Combiner Panel\n  const hasCombinerPanelSelection = Object.values(systemLandings).some(\n    landing => landing === 'Combiner Panel'\n  );\n\n  return (\n    <div className={styles.container}>\n      {/* Mode Toggle - Not rendered, controlled by parent */}\n      {/* Parent EquipmentForm handles Do Not Combine / Combine buttons */}\n\n      {/* Do Not Combine State */}\n      {combineSystems === false && (\n        <div className={styles.messageBox}>\n          <span className={`${styles.messageIcon} ${styles.success}`}>âœ“</span>\n          <p className={styles.messageText}>\n            Each system will connect independently to the electrical panel.\n          </p>\n        </div>\n      )}\n\n      {/* Combine State - System Landing Rows */}\n      {combineSystems === true && (\n        <>\n          {activeSystems.map((systemNum) => {\n            const landingKey = `system${systemNum}`;\n            const selectedLanding = systemLandings[landingKey];\n            const isExpanded = expandedSystem === systemNum;\n            const landingOptions = getLandingOptionsForSystem(systemNum);\n\n            return (\n              <div key={systemNum} className={styles.landingRow}>\n                {/* Row Header */}\n                <button\n                  type=\"button\"\n                  className={styles.landingRowHeader}\n                  onClick={() => handleToggleRow(systemNum)}\n                >\n                  <div className={styles.landingRowLeft}>\n                    <span className={styles.systemName}>System {systemNum}</span>\n                    <span className={styles.landingArrow}>â†’</span>\n                    {selectedLanding ? (\n                      <span className={styles.landingValue}>{selectedLanding}</span>\n                    ) : (\n                      <span className={styles.landingEmpty}>Select landing</span>\n                    )}\n                  </div>\n                  <div className={`${styles.chevron} ${isExpanded ? styles.open : ''}`}>\n                    <ChevronDownIcon />\n                  </div>\n                </button>\n\n                {/* Expanded Options Panel */}\n                {isExpanded && (\n                  <div className={styles.optionsPanel}>\n                    <div className={styles.optionsGrid}>\n                      {landingOptions.map((option) => {\n                        const isTaken = isLandingTaken(systemNum, option.value);\n                        const isSelected = selectedLanding === option.value;\n                        const isDisabled = option.disabled || isTaken;\n                        const isShared = !isSelected && isCombinerShared(systemNum, option.value);\n\n                        return (\n                          <div\n                            key={option.value}\n                            className={`\n                              ${styles.optionCard}\n                              ${isSelected ? styles.selected : ''}\n                              ${isDisabled ? styles.disabled : ''}\n                              ${isShared ? styles.shared : ''}\n                            `.trim()}\n                            onClick={() => !isDisabled && handleLandingSelect(systemNum, option.value)}\n                          >\n                            <div className={styles.optionTitle}>\n                              {option.label}\n                              {isShared && (\n                                <span className={styles.sharedBadge}>Shared</span>\n                              )}\n                            </div>\n                            <div className={styles.optionSubtitle}>{option.description}</div>\n                            {isTaken && (\n                              <div className={styles.optionDisabledReason}>\n                                (Already selected by another system)\n                              </div>\n                            )}\n                          </div>\n                        );\n                      })}\n                    </div>\n                  </div>\n                )}\n              </div>\n            );\n          })}\n\n          {/* Completion Message */}\n          {configComplete && (\n            <div className={styles.messageBox}>\n              <span className={`${styles.messageIcon} ${styles.success}`}>âœ“</span>\n              <p className={styles.messageText}>\n                All systems configured. Click any row to edit.\n              </p>\n            </div>\n          )}\n\n          {/* Combiner Panel Form (if selected) */}\n          {hasCombinerPanelSelection && (\n            <div className={styles.combinerPanelSection}>\n              <div className={styles.sectionTitle}>Combiner Panel Details</div>\n              <CombinerPanelForm\n                onSave={handleCombinerPanelDataSave}\n                initialData={combinerPanelData}\n              />\n            </div>\n          )}\n        </>\n      )}\n\n      {/* Initial State (no choice made) */}\n      {combineSystems === null && (\n        <div className={styles.messageBox}>\n          <span className={`${styles.messageIcon} ${styles.info}`}>â„¹ï¸</span>\n          <p className={styles.messageText}>\n            Select whether to combine systems or connect them independently.\n          </p>\n        </div>\n      )}\n\n      {/* Warning Modal */}\n      <WarningModal\n        isOpen={showWarningModal}\n        onClose={handleCancelSwitch}\n        onConfirm={handleConfirmSwitch}\n        title=\"Clear Configuration?\"\n        message=\"The Combine System configuration will be cleared.\"\n        scopedToPanel={true}\n      />\n    </div>\n  );\n};\n\n// Chevron Down Icon\nconst ChevronDownIcon = () => (\n  <svg\n    className={styles.chevronSvg}\n    viewBox=\"0 0 16 16\"\n    fill=\"currentColor\"\n  >\n    <path fillRule=\"evenodd\" d=\"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z\"/>\n  </svg>\n);\n\nexport default CombineSystemsForm;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\CombinerPanelForm.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\ConfigurationSummary.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\EnergyStorageSection.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\GatewayConfigurationSection.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\InlineBOSSection.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'AddButton' is defined but never used.","line":12,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * InlineBOSSection - Inline BOS equipment display\n *\n * Displays BOS equipment slots inline within the equipment form,\n * right after the trigger equipment (String Combiner, Battery, etc.)\n */\n\nimport React, { useState } from 'react';\nimport EquipmentRow from '../../ui/EquipmentRow';\nimport BOSEquipmentModal from './BOSEquipmentModal';\nimport ConfirmDialog from '../../ui/ConfirmDialog';\nimport { AddButton } from '../../ui';\nimport { BOS_FIELD_PATTERNS } from '../../../constants/bosFieldPatterns';\nimport { getPopulatedSlots } from '../../../utils/bosFieldUtils';\nimport api from '../../../config/axios';\nimport logger from '../../../services/devLogger';\nimport styles from './InlineBOSSection.module.css';\n\nconst PlusIcon = () => (\n  <svg width=\"12\" height=\"12\" viewBox=\"0 0 16 16\" fill=\"currentColor\">\n    <path d=\"M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2z\"/>\n  </svg>\n);\n\nconst InlineBOSSection = ({\n  projectUuid,\n  systemNumber,\n  section,\n  systemDetails,\n  equipmentCatalog = [],\n  onRefresh,\n  onNavigateToTab,\n}) => {\n  const [showModal, setShowModal] = useState(false);\n  const [editingSlot, setEditingSlot] = useState(null);\n  const [deletingSlot, setDeletingSlot] = useState(null);\n  const [expandedSlots, setExpandedSlots] = useState({});\n  const [saving, setSaving] = useState(false);\n\n  const pattern = BOS_FIELD_PATTERNS[section];\n  const slots = getPopulatedSlots(systemDetails || {}, section, systemNumber);\n\n  const toggleSlot = (slotKey) => {\n    setExpandedSlots(prev => ({ ...prev, [slotKey]: !prev[slotKey] }));\n  };\n\n  const handleAddClick = () => {\n    setEditingSlot(null);\n    setShowModal(true);\n  };\n\n  const handleEditClick = (slot) => {\n    setEditingSlot(slot);\n    setShowModal(true);\n  };\n\n  const handleDeleteClick = (slot) => {\n    setDeletingSlot(slot);\n  };\n\n  const handleModalSave = async (equipmentData) => {\n    setSaving(true);\n\n    try {\n      let slotNumber = 1;\n      if (!editingSlot) {\n        // Adding new - find next available slot\n        slotNumber = slots.length + 1;\n        if (slotNumber > pattern.maxSlots) {\n          logger.error('BOS', 'All slots are full');\n          return;\n        }\n      } else {\n        slotNumber = editingSlot.slotNumber;\n      }\n\n      const prefix = pattern.slotPattern(systemNumber, slotNumber);\n      const payload = {\n        [`${prefix}_equipment_type`]: equipmentData.equipmentType,\n        [`${prefix}_make`]: equipmentData.make,\n        [`${prefix}_model`]: equipmentData.model,\n        [`${prefix}_amp_rating`]: equipmentData.ampRating,\n        [`${prefix}_is_new`]: equipmentData.isNew ?? true,\n        [`${prefix}_block_name`]: equipmentData.blockName,\n      };\n\n      // Add trigger and active fields if needed\n      if (pattern.hasTrigger) {\n        payload[`${prefix}_trigger`] = true;\n      }\n      if (pattern.hasActive) {\n        payload[`${prefix}_active`] = true;\n      }\n\n      await api.patch(`/project/${projectUuid}/system-details`, payload);\n\n      setShowModal(false);\n      setEditingSlot(null);\n\n      if (onRefresh) {\n        onRefresh();\n      }\n    } catch (err) {\n      logger.error('BOS', 'Failed to save BOS equipment:', err);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleDeleteConfirm = async () => {\n    if (deletingSlot) {\n      setSaving(true);\n\n      try {\n        const prefix = deletingSlot.fieldPrefix;\n        const payload = {\n          [`${prefix}_equipment_type`]: null,\n          [`${prefix}_make`]: null,\n          [`${prefix}_model`]: null,\n          [`${prefix}_amp_rating`]: null,\n          [`${prefix}_is_new`]: null,\n          [`${prefix}_block_name`]: null,\n        };\n\n        if (pattern.hasTrigger) {\n          payload[`${prefix}_trigger`] = null;\n        }\n        if (pattern.hasActive) {\n          payload[`${prefix}_active`] = null;\n        }\n\n        await api.patch(`/project/${projectUuid}/system-details`, payload);\n\n        if (onRefresh) {\n          onRefresh();\n        }\n      } catch (err) {\n        logger.error('BOS', 'Failed to delete BOS equipment:', err);\n      } finally {\n        setSaving(false);\n        setDeletingSlot(null);\n      }\n    }\n  };\n\n  const handleCameraClick = () => {\n    if (onNavigateToTab) {\n      onNavigateToTab('survey', 'photos');\n    }\n  };\n\n  // Section labels\n  const sectionLabels = {\n    utility: 'BOS Equipment',\n    battery1: 'BOS Equipment',\n    battery2: 'BOS Equipment',\n    backup: 'BOS Equipment',\n    postSMS: 'BOS Equipment',\n  };\n\n  return (\n    <div className={styles.container}>\n      {/* BOS Equipment Rows */}\n      {slots.map(slot => {\n        const slotKey = `${slot.fieldPrefix}-${slot.slotNumber}`;\n        const isExpanded = expandedSlots[slotKey] || false;\n\n        return (\n          <EquipmentRow\n            key={slotKey}\n            title={slot.equipment_type || 'BOS Equipment'}\n            subtitle={`${slot.make || ''} ${slot.model || ''}`.trim() || undefined}\n            badge={slot.amp_rating}\n            isComplete={!!(slot.make && slot.model)}\n            expanded={isExpanded}\n            onToggle={() => toggleSlot(slotKey)}\n            fields={[\n              { label: 'Type', value: slot.equipment_type },\n              { label: 'Make', value: slot.make },\n              { label: 'Model', value: slot.model },\n              { label: 'Amp Rating', value: slot.amp_rating },\n              { label: 'Status', value: slot.isNew ? 'New' : 'Existing' },\n            ]}\n            onCamera={handleCameraClick}\n            onEdit={() => handleEditClick(slot)}\n            onDelete={() => handleDeleteClick(slot)}\n          />\n        );\n      })}\n\n      {/* Add Button - Only show if not full */}\n      {slots.length < pattern.maxSlots && (\n        <button\n          type=\"button\"\n          className={styles.addButton}\n          onClick={handleAddClick}\n          disabled={saving}\n        >\n          <PlusIcon /> Add {sectionLabels[section]}\n        </button>\n      )}\n\n      {/* Modal */}\n      <BOSEquipmentModal\n        isOpen={showModal}\n        onClose={() => {\n          setShowModal(false);\n          setEditingSlot(null);\n        }}\n        onSave={handleModalSave}\n        section={section}\n        systemNumber={systemNumber}\n        existingSlot={editingSlot}\n        equipmentCatalog={equipmentCatalog}\n      />\n\n      {/* Delete Confirmation */}\n      <ConfirmDialog\n        isOpen={!!deletingSlot}\n        onClose={() => setDeletingSlot(null)}\n        onConfirm={handleDeleteConfirm}\n        title=\"Remove Equipment\"\n        message={deletingSlot ? `Remove ${deletingSlot.make} ${deletingSlot.model}?` : ''}\n        confirmText=\"Remove\"\n        variant=\"danger\"\n      />\n    </div>\n  );\n};\n\nexport default InlineBOSSection;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\InverterMicroSection.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'Divider' is defined but never used.","line":7,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":10},{"ruleId":"no-unused-vars","severity":1,"message":"'formStyles' is defined but never used.","line":17,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":18},{"ruleId":"no-unused-vars","severity":1,"message":"'selectedModelData' is assigned a value but never used.","line":43,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":43,"endColumn":27},{"ruleId":"no-unused-vars","severity":1,"message":"'activeStringInput' is assigned a value but never used.","line":55,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":55,"endColumn":27},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadModels'. Either include it or remove the dependency array.","line":88,"column":6,"nodeType":"ArrayExpression","endLine":88,"endColumn":30,"suggestions":[{"desc":"Update the dependencies array to be: [formData.inverter_make, loadModels]","fix":{"range":[3277,3301],"text":"[formData.inverter_make, loadModels]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'loadingOptimizerMakes' and 'optimizerManufacturers.length'. Either include them or remove the dependency array.","line":111,"column":6,"nodeType":"ArrayExpression","endLine":111,"endColumn":81,"suggestions":[{"desc":"Update the dependencies array to be: [formData.inverter_make, formData.optimizer_make, formData.optimizer_model, loadingOptimizerMakes, optimizerManufacturers.length]","fix":{"range":[4392,4467],"text":"[formData.inverter_make, formData.optimizer_make, formData.optimizer_model, loadingOptimizerMakes, optimizerManufacturers.length]"}}]},{"ruleId":"no-unused-vars","severity":1,"message":"'inverterMaxContOutput' is assigned a value but never used.","line":307,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":307,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo, useRef } from 'react';\nimport {\n  EquipmentRow,\n  TableDropdown,\n  SectionClearModal,\n  SectionRemoveModal,\n  Divider,\n  FormFieldRow,\n  TableRowButton,\n  Alert,\n  Button,\n  PreferredButton\n} from '../../ui';\nimport { PreferredEquipmentModal } from '../../equipment';\nimport BOSEquipmentSection from './BOSEquipmentSection';\nimport styles from '../../../styles/ProjectAdd.module.css';\nimport formStyles from '../../../styles/FormSections.module.css';\nimport componentStyles from './InverterMicroSection.module.css';\nimport {\n  getInverterManufacturers,\n  getInverterModels,\n  getOptimizerManufacturers,\n  getOptimizerModels,\n  manufacturerSupportsOptimizers,\n} from '../../../services/equipmentService';\nimport { isPowerWall3, extractPowerWall3KW, updatePowerWall3ModelWithKW } from '../../../utils/powerWallDetection';\nimport { POWERWALL_3_KILOWATT_OPTIONS } from '../../../utils/constants';\nimport logger from '../../../services/devLogger';\nimport { useSectionDelete, DELETE_BEHAVIOR } from '../../../hooks/useSectionDelete';\nimport {\n  calculateInverterInputDistribution,\n} from '../../../utils/stringingCalculations';\n\n/**\n * Inverter/Microinverter Section\n * Determines equipment type from model number, then loads appropriate configuration\n */\nconst InverterMicroSection = ({ formData, onChange }) => {\n  const [manufacturers, setManufacturers] = useState([]);\n  const [models, setModels] = useState([]);\n  const [loadingMakes, setLoadingMakes] = useState(false);\n  const [loadingModels, setLoadingModels] = useState(false);\n  const [selectedModelData, setSelectedModelData] = useState(null);\n  const [showOptimizers, setShowOptimizers] = useState(false);\n  const [optimizerManufacturers, setOptimizerManufacturers] = useState([]);\n  const [optimizerModels, setOptimizerModels] = useState([]);\n  const [loadingOptimizerMakes, setLoadingOptimizerMakes] = useState(false);\n  const [loadingOptimizerModels, setLoadingOptimizerModels] = useState(false);\n\n  // Track auto-population to prevent duplicate onChange calls\n  const hasAutoPopulatedRef = useRef(false);\n  const lastProcessedModelRef = useRef(null);\n\n  // Stringing state\n  const [activeStringInput, setActiveStringInput] = useState(null);\n\n  // Preferred equipment modal state\n  const [showPreferredModal, setShowPreferredModal] = useState(false);\n  const [showOptimizerPreferredModal, setShowOptimizerPreferredModal] = useState(false);\n\n  // PowerWall 3 Detection\n  const isPW3 = useMemo(() => {\n    return isPowerWall3(formData.inverter_model);\n  }, [formData.inverter_model]);\n\n  // Extract current kW rating from PowerWall 3 model name\n  const currentPW3KW = useMemo(() => {\n    if (!isPW3) return null;\n    return extractPowerWall3KW(formData.inverter_model);\n  }, [isPW3, formData.inverter_model]);\n\n  // Load manufacturers on mount\n  useEffect(() => {\n    loadManufacturers();\n  }, []);\n\n  // Load models when manufacturer changes\n  useEffect(() => {\n    if (formData.inverter_make) {\n      loadModels(formData.inverter_make);\n    } else {\n      setModels([]);\n      setSelectedModelData(null);\n      // Reset auto-population tracking when manufacturer is cleared\n      hasAutoPopulatedRef.current = false;\n      lastProcessedModelRef.current = null;\n    }\n  }, [formData.inverter_make]);\n\n  // Check if optimizers should be shown\n  useEffect(() => {\n    const supportsOptimizers = manufacturerSupportsOptimizers(formData.inverter_make);\n    const hasOptimizerData = formData.optimizer_make || formData.optimizer_model;\n\n    logger.debug('Equipment', `ðŸ” Optimizer visibility check - inverter_make: ${formData.inverter_make}`);\n    logger.debug('Equipment', `ðŸ” supportsOptimizers: ${supportsOptimizers}, hasOptimizerData: ${hasOptimizerData}`);\n\n    if (supportsOptimizers || hasOptimizerData) {\n      logger.debug('Equipment', `âœ… Showing optimizer section`);\n      setShowOptimizers(true);\n      if (supportsOptimizers && !loadingOptimizerMakes && optimizerManufacturers.length === 0) {\n        logger.debug('Equipment', `ðŸ“ž Loading optimizer manufacturers...`);\n        loadOptimizerManufacturers();\n      } else {\n        logger.debug('Equipment', `â„¹ï¸ Optimizer manufacturers already loaded or loading. Count: ${optimizerManufacturers.length}`);\n      }\n    } else {\n      logger.debug('Equipment', `âŒ Hiding optimizer section`);\n      setShowOptimizers(false);\n    }\n  }, [formData.inverter_make, formData.optimizer_make, formData.optimizer_model]);\n\n  // Load optimizer models when optimizer manufacturer changes\n  useEffect(() => {\n    if (formData.optimizer_make) {\n      loadOptimizerModelsData(formData.optimizer_make);\n    } else {\n      setOptimizerModels([]);\n    }\n  }, [formData.optimizer_make]);\n\n  const loadManufacturers = async () => {\n    setLoadingMakes(true);\n    try {\n      const response = await getInverterManufacturers();\n      setManufacturers(response.data || []);\n    } catch (error) {\n      logger.error('Equipment', 'Failed to load inverter manufacturers:', error);\n    } finally {\n      setLoadingMakes(false);\n    }\n  };\n\n  const loadModels = async (manufacturer) => {\n    setLoadingModels(true);\n    try {\n      const response = await getInverterModels(manufacturer);\n      const modelsData = response.data || [];\n      setModels(modelsData);\n\n      // If current model is selected, find its data\n      if (formData.inverter_model && lastProcessedModelRef.current !== formData.inverter_model) {\n        const modelData = modelsData.find(m => m.model_number === formData.inverter_model);\n        if (modelData && !hasAutoPopulatedRef.current) {\n          // Mark as processed to prevent duplicate calls\n          hasAutoPopulatedRef.current = true;\n          lastProcessedModelRef.current = formData.inverter_model;\n\n          setSelectedModelData(modelData);\n\n          // Detect if this is a microinverter or string inverter\n          const isMicroinverter = modelData.microinverter === true ||\n                                 modelData.equipment_type?.toLowerCase().includes('micro');\n\n          onChange('inverter_type', isMicroinverter ? 'microinverter' : 'inverter');\n          onChange('inverter_max_cont_output_amps', modelData.max_cont_output_amps);\n\n          // Store max_strings_branches for string inverters\n          if (!isMicroinverter && modelData.max_strings_branches) {\n            onChange('inverter_max_strings_branches', modelData.max_strings_branches);\n          }\n\n          // Store model ID for future reference\n          if (modelData.id) {\n            onChange('inverter_model_id', modelData.id);\n          }\n        }\n      }\n    } catch (error) {\n      logger.error('Equipment', 'Failed to load inverter models:', error);\n    } finally {\n      setLoadingModels(false);\n    }\n  };\n\n  const loadOptimizerManufacturers = async () => {\n    setLoadingOptimizerMakes(true);\n    try {\n      const response = await getOptimizerManufacturers();\n      setOptimizerManufacturers(response.data || []);\n    } catch (error) {\n      logger.error('Equipment', 'Failed to load optimizer manufacturers:', error);\n    } finally {\n      setLoadingOptimizerMakes(false);\n    }\n  };\n\n  const loadOptimizerModelsData = async (manufacturer) => {\n    setLoadingOptimizerModels(true);\n    try {\n      const response = await getOptimizerModels(manufacturer);\n      const models = response.data || [];\n      setOptimizerModels(models);\n    } catch (error) {\n      logger.error('Equipment', 'Failed to load optimizer models:', error);\n      setOptimizerModels([]);\n    } finally {\n      setLoadingOptimizerModels(false);\n    }\n  };\n\n  // Wrapper to save toggle defaults when any field changes\n  const handleFieldChange = (fieldName, value) => {\n    onChange(fieldName, value);\n    // Also save New/Existing toggle default if not already set\n    if (formData.inverter_isnew === undefined) {\n      onChange('inverter_isnew', true);\n    }\n  };\n\n  // Wrapper for optimizer fields\n  const handleOptimizerFieldChange = (fieldName, value) => {\n    onChange(fieldName, value);\n    // Also save New/Existing toggle default if not already set\n    if (formData.optimizer_isnew === undefined) {\n      onChange('optimizer_isnew', true);\n    }\n  };\n\n  const handleManufacturerChange = (value) => {\n    // Reset auto-population tracking when manufacturer changes\n    hasAutoPopulatedRef.current = false;\n    lastProcessedModelRef.current = null;\n\n    handleFieldChange('inverter_make', value);\n    // Clear model when manufacturer changes\n    onChange('inverter_model', '');\n    onChange('inverter_type', '');\n    onChange('inverter_max_cont_output_amps', '');\n  };\n\n  // Use the section delete hook with CLEAR_ONLY behavior (Inverter can never be removed - Battery Only mode exists as alternative)\n  const {\n    showClearModal,\n    showRemoveModal,\n    handleTrashClick,\n    handleClearConfirm,\n    handleRemoveConfirm,\n    closeClearModal,\n    closeRemoveModal,\n  } = useSectionDelete({\n    sectionName: 'inverter',\n    formData,\n    onChange,\n    behavior: DELETE_BEHAVIOR.CLEAR_ONLY,\n    visibilityFlag: null, // No visibility flag - section always visible\n  });\n\n  // Legacy handleDelete removed - now using useSectionDelete hook\n\n  const handleModelChange = (value) => {\n    handleFieldChange('inverter_model', value);\n\n    // Find model data and update related fields\n    const modelData = models.find(m => m.model_number === value);\n    if (modelData) {\n      setSelectedModelData(modelData);\n\n      // Detect if this is a microinverter or string inverter\n      const isMicroinverter = modelData.microinverter === true ||\n                             modelData.equipment_type?.toLowerCase().includes('micro');\n\n      onChange('inverter_type', isMicroinverter ? 'microinverter' : 'inverter');\n      onChange('inverter_max_cont_output_amps', modelData.max_cont_output_amps);\n\n      // Store max_strings_branches for string inverters (used for stringing calculations)\n      if (!isMicroinverter && modelData.max_strings_branches) {\n        onChange('inverter_max_strings_branches', modelData.max_strings_branches);\n      } else {\n        onChange('inverter_max_strings_branches', null);\n      }\n\n      // Store electrical specs for stringing validation\n      // Try both possible field names from database\n      onChange('inverter_max_vdc', modelData.voltage_maximum || modelData.max_vdc || '');\n      onChange('inverter_min_vdc', modelData.voltage_minimum || modelData.min_vdc || '');\n      onChange('inverter_max_input_isc', modelData.max_input_isc || modelData.max_isc_per_input || '');\n\n      // Store full model data ID for future reference\n      if (modelData.id) {\n        onChange('inverter_model_id', modelData.id);\n      }\n    }\n  };\n\n  // Check if we have inverter configured\n  const hasInverter = formData.inverter_make && formData.inverter_model;\n\n  // ============================================\n  // STRINGING LOGIC\n  // ============================================\n\n  // Get stringing type (default to 'auto')\n  const stringingType = formData.stringing_type || 'auto';\n\n  // Get solar panel data\n  const solarPanelQty = parseInt(formData.solar_panel_quantity) || 0;\n  const solarPanelQty2 = parseInt(formData.solar_panel_type2_quantity) || 0;\n  const totalPanelQty = solarPanelQty + solarPanelQty2;\n  const isBatteryOnly = formData.batteryonly === true;\n\n  // Determine inverter type\n  const inverterType = formData.inverter_type || 'string'; // Default to string\n  const isMicroinverter = inverterType === 'microinverter';\n\n  // Get inverter electrical specs\n  const inverterMaxContOutput = parseFloat(formData.inverter_max_cont_output_amps) || 0;\n  const inverterMaxVdc = parseFloat(formData.inverter_max_vdc) || 0;\n  const inverterMinVdc = parseFloat(formData.inverter_min_vdc) || 0;\n  const inverterMaxIsc = parseFloat(formData.inverter_max_input_isc) || 0;\n  const maxStringsBranches = parseInt(formData.inverter_max_strings_branches) || 0;\n\n  // Get solar panel electrical specs\n  const panelVoc = parseFloat(formData.solar_panel_voc) || 0;\n  const panelIsc = parseFloat(formData.solar_panel_isc) || 0;\n\n  // Determine if stringing should be shown\n  // Only show stringing in InverterMicroSection for STRING INVERTERS\n  // Microinverter stringing is now in StringCombinerPanelSection\n  const shouldShowStringing = !!(\n    hasInverter &&\n    totalPanelQty > 0 &&\n    !isBatteryOnly &&\n    !isMicroinverter\n  );\n\n  // Max branches/strings for string inverters only\n  const maxBranches = maxStringsBranches || 10;\n\n  // Calculate max panels per string (for string inverters only)\n  const maxPanelsPerBranch = useMemo(() => {\n    // String inverters: calculate from voltage limits\n    if (panelVoc > 0 && inverterMaxVdc > 0) {\n      return Math.floor(inverterMaxVdc / panelVoc);\n    }\n    return 20; // Default fallback\n  }, [panelVoc, inverterMaxVdc]);\n\n  // Calculate total panels assigned across all strings (for string inverters only)\n  const totalPanelsAssigned = useMemo(() => {\n    let total = 0;\n    // String inverters use branch_string_X (strings qty) Ã— branch_panels_per_string_X\n    for (let i = 1; i <= 10; i++) {\n      const stringsQty = parseInt(formData[`branch_string_${i}`]) || 0;\n      const panelsPerString = parseInt(formData[`branch_panels_per_string_${i}`]) || 0;\n      total += stringsQty * panelsPerString;\n    }\n    return total;\n  }, [formData]);\n\n  const panelsRemaining = totalPanelQty - totalPanelsAssigned;\n\n  // Stringing event handlers (for string inverters only)\n  const handleStringingTypeChange = (type) => {\n    onChange('stringing_type', type);\n\n    // Clear all string data when switching to auto\n    if (type === 'auto') {\n      for (let i = 1; i <= 10; i++) {\n        onChange(`branch_string_${i}`, '');\n        onChange(`branch_panels_per_string_${i}`, '');\n      }\n    }\n  };\n\n  const handleBranchStringChange = (index, value) => {\n    // Only allow numbers\n    const numericValue = value.replace(/[^0-9]/g, '');\n    onChange(`branch_string_${index}`, numericValue);\n  };\n\n  const handlePanelsPerStringChange = (index, value) => {\n    // Only allow numbers (for string inverters)\n    const numericValue = value.replace(/[^0-9]/g, '');\n    onChange(`branch_panels_per_string_${index}`, numericValue);\n  };\n\n  // Auto-calculate function (for string inverters only)\n  const handleAutoCalculate = () => {\n    if (totalPanelQty <= 0) return;\n\n    // String inverters auto-distribution\n    const distribution = calculateInverterInputDistribution({\n      totalPanels: totalPanelQty,\n      maxInputs: maxBranches,\n      maxPanelsPerString: maxPanelsPerBranch,\n      panelVoc,\n      panelIsc,\n      inverterMaxVdc,\n      inverterMinVdc,\n      inverterMaxIsc,\n    });\n\n    if (!distribution || !distribution.strings) return;\n\n    // Clear all strings first\n    for (let i = 1; i <= 10; i++) {\n      onChange(`branch_string_${i}`, '');\n      onChange(`branch_panels_per_string_${i}`, '');\n    }\n\n    // Populate with calculated values\n    distribution.strings.forEach((string, idx) => {\n      const i = idx + 1;\n      onChange(`branch_string_${i}`, String(string.numStrings || 0));\n      onChange(`branch_panels_per_string_${i}`, String(string.panelsPerString || 0));\n    });\n  };\n\n  // Preferred equipment handlers\n  const handlePreferredSelect = (selected) => {\n    onChange('inverter_make', selected.make);\n    onChange('inverter_model', selected.model);\n  };\n\n  const handleSelectOther = () => {\n    // Clear selection to force user to choose from dropdowns\n    onChange('inverter_make', '');\n    onChange('inverter_model', '');\n  };\n\n  const handleOptimizerPreferredSelect = (selected) => {\n    handleOptimizerFieldChange('optimizer_make', selected.make);\n    handleOptimizerFieldChange('optimizer_model', selected.model);\n  };\n\n  const handleOptimizerSelectOther = () => {\n    // Clear selection to force user to choose from dropdowns\n    onChange('optimizer_make', '');\n    onChange('optimizer_model', '');\n  };\n\n  // Dynamic title based on inverter type\n  const getSectionTitle = () => {\n    if (!hasInverter) return 'Micro/Inverter';\n    return isMicroinverter ? 'Microinverter' : 'Inverter';\n  };\n\n  return (\n    <div className={componentStyles.sectionWrapper}>\n      <EquipmentRow\n        title={getSectionTitle()}\n        subtitle={hasInverter ? `${formData.inverter_make} ${formData.inverter_model}` : ''}\n        showNewExistingToggle={true}\n        isNew={formData.inverter_isnew !== false}\n        onNewExistingChange={(isNew) => onChange('inverter_isnew', isNew)}\n        onDelete={handleTrashClick}\n        headerRightContent={\n          <PreferredButton onClick={() => setShowPreferredModal(true)} />\n        }\n      >\n        {/* Make dropdown */}\n        <TableDropdown\n          label=\"Make\"\n          value={formData.inverter_make || ''}\n          onChange={handleManufacturerChange}\n          options={manufacturers.map(m => ({ value: m, label: m }))}\n          placeholder={loadingMakes ? 'Loading...' : 'Select make'}\n          disabled={loadingMakes}\n        />\n\n        {/* Model dropdown */}\n        <TableDropdown\n          label=\"Model\"\n          value={formData.inverter_model || ''}\n          onChange={handleModelChange}\n          options={models.map(m => ({ value: m.model_number, label: m.model_number }))}\n          placeholder={\n            loadingModels ? 'Loading...' :\n            formData.inverter_make ? 'Select model' :\n            'Select make first'\n          }\n          disabled={!formData.inverter_make || loadingModels}\n        />\n\n        {/* Breaker Size - Only for Hoymiles/Hoymiles Power/APSystems */}\n        {(formData.inverter_make === 'Hoymiles' || formData.inverter_make === 'Hoymiles Power' || formData.inverter_make === 'APSystems') && (\n          <TableDropdown\n            label=\"Breaker Size\"\n            value={formData.sys1_ap_hoy_breaker_size || ''}\n            onChange={(value) => onChange('sys1_ap_hoy_breaker_size', value)}\n            options={[\n              { label: '20', value: '20' },\n              { label: '30', value: '30' },\n            ]}\n            placeholder=\"Select breaker size...\"\n          />\n        )}\n\n        {/* STRINGING SECTION */}\n        {shouldShowStringing && (\n          <>\n            {/* Auto/Custom Toggle */}\n            <FormFieldRow label=\"Stringing Mode\">\n              <TableRowButton\n                label=\"Auto\"\n                variant=\"outline\"\n                active={stringingType === 'auto'}\n                onClick={() => handleStringingTypeChange('auto')}\n              />\n              <TableRowButton\n                label=\"Custom\"\n                variant=\"outline\"\n                active={stringingType === 'custom'}\n                onClick={() => handleStringingTypeChange('custom')}\n              />\n            </FormFieldRow>\n\n            {/* Auto Stringing Info */}\n            {stringingType === 'auto' && (\n              <div className={componentStyles.autoStringingInfo}>\n                <Alert variant=\"info\" collapsible={false}>\n                  Stringing will auto size to distribute total quantity in Solar Panel 1\n                  {solarPanelQty2 > 0 && ' and Type 2'} and to stay within manufacturer stringing requirements and limits.\n                </Alert>\n              </div>\n            )}\n\n            {/* Custom Stringing Interface */}\n            {stringingType === 'custom' && (\n              <div className={componentStyles.customStringingSection}>\n                {/* Panels Remaining Counter */}\n                <div className={componentStyles.panelsRemainingCounter}>\n                  <span className={componentStyles.panelsRemainingText}>\n                    Solar Panels Remaining:{' '}\n                    <span className={`${componentStyles.panelsRemainingValue} ${\n                      panelsRemaining === 0 ? componentStyles.panelsRemainingComplete :\n                      panelsRemaining < 0 ? componentStyles.panelsRemainingError :\n                      componentStyles.panelsRemainingWarning\n                    }`}>\n                      {panelsRemaining}\n                    </span>\n                  </span>\n                </div>\n\n                {/* Auto-Calculate Button */}\n                {totalPanelQty > 0 && (\n                  <Button\n                    variant=\"outline\"\n                    size=\"md\"\n                    onClick={handleAutoCalculate}\n                    className={componentStyles.autoCalculateButton}\n                  >\n                    Auto-Calculate Distribution\n                  </Button>\n                )}\n\n                {/* String Inverter Input Rows */}\n                <div className={componentStyles.stringInputContainer}>\n                  {Array.from({ length: maxBranches }, (_, i) => {\n                    const index = i + 1;\n                    const stringsValue = formData[`branch_string_${index}`] || '';\n                    const panelsPerStringValue = formData[`branch_panels_per_string_${index}`] || '';\n\n                    // Only show row if it has values or if it's one of the first few rows\n                    const shouldShowRow = stringsValue || panelsPerStringValue || index <= 3;\n\n                    if (!shouldShowRow) return null;\n\n                    return (\n                      <div key={index} className={componentStyles.stringInputRow}>\n                        <span className={componentStyles.mpptLabel}>\n                          MPPT {index}\n                        </span>\n                        <input\n                          type=\"text\"\n                          value={stringsValue}\n                          onChange={(e) => handleBranchStringChange(index, e.target.value)}\n                          onFocus={() => setActiveStringInput(`strings_${index}`)}\n                          onBlur={() => setActiveStringInput(null)}\n                          placeholder=\"Strings\"\n                          className={componentStyles.stringInput}\n                        />\n                        <span className={componentStyles.multiplySymbol}>Ã—</span>\n                        <input\n                          type=\"text\"\n                          value={panelsPerStringValue}\n                          onChange={(e) => handlePanelsPerStringChange(index, e.target.value)}\n                          onFocus={() => setActiveStringInput(`panels_${index}`)}\n                          onBlur={() => setActiveStringInput(null)}\n                          placeholder=\"Panels/String\"\n                          className={componentStyles.panelsPerStringInput}\n                        />\n                      </div>\n                    );\n                  })}\n                </div>\n              </div>\n            )}\n          </>\n        )}\n      </EquipmentRow>\n\n      {/* PowerWall 3 kW Selector - Only shown for PowerWall 3 */}\n      {isPW3 && (\n        <div className={styles.formGroup}>\n          <label className={styles.label}>PowerWall 3 kW Rating*</label>\n          <select\n            value={currentPW3KW || ''}\n            onChange={(e) => {\n              const newKW = e.target.value;\n              const updatedModel = updatePowerWall3ModelWithKW(formData.inverter_model, newKW);\n              onChange('inverter_model', updatedModel);\n            }}\n            className={`${styles.select} ${currentPW3KW ? componentStyles.pw3SelectFilled : componentStyles.pw3SelectEmpty}`}\n          >\n            <option value=\"\">Select kW rating...</option>\n            {POWERWALL_3_KILOWATT_OPTIONS.map((option) => (\n              <option key={option.value} value={option.value}>\n                {option.label} kW\n              </option>\n            ))}\n          </select>\n        </div>\n      )}\n\n      {/* Optimizer Section - Only show for SolarEdge, SOL-ARK, TIGO */}\n      {showOptimizers && (\n        <div className={componentStyles.optimizerSection}>\n          <EquipmentRow\n            title=\"Optimizer\"\n            subtitle={formData.optimizer_make && formData.optimizer_model ? `${formData.optimizer_make} ${formData.optimizer_model}` : ''}\n            showNewExistingToggle={true}\n            isNew={formData.optimizer_isnew !== false}\n            onNewExistingChange={(isNew) => onChange('optimizer_isnew', isNew)}\n            onDelete={(e) => {\n              // Stop propagation\n              if (e && e.stopPropagation) e.stopPropagation();\n              // Clear optimizer fields inline (optimizer is a sub-section, doesn't need full modal flow)\n              onChange('optimizer_make', '');\n              onChange('optimizer_model', '');\n              onChange('optimizer_isnew', true);\n            }}\n            headerRightContent={\n              <PreferredButton onClick={() => setShowOptimizerPreferredModal(true)} />\n            }\n          >\n            {/* Make dropdown */}\n            <TableDropdown\n              label=\"Make\"\n              value={formData.optimizer_make || ''}\n              onChange={(value) => {\n                handleOptimizerFieldChange('optimizer_make', value);\n                onChange('optimizer_model', ''); // Clear model when manufacturer changes\n              }}\n              options={optimizerManufacturers.map(m => ({ value: m, label: m }))}\n              placeholder={loadingOptimizerMakes ? 'Loading...' : 'Select make'}\n              disabled={loadingOptimizerMakes}\n            />\n\n            {/* Model dropdown */}\n            <TableDropdown\n              label=\"Model\"\n              value={formData.optimizer_model || ''}\n              onChange={(value) => handleOptimizerFieldChange('optimizer_model', value)}\n              options={optimizerModels\n                .filter(m => m.model || m.model_number) // Optimizers use 'model', inverters use 'model_number'\n                .map(m => ({\n                  value: m.model || m.model_number,\n                  label: m.model || m.model_number\n                }))\n              }\n              placeholder={\n                loadingOptimizerModels ? 'Loading...' :\n                formData.optimizer_make ? 'Select model' :\n                'Select make first'\n              }\n              disabled={!formData.optimizer_make || loadingOptimizerModels}\n            />\n          </EquipmentRow>\n\n          {/* BOS Equipment after Optimizer */}\n          {formData.optimizer_make && formData.optimizer_model && (\n            <>\n              {console.log('[InverterMicroSection] Rendering BOS after Optimizer - formData.utility:', formData.utility)}\n              {console.log('[InverterMicroSection] Rendering BOS after Optimizer - formData.site?.utility:', formData.site?.utility)}\n              <BOSEquipmentSection\n                formData={formData}\n                onChange={onChange}\n                section=\"utility\"\n                systemNumber={1}\n              />\n            </>\n          )}\n        </div>\n      )}\n\n      {/* BOS Equipment for String Inverters - Show when inverter selected and optimizer not yet configured */}\n      {formData.inverter_type !== 'microinverter' &&\n       formData.inverter_make &&\n       formData.inverter_model &&\n       (!showOptimizers || (!formData.optimizer_make || !formData.optimizer_model)) && (\n        <>\n          {console.log('[InverterMicroSection] Rendering BOS after Inverter - formData.utility:', formData.utility)}\n          {console.log('[InverterMicroSection] Rendering BOS after Inverter - formData.site?.utility:', formData.site?.utility)}\n          <BOSEquipmentSection\n            formData={formData}\n            onChange={onChange}\n            section=\"utility\"\n            systemNumber={1}\n          />\n        </>\n      )}\n\n      {/* Section Clear Modal */}\n      <SectionClearModal\n        isOpen={showClearModal}\n        onClose={closeClearModal}\n        onConfirm={handleClearConfirm}\n        sectionName={formData.inverter_type === 'microinverter' ? 'Microinverter' : 'Inverter'}\n      />\n\n      {/* Section Remove Modal - Not used for CLEAR_ONLY behavior, but included for completeness */}\n      <SectionRemoveModal\n        isOpen={showRemoveModal}\n        onClose={closeRemoveModal}\n        onConfirm={handleRemoveConfirm}\n        sectionName={formData.inverter_type === 'microinverter' ? 'Microinverter' : 'Inverter'}\n      />\n\n      {/* Preferred Equipment Modal */}\n      <PreferredEquipmentModal\n        isOpen={showPreferredModal}\n        onClose={() => setShowPreferredModal(false)}\n        onSelect={handlePreferredSelect}\n        onSelectOther={handleSelectOther}\n        equipmentType=\"inverters\"\n        title=\"Select Inverter\"\n      />\n\n      {/* Optimizer Preferred Equipment Modal */}\n      <PreferredEquipmentModal\n        isOpen={showOptimizerPreferredModal}\n        onClose={() => setShowOptimizerPreferredModal(false)}\n        onSelect={handleOptimizerPreferredSelect}\n        onSelectOther={handleOptimizerSelectOther}\n        equipmentType=\"optimizers\"\n        title=\"Select Optimizer\"\n      />\n    </div>\n  );\n};\n\nexport default InverterMicroSection;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\InverterStringingSection.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'styles' is defined but never used.","line":3,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":14},{"ruleId":"no-unused-vars","severity":1,"message":"'equipStyles' is defined but never used.","line":4,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'formStyles' is defined but never used.","line":5,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":18},{"ruleId":"no-unused-vars","severity":1,"message":"'panelQtyOptions' is assigned a value but never used.","line":67,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":67,"endColumn":24},{"ruleId":"no-unused-vars","severity":1,"message":"'rowMaxPanels' is assigned a value but never used.","line":162,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":162,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useMemo } from 'react';\nimport { Alert, Button, EquipmentRow, FormFieldRow, TableRowButton } from '../../ui';\nimport styles from '../../../styles/ProjectAdd.module.css';\nimport equipStyles from '../EquipmentForm.module.css';\nimport formStyles from '../../../styles/FormSections.module.css';\nimport componentStyles from './InverterStringingSection.module.css';\n\nimport {\n  calculateInverterInputDistribution,\n  calculateStringVoltage,\n  validateStringVoltage,\n  calculateStringCurrent,\n  validateStringCurrent,\n} from '../../../utils/stringingCalculations';\n\n/**\n * String Inverter Stringing Section\n * Handles Auto vs Custom stringing configuration for string inverters\n *\n * String inverters have multiple DC inputs, each with 1-2 strings of panels\n * Uses max_strings_branches from inverter specs to determine max inputs\n */\nconst InverterStringingSection = ({ formData, onChange }) => {\n  // ============================================\n  // FORM DATA & DERIVED STATE\n  // ============================================\n\n  const stringingType = formData.stringing_type || 'auto';\n  const totalPanels = parseInt(formData.solar_panel_quantity) || 0;\n\n  // Get max inputs from inverter specs (max_strings_branches)\n  // This comes from the inverters table when user selects a model\n  const maxInputs = parseInt(formData.inverter_max_strings_branches) || 6;\n\n  // Get panel electrical specs for validation\n  const panelVoc = parseFloat(formData.solar_panel_voc) || 0;\n  const panelIsc = parseFloat(formData.solar_panel_isc) || 0;\n  const panelTempCoeffVoc = parseFloat(formData.solar_panel_temp_coeff_voc) || -0.3;\n\n  // Get inverter electrical specs for validation\n  const inverterMaxVdc = parseFloat(formData.inverter_max_vdc) || 600;\n  const inverterMaxIsc = parseFloat(formData.inverter_max_input_isc) || 15;\n\n  // Calculate max panels per string based on voltage limits\n  const maxPanelsPerString = useMemo(() => {\n    if (panelVoc > 0 && inverterMaxVdc > 0) {\n      // Calculate at coldest temp (-10Â°C by default)\n      const vocCold = panelVoc * (1 + (panelTempCoeffVoc / 100) * (-10 - 25));\n      return Math.floor(inverterMaxVdc / vocCold);\n    }\n    return 15; // Default fallback\n  }, [panelVoc, inverterMaxVdc, panelTempCoeffVoc]);\n\n  // ============================================\n  // STRINGS OPTIONS (1 or 2 per input)\n  // ============================================\n\n  const stringsOptions = [\n    { value: '1', label: '1' },\n    { value: '2', label: '2' },\n  ];\n\n  // ============================================\n  // PANEL QTY OPTIONS\n  // ============================================\n\n  const panelQtyOptions = useMemo(() => {\n    // Max panels depends on strings selected (calculated per-row)\n    // For now, generate options up to max possible (2 strings Ã— maxPanelsPerString)\n    const maxPossible = 2 * maxPanelsPerString;\n    return Array.from({ length: maxPossible }, (_, i) => ({\n      value: String(i + 1),\n      label: String(i + 1)\n    }));\n  }, [maxPanelsPerString]);\n\n  // ============================================\n  // CALCULATE TOTALS\n  // ============================================\n\n  // Calculate total panels assigned (from branch_string_X fields)\n  const totalPanelsAssigned = useMemo(() => {\n    let total = 0;\n    for (let i = 1; i <= maxInputs; i++) {\n      total += parseInt(formData[`branch_string_${i}`]) || 0;\n    }\n    return total;\n  }, [formData, maxInputs]);\n\n  const panelsRemaining = totalPanels - totalPanelsAssigned;\n\n  // ============================================\n  // HANDLERS\n  // ============================================\n\n  const handleStringingTypeChange = (type) => {\n    onChange('stringing_type', type);\n\n    // Clear branch string fields when switching to auto\n    if (type === 'auto') {\n      for (let i = 1; i <= 10; i++) {\n        onChange(`branch_string_${i}`, '');\n      }\n    }\n  };\n\n  const handleStringsChange = (inputIndex, value) => {\n    // Store strings value locally for validation only (not saved to database)\n    onChange(`input_${inputIndex}_strings_local`, value);\n  };\n\n  const handlePanelQtyChange = (inputIndex, value) => {\n    const numericValue = value.replace(/[^0-9]/g, '');\n    // Save to branch_string_X (matches mobile app database)\n    onChange(`branch_string_${inputIndex}`, numericValue);\n  };\n\n  // ============================================\n  // AUTO-CALCULATE DISTRIBUTION\n  // ============================================\n\n  const handleAutoCalculate = () => {\n    // Default to 1 string per input for simplicity\n    // User can adjust strings manually after\n    const stringsPerInput = 1;\n\n    const distribution = calculateInverterInputDistribution(\n      totalPanels,\n      maxInputs,\n      stringsPerInput,\n      maxPanelsPerString\n    );\n\n    if (!distribution) return;\n\n    // Clear all branch strings first\n    for (let i = 1; i <= 10; i++) {\n      onChange(`branch_string_${i}`, '');\n    }\n\n    // Populate with calculated values (save panel qty to branch_string_X)\n    distribution.inputs.forEach((input) => {\n      const i = input.inputIndex;\n      onChange(`branch_string_${i}`, String(input.panelQty));\n    });\n  };\n\n  // ============================================\n  // RENDER INPUT ROW\n  // ============================================\n\n  const renderInputRow = (inputIndex) => {\n    // Panel qty is stored in branch_string_X (matches mobile app database)\n    const panelQtyField = `branch_string_${inputIndex}`;\n    const panelQtyValue = formData[panelQtyField] || '';\n\n    // Strings value is local state only (not saved to database, used for validation)\n    // Default to 1 string if not explicitly set\n    const localStringsField = `input_${inputIndex}_strings_local`;\n    const stringsValue = formData[localStringsField] || '1';\n    const stringsNum = parseInt(stringsValue) || 1;\n    const rowMaxPanels = stringsNum * maxPanelsPerString;\n\n    // Voltage and current validation\n    const panelQtyNum = parseInt(panelQtyValue) || 0;\n    const panelsPerString = panelQtyNum > 0 ? Math.ceil(panelQtyNum / stringsNum) : 0;\n\n    let voltageValidation = null;\n    let currentValidation = null;\n\n    if (panelsPerString > 0 && panelVoc > 0) {\n      const stringVoltage = calculateStringVoltage(panelsPerString, panelVoc, panelTempCoeffVoc);\n      voltageValidation = validateStringVoltage(stringVoltage, inverterMaxVdc);\n    }\n\n    if (stringsNum > 0 && panelIsc > 0) {\n      const stringCurrent = calculateStringCurrent(panelIsc, stringsNum);\n      currentValidation = validateStringCurrent(stringCurrent, inverterMaxIsc);\n    }\n\n    const hasValidationErrors = (voltageValidation && !voltageValidation.isValid) ||\n                                 (currentValidation && !currentValidation.isValid);\n\n    return (\n      <div key={inputIndex}>\n        <div className={componentStyles.inputRow}>\n        {/* Input Label */}\n        <div className={componentStyles.inputLabel}>\n          Input {inputIndex}\n        </div>\n\n        {/* Flexible spacer */}\n        <div className={componentStyles.spacer} />\n\n        {/* Strings Dropdown */}\n        <select\n          value={stringsValue}\n          onChange={(e) => handleStringsChange(inputIndex, e.target.value)}\n          className={`${componentStyles.stringsSelect} ${!stringsValue ? componentStyles.stringsSelectEmpty : ''}`}\n        >\n          <option value=\"\">0</option>\n          {stringsOptions.map(opt => (\n            <option key={opt.value} value={opt.value}>{opt.label}</option>\n          ))}\n        </select>\n\n        {/* Panel Qty Input */}\n        <input\n          type=\"text\"\n          value={panelQtyValue}\n          onChange={(e) => handlePanelQtyChange(inputIndex, e.target.value)}\n          placeholder=\"0\"\n          className={hasValidationErrors ? componentStyles.panelQtyInputError : componentStyles.panelQtyInput}\n        />\n      </div>\n\n      {/* Validation Messages */}\n      {panelQtyNum > 0 && (voltageValidation || currentValidation) && (\n        <div className={componentStyles.validationContainer}>\n          {voltageValidation && (\n            <div className={voltageValidation.isValid ? componentStyles.validationMessage : componentStyles.validationMessageError}>\n              {!voltageValidation.isValid && 'âš ï¸'}\n              {panelsPerString} panels/string Ã— {voltageValidation.stringVoltage}V = {(panelsPerString * voltageValidation.stringVoltage).toFixed(1)}V\n              {' '}({voltageValidation.message})\n            </div>\n          )}\n          {currentValidation && (\n            <div className={currentValidation.isValid ? componentStyles.validationMessage : componentStyles.validationMessageError}>\n              {!currentValidation.isValid && 'âš ï¸'}\n              {stringsNum} string{stringsNum > 1 ? 's' : ''} Ã— {panelIsc}A Ã— 1.25 = {currentValidation.stringCurrent}A\n              {' '}({currentValidation.message})\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n    );\n  };\n\n  // ============================================\n  // RENDER\n  // ============================================\n\n  return (\n    <div className={componentStyles.sectionWrapper}>\n      <EquipmentRow\n        title=\"Stringing\"\n        subtitle={stringingType === 'auto' ? 'Auto' : 'Custom'}\n      >\n        {/* Auto/Custom Toggle */}\n        <FormFieldRow label=\"Mode\">\n          <TableRowButton\n            label=\"Auto\"\n            variant=\"outline\"\n            active={stringingType === 'auto'}\n            onClick={() => handleStringingTypeChange('auto')}\n          />\n          <TableRowButton\n            label=\"Custom\"\n            variant=\"outline\"\n            active={stringingType === 'custom'}\n            onClick={() => handleStringingTypeChange('custom')}\n          />\n        </FormFieldRow>\n\n        {/* Auto Stringing Note */}\n        {stringingType === 'auto' && (\n          <div className={componentStyles.autoNotePadding}>\n            <Alert variant=\"info\">\n              Stringing will auto-size to distribute panels across available inverter inputs\n              while staying within voltage and current limits.\n            </Alert>\n          </div>\n        )}\n\n        {/* Custom Stringing Interface */}\n        {stringingType === 'custom' && (\n          <div className={componentStyles.customSection}>\n            {/* Specs Info */}\n            <Alert variant=\"info\" className={componentStyles.infoAlert}>\n              {maxInputs} DC Inputs available â€¢ Max {maxPanelsPerString} panels/string â€¢ 1-2 strings/input\n            </Alert>\n\n            {/* Auto-Calculate Button */}\n            {totalPanels > 0 && (\n              <Button\n                variant=\"outline\"\n                size=\"md\"\n                onClick={handleAutoCalculate}\n                className={componentStyles.autoCalcButton}\n              >\n                Auto-Calculate Distribution\n              </Button>\n            )}\n\n            {/* Header Row */}\n            <div className={componentStyles.headerRow}>\n              {/* Left side: Solar Panels Remaining */}\n              <div className={componentStyles.headerFlex}>\n                <span className={componentStyles.headerText}>\n                  Solar Panels Remaining:{' '}\n                  <span className={`${componentStyles.panelsRemaining} ${\n                    panelsRemaining === 0 ? componentStyles.panelsRemainingComplete :\n                    panelsRemaining < 0 ? componentStyles.panelsRemainingError :\n                    componentStyles.panelsRemainingWarning\n                  }`}>\n                    {panelsRemaining}\n                  </span>\n                </span>\n              </div>\n\n              {/* Column headers */}\n              <div className={componentStyles.columnHeader}>\n                Strings\n              </div>\n              <div className={componentStyles.columnHeaderWide}>\n                Panel Qty\n              </div>\n            </div>\n\n            {/* Input Rows */}\n            <div className={componentStyles.inputRowsContainer}>\n              {Array.from({ length: maxInputs }, (_, i) => renderInputRow(i + 1))}\n            </div>\n          </div>\n        )}\n      </EquipmentRow>\n    </div>\n  );\n};\n\nexport default InverterStringingSection;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\LandingOptionButton.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\MicroinverterStringingSection.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'projectStyles' is defined but never used.","line":4,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":21},{"ruleId":"no-unused-vars","severity":1,"message":"'equipStyles' is defined but never used.","line":5,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'formStyles' is defined but never used.","line":6,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":18},{"ruleId":"no-unused-vars","severity":1,"message":"'isDualQtyManufacturer' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":24},{"ruleId":"no-unused-vars","severity":1,"message":"'maxMicrosPerBranch' is assigned a value but never used.","line":77,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":77,"endColumn":27},{"ruleId":"no-unused-vars","severity":1,"message":"'panelRatio' is assigned a value but never used.","line":80,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":80,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useMemo } from 'react';\nimport { Alert, Button, EquipmentRow, FormFieldRow, TableRowButton } from '../../ui';\nimport StringingGrid from './StringingGrid';\nimport projectStyles from '../../../styles/ProjectAdd.module.css';\nimport equipStyles from '../EquipmentForm.module.css';\nimport formStyles from '../../../styles/FormSections.module.css';\nimport styles from './MicroinverterStringingSection.module.css';\nimport {\n  getStringingSpecs,\n  getMaxBranches as getMaxBranchesUtil,\n  isDualQtyManufacturer,\n} from '../../../utils/stringingConstants';\nimport {\n  calculateMaxPanelsPerBranch,\n  distributeStandardMicros,\n  calculateDualQtyDistribution,\n  getStringingMode,\n} from '../../../utils/stringingCalculations';\n\n/**\n * Microinverter Stringing Section\n * Handles Auto vs Custom stringing configuration for microinverters with combiner panels\n */\nconst MicroinverterStringingSection = ({ formData, onChange }) => {\n  const [activeStringInput, setActiveStringInput] = useState(null);\n\n  // ============================================\n  // DERIVED STATE FROM FORM DATA\n  // ============================================\n\n  // Get stringing type (default to 'auto')\n  const stringingType = formData.stringing_type || 'auto';\n\n  // Get combiner panel data\n  const combinerPanelMake = formData.combiner_panel_make || '';\n  const combinerPanelModel = formData.combiner_panel_model || '';\n  const hasCombinerPanel = combinerPanelMake && combinerPanelModel;\n\n  // Get inverter data\n  const inverterMake = formData.inverter_make || '';\n  const inverterModel = formData.inverter_model || '';\n  const inverterMaxContOutput = parseFloat(formData.inverter_max_cont_output_amps) || 0;\n\n  // Get solar panel quantity\n  const solarPanelQty = parseInt(formData.solar_panel_quantity) || 0;\n\n  // ============================================\n  // STRINGING MODE DETECTION\n  // ============================================\n\n  // Determine stringing mode: 'standard' (Enphase), 'dual-qty' (Hoymiles/APSystems)\n  const stringingMode = getStringingMode('microinverter', inverterMake);\n  const isDualQtyMode = stringingMode === 'dual-qty';\n\n  // Get specs for dual-qty manufacturers\n  const specs = useMemo(() => {\n    return isDualQtyMode ? getStringingSpecs(inverterMake, inverterModel) : null;\n  }, [isDualQtyMode, inverterMake, inverterModel]);\n\n  // ============================================\n  // BRANCH & PANEL LIMITS\n  // ============================================\n\n  // Use utility function for max branches\n  const maxBranches = getMaxBranchesUtil(combinerPanelMake, combinerPanelModel);\n\n  // Calculate max panels per branch based on mode\n  const maxPanelsPerBranch = useMemo(() => {\n    if (isDualQtyMode && specs) {\n      return specs.maxPanelsBranch;\n    }\n    // Standard mode: calculate from max continuous output amps\n    return calculateMaxPanelsPerBranch(inverterMaxContOutput);\n  }, [isDualQtyMode, specs, inverterMaxContOutput]);\n\n  // For dual-qty mode, also get max micros per branch\n  const maxMicrosPerBranch = isDualQtyMode && specs ? specs.maxUnitsBranch : null;\n\n  // Panel ratio for dual-qty mode\n  const panelRatio = specs ? parseInt(specs.panelRatio.split(':')[0], 10) : 1;\n\n  // ============================================\n  // COLUMN LABELS\n  // ============================================\n\n  // Column labels based on mode\n  const columnLabels = isDualQtyMode\n    ? { col1: 'Branch', col3: 'Panel Qty', col4: 'Micro Qty' }\n    : { col1: 'Branch', col4: 'Panel Qty' };\n\n  // ============================================\n  // CALCULATE TOTALS\n  // ============================================\n\n  // Calculate total panels assigned across all branches\n  const totalPanelsAssigned = useMemo(() => {\n    let total = 0;\n    for (let i = 1; i <= 10; i++) {\n      const panelQty = parseInt(formData[`branch_string_${i}`]) || 0;\n      total += panelQty;\n    }\n    return total;\n  }, [formData]);\n\n  const panelsRemaining = solarPanelQty - totalPanelsAssigned;\n\n  // ============================================\n  // EVENT HANDLERS\n  // ============================================\n\n  const handleStringingTypeChange = (type) => {\n    onChange('stringing_type', type);\n\n    // Clear all branch data when switching to auto\n    if (type === 'auto') {\n      for (let i = 1; i <= 10; i++) {\n        onChange(`branch_string_${i}`, '');\n      }\n    }\n  };\n\n  const handleBranchStringChange = (index, value) => {\n    // Only allow numbers\n    const numericValue = value.replace(/[^0-9]/g, '');\n    onChange(`branch_string_${index}`, numericValue);\n  };\n\n  // ============================================\n  // AUTO-CALCULATE FUNCTION\n  // ============================================\n\n  const handleAutoCalculate = () => {\n    if (solarPanelQty <= 0) return;\n\n    let distribution;\n\n    if (isDualQtyMode && specs) {\n      // Hoymiles/APSystems auto-distribution\n      distribution = calculateDualQtyDistribution(solarPanelQty, specs, maxBranches);\n    } else {\n      // Standard (Enphase) auto-distribution\n      distribution = distributeStandardMicros(solarPanelQty, maxPanelsPerBranch, maxBranches);\n    }\n\n    if (!distribution || !distribution.branches) return;\n\n    // Clear all branches first\n    for (let i = 1; i <= 10; i++) {\n      onChange(`branch_string_${i}`, '');\n    }\n\n    // Populate with calculated values\n    distribution.branches.forEach((branch) => {\n      const i = branch.branchIndex;\n      const panelQtyStr = String(branch.panelQty || 0);\n      onChange(`branch_string_${i}`, panelQtyStr);\n    });\n  };\n\n  // Prepare rows data for StringingGrid component\n  const prepareGridRows = () => {\n    return Array.from({ length: maxBranches }, (_, i) => {\n      const index = i + 1;\n      const fieldName = `branch_string_${index}`;\n      const value = formData[fieldName] || '';\n      const displayValue = value === '' || value === '0' ? '' : value;\n\n      return {\n        id: index,\n        index,\n        displayValue,\n        panelQtyValue: isDualQtyMode ? displayValue : undefined,\n        isNew: true, // No longer tracking per-branch new/existing\n      };\n    });\n  };\n\n  return (\n    <div className={styles.sectionWrapper}>\n      <EquipmentRow\n        title=\"Stringing\"\n        subtitle={stringingType === 'auto' ? 'Auto' : 'Custom'}\n      >\n        {/* Auto/Custom Toggle */}\n        <FormFieldRow label=\"Mode\">\n          <TableRowButton\n            label=\"Auto\"\n            variant=\"outline\"\n            active={stringingType === 'auto'}\n            onClick={() => handleStringingTypeChange('auto')}\n          />\n          <TableRowButton\n            label=\"Custom\"\n            variant=\"outline\"\n            active={stringingType === 'custom'}\n            onClick={() => handleStringingTypeChange('custom')}\n          />\n        </FormFieldRow>\n\n        {/* Auto Stringing Note */}\n        {stringingType === 'auto' && (\n          <div className={styles.autoAlertContainer}>\n            <Alert variant=\"info\">\n              Stringing will auto size to distribute total Quantity in Solar Panel 1\n              and to stay within Manufacturer stringing requirements and limits.\n              <br /><br />\n              Must choose Combiner Panel to custom string branches.\n            </Alert>\n          </div>\n        )}\n\n        {/* Custom Stringing Interface */}\n        {stringingType === 'custom' && (\n          <div className={styles.customContainer}>\n            {/* Check if combiner panel is selected */}\n            {!hasCombinerPanel ? (\n              <Alert variant=\"warning\">\n                Please select a combiner panel make and model first to configure custom stringing.\n              </Alert>\n            ) : (\n              <>\n                {/* Specs Info Display */}\n                {isDualQtyMode && specs && (\n                  <Alert variant=\"info\" className={styles.specsInfoAlert}>\n                    <strong>{inverterModel}</strong>: {specs.panelRatio} ratio â€¢\n                    Max {specs.maxUnitsBranch} micros/branch â€¢\n                    Max {specs.maxPanelsBranch} panels/branch\n                  </Alert>\n                )}\n\n                {/* Auto-Calculate Button */}\n                {solarPanelQty > 0 && (\n                  <Button\n                    variant=\"outline\"\n                    size=\"md\"\n                    onClick={handleAutoCalculate}\n                    className={styles.autoCalculateButton}\n                  >\n                    Auto-Calculate Distribution\n                  </Button>\n                )}\n\n                {/* Stringing Grid */}\n                <StringingGrid\n                  rows={prepareGridRows()}\n                  panelsRemaining={panelsRemaining}\n                  columnLabels={columnLabels}\n                  mode={isDualQtyMode ? 'dual-qty' : 'standard'}\n                  maxPanelsPerBranch={maxPanelsPerBranch}\n                  onToggle={undefined}\n                  onChange={handleBranchStringChange}\n                  onPanelQtyChange={undefined}\n                  onFocus={setActiveStringInput}\n                  onBlur={() => setActiveStringInput(null)}\n                  activeInput={activeStringInput}\n                />\n              </>\n            )}\n          </div>\n        )}\n      </EquipmentRow>\n    </div>\n  );\n};\n\nexport default MicroinverterStringingSection;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\PowerWallConfigurationSection.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\SolarPanel2Section.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'styles' is defined but never used.","line":3,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":14},{"ruleId":"no-unused-vars","severity":1,"message":"'selectedModelData' is assigned a value but never used.","line":21,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":27},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadModels'. Either include it or remove the dependency array.","line":36,"column":6,"nodeType":"ArrayExpression","endLine":36,"endColumn":47,"suggestions":[{"desc":"Update the dependencies array to be: [formData.solar_panel_type2_manufacturer, loadModels]","fix":{"range":[1335,1376],"text":"[formData.solar_panel_type2_manufacturer, loadModels]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { EquipmentRow, FormFieldRow, TableDropdown, Alert, SectionClearModal, SectionRemoveModal } from '../../ui';\nimport styles from '../../../styles/ProjectAdd.module.css';\nimport logger from '../../../services/devLogger';\nimport {\n  getSolarPanelManufacturers,\n  getSolarPanelModels,\n} from '../../../services/equipmentService';\nimport { useSectionDelete, DELETE_BEHAVIOR } from '../../../hooks/useSectionDelete';\n\n/**\n * 2nd Solar Panel Section\n * Handles 2nd solar panel configuration with EquipmentRow display\n * Fields are always editable dropdowns (no edit mode)\n */\nconst SolarPanel2Section = ({ formData, onChange, systemNumber = 1 }) => {\n  const [manufacturers, setManufacturers] = useState([]);\n  const [models, setModels] = useState([]);\n  const [loadingMakes, setLoadingMakes] = useState(false);\n  const [loadingModels, setLoadingModels] = useState(false);\n  const [selectedModelData, setSelectedModelData] = useState(null);\n\n  // Load manufacturers on mount\n  useEffect(() => {\n    loadManufacturers();\n  }, []);\n\n  // Load models when manufacturer changes\n  useEffect(() => {\n    if (formData.solar_panel_type2_manufacturer) {\n      loadModels(formData.solar_panel_type2_manufacturer);\n    } else {\n      setModels([]);\n      setSelectedModelData(null);\n    }\n  }, [formData.solar_panel_type2_manufacturer]);\n\n  const loadManufacturers = async () => {\n    setLoadingMakes(true);\n    try {\n      const response = await getSolarPanelManufacturers();\n      setManufacturers(response.data || []);\n    } catch (error) {\n      logger.error('Equipment', 'Failed to load solar panel manufacturers:', error);\n    } finally {\n      setLoadingMakes(false);\n    }\n  };\n\n  const loadModels = async (manufacturer) => {\n    setLoadingModels(true);\n    try {\n      const response = await getSolarPanelModels(manufacturer);\n      const modelsData = response.data || [];\n      setModels(modelsData);\n\n      // If current model is selected, find its data and auto-populate wattage\n      if (formData.solar_panel_type2_model) {\n        const modelData = modelsData.find(m => m.model_number === formData.solar_panel_type2_model);\n        if (modelData) {\n          setSelectedModelData(modelData);\n\n          // Auto-populate wattage from nameplate_pmax if available\n          if (modelData.nameplate_pmax) {\n            onChange('solar_panel_type2_wattage', modelData.nameplate_pmax);\n          }\n\n          // Store model ID for future reference\n          if (modelData.id) {\n            onChange('solar_panel_type2_model_id', modelData.id);\n          }\n        }\n      }\n    } catch (error) {\n      logger.error('Equipment', 'Failed to load solar panel models:', error);\n    } finally {\n      setLoadingModels(false);\n    }\n  };\n\n  // Wrapper to save toggle defaults when any field changes\n  const handleFieldChange = (fieldName, value) => {\n    onChange(fieldName, value);\n    // Also save New/Existing toggle default if not already set\n    if (formData.solar_panel_type2_is_new === undefined) {\n      onChange('solar_panel_type2_is_new', true);\n    }\n  };\n\n  const handleManufacturerChange = (value) => {\n    handleFieldChange('solar_panel_type2_manufacturer', value);\n    onChange('solar_panel_type2_model', ''); // Clear model when manufacturer changes\n    onChange('solar_panel_type2_wattage', ''); // Clear wattage\n    setSelectedModelData(null);\n  };\n\n  const handleModelChange = (value) => {\n    handleFieldChange('solar_panel_type2_model', value);\n\n    // Find model data and auto-populate wattage and electrical specs\n    const modelData = models.find(m => m.model_number === value);\n    if (modelData) {\n      setSelectedModelData(modelData);\n\n      // Auto-populate wattage from nameplate_pmax\n      if (modelData.nameplate_pmax) {\n        onChange('solar_panel_type2_wattage', modelData.nameplate_pmax);\n      }\n\n      // Store model ID for future reference\n      if (modelData.id) {\n        onChange('solar_panel_type2_model_id', modelData.id);\n      }\n\n      // Store electrical specs for stringing calculations\n      const voc = modelData.voc || modelData.open_circuit_voltage || '';\n      const isc = modelData.isc || modelData.short_circuit_current || '';\n      const vmp = modelData.vmp || modelData.voltage_max_power || '';\n      const imp = modelData.imp || modelData.current_max_power || '';\n      const tempCoeff = modelData.temp_coeff_voc || modelData.temperature_coefficient_voc || '';\n\n      onChange('solar_panel_type2_voc', voc);\n      onChange('solar_panel_type2_isc', isc);\n      onChange('solar_panel_type2_vmp', vmp);\n      onChange('solar_panel_type2_imp', imp);\n\n      // Temperature coefficient (if available)\n      if (tempCoeff) {\n        onChange('solar_panel_type2_temp_coeff_voc', tempCoeff);\n      }\n    }\n  };\n\n  // Use the section delete hook with CLEAR_AND_REMOVE behavior\n  const {\n    showClearModal,\n    showRemoveModal,\n    handleTrashClick,\n    handleClearConfirm,\n    handleRemoveConfirm,\n    closeClearModal,\n    closeRemoveModal,\n  } = useSectionDelete({\n    sectionName: 'solarPanel2',\n    formData,\n    onChange,\n    behavior: DELETE_BEHAVIOR.CLEAR_AND_REMOVE,\n    visibilityFlag: 'show_solar_panel_2',\n  });\n\n  // Legacy handleDelete removed - now using useSectionDelete hook\n\n  // Check if we have a 2nd solar panel configured\n  const hasSolarPanel2 = formData.solar_panel_type2_manufacturer && formData.solar_panel_type2_model;\n\n  return (\n    <div style={{ marginBottom: 'var(--spacing)' }}>\n      <EquipmentRow\n        title={`Solar Panel ${systemNumber} - Type 2`}\n        subtitle={hasSolarPanel2 ? `${formData.solar_panel_type2_manufacturer} ${formData.solar_panel_type2_model}` : ''}\n        showNewExistingToggle={true}\n        isNew={formData.solar_panel_type2_is_new !== false}\n        onNewExistingChange={(isNew) => onChange('solar_panel_type2_is_new', isNew)}\n        onEdit={() => console.log('Edit 2nd solar panel')}\n        onCamera={() => console.log('Camera for 2nd solar panel')}\n        onDelete={handleTrashClick}\n      >\n        {/* Orange-bordered note */}\n        <Alert variant=\"warning\" collapsible={false}>\n          Note: Solar Panel Type 2 must use the same inverter and combiner panel as Type 1.\n        </Alert>\n\n        {/* Quantity field */}\n        <FormFieldRow label=\"Quantity\">\n          <input\n            type=\"text\"\n            value={formData.solar_panel_type2_quantity || ''}\n            onChange={(e) => handleFieldChange('solar_panel_type2_quantity', e.target.value)}\n            onKeyDown={(e) => {\n              if (e.key === 'Enter') {\n                e.preventDefault();\n              }\n            }}\n            placeholder=\"Enter quantity\"\n          />\n        </FormFieldRow>\n\n        {/* Make dropdown */}\n        <TableDropdown\n          label=\"Make\"\n          value={formData.solar_panel_type2_manufacturer || ''}\n          onChange={handleManufacturerChange}\n          options={manufacturers.map(m => ({ value: m, label: m }))}\n          placeholder={loadingMakes ? 'Loading...' : 'Select make'}\n          disabled={loadingMakes}\n        />\n\n        {/* Model dropdown */}\n        <TableDropdown\n          label=\"Model\"\n          value={formData.solar_panel_type2_model || ''}\n          onChange={handleModelChange}\n          options={models.map(m => ({ value: m.model_number, label: m.model_number }))}\n          placeholder={\n            loadingModels ? 'Loading...' :\n            formData.solar_panel_type2_manufacturer ? 'Select model' :\n            'Select make first'\n          }\n          disabled={!formData.solar_panel_type2_manufacturer || loadingModels}\n        />\n\n      </EquipmentRow>\n\n      {/* Section Clear Modal */}\n      <SectionClearModal\n        isOpen={showClearModal}\n        onClose={closeClearModal}\n        onConfirm={handleClearConfirm}\n        sectionName={`Solar Panel ${systemNumber} - Type 2`}\n      />\n\n      {/* Section Remove Modal */}\n      <SectionRemoveModal\n        isOpen={showRemoveModal}\n        onClose={closeRemoveModal}\n        onConfirm={handleRemoveConfirm}\n        sectionName={`Solar Panel ${systemNumber} - Type 2`}\n      />\n    </div>\n  );\n};\n\nexport default SolarPanel2Section;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\SolarPanelSection.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'AddButton' is defined but never used.","line":2,"column":69,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":78},{"ruleId":"no-unused-vars","severity":1,"message":"'styles' is defined but never used.","line":4,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":14},{"ruleId":"no-unused-vars","severity":1,"message":"'selectedModelData' is assigned a value but never used.","line":22,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":27},{"ruleId":"no-unused-vars","severity":1,"message":"'useFullCatalog' is assigned a value but never used.","line":27,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":24},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadModels'. Either include it or remove the dependency array.","line":52,"column":6,"nodeType":"ArrayExpression","endLine":52,"endColumn":33,"suggestions":[{"desc":"Update the dependencies array to be: [formData.solar_panel_make, loadModels]","fix":{"range":[2164,2191],"text":"[formData.solar_panel_make, loadModels]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { EquipmentRow, FormFieldRow, TableRowButton, TableDropdown, AddButton, ConfirmDialog, SectionClearModal, SectionRemoveModal, PreferredButton } from '../../ui';\nimport { PreferredEquipmentModal } from '../../equipment';\nimport styles from '../../../styles/ProjectAdd.module.css';\nimport logger from '../../../services/devLogger';\nimport {\n  getSolarPanelManufacturers,\n  getSolarPanelModels,\n} from '../../../services/equipmentService';\nimport { useSectionDelete, DELETE_BEHAVIOR } from '../../../hooks/useSectionDelete';\n\n/**\n * Solar Panel Section\n * Handles solar panel configuration with EquipmentRow display\n * Fields are always editable dropdowns (no edit mode)\n */\nconst SolarPanelSection = ({ formData, onChange, systemNumber = 1 }) => {\n  const [manufacturers, setManufacturers] = useState([]);\n  const [models, setModels] = useState([]);\n  const [loadingMakes, setLoadingMakes] = useState(false);\n  const [loadingModels, setLoadingModels] = useState(false);\n  const [selectedModelData, setSelectedModelData] = useState(null);\n  const [batteryOnlyMode, setBatteryOnlyMode] = useState(formData.batteryonly === true);\n  const [showBatteryOnlyConfirm, setShowBatteryOnlyConfirm] = useState(false);\n  const [showType2Confirm, setShowType2Confirm] = useState(false);\n  const [showPreferredModal, setShowPreferredModal] = useState(false);\n  const [useFullCatalog, setUseFullCatalog] = useState(false);\n\n  // Check if we have a solar panel configured\n  const hasSolarPanel = formData.solar_panel_make && formData.solar_panel_model;\n\n  // Determine title based on Battery Only mode and Type 2 visibility\n  const sectionTitle = batteryOnlyMode\n    ? \"Battery Only\"\n    : (formData.show_solar_panel_2\n        ? `Solar Panel ${systemNumber} - Type 1`\n        : `Solar Panel ${systemNumber}`);\n\n  // Load manufacturers on mount\n  useEffect(() => {\n    loadManufacturers();\n  }, []);\n\n  // Load models when manufacturer changes\n  useEffect(() => {\n    if (formData.solar_panel_make) {\n      loadModels(formData.solar_panel_make);\n    } else {\n      setModels([]);\n      setSelectedModelData(null);\n    }\n  }, [formData.solar_panel_make]);\n\n  const loadManufacturers = async () => {\n    setLoadingMakes(true);\n    try {\n      const response = await getSolarPanelManufacturers();\n      setManufacturers(response.data || []);\n    } catch (error) {\n      logger.error('Equipment', 'Failed to load solar panel manufacturers:', error);\n    } finally {\n      setLoadingMakes(false);\n    }\n  };\n\n  const loadModels = async (manufacturer) => {\n    setLoadingModels(true);\n    try {\n      const response = await getSolarPanelModels(manufacturer);\n      const modelsData = response.data || [];\n      setModels(modelsData);\n\n      // If current model is selected, find its data and auto-populate wattage\n      if (formData.solar_panel_model) {\n        const modelData = modelsData.find(m => m.model_number === formData.solar_panel_model);\n        if (modelData) {\n          setSelectedModelData(modelData);\n\n          // Auto-populate wattage from nameplate_pmax if available\n          if (modelData.nameplate_pmax) {\n            onChange('solar_panel_wattage', modelData.nameplate_pmax);\n          }\n\n          // Store model ID for future reference\n          if (modelData.id) {\n            onChange('solar_panel_model_id', modelData.id);\n          }\n        }\n      }\n    } catch (error) {\n      logger.error('Equipment', 'Failed to load solar panel models:', error);\n    } finally {\n      setLoadingModels(false);\n    }\n  };\n\n  // Wrapper to save toggle defaults when any field changes\n  const handleFieldChange = (fieldName, value) => {\n    onChange(fieldName, value);\n    // Also save New/Existing toggle default if not already set\n    if (formData.solar_panel_isnew === undefined) {\n      onChange('solar_panel_isnew', true);\n    }\n  };\n\n  const handleManufacturerChange = (value) => {\n    handleFieldChange('solar_panel_make', value);\n    onChange('solar_panel_model', ''); // Clear model when manufacturer changes\n    onChange('solar_panel_wattage', ''); // Clear wattage\n    setSelectedModelData(null);\n  };\n\n  const handleModelChange = (value) => {\n    handleFieldChange('solar_panel_model', value);\n\n    // Find model data and auto-populate wattage and electrical specs\n    const modelData = models.find(m => m.model_number === value);\n    if (modelData) {\n      setSelectedModelData(modelData);\n\n      // Auto-populate wattage from nameplate_pmax\n      if (modelData.nameplate_pmax) {\n        onChange('solar_panel_wattage', modelData.nameplate_pmax);\n      }\n\n      // Store model ID for future reference\n      if (modelData.id) {\n        onChange('solar_panel_model_id', modelData.id);\n      }\n\n      // Store electrical specs for stringing calculations\n      const voc = modelData.voc || modelData.open_circuit_voltage || '';\n      const isc = modelData.isc || modelData.short_circuit_current || '';\n      const vmp = modelData.vmp || modelData.voltage_max_power || '';\n      const imp = modelData.imp || modelData.current_max_power || '';\n      const tempCoeff = modelData.temp_coeff_voc || modelData.temperature_coefficient_voc || '';\n\n      onChange('solar_panel_voc', voc);\n      onChange('solar_panel_isc', isc);\n      onChange('solar_panel_vmp', vmp);\n      onChange('solar_panel_imp', imp);\n\n      // Temperature coefficient (if available)\n      if (tempCoeff) {\n        onChange('solar_panel_temp_coeff_voc', tempCoeff);\n      }\n\n    }\n  };\n\n  // Handle preferred equipment selection\n  const handlePreferredSelect = (selected) => {\n    onChange('solar_panel_make', selected.make);\n    onChange('solar_panel_model', selected.model);\n    if (selected.wattage) {\n      onChange('solar_panel_wattage', selected.wattage);\n    }\n    setUseFullCatalog(false);\n  };\n\n  // Handle \"Other\" selection - switch to full catalog mode\n  const handleSelectOther = () => {\n    setUseFullCatalog(true);\n    // Clear current selection to force user to choose from dropdowns\n    onChange('solar_panel_make', '');\n    onChange('solar_panel_model', '');\n  };\n\n  const clearType2Fields = () => {\n    onChange('solar_panel_type2_manufacturer', '');\n    onChange('solar_panel_type2_model', '');\n    onChange('solar_panel_type2_quantity', '');\n    onChange('solar_panel_type2_wattage', '');\n    onChange('solar_panel_type2_is_new', true);\n    onChange('solar_panel_type2_voc', '');\n    onChange('solar_panel_type2_isc', '');\n    onChange('solar_panel_type2_vmp', '');\n    onChange('solar_panel_type2_imp', '');\n    onChange('solar_panel_type2_temp_coeff_voc', '');\n    onChange('solar_panel_type2_model_id', '');\n  };\n\n  const handleBatteryOnlyClick = () => {\n    // Check if ANY solar panel data exists (Type 1 OR Type 2)\n    const hasData = !!(\n      formData.solar_panel_make ||\n      formData.solar_panel_model ||\n      formData.solar_panel_quantity ||\n      formData.solar_panel_type2_manufacturer ||\n      formData.solar_panel_type2_model ||\n      formData.solar_panel_type2_quantity\n    );\n\n    if (hasData) {\n      setShowBatteryOnlyConfirm(true);\n    } else {\n      activateBatteryOnly();\n    }\n  };\n\n  const activateBatteryOnly = () => {\n    setBatteryOnlyMode(true);\n\n    // Set batteryonly flag\n    onChange('batteryonly', true);\n\n    // Clear ALL Type 1 fields (use null)\n    onChange('solar_panel_make', null);\n    onChange('solar_panel_model', null);\n    onChange('solar_panel_model_id', null);\n    onChange('solar_panel_quantity', null);\n    onChange('solar_panel_wattage', null);\n    onChange('solar_panel_isnew', null);\n    onChange('solar_panel_voc', null);\n    onChange('solar_panel_isc', null);\n    onChange('solar_panel_vmp', null);\n    onChange('solar_panel_imp', null);\n    onChange('solar_panel_temp_coeff_voc', null);\n\n    // Hide Type 2 and clear ALL Type 2 fields (use null)\n    onChange('show_solar_panel_2', false);\n    onChange('solar_panel_type2_manufacturer', null);\n    onChange('solar_panel_type2_model', null);\n    onChange('solar_panel_type2_model_id', null);\n    onChange('solar_panel_type2_quantity', null);\n    onChange('solar_panel_type2_wattage', null);\n    onChange('solar_panel_type2_is_new', null);\n    onChange('solar_panel_type2_voc', null);\n    onChange('solar_panel_type2_isc', null);\n    onChange('solar_panel_type2_vmp', null);\n    onChange('solar_panel_type2_imp', null);\n    onChange('solar_panel_type2_temp_coeff_voc', null);\n\n    setShowBatteryOnlyConfirm(false);\n  };\n\n  const deactivateBatteryOnly = () => {\n    setBatteryOnlyMode(false);\n    onChange('batteryonly', false);\n    // Form is now empty and ready for input\n  };\n\n  const handleToggleType2 = () => {\n    if (formData.show_solar_panel_2) {\n      // Hide Type 2 - check if data exists\n      const hasType2Data = formData.solar_panel_type2_manufacturer ||\n                          formData.solar_panel_type2_model ||\n                          formData.solar_panel_type2_quantity;\n\n      if (hasType2Data) {\n        setShowType2Confirm(true);\n      } else {\n        onChange('show_solar_panel_2', false);\n      }\n    } else {\n      // Show Type 2\n      onChange('show_solar_panel_2', true);\n    }\n  };\n\n  const handleConfirmHideType2 = () => {\n    onChange('show_solar_panel_2', false);\n    clearType2Fields();\n    setShowType2Confirm(false);\n  };\n\n  // Use the section delete hook with CLEAR_ONLY behavior (System 1 Solar Panel can never be removed)\n  const {\n    showClearModal,\n    showRemoveModal,\n    handleTrashClick,\n    handleClearConfirm,\n    handleRemoveConfirm,\n    closeClearModal,\n    closeRemoveModal,\n  } = useSectionDelete({\n    sectionName: 'solarPanel',\n    formData,\n    onChange,\n    behavior: DELETE_BEHAVIOR.CLEAR_ONLY,\n    visibilityFlag: null, // No visibility flag - section always visible\n  });\n\n  // Legacy handleDelete removed - now using useSectionDelete hook\n\n  return (\n    <div>\n      <div style={{ marginBottom: 'var(--spacing)' }}>\n        <EquipmentRow\n          title={sectionTitle}\n          subtitle={batteryOnlyMode ? null : (hasSolarPanel ? `${formData.solar_panel_make} ${formData.solar_panel_model}` : '')}\n          showNewExistingToggle={!batteryOnlyMode}\n          isNew={formData.solar_panel_isnew !== false}\n          onNewExistingChange={(isNew) => onChange('solar_panel_isnew', isNew)}\n          onEdit={!batteryOnlyMode ? () => console.log('Edit solar panel') : undefined}\n          onCamera={!batteryOnlyMode ? () => console.log('Camera for solar panel') : undefined}\n          onDelete={!batteryOnlyMode ? handleTrashClick : undefined}\n          headerRightContent={\n            !batteryOnlyMode ? (\n              <PreferredButton onClick={() => setShowPreferredModal(true)} />\n            ) : null\n          }\n          toggleRowRightContent={\n            !batteryOnlyMode ? (\n              <TableRowButton\n                label=\"Battery Only\"\n                variant=\"outline\"\n                active={false}\n                onClick={handleBatteryOnlyClick}\n              />\n            ) : null\n          }\n        >\n          {batteryOnlyMode ? (\n            /* Battery Only Active State - Clean Centered UI */\n            <div style={{\n              display: 'flex',\n              flexDirection: 'column',\n              alignItems: 'center',\n              justifyContent: 'center',\n              padding: 'var(--spacing-loose)',\n              gap: 'var(--spacing)'\n            }}>\n              <span style={{ color: 'var(--text-secondary)', fontSize: 'var(--font-size-base)' }}>\n                Battery Only\n              </span>\n              <TableRowButton\n                label=\"Switch to Solar\"\n                variant=\"outline\"\n                active={false}\n                onClick={deactivateBatteryOnly}\n              />\n            </div>\n          ) : (\n            /* Normal Solar Panel Form */\n            <>\n              {/* Quantity field */}\n              <FormFieldRow label=\"Quantity\">\n                <input\n                  type=\"text\"\n                  value={formData.solar_panel_quantity || ''}\n                  onChange={(e) => handleFieldChange('solar_panel_quantity', e.target.value)}\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter') {\n                      e.preventDefault();\n                    }\n                  }}\n                  placeholder=\"Enter quantity\"\n                />\n              </FormFieldRow>\n\n              {/* Make dropdown */}\n              <TableDropdown\n                label=\"Make\"\n                value={formData.solar_panel_make || ''}\n                onChange={handleManufacturerChange}\n                options={manufacturers.map(m => ({ value: m, label: m }))}\n                placeholder={loadingMakes ? 'Loading...' : 'Select make'}\n                disabled={loadingMakes}\n              />\n\n              {/* Model dropdown */}\n              <TableDropdown\n                label=\"Model\"\n                value={formData.solar_panel_model || ''}\n                onChange={handleModelChange}\n                options={models.map(m => ({ value: m.model_number, label: m.model_number }))}\n                placeholder={\n                  loadingModels ? 'Loading...' :\n                  formData.solar_panel_make ? 'Select model' :\n                  'Select make first'\n                }\n                disabled={!formData.solar_panel_make || loadingModels}\n              />\n\n              {/* + Solar Panel (Type 2) Button */}\n              <div style={{\n                paddingLeft: 'var(--spacing)',\n                paddingRight: 'var(--spacing)',\n                paddingTop: 'var(--spacing-tight)',\n                paddingBottom: 'var(--spacing-tight)',\n              }}>\n                <TableRowButton\n                  label=\"+ Solar Panel (Type 2)\"\n                  variant=\"outline\"\n                  active={formData.show_solar_panel_2}\n                  onClick={handleToggleType2}\n                />\n              </div>\n            </>\n          )}\n        </EquipmentRow>\n      </div>\n\n      {/* Battery Only Confirmation Modal */}\n      <ConfirmDialog\n        isOpen={showBatteryOnlyConfirm}\n        onClose={() => setShowBatteryOnlyConfirm(false)}\n        onConfirm={activateBatteryOnly}\n        title=\"Activate Battery Only Mode\"\n        message=\"This will clear all solar panel data. Continue?\"\n        confirmText=\"Continue\"\n        cancelText=\"Cancel\"\n        variant=\"warning\"\n      />\n\n      {/* Type 2 Hide Confirmation Modal */}\n      <ConfirmDialog\n        isOpen={showType2Confirm}\n        onClose={() => setShowType2Confirm(false)}\n        onConfirm={handleConfirmHideType2}\n        title={`Clear Solar Panel ${systemNumber} - Type 2`}\n        message={`Are you sure you want to clear Solar Panel ${systemNumber} - Type 2?`}\n        confirmText=\"Clear\"\n        cancelText=\"Cancel\"\n        variant=\"warning\"\n      />\n\n      {/* Section Clear Modal */}\n      <SectionClearModal\n        isOpen={showClearModal}\n        onClose={closeClearModal}\n        onConfirm={handleClearConfirm}\n        sectionName=\"Solar Panel\"\n      />\n\n      {/* Section Remove Modal - Not used for CLEAR_ONLY behavior, but included for completeness */}\n      <SectionRemoveModal\n        isOpen={showRemoveModal}\n        onClose={closeRemoveModal}\n        onConfirm={handleRemoveConfirm}\n        sectionName=\"Solar Panel\"\n      />\n\n      {/* Preferred Equipment Modal */}\n      <PreferredEquipmentModal\n        isOpen={showPreferredModal}\n        onClose={() => setShowPreferredModal(false)}\n        onSelect={handlePreferredSelect}\n        onSelectOther={handleSelectOther}\n        equipmentType=\"solar-panels\"\n        title=\"Select Solar Panel\"\n      />\n    </div>\n  );\n};\n\nexport default SolarPanelSection;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\SolarPanelSelection.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\StorageManagementSystemSection.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'AddSectionButton' is defined but never used.","line":2,"column":76,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":92},{"ruleId":"no-unused-vars","severity":1,"message":"'BREAKER_RATING_OPTIONS' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":32},{"ruleId":"no-unused-vars","severity":1,"message":"'equipStyles' is defined but never used.","line":10,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":19},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadModels'. Either include it or remove the dependency array.","line":42,"column":6,"nodeType":"ArrayExpression","endLine":42,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: [formData.sms_make, loadModels]","fix":{"range":[1735,1754],"text":"[formData.sms_make, loadModels]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Alert, EquipmentRow, FormFieldRow, TableDropdown, TableRowButton, AddSectionButton, PreferredButton } from '../../ui';\nimport { PreferredEquipmentModal } from '../../equipment';\nimport BOSEquipmentSection from './BOSEquipmentSection';\nimport {\n  getSMSManufacturers,\n  getSMSModels,\n} from '../../../services/equipmentService';\nimport { BREAKER_RATING_OPTIONS, SMS_MAIN_BREAKER_OPTIONS } from '../../../utils/constants';\nimport equipStyles from '../EquipmentForm.module.css';\nimport logger from '../../../services/devLogger';\n\n/**\n * Storage Management System (SMS) Section\n * Allows user to select SMS equipment or choose \"No SMS\"\n */\nconst StorageManagementSystemSection = ({ formData, onChange, backupOption, systemNumber = 1 }) => {\n  const [manufacturers, setManufacturers] = useState([]);\n  const [models, setModels] = useState([]);\n  const [loadingManufacturers, setLoadingManufacturers] = useState(false);\n  const [loadingModels, setLoadingModels] = useState(false);\n  const [editPVBreaker, setEditPVBreaker] = useState(false);\n  const [editESSBreaker, setEditESSBreaker] = useState(false);\n  const [editTieInBreaker, setEditTieInBreaker] = useState(false);\n  const [showPreferredModal, setShowPreferredModal] = useState(false);\n\n  // Breaker size options (15-250 Amps)\n  const breakerOptions = [15, 20, 25, 30, 35, 40, 45, 50, 60, 70, 80, 90, 100, 110, 125, 150, 175, 200, 225, 250];\n\n  // Load manufacturers on mount\n  useEffect(() => {\n    loadManufacturers();\n  }, []);\n\n  // Load models when manufacturer changes\n  useEffect(() => {\n    if (formData.sms_make && formData.sms_make !== 'No SMS') {\n      loadModels();\n    } else {\n      setModels([]);\n    }\n  }, [formData.sms_make]);\n\n  const loadManufacturers = async () => {\n    setLoadingManufacturers(true);\n    try {\n      const response = await getSMSManufacturers();\n      const manufacturerList = response?.data || [];\n      // Normalize data to { label, value } format\n      const normalized = manufacturerList.map(item => {\n        if (typeof item === 'string') {\n          return { label: item, value: item };\n        }\n        const name = item.manufacturer || item.name || item.label || String(item);\n        return { label: name, value: name };\n      });\n      setManufacturers(normalized);\n    } catch (error) {\n      logger.error('Equipment', 'Error loading SMS manufacturers:', error);\n    } finally {\n      setLoadingManufacturers(false);\n    }\n  };\n\n  const loadModels = async () => {\n    setLoadingModels(true);\n    try {\n      const response = await getSMSModels(formData.sms_make);\n      const modelList = response?.data || [];\n      // Normalize data to { label, value } format\n      const normalized = modelList.map(item => {\n        if (typeof item === 'string') {\n          return { label: item, value: item };\n        }\n        const modelName = item.model || item.model_number || item.name || item.label || String(item);\n        return { label: modelName, value: modelName };\n      });\n      setModels(normalized);\n    } catch (error) {\n      logger.error('Equipment', 'Error loading SMS models:', error);\n    } finally {\n      setLoadingModels(false);\n    }\n  };\n\n  const handleToggle = (isNew) => {\n    onChange('sms_isnew', isNew);\n  };\n\n  const handleMakeChange = (e) => {\n    const makeValue = e.target.value;\n    onChange('sms_make', makeValue);\n    onChange('sms_model', '');\n\n    // If \"No SMS\" selected, clear all other fields\n    if (makeValue === 'No SMS') {\n      onChange('sms_main_breaker', 'MLO');\n      onChange('sms_has_rsd', false);\n    }\n  };\n\n  const handleClearPVBreaker = () => {\n    onChange('sms_pv_breaker', '');\n    setEditPVBreaker(false);\n  };\n\n  const handleClearESSBreaker = () => {\n    onChange('sms_ess_breaker', '');\n    setEditESSBreaker(false);\n  };\n\n  const handleClearTieInBreaker = () => {\n    onChange('sms_tie_in_breaker', '');\n    setEditTieInBreaker(false);\n  };\n\n  // Build dynamic Tie-in Breaker note based on backup option\n  const getTieInBreakerNote = () => {\n    let note = \"A minimum SMS Tie-in Breaker will be added in the Main Panel (A). If you are landing in another location and/or using an alternate Tie-in method, you can edit it in the Electrical section.\";\n\n    if (backupOption === \"Whole Home\") {\n      note += \"\\n\\nThe Tie-in breaker will auto-size to the bus rating of the Panel it is landing in.\";\n    } else if (backupOption === \"Partial Home\") {\n      note += \"\\n\\nThe Tie-in breaker will auto-size to protect the total PV and battery max continuous output current landed in the SMS.\";\n    }\n\n    note += \"\\n\\nIf the total PV and Battery max continuous output of the current landed in the SMS is larger than the max allowable panel backfeed, the Power Control System (PCS) will activate and be sized to the max allowable panel backfeed.\";\n\n    return note;\n  };\n\n  const isNoSMS = formData.sms_make === 'No SMS';\n  const hasSMS = formData.sms_make && formData.sms_model && !isNoSMS;\n\n  const getSubtitle = () => {\n    if (isNoSMS) return 'No SMS';\n    if (formData.sms_make && formData.sms_model) {\n      return `${formData.sms_make} ${formData.sms_model}`;\n    }\n    return '';\n  };\n\n  const handleDelete = () => {\n    onChange('sms_make', '');\n    onChange('sms_model', '');\n    onChange('sms_main_breaker', 'MLO');\n    onChange('sms_pv_breaker', '');\n    onChange('sms_ess_breaker', '');\n    onChange('sms_tie_in_breaker', '');\n    onChange('sms_has_rsd', false);\n    setEditPVBreaker(false);\n    setEditESSBreaker(false);\n    setEditTieInBreaker(false);\n  };\n\n  // Preferred equipment handlers\n  const handlePreferredSelect = (selected) => {\n    onChange('sms_make', selected.make);\n    onChange('sms_model', selected.model);\n  };\n\n  const handleSelectOther = () => {\n    onChange('sms_make', '');\n    onChange('sms_model', '');\n  };\n\n  return (\n    <div style={{ marginBottom: 'var(--spacing)' }}>\n      <EquipmentRow\n        title=\"Storage Management System\"\n        subtitle={getSubtitle()}\n        showNewExistingToggle={true}\n        isNew={formData.sms_isnew !== false}\n        onNewExistingChange={handleToggle}\n        onDelete={handleDelete}\n        headerRightContent={\n          <PreferredButton onClick={() => setShowPreferredModal(true)} />\n        }\n      >\n        {/* No SMS Button - Show when no make is selected */}\n        {!formData.sms_make && (\n          <div style={{\n            display: 'flex',\n            alignItems: 'center',\n            padding: 'var(--spacing-tight) var(--spacing)',\n          }}>\n            <TableRowButton\n              label=\"No SMS\"\n              variant=\"outline\"\n              onClick={() => handleMakeChange({ target: { value: 'No SMS' } })}\n              style={{ width: '100%' }}\n            />\n          </div>\n        )}\n\n        {/* Show \"No SMS Selected\" indicator when No SMS is chosen */}\n        {isNoSMS && (\n          <div style={{\n            padding: 'var(--spacing-tight) var(--spacing)',\n            borderBottom: 'var(--border-thin) solid var(--border-subtle)',\n          }}>\n            <Alert variant=\"info\">\n              This system does not require a Storage Management System. The inverter acts as the SMS.\n            </Alert>\n          </div>\n        )}\n\n        {/* Make & Model - Hide when \"No SMS\" is selected */}\n        {!isNoSMS && (\n          <>\n            <TableDropdown\n              label=\"Make\"\n              value={formData.sms_make || ''}\n              onChange={(value) => handleMakeChange({ target: { value } })}\n              options={manufacturers}\n              placeholder={loadingManufacturers ? 'Loading...' : 'Select make...'}\n              disabled={loadingManufacturers}\n            />\n\n            <TableDropdown\n              label=\"Model\"\n              value={formData.sms_model || ''}\n              onChange={(value) => onChange('sms_model', value)}\n              options={models}\n              placeholder={!formData.sms_make ? 'Select make' : loadingModels ? 'Loading...' : 'Select model'}\n              disabled={!formData.sms_make || loadingModels}\n            />\n\n            <TableDropdown\n              label=\"Main Breaker\"\n              value={formData.sms_main_breaker || ''}\n              onChange={(value) => onChange('sms_main_breaker', value)}\n              options={SMS_MAIN_BREAKER_OPTIONS}\n              placeholder=\"Select breaker...\"\n            />\n\n            {/* PV Breaker */}\n            <FormFieldRow label=\"PV Breaker\">\n              <TableRowButton\n                label=\"Auto\"\n                variant=\"outline\"\n                active={!editPVBreaker}\n                onClick={() => {\n                  handleClearPVBreaker();\n                }}\n              />\n              <TableRowButton\n                label=\"Custom\"\n                variant=\"outline\"\n                active={editPVBreaker}\n                onClick={() => setEditPVBreaker(true)}\n              />\n            </FormFieldRow>\n            {!editPVBreaker ? (\n              <div style={{\n                padding: 'var(--spacing-tight) var(--spacing)',\n                borderBottom: 'var(--border-thin) solid var(--border-subtle)',\n              }}>\n                <Alert variant=\"info\">\n                  A minimum PV Breaker will be added in the SMS PV input and will be rated to protect the total PV max continuous output current.\n                </Alert>\n              </div>\n            ) : (\n              <TableDropdown\n                label=\"Breaker Rating\"\n                value={formData.sms_pv_breaker || ''}\n                onChange={(value) => onChange('sms_pv_breaker', value)}\n                options={breakerOptions.map(rating => ({ label: `${rating}`, value: `${rating}` }))}\n                placeholder=\"Select rating...\"\n              />\n            )}\n\n            {/* ESS Breaker */}\n            <FormFieldRow label=\"ESS Breaker\">\n              <TableRowButton\n                label=\"Auto\"\n                variant=\"outline\"\n                active={!editESSBreaker}\n                onClick={() => {\n                  handleClearESSBreaker();\n                }}\n              />\n              <TableRowButton\n                label=\"Custom\"\n                variant=\"outline\"\n                active={editESSBreaker}\n                onClick={() => setEditESSBreaker(true)}\n              />\n            </FormFieldRow>\n            {!editESSBreaker ? (\n              <div style={{\n                padding: 'var(--spacing-tight) var(--spacing)',\n                borderBottom: 'var(--border-thin) solid var(--border-subtle)',\n              }}>\n                <Alert variant=\"info\">\n                  A minimum ESS Breaker will be added in the SMS ESS input and will be rated to protect the battery max continuous output current.\n                </Alert>\n              </div>\n            ) : (\n              <TableDropdown\n                label=\"Breaker Rating\"\n                value={formData.sms_ess_breaker || ''}\n                onChange={(value) => onChange('sms_ess_breaker', value)}\n                options={breakerOptions.map(rating => ({ label: `${rating}`, value: `${rating}` }))}\n                placeholder=\"Select rating...\"\n              />\n            )}\n\n            {/* Tie-in Breaker */}\n            <FormFieldRow label=\"Tie-in Breaker\">\n              <TableRowButton\n                label=\"Auto\"\n                variant=\"outline\"\n                active={!editTieInBreaker}\n                onClick={() => {\n                  handleClearTieInBreaker();\n                }}\n              />\n              <TableRowButton\n                label=\"Custom\"\n                variant=\"outline\"\n                active={editTieInBreaker}\n                onClick={() => setEditTieInBreaker(true)}\n              />\n            </FormFieldRow>\n            {!editTieInBreaker ? (\n              <div style={{\n                padding: 'var(--spacing-tight) var(--spacing)',\n                borderBottom: 'var(--border-thin) solid var(--border-subtle)',\n              }}>\n                <Alert variant=\"info\">\n                  {getTieInBreakerNote()}\n                </Alert>\n              </div>\n            ) : (\n              <TableDropdown\n                label=\"Breaker Rating\"\n                value={formData.sms_tie_in_breaker || ''}\n                onChange={(value) => onChange('sms_tie_in_breaker', value)}\n                options={breakerOptions.map(rating => ({ label: `${rating}`, value: `${rating}` }))}\n                placeholder=\"Select rating...\"\n              />\n            )}\n\n            {/* RSD Toggle Button */}\n            <div style={{\n              display: 'flex',\n              alignItems: 'center',\n              padding: 'var(--spacing-tight) var(--spacing)',\n            }}>\n              <TableRowButton\n                label={formData.sms_has_rsd ? 'Rapid Shutdown Switch' : '+ Rapid Shutdown Switch'}\n                variant={formData.sms_has_rsd ? 'primary' : 'outline'}\n                onClick={() => onChange('sms_has_rsd', !formData.sms_has_rsd)}\n                style={{ width: '50%' }}\n              />\n            </div>\n          </>\n        )}\n      </EquipmentRow>\n\n      {/* BOS Equipment */}\n      {hasSMS && (\n        <BOSEquipmentSection\n          formData={formData}\n          onChange={onChange}\n          section=\"postSMS\"\n          systemNumber={systemNumber}\n        />\n      )}\n\n      {/* Preferred Equipment Modal */}\n      <PreferredEquipmentModal\n        isOpen={showPreferredModal}\n        onClose={() => setShowPreferredModal(false)}\n        onSelect={handlePreferredSelect}\n        onSelectOther={handleSelectOther}\n        equipmentType=\"storage-management\"\n        title=\"Select Storage Management System\"\n      />\n    </div>\n  );\n};\n\nexport default StorageManagementSystemSection;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\StringCombinerPanelSection.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'Divider' is defined but never used.","line":2,"column":84,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":91},{"ruleId":"no-unused-vars","severity":1,"message":"'styles' is defined but never used.","line":6,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":14},{"ruleId":"no-unused-vars","severity":1,"message":"'equipStyles' is defined but never used.","line":7,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'calculateMaxPanelsPerBranch' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":30},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'formData.combiner_panel_main_breaker' and 'onChange'. Either include them or remove the dependency array. If 'onChange' changes too often, find the parent component that defines it and wrap that definition in useCallback.","line":148,"column":6,"nodeType":"ArrayExpression","endLine":148,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [formData.combiner_panel_main_breaker, onChange]","fix":{"range":[5188,5190],"text":"[formData.combiner_panel_main_breaker, onChange]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo } from 'react';\nimport { EquipmentRow, FormFieldRow, TableDropdown, TableRowButton, Alert, Button, Divider, PreferredButton } from '../../ui';\nimport { PreferredEquipmentModal } from '../../equipment';\nimport StringingGrid from './StringingGrid';\nimport BOSEquipmentSection from './BOSEquipmentSection';\nimport styles from '../../../styles/ProjectAdd.module.css';\nimport equipStyles from '../EquipmentForm.module.css';\nimport {\n  getCombinerPanelManufacturers,\n  getCombinerPanelModels,\n} from '../../../services/equipmentService';\nimport logger from '../../../services/devLogger';\nimport {\n  getStringingSpecs,\n  getMaxBranches as getMaxBranchesUtil,\n} from '../../../utils/stringingConstants';\nimport {\n  calculateMaxPanelsPerBranch,\n  distributeStandardMicros,\n  calculateDualQtyDistribution,\n  getStringingMode,\n} from '../../../utils/stringingCalculations';\n\n/**\n * String Combiner Panel Section\n * Used for microinverter systems to combine strings before main panel\n * Special handling for Enphase (no bus amps or main breaker required)\n * Now includes microinverter stringing configuration\n */\nconst StringCombinerPanelSection = ({\n  formData,\n  onChange,\n  systemNumber = 1,\n  // Stringing props\n  solarPanelQty = 0,      // Primary panel quantity\n  solarPanelQty2 = 0,     // Type 2 panel quantity (if mixed system)\n  inverterMake = '',      // For stringing mode detection\n  inverterModel = '',     // For specs lookup\n  inverterMaxContOutput = 0,  // Max continuous output amps per microinverter\n}) => {\n  const [manufacturers, setManufacturers] = useState([]);\n  const [models, setModels] = useState([]);\n  const [loadingMakes, setLoadingMakes] = useState(false);\n  const [loadingModels, setLoadingModels] = useState(false);\n  const [editTieInBreaker, setEditTieInBreaker] = useState(false);\n\n  // Stringing state\n  const [activeStringInput, setActiveStringInput] = useState(null);\n\n  // Preferred equipment modal state\n  const [showPreferredModal, setShowPreferredModal] = useState(false);\n\n  // Derived stringing values\n  const totalPanelQty = solarPanelQty + solarPanelQty2;\n  const stringingType = formData.stringing_type || 'auto';\n\n  // Calculate total max continuous output for all microinverters\n  // Total panels Ã— max continuous output per microinverter\n  const totalMaxContOutput = totalPanelQty * (parseFloat(inverterMaxContOutput) || 0);\n\n  // Auto-size tie-in breaker: round up to next standard breaker size\n  const getAutoTieInBreaker = () => {\n    if (totalMaxContOutput <= 0) return null;\n\n    // Standard breaker sizes\n    const breakerSizes = [15, 20, 25, 30, 35, 40, 45, 50, 60, 70, 80, 90, 100, 110, 125, 150, 175, 200, 225, 250];\n\n    // Find the smallest breaker that can handle the load (125% of continuous)\n    const requiredRating = totalMaxContOutput * 1.25;\n\n    for (const size of breakerSizes) {\n      if (size >= requiredRating) {\n        return size;\n      }\n    }\n\n    return 250; // Max fallback\n  };\n\n  const autoTieInBreaker = getAutoTieInBreaker();\n\n  // Stringing mode (Enphase = standard, Hoymiles/APSystems = dual-qty)\n  const stringingMode = getStringingMode('microinverter', inverterMake);\n  const isDualQtyMode = stringingMode === 'dual-qty';\n\n  // Get specs for dual-qty manufacturers\n  const specs = useMemo(() => {\n    return isDualQtyMode ? getStringingSpecs(inverterMake, inverterModel) : null;\n  }, [isDualQtyMode, inverterMake, inverterModel]);\n\n  // Max branches from combiner panel model\n  const maxBranches = getMaxBranchesUtil(\n    formData.combiner_panel_make,\n    formData.combiner_panel_model\n  );\n\n  // Max panels per branch\n  const maxPanelsPerBranch = useMemo(() => {\n    if (isDualQtyMode && specs) {\n      return specs.maxPanelsBranch;\n    }\n    return 25; // Default for standard microinverters\n  }, [isDualQtyMode, specs]);\n\n  // Calculate total panels assigned\n  const totalPanelsAssigned = useMemo(() => {\n    let total = 0;\n    for (let i = 1; i <= 10; i++) {\n      const panelQty = parseInt(formData[`branch_string_${i}`]) || 0;\n      total += panelQty;\n    }\n    return total;\n  }, [formData]);\n\n  const panelsRemaining = totalPanelQty - totalPanelsAssigned;\n\n  // Bus amps options (40-250 in increments of 10)\n  const busAmpOptions = Array.from({ length: 22 }, (_, i) => 40 + i * 10);\n\n  // Main breaker options\n  const mainBreakerOptions = ['MLO', 100, 110, 125, 150, 175, 200, 225, 250, 300, 350, 400, 450, 500, 600];\n\n  // Tie-in breaker options\n  const tieInBreakerOptions = [15, 20, 25, 30, 35, 40, 45, 50, 60, 70, 80, 90, 100, 110, 125, 150, 175, 200, 225, 250];\n\n  // Check if Enphase is selected\n  const isEnphase = formData.combiner_panel_make === 'Enphase';\n\n  // Load manufacturers on mount\n  useEffect(() => {\n    loadManufacturers();\n  }, []);\n\n  // Load models from API when manufacturer changes\n  useEffect(() => {\n    if (formData.combiner_panel_make) {\n      loadModels(formData.combiner_panel_make);\n    } else {\n      setModels([]);\n    }\n  }, [formData.combiner_panel_make]);\n\n  // Set default MLO on mount\n  useEffect(() => {\n    if (!formData.combiner_panel_main_breaker) {\n      onChange('combiner_panel_main_breaker', 'MLO');\n    }\n  }, []);\n\n  const loadManufacturers = async () => {\n    setLoadingMakes(true);\n    try {\n      const response = await getCombinerPanelManufacturers();\n      setManufacturers(response.data || []);\n    } catch (error) {\n      logger.error('Equipment', 'Failed to load combiner panel manufacturers:', error);\n    } finally {\n      setLoadingMakes(false);\n    }\n  };\n\n  const loadModels = async (manufacturer) => {\n    setLoadingModels(true);\n    try {\n      const response = await getCombinerPanelModels(manufacturer);\n      const modelsData = response.data || [];\n\n      // Normalize models data to ensure consistent format\n      const normalizedModels = modelsData.map(model => {\n        if (typeof model === 'string') {\n          return { value: model, label: model };\n        }\n        return { value: model.model_number || model.value || model, label: model.model_number || model.label || model };\n      });\n\n      setModels(normalizedModels);\n    } catch (error) {\n      logger.error('Equipment', 'Failed to load combiner panel models:', error);\n    } finally {\n      setLoadingModels(false);\n    }\n  };\n\n\n  const handleDelete = () => {\n    onChange('combiner_panel_make', '');\n    onChange('combiner_panel_model', '');\n    onChange('combiner_panel_bus_amps', '');\n    onChange('combiner_panel_main_breaker', 'MLO');\n    onChange('combiner_panel_tie_in_breaker', '');\n    onChange('combiner_panel_isnew', true);\n  };\n\n  // Preferred equipment handlers\n  const handlePreferredSelect = (selected) => {\n    onChange('combiner_panel_make', selected.make);\n    onChange('combiner_panel_model', selected.model);\n  };\n\n  const handleSelectOther = () => {\n    onChange('combiner_panel_make', '');\n    onChange('combiner_panel_model', '');\n  };\n\n  const handleManufacturerChange = (value) => {\n    onChange('combiner_panel_make', value);\n    onChange('combiner_panel_model', ''); // Clear model when manufacturer changes\n\n    // Clear Bus Amps and Main Breaker fields when Enphase is selected\n    if (value === 'Enphase') {\n      onChange('combiner_panel_bus_amps', '');\n      onChange('combiner_panel_main_breaker', '');\n    }\n  };\n\n  const handleModelChange = (value) => {\n    const modelValue = value;\n    onChange('combiner_panel_model', modelValue);\n\n    // Auto-set bus amps if the model contains an amp rating (e.g., \"200 Amps\" -> 200)\n    // Skip for Enphase since they don't use bus amps\n    if (!isEnphase && modelValue) {\n      const ampMatch = modelValue.match(/(\\d+)\\s*Amp/i);\n      if (ampMatch) {\n        const amps = ampMatch[1];\n        onChange('combiner_panel_bus_amps', amps);\n      }\n    }\n  };\n\n  const handleClearTieInBreaker = () => {\n    onChange('combiner_panel_tie_in_breaker', '');\n    setEditTieInBreaker(false);\n  };\n\n  // ============================================\n  // STRINGING HANDLERS\n  // ============================================\n\n  // Handle stringing type change (auto/custom)\n  const handleStringingTypeChange = (type) => {\n    onChange('stringing_type', type);\n\n    // Clear all branch data when switching to auto\n    if (type === 'auto') {\n      for (let i = 1; i <= 10; i++) {\n        onChange(`branch_string_${i}`, '');\n      }\n    }\n  };\n\n  // Handle branch panel qty change\n  const handleBranchStringChange = (index, value) => {\n    const numericValue = value.replace(/[^0-9]/g, '');\n    onChange(`branch_string_${index}`, numericValue);\n  };\n\n  // Auto-calculate distribution\n  const handleAutoCalculate = () => {\n    if (totalPanelQty <= 0) return;\n\n    let distribution;\n\n    if (isDualQtyMode && specs) {\n      distribution = calculateDualQtyDistribution(totalPanelQty, specs, maxBranches);\n    } else {\n      distribution = distributeStandardMicros(totalPanelQty, maxPanelsPerBranch, maxBranches);\n    }\n\n    if (!distribution || !distribution.branches) return;\n\n    // Clear all branches first\n    for (let i = 1; i <= 10; i++) {\n      onChange(`branch_string_${i}`, '');\n    }\n\n    // Populate with calculated values\n    distribution.branches.forEach((branch) => {\n      const i = branch.branchIndex;\n      onChange(`branch_string_${i}`, String(branch.panelQty || 0));\n    });\n  };\n\n  // Prepare rows for StringingGrid\n  const prepareGridRows = () => {\n    return Array.from({ length: maxBranches }, (_, i) => {\n      const index = i + 1;\n      const value = formData[`branch_string_${index}`] || '';\n      const displayValue = value === '' || value === '0' ? '' : value;\n\n      return {\n        id: index,\n        index,\n        displayValue,\n        panelQtyValue: isDualQtyMode ? displayValue : undefined,\n        isNew: true,\n      };\n    });\n  };\n\n  // Column labels\n  const columnLabels = isDualQtyMode\n    ? { col1: 'Branch', col3: 'Panel Qty', col4: 'Micro Qty' }\n    : { col1: 'Branch', col4: 'Panel Qty' };\n\n  // Check if we have combiner panel configured\n  const hasCombinerPanel = formData.combiner_panel_make && formData.combiner_panel_model;\n\n  // Debug logging\n  logger.debug('StringCombinerPanel', `Stringing visibility check:`, {\n    hasCombinerPanel,\n    totalPanelQty,\n    solarPanelQty,\n    solarPanelQty2,\n    shouldShow: hasCombinerPanel && totalPanelQty > 0,\n    inverterMake,\n    inverterModel,\n  });\n\n  return (\n    <div style={{ marginBottom: 'var(--spacing)' }}>\n      <EquipmentRow\n        title=\"String Combiner Panel\"\n        subtitle={hasCombinerPanel ? `${formData.combiner_panel_make} ${formData.combiner_panel_model}` : ''}\n        showNewExistingToggle={true}\n        isNew={formData.combiner_panel_isnew !== false}\n        onNewExistingChange={(isNew) => onChange('combiner_panel_isnew', isNew)}\n        onDelete={handleDelete}\n        headerRightContent={\n          <PreferredButton onClick={() => setShowPreferredModal(true)} />\n        }\n      >\n        {/* Make dropdown */}\n        <TableDropdown\n          label=\"Make\"\n          value={formData.combiner_panel_make || ''}\n          onChange={handleManufacturerChange}\n          options={manufacturers.map(m => ({ value: m, label: m }))}\n          placeholder={loadingMakes ? 'Loading...' : 'Select make'}\n          disabled={loadingMakes}\n        />\n\n        {/* Model dropdown */}\n        <TableDropdown\n          label=\"Model\"\n          value={formData.combiner_panel_model || ''}\n          onChange={handleModelChange}\n          options={models.map(m => ({ value: m.value, label: m.label }))}\n          placeholder={\n            loadingModels ? 'Loading...' :\n            formData.combiner_panel_make ? 'Select model' :\n            'Select make first'\n          }\n          disabled={!formData.combiner_panel_make || loadingModels}\n        />\n\n        {/* Bus Amps - Hidden for Enphase */}\n        {!isEnphase && (\n          <TableDropdown\n            label=\"Bus (Amps)\"\n            value={formData.combiner_panel_bus_amps || ''}\n            onChange={(value) => onChange('combiner_panel_bus_amps', value)}\n            options={busAmpOptions.map(amps => ({ value: amps, label: amps.toString() }))}\n            placeholder=\"Select amps\"\n          />\n        )}\n\n        {/* Main Circuit Breaker - Hidden for Enphase */}\n        {!isEnphase && (\n          <TableDropdown\n            label=\"Main Circuit Breaker (Amps)\"\n            value={formData.combiner_panel_main_breaker || 'MLO'}\n            onChange={(value) => onChange('combiner_panel_main_breaker', value)}\n            options={mainBreakerOptions.map(option => ({ value: option, label: option.toString() }))}\n            placeholder=\"Select breaker\"\n          />\n        )}\n\n        {/* Tie-in Breaker */}\n        <FormFieldRow label=\"Tie-in Breaker\">\n          <TableRowButton\n            label=\"Auto\"\n            variant=\"outline\"\n            active={!editTieInBreaker}\n            onClick={() => {\n              handleClearTieInBreaker();\n            }}\n          />\n          <TableRowButton\n            label=\"Custom\"\n            variant=\"outline\"\n            active={editTieInBreaker}\n            onClick={() => setEditTieInBreaker(true)}\n          />\n        </FormFieldRow>\n        {!editTieInBreaker ? (\n          <div style={{\n            padding: 'var(--spacing-tight) var(--spacing)',\n            borderBottom: 'var(--border-thin) solid var(--border-subtle)',\n          }}>\n            <Alert variant=\"info\">\n              {autoTieInBreaker ? (\n                <>\n                  Tie-in Breaker will be auto-sized to <strong>{autoTieInBreaker}A</strong> based on {totalPanelQty} panels Ã— {inverterMaxContOutput}A = {totalMaxContOutput.toFixed(1)}A total continuous output.\n                  <br /><br />\n                  You can change the Tie-in Location in the Electrical Section.\n                </>\n              ) : (\n                <>\n                  A Tie-in Breaker will be added in the Main Panel (A) and will be rated to protect the total Microinverter continuous output current landed in this Combiner Panel.\n                  <br /><br />\n                  You can change the Tie-in Location in the Electrical Section.\n                </>\n              )}\n            </Alert>\n          </div>\n        ) : (\n          <TableDropdown\n            label=\"Breaker Rating\"\n            value={formData.combiner_panel_tie_in_breaker || ''}\n            onChange={(value) => onChange('combiner_panel_tie_in_breaker', value)}\n            options={tieInBreakerOptions.map(rating => ({ value: rating, label: rating.toString() }))}\n            placeholder=\"Select rating...\"\n          />\n        )}\n\n        {/* STRINGING SECTION - Only show if combiner panel is configured and panels exist */}\n        {hasCombinerPanel && totalPanelQty > 0 && (\n          <>\n            {/* Auto/Custom Toggle */}\n            <FormFieldRow label=\"Stringing Mode\">\n              <TableRowButton\n                label=\"Auto\"\n                variant=\"outline\"\n                active={stringingType === 'auto'}\n                onClick={() => handleStringingTypeChange('auto')}\n              />\n              <TableRowButton\n                label=\"Custom\"\n                variant=\"outline\"\n                active={stringingType === 'custom'}\n                onClick={() => handleStringingTypeChange('custom')}\n              />\n            </FormFieldRow>\n\n            {/* Auto Stringing Info */}\n            {stringingType === 'auto' && (\n              <div style={{ padding: 'var(--spacing)' }}>\n                <Alert variant=\"info\" collapsible={false}>\n                  Stringing will auto-size to distribute total quantity in Solar Panel 1\n                  {solarPanelQty2 > 0 && ' and Type 2'} across branches within manufacturer limits.\n                </Alert>\n              </div>\n            )}\n\n            {/* Custom Stringing Interface */}\n            {stringingType === 'custom' && (\n              <div style={{ padding: 'var(--spacing)' }}>\n                {/* Specs Info Display (for dual-qty microinverters) */}\n                {isDualQtyMode && specs && (\n                  <Alert variant=\"info\" collapsible={false} style={{ marginBottom: 'var(--spacing)' }}>\n                    <strong>{inverterModel}</strong>: {specs.panelRatio} ratio â€¢\n                    Max {specs.maxUnitsBranch} micros/branch â€¢\n                    Max {specs.maxPanelsBranch} panels/branch\n                  </Alert>\n                )}\n\n                {/* Panels Remaining Counter */}\n                <div style={{ marginBottom: 'var(--spacing)', textAlign: 'center' }}>\n                  <span style={{ color: 'var(--text-secondary)', fontSize: 'var(--text-sm)' }}>\n                    Solar Panels Remaining:{' '}\n                    <span style={{\n                      color: panelsRemaining === 0 ? 'var(--color-success)' :\n                             panelsRemaining < 0 ? 'var(--color-error)' : 'var(--color-primary)',\n                      fontWeight: 'var(--font-bold)',\n                    }}>\n                      {panelsRemaining}\n                    </span>\n                  </span>\n                </div>\n\n                {/* Auto-Calculate Button */}\n                {totalPanelQty > 0 && (\n                  <Button\n                    variant=\"outline\"\n                    size=\"md\"\n                    onClick={handleAutoCalculate}\n                    style={{ marginBottom: 'var(--spacing)', width: '100%' }}\n                  >\n                    Auto-Calculate Distribution\n                  </Button>\n                )}\n\n                {/* Stringing Grid */}\n                <StringingGrid\n                  rows={prepareGridRows()}\n                  panelsRemaining={panelsRemaining}\n                  columnLabels={columnLabels}\n                  mode={isDualQtyMode ? 'dual-qty' : 'standard'}\n                  maxPanelsPerBranch={maxPanelsPerBranch}\n                  onToggle={undefined}\n                  onChange={handleBranchStringChange}\n                  onPanelQtyChange={undefined}\n                  onFocus={setActiveStringInput}\n                  onBlur={() => setActiveStringInput(null)}\n                  activeInput={activeStringInput}\n                />\n              </div>\n            )}\n          </>\n        )}\n      </EquipmentRow>\n\n      {/* BOS Equipment */}\n      {hasCombinerPanel && (\n        <BOSEquipmentSection\n          formData={formData}\n          onChange={onChange}\n          section=\"utility\"\n          systemNumber={systemNumber}\n        />\n      )}\n\n      {/* Preferred Equipment Modal */}\n      <PreferredEquipmentModal\n        isOpen={showPreferredModal}\n        onClose={() => setShowPreferredModal(false)}\n        onSelect={handlePreferredSelect}\n        onSelectOther={handleSelectOther}\n        equipmentType=\"string-combiner\"\n        title=\"Select String Combiner Panel\"\n      />\n    </div>\n  );\n};\n\nexport default StringCombinerPanelSection;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\StringingGrid.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'styles' is defined but never used.","line":5,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useMemo } from 'react';\nimport Toggle from '../../common/Toggle';\nimport FormInput from '../../ui/FormInput';\nimport FormSelect from '../../ui/FormSelect';\nimport styles from '../../../styles/ProjectAdd.module.css';\nimport gridStyles from './StringingGrid.module.css';\n\n/**\n * StringingGrid Component\n * Reusable grid for both inverter and microinverter stringing configuration\n * Uses CSS Grid with content-aware column sizing\n *\n * Modes:\n * - 'standard': Shows Strings column + Panel Qty dropdown (for standard microinverters like Enphase)\n * - 'dual-qty': Shows Panel Qty + Micro Qty columns (for APSystems, Hoymiles Power)\n */\nconst StringingGrid = ({\n  rows,\n  panelsRemaining,\n  columnLabels = { col1: 'Input', col3: 'Panel Qty', col4: 'Micro Qty' },\n  mode = 'standard', // 'standard' or 'dual-qty'\n  maxPanelsPerBranch = 20, // Max panels per branch for standard mode dropdown\n  onToggle,\n  onChange,\n  onPanelQtyChange, // For dual-qty mode\n  onFocus,\n  onBlur,\n  activeInput\n}) => {\n  // Generate panel quantity options for standard mode (1 to maxPanelsPerBranch)\n  const panelQtyOptions = useMemo(() => {\n    const options = [];\n    for (let i = 1; i <= maxPanelsPerBranch; i++) {\n      options.push({ value: i.toString(), label: i.toString() });\n    }\n    return options;\n  }, [maxPanelsPerBranch]);\n  return (\n    <div className={gridStyles.gridContainer}>\n      {/* Header Row */}\n      <div className={mode === 'dual-qty' ? gridStyles.headerRowDual : gridStyles.headerRow}>\n        <div className={gridStyles.panelsRemaining}>\n          Solar Panels Remaining: <span className={gridStyles.highlight}>{panelsRemaining >= 0 ? panelsRemaining : 0}</span>\n        </div>\n        {mode === 'dual-qty' && <div className={gridStyles.headerLabel}>{columnLabels.col3}</div>}\n        <div className={gridStyles.headerLabel}>{columnLabels.col4}</div>\n      </div>\n\n      {/* Divider */}\n      <div className={gridStyles.divider}></div>\n\n      {/* Data Rows */}\n      <div className={gridStyles.rowsContainer}>\n        {rows.map((row, index) => (\n          <div key={row.id || index} className={mode === 'dual-qty' ? gridStyles.dataRowDual : gridStyles.dataRow}>\n            {/* Column 1: New/Existing Toggle */}\n            <div className={gridStyles.toggleCell}>\n              <Toggle\n                isNew={row.isNew}\n                onToggle={(isNew) => onToggle(row.index, isNew)}\n              />\n            </div>\n\n            {/* Column 2: Label (Input/Branch) */}\n            <div className={gridStyles.labelCell}>\n              {columnLabels.col1} {row.index}\n            </div>\n\n            {/* Column 3: Panel Qty (dual-qty mode only) */}\n            {mode === 'dual-qty' && (\n              <div className={gridStyles.qtyCell}>\n                <FormInput\n                  type=\"text\"\n                  value={row.panelQtyValue || ''}\n                  onChange={(e) => onPanelQtyChange && onPanelQtyChange(row.index, e.target.value)}\n                  onFocus={() => onFocus && onFocus(`panel_${row.index}`)}\n                  onBlur={() => onBlur && onBlur()}\n                  placeholder=\"0\"\n                  size=\"sm\"\n                  fullWidth={false}\n                  className={gridStyles.formInputWrapper}\n                />\n              </div>\n            )}\n\n            {/* Column 3/4: Panel Qty Dropdown (standard mode) or Micro Qty Input (dual-qty mode) */}\n            <div className={gridStyles.qtyCell}>\n              {mode === 'standard' ? (\n                <FormSelect\n                  value={row.displayValue}\n                  onChange={(e) => onChange(row.index, e.target.value)}\n                  onFocus={() => onFocus && onFocus(row.index)}\n                  onBlur={() => onBlur && onBlur()}\n                  options={panelQtyOptions}\n                  placeholder=\"0\"\n                  size=\"sm\"\n                  fullWidth={false}\n                  className={gridStyles.formInputWrapper}\n                />\n              ) : (\n                <FormInput\n                  type=\"text\"\n                  value={row.displayValue}\n                  onChange={(e) => onChange(row.index, e.target.value)}\n                  onFocus={() => onFocus && onFocus(row.index)}\n                  onBlur={() => onBlur && onBlur()}\n                  placeholder=\"0\"\n                  size=\"sm\"\n                  fullWidth={false}\n                  className={gridStyles.formInputWrapper}\n                />\n              )}\n            </div>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default StringingGrid;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\StringingSection.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\SystemContainer.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\SystemProgressIndicator.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\inline-bos\\BOSEquipmentForm.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\inline-bos\\BOSSlot.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\inline-bos\\InlineBOSSection.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\storage\\BatteryCombinerPanelSection.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\storage\\BatteryTypeSection.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'selectedModelData' is assigned a value but never used.","line":31,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":27},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'formData'. Either include it or remove the dependency array.","line":71,"column":6,"nodeType":"ArrayExpression","endLine":71,"endColumn":84,"suggestions":[{"desc":"Update the dependencies array to be: [isFranklinAPower, configurationField, onChange, formData]","fix":{"range":[2343,2421],"text":"[isFranklinAPower, configurationField, onChange, formData]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a complex expression in the dependency array. Extract it to a separate variable so it can be statically checked.","line":71,"column":25,"nodeType":"MemberExpression","endLine":71,"endColumn":53},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'formData', 'loadModels', and 'makeField'. Either include them or remove the dependency array.","line":86,"column":6,"nodeType":"ArrayExpression","endLine":86,"endColumn":27,"suggestions":[{"desc":"Update the dependencies array to be: [formData, loadModels, makeField]","fix":{"range":[2726,2747],"text":"[formData, loadModels, makeField]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a complex expression in the dependency array. Extract it to a separate variable so it can be statically checked.","line":86,"column":7,"nodeType":"MemberExpression","endLine":86,"endColumn":26}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport Toggle from '../../../common/Toggle';\nimport { SearchableDropdown, Button } from '../../../ui';\nimport styles from '../../../../styles/ProjectAdd.module.css';\nimport logger from '../../../../services/devLogger';\nimport {\n  getBatteryManufacturers,\n  getBatteryModels,\n} from '../../../../services/equipmentService';\n\n/**\n * Battery Type Section\n * Handles battery configuration with New/Existing toggle\n * Supports configuration for multiple batteries (Daisy Chain, Battery Combiner Panel, Inverter)\n */\nconst BatteryTypeSection = ({\n  formData,\n  onChange,\n  batteryNumber = 1,\n  showAddBattery2 = false,\n  onAddBattery2,\n  showConfiguration = false,\n  smsData = null,\n  inverterData = null,\n  batteryCombinerPanelData = null,\n}) => {\n  const [manufacturers, setManufacturers] = useState([]);\n  const [models, setModels] = useState([]);\n  const [loadingMakes, setLoadingMakes] = useState(false);\n  const [loadingModels, setLoadingModels] = useState(false);\n  const [selectedModelData, setSelectedModelData] = useState(null);\n\n  // Field names based on battery number\n  const prefix = `battery${batteryNumber}`;\n  const isNewField = `${prefix}_isnew`;\n  const makeField = `${prefix}_make`;\n  const modelField = `${prefix}_model`;\n  const quantityField = `${prefix}_quantity`;\n  const configurationField = `${prefix}_configuration`;\n  const tieInLocationField = `${prefix}_tie_in_location`;\n\n  // Configuration options\n  const configOptions = [\n    'Daisy Chain',\n    'Battery Combiner Panel',\n    'Inverter',\n  ];\n\n  // Get quantity as number\n  const quantity = parseInt(formData[quantityField]) || 0;\n\n  // Detect Franklin aPower: requires Battery Combiner Panel for qty > 1\n  const isFranklinAPower =\n    formData[makeField]?.toLowerCase().includes('franklin') &&\n    formData[modelField]?.toLowerCase().includes('apower') &&\n    quantity > 1;\n\n  // Get filtered configuration options\n  const getConfigOptions = () => {\n    if (isFranklinAPower) {\n      return ['Battery Combiner Panel'];\n    }\n    return configOptions;\n  };\n\n  // Auto-select Battery Combiner Panel for Franklin aPower with qty > 1\n  useEffect(() => {\n    if (isFranklinAPower && formData[configurationField] !== 'Battery Combiner Panel') {\n      onChange(configurationField, 'Battery Combiner Panel');\n    }\n  }, [isFranklinAPower, formData[configurationField], configurationField, onChange]);\n\n  // Load manufacturers on mount\n  useEffect(() => {\n    loadManufacturers();\n  }, []);\n\n  // Load models when manufacturer changes\n  useEffect(() => {\n    if (formData[makeField]) {\n      loadModels(formData[makeField]);\n    } else {\n      setModels([]);\n      setSelectedModelData(null);\n    }\n  }, [formData[makeField]]);\n\n  const loadManufacturers = async () => {\n    setLoadingMakes(true);\n    try {\n      const response = await getBatteryManufacturers();\n      setManufacturers(response.data || []);\n    } catch (error) {\n      logger.error('Equipment', 'Failed to load battery manufacturers:', error);\n    } finally {\n      setLoadingMakes(false);\n    }\n  };\n\n  const loadModels = async (manufacturer) => {\n    setLoadingModels(true);\n    try {\n      const response = await getBatteryModels(manufacturer);\n      const modelsData = response.data || [];\n      setModels(modelsData);\n\n      // If current model is selected, find its data\n      if (formData[modelField]) {\n        const modelData = modelsData.find(m => m.model_number === formData[modelField]);\n        if (modelData) {\n          setSelectedModelData(modelData);\n          // Store model ID for future reference\n          if (modelData.id) {\n            onChange(`${prefix}_model_id`, modelData.id);\n          }\n        }\n      }\n    } catch (error) {\n      logger.error('Equipment', 'Failed to load battery models:', error);\n    } finally {\n      setLoadingModels(false);\n    }\n  };\n\n  const handleToggle = (isNew) => {\n    onChange(isNewField, isNew);\n  };\n\n  const handleManufacturerChange = (value) => {\n    onChange(makeField, value);\n    onChange(modelField, ''); // Clear model when manufacturer changes\n    setSelectedModelData(null);\n  };\n\n  const handleModelChange = (value) => {\n    onChange(modelField, value);\n\n    // Find model data\n    const modelData = models.find(m => m.model_number === value);\n    if (modelData) {\n      setSelectedModelData(modelData);\n      // Store model ID for future reference\n      if (modelData.id) {\n        onChange(`${prefix}_model_id`, modelData.id);\n      }\n    }\n  };\n\n  // Build tie-in location options\n  const buildTieInLocationOptions = () => {\n    const options = [];\n\n    // Storage Management System (SMS)\n    if (smsData?.make && smsData?.model) {\n      options.push(`SMS - ${smsData.make} ${smsData.model}`);\n    } else {\n      options.push('SMS');\n    }\n\n    // Inverter\n    if (inverterData?.make && inverterData?.model) {\n      options.push(`Inverter - ${inverterData.make} ${inverterData.model}`);\n    }\n\n    // Main Panel\n    options.push('Main Panel');\n\n    // Sub Panel\n    options.push('Sub Panel');\n\n    // Battery Combiner Panel\n    if (batteryCombinerPanelData?.make && batteryCombinerPanelData?.model) {\n      options.push(`Battery Combiner Panel - ${batteryCombinerPanelData.make} ${batteryCombinerPanelData.model}`);\n    } else {\n      options.push('Battery Combiner Panel');\n    }\n\n    // Backup Load Sub Panel\n    options.push('Backup Load Sub Panel');\n\n    return options;\n  };\n\n  const tieInLocationOptions = buildTieInLocationOptions();\n\n  // Check if form is complete for Battery Type 2 button enablement\n  const isComplete = formData[makeField] && formData[modelField] && (quantity <= 1 || formData[configurationField]);\n\n  return (\n    <>\n      <Toggle\n        isNew={formData[isNewField] !== false}\n        onToggle={handleToggle}\n      />\n\n      <div className={styles.formRow}>\n        <div className={styles.formGroup}>\n          <label className={styles.label}>Quantity</label>\n          <input\n            type=\"text\"\n            value={formData[quantityField] || ''}\n            onChange={(e) => {\n              // Only allow numbers\n              const numericValue = e.target.value.replace(/[^0-9]/g, '');\n              onChange(quantityField, numericValue);\n            }}\n            className={styles.input}\n            placeholder=\"1\"\n          />\n        </div>\n      </div>\n\n      <div className={styles.formRow}>\n        <div className={styles.formGroup}>\n          <SearchableDropdown\n            label=\"Make\"\n            value={formData[makeField] || ''}\n            onChange={handleManufacturerChange}\n            options={manufacturers.map(m => ({ value: m, label: m }))}\n            placeholder={loadingMakes ? 'Loading...' : 'Select make...'}\n            disabled={loadingMakes}\n          />\n        </div>\n\n        <div className={styles.formGroup}>\n          <SearchableDropdown\n            label=\"Model\"\n            value={formData[modelField] || ''}\n            onChange={handleModelChange}\n            options={models.map(m => ({ value: m.model_number, label: m.model_number }))}\n            placeholder={loadingModels ? 'Loading...' : formData[makeField] ? 'Select model' : 'Select make'}\n            disabled={!formData[makeField] || loadingModels}\n          />\n        </div>\n      </div>\n\n      {/* Tie-in Location */}\n      <div className={styles.formRow}>\n        <div className={styles.formGroup}>\n          <SearchableDropdown\n            label=\"Tie-in Location\"\n            value={formData[tieInLocationField] || ''}\n            onChange={(value) => onChange(tieInLocationField, value)}\n            options={tieInLocationOptions.map(opt => ({ value: opt, label: opt }))}\n            placeholder=\"Select location...\"\n          />\n        </div>\n      </div>\n\n      {/* Configuration - Show when quantity > 1 */}\n      {showConfiguration && quantity > 1 && (\n        <div className={styles.formRow}>\n          <div className={styles.formGroup}>\n            <SearchableDropdown\n              label=\"Configuration\"\n              value={formData[configurationField] || ''}\n              onChange={(value) => onChange(configurationField, value)}\n              options={getConfigOptions().map(opt => ({ value: opt, label: opt }))}\n              placeholder=\"Select configuration...\"\n              disabled={isFranklinAPower}\n            />\n          </div>\n        </div>\n      )}\n\n      {/* Battery Type 2 Button */}\n      {showAddBattery2 && (\n        <Button\n          variant=\"secondary\"\n          size=\"md\"\n          onClick={onAddBattery2}\n          disabled={!isComplete}\n          style={{\n            width: '50%',\n          }}\n        >\n          + Battery Type 2\n        </Button>\n      )}\n    </>\n  );\n};\n\nexport default BatteryTypeSection;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\storage\\EnergyStorageSection.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\equipment\\storage\\SMSSection.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'selectedModelData' is assigned a value but never used.","line":20,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":27},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadModels'. Either include it or remove the dependency array.","line":43,"column":6,"nodeType":"ArrayExpression","endLine":43,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: [formData.sms_make, loadModels]","fix":{"range":[1518,1537],"text":"[formData.sms_make, loadModels]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'formData.sms_breaker_rating' and 'onChange'. Either include them or remove the dependency array. If 'onChange' changes too often, find the parent component that defines it and wrap that definition in useCallback.","line":50,"column":6,"nodeType":"ArrayExpression","endLine":50,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [formData.sms_breaker_rating, onChange]","fix":{"range":[1705,1707],"text":"[formData.sms_breaker_rating, onChange]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport Toggle from '../../../common/Toggle';\nimport styles from '../../../../styles/ProjectAdd.module.css';\nimport componentStyles from './SMSSection.module.css';\nimport logger from '../../../../services/devLogger';\nimport {\n  getSMSManufacturers,\n  getSMSModels,\n} from '../../../../services/equipmentService';\n\n/**\n * Storage Management System (SMS) Section\n * Handles SMS equipment selection with optional breaker overrides\n */\nconst SMSSection = ({ formData, onChange }) => {\n  const [manufacturers, setManufacturers] = useState([]);\n  const [models, setModels] = useState([]);\n  const [loadingMakes, setLoadingMakes] = useState(false);\n  const [loadingModels, setLoadingModels] = useState(false);\n  const [selectedModelData, setSelectedModelData] = useState(null);\n\n  // Breaker override states\n  const [editPVBreaker, setEditPVBreaker] = useState(false);\n  const [editESSBreaker, setEditESSBreaker] = useState(false);\n  const [editTieInBreaker, setEditTieInBreaker] = useState(false);\n\n  // Breaker options\n  const breakerOptions = ['15', '20', '25', '30', '35', '40', '45', '50', '60', '70', '80', '90', '100', '110', '125', '150', '175', '200', '225', '250'];\n\n  // Load manufacturers on mount\n  useEffect(() => {\n    loadManufacturers();\n  }, []);\n\n  // Load models when manufacturer changes\n  useEffect(() => {\n    if (formData.sms_make) {\n      loadModels(formData.sms_make);\n    } else {\n      setModels([]);\n      setSelectedModelData(null);\n    }\n  }, [formData.sms_make]);\n\n  // Set default breaker rating to MLO on mount\n  useEffect(() => {\n    if (!formData.sms_breaker_rating) {\n      onChange('sms_breaker_rating', 'MLO');\n    }\n  }, []);\n\n  const loadManufacturers = async () => {\n    setLoadingMakes(true);\n    try {\n      const response = await getSMSManufacturers();\n      // Add \"No SMS\" option\n      setManufacturers(['No SMS', ...(response.data || [])]);\n    } catch (error) {\n      logger.error('Equipment', 'Failed to load SMS manufacturers:', error);\n    } finally {\n      setLoadingMakes(false);\n    }\n  };\n\n  const loadModels = async (manufacturer) => {\n    if (manufacturer === 'No SMS') {\n      setModels([]);\n      setSelectedModelData(null);\n      return;\n    }\n\n    setLoadingModels(true);\n    try {\n      const response = await getSMSModels(manufacturer);\n      const modelsData = response.data || [];\n      setModels(modelsData);\n\n      // If current model is selected, find its data\n      if (formData.sms_model) {\n        const modelData = modelsData.find(m => m.model_number === formData.sms_model);\n        if (modelData) {\n          setSelectedModelData(modelData);\n          // Store model ID for future reference\n          if (modelData.id) {\n            onChange('sms_model_id', modelData.id);\n          }\n        }\n      }\n    } catch (error) {\n      logger.error('Equipment', 'Failed to load SMS models:', error);\n    } finally {\n      setLoadingModels(false);\n    }\n  };\n\n  const handleToggle = (isNew) => {\n    onChange('sms_isnew', isNew);\n  };\n\n  const handleManufacturerChange = (e) => {\n    const value = e.target.value;\n    onChange('sms_make', value);\n    onChange('sms_model', ''); // Clear model when manufacturer changes\n    setSelectedModelData(null);\n\n    // Clear breaker rating if \"No SMS\" is selected\n    if (value === 'No SMS') {\n      onChange('sms_breaker_rating', '');\n    }\n  };\n\n  const handleModelChange = (e) => {\n    const newModel = e.target.value;\n    onChange('sms_model', newModel);\n\n    // Find model data\n    const modelData = models.find(m => m.model_number === newModel);\n    if (modelData) {\n      setSelectedModelData(modelData);\n      // Store model ID for future reference\n      if (modelData.id) {\n        onChange('sms_model_id', modelData.id);\n      }\n    }\n  };\n\n  const handleClearBreaker = (field, setEditState) => {\n    onChange(field, '');\n    setEditState(false);\n  };\n\n  const isNoSMS = formData.sms_make === 'No SMS';\n\n  return (\n    <>\n      <Toggle\n        isNew={formData.sms_isnew !== false}\n        onToggle={handleToggle}\n      />\n\n      <div className={styles.formRow}>\n        <div className={styles.formGroup}>\n          <label className={styles.label}>Manufacturer</label>\n          <select\n            value={formData.sms_make || ''}\n            onChange={handleManufacturerChange}\n            className={`${styles.select} ${formData.sms_make ? componentStyles.selectFilled : componentStyles.selectEmpty}`}\n            disabled={loadingMakes}\n          >\n            <option value=\"\">{loadingMakes ? 'Loading...' : 'Select manufacturer...'}</option>\n            {manufacturers.map((manufacturer) => (\n              <option key={manufacturer} value={manufacturer}>\n                {manufacturer}\n              </option>\n            ))}\n          </select>\n        </div>\n\n        <div className={styles.formGroup}>\n          <label className={styles.label}>Model</label>\n          <select\n            value={formData.sms_model || ''}\n            onChange={handleModelChange}\n            className={`${styles.select} ${formData.sms_model ? componentStyles.selectFilled : componentStyles.selectEmpty}`}\n            disabled={!formData.sms_make || isNoSMS || loadingModels}\n          >\n            <option value=\"\">\n              {loadingModels ? 'Loading...' : formData.sms_make ? (isNoSMS ? 'N/A' : 'Select model') : 'Select manufacturer'}\n            </option>\n            {models.map((model) => (\n              <option key={model.model_number} value={model.model_number}>\n                {model.model_number}\n              </option>\n            ))}\n          </select>\n        </div>\n      </div>\n\n      {/* RSD Toggle */}\n      {!isNoSMS && (\n        <div className={styles.formGroup}>\n          <label className={styles.label}>RSD (Rapid Shutdown)</label>\n          <div className={componentStyles.rsdButtonGroup}>\n            <button\n              type=\"button\"\n              className={`${styles.inactiveButton} ${formData.sms_rsd_enabled ? styles.activeButton : ''} ${componentStyles.rsdButton}`}\n              onClick={() => onChange('sms_rsd_enabled', true)}\n            >\n              Yes\n            </button>\n            <button\n              type=\"button\"\n              className={`${styles.inactiveButton} ${formData.sms_rsd_enabled === false ? styles.activeButton : ''} ${componentStyles.rsdButton}`}\n              onClick={() => onChange('sms_rsd_enabled', false)}\n            >\n              No\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Main Breaker - defaults to MLO */}\n      {!isNoSMS && (\n        <div className={styles.formGroup}>\n          <label className={styles.label}>Main Breaker</label>\n          <select\n            value={formData.sms_breaker_rating || 'MLO'}\n            onChange={(e) => onChange('sms_breaker_rating', e.target.value)}\n            className={`${styles.select} ${formData.sms_breaker_rating ? componentStyles.selectFilled : componentStyles.selectEmpty}`}\n          >\n            <option value=\"MLO\">MLO</option>\n            {breakerOptions.map((rating) => (\n              <option key={rating} value={rating}>\n                {rating}\n              </option>\n            ))}\n          </select>\n        </div>\n      )}\n\n      {/* PV Breaker Override */}\n      {!isNoSMS && (\n        <div className={styles.formGroup}>\n          <div className={componentStyles.breakerHeader}>\n            <label className={styles.label}>PV Breaker</label>\n            <button\n              type=\"button\"\n              onClick={() => editPVBreaker ? handleClearBreaker('sms_pv_breaker_rating_override', setEditPVBreaker) : setEditPVBreaker(true)}\n              className={editPVBreaker ? componentStyles.clearButton : componentStyles.editButton}\n            >\n              {editPVBreaker ? 'Clear' : 'Edit'}\n            </button>\n          </div>\n          {!editPVBreaker ? (\n            <div className={componentStyles.breakerDefaultText}>\n              A minimum PV Breaker will be added in the SMS PV input and will be rated to protect the total PV max continuous output current.\n            </div>\n          ) : (\n            <select\n              value={formData.sms_pv_breaker_rating_override || ''}\n              onChange={(e) => onChange('sms_pv_breaker_rating_override', e.target.value)}\n              className={`${styles.select} ${formData.sms_pv_breaker_rating_override ? componentStyles.selectFilled : componentStyles.selectEmpty}`}\n            >\n              <option value=\"\">Select rating...</option>\n              {breakerOptions.map((rating) => (\n                <option key={rating} value={rating}>\n                  {rating}\n                </option>\n              ))}\n            </select>\n          )}\n        </div>\n      )}\n\n      {/* ESS Breaker Override */}\n      {!isNoSMS && (\n        <div className={styles.formGroup}>\n          <div className={componentStyles.breakerHeader}>\n            <label className={styles.label}>ESS Breaker</label>\n            <button\n              type=\"button\"\n              onClick={() => editESSBreaker ? handleClearBreaker('sms_ess_breaker_rating_override', setEditESSBreaker) : setEditESSBreaker(true)}\n              className={editESSBreaker ? componentStyles.clearButton : componentStyles.editButton}\n            >\n              {editESSBreaker ? 'Clear' : 'Edit'}\n            </button>\n          </div>\n          {!editESSBreaker ? (\n            <div className={componentStyles.breakerDefaultText}>\n              A minimum Battery Breaker will be added in the SMS Battery input and will be rated to protect the total Battery max continuous output current.\n            </div>\n          ) : (\n            <select\n              value={formData.sms_ess_breaker_rating_override || ''}\n              onChange={(e) => onChange('sms_ess_breaker_rating_override', e.target.value)}\n              className={`${styles.select} ${formData.sms_ess_breaker_rating_override ? componentStyles.selectFilled : componentStyles.selectEmpty}`}\n            >\n              <option value=\"\">Select rating...</option>\n              {breakerOptions.map((rating) => (\n                <option key={rating} value={rating}>\n                  {rating}\n                </option>\n              ))}\n            </select>\n          )}\n        </div>\n      )}\n\n      {/* Tie-in Breaker Override */}\n      {!isNoSMS && (\n        <div className={styles.formGroup}>\n          <div className={componentStyles.breakerHeader}>\n            <label className={styles.label}>Tie-in Breaker</label>\n            <button\n              type=\"button\"\n              onClick={() => editTieInBreaker ? handleClearBreaker('sms_tie_in_breaker_rating_override', setEditTieInBreaker) : setEditTieInBreaker(true)}\n              className={editTieInBreaker ? componentStyles.clearButton : componentStyles.editButton}\n            >\n              {editTieInBreaker ? 'Clear' : 'Edit'}\n            </button>\n          </div>\n          {!editTieInBreaker ? (\n            <div className={componentStyles.breakerDefaultText}>\n              A minimum SMS Tie-in Breaker will be added in Main Panel (A). The breaker will auto size based on backup option selected.\n            </div>\n          ) : (\n            <select\n              value={formData.sms_tie_in_breaker_rating_override || ''}\n              onChange={(e) => onChange('sms_tie_in_breaker_rating_override', e.target.value)}\n              className={`${styles.select} ${formData.sms_tie_in_breaker_rating_override ? componentStyles.selectFilled : componentStyles.selectEmpty}`}\n            >\n              <option value=\"\">Select rating...</option>\n              {breakerOptions.map((rating) => (\n                <option key={rating} value={rating}>\n                  {rating}\n                </option>\n              ))}\n            </select>\n          )}\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default SMSSection;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\structural\\MountingHardwareSection.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'FormFieldRow' is defined but never used.","line":2,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":36},{"ruleId":"no-unused-vars","severity":1,"message":"'loadingMakes' is assigned a value but never used.","line":23,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":22},{"ruleId":"no-unused-vars","severity":1,"message":"'loadingModels' is assigned a value but never used.","line":24,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useMemo, useState, useEffect } from 'react';\nimport { EquipmentRow, FormFieldRow, TableDropdown, TableRowButton } from '../../ui';\nimport { getMountingHardwareManufacturers, getMountingHardwareModels } from '../../../services/equipmentService';\nimport logger from '../../../services/devLogger';\n\n/**\n * Mounting Hardware Section\n * Handles attachment hardware (make and model)\n */\nconst MountingHardwareSection = ({ formData, onChange, hardwareType = 'A', onClear }) => {\n  const prefix = hardwareType === 'A' ? 'rta' : 'rtb';\n\n  const attachMake = formData[`${prefix}_attachment_make`] || '';\n  const attachModel = formData[`${prefix}_attachment_model`] || '';\n\n  // Local state\n  const [isNew, setIsNew] = useState(false);\n  const [isExpanded, setIsExpanded] = useState(false);\n\n  // Database state\n  const [manufacturers, setManufacturers] = useState([]);\n  const [models, setModels] = useState([]);\n  const [loadingMakes, setLoadingMakes] = useState(false);\n  const [loadingModels, setLoadingModels] = useState(false);\n\n  // Load manufacturers on mount\n  useEffect(() => {\n    loadManufacturers();\n  }, []);\n\n  // Load models when manufacturer changes\n  useEffect(() => {\n    if (attachMake) {\n      loadModels(attachMake);\n    } else {\n      setModels([]);\n    }\n  }, [attachMake]);\n\n  const loadManufacturers = async () => {\n    setLoadingMakes(true);\n    try {\n      const response = await getMountingHardwareManufacturers();\n      const manufacturersList = response?.data || [];\n      setManufacturers(manufacturersList.map(m => ({ label: m, value: m })));\n      logger.debug('MountingHardware', `Loaded ${manufacturersList.length} mounting hardware manufacturers`);\n    } catch (error) {\n      logger.error('MountingHardware', 'Failed to load mounting hardware manufacturers:', error);\n      setManufacturers([]);\n    } finally {\n      setLoadingMakes(false);\n    }\n  };\n\n  const loadModels = async (manufacturer) => {\n    setLoadingModels(true);\n    try {\n      const response = await getMountingHardwareModels(manufacturer);\n      const modelsList = response?.data || [];\n      setModels(modelsList.map(m => {\n        // Handle both object format {model: \"...\"} and string format\n        const modelValue = typeof m === 'string' ? m : (m.model || m.model_number || '');\n        return {\n          label: modelValue,\n          value: modelValue\n        };\n      }));\n      logger.debug('MountingHardware', `Loaded ${modelsList.length} models for ${manufacturer}`);\n    } catch (error) {\n      logger.error('MountingHardware', `Failed to load models for ${manufacturer}:`, error);\n      setModels([]);\n    } finally {\n      setLoadingModels(false);\n    }\n  };\n\n  // Get attachment makes from database\n  const attachMakes = useMemo(() => manufacturers, [manufacturers]);\n\n  // Get attachment models from database\n  const attachModels = useMemo(() => models, [models]);\n\n  const handleAttachMakeChange = (value) => {\n    onChange(`${prefix}_attachment_make`, value);\n    // Clear model when make changes\n    onChange(`${prefix}_attachment_model`, '');\n  };\n\n  const isComplete = !!(attachMake && attachModel);\n  const subtitle = attachMake && attachModel ? `${attachMake} ${attachModel}` : undefined;\n\n  return (\n    <div style={{ marginBottom: 'var(--spacing)' }}>\n      <EquipmentRow\n        title={`Attachment (${hardwareType})`}\n        subtitle={subtitle}\n        isComplete={isComplete}\n        expanded={isExpanded}\n        onToggle={() => setIsExpanded(!isExpanded)}\n        onDelete={onClear}\n      >\n        {/* New/Existing Toggle - No label, left-justified */}\n        <div style={{\n          display: 'flex',\n          gap: 'var(--spacing-xs)',\n          padding: 'var(--spacing-tight) var(--spacing)',\n          borderBottom: '1px solid var(--border-subtle)',\n        }}>\n          <TableRowButton\n            label=\"New\"\n            variant=\"outline\"\n            active={isNew}\n            onClick={() => setIsNew(true)}\n          />\n          <TableRowButton\n            label=\"Existing\"\n            variant=\"outline\"\n            active={!isNew}\n            onClick={() => setIsNew(false)}\n          />\n        </div>\n\n        {/* Attachment Make and Model */}\n        <TableDropdown\n          label=\"Attachment Make\"\n          value={attachMake}\n          onChange={handleAttachMakeChange}\n          options={attachMakes}\n          placeholder=\"Select make...\"\n        />\n\n        <TableDropdown\n          label=\"Attachment Model\"\n          value={attachModel}\n          onChange={(value) => onChange(`${prefix}_attachment_model`, value)}\n          options={attachModels}\n          placeholder={attachMake ? \"Select model...\" : \"Select make first\"}\n          disabled={!attachMake}\n        />\n      </EquipmentRow>\n    </div>\n  );\n};\n\nexport default MountingHardwareSection;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\structural\\MountingPlaneSection.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\structural\\MountingPlanesContainer.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\structural\\RailsSection.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'FormFieldRow' is defined but never used.","line":2,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":36},{"ruleId":"no-unused-vars","severity":1,"message":"'loadingMakes' is assigned a value but never used.","line":24,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":22},{"ruleId":"no-unused-vars","severity":1,"message":"'loadingModels' is assigned a value but never used.","line":25,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useMemo, useState, useEffect } from 'react';\nimport { EquipmentRow, FormFieldRow, TableDropdown, TableRowButton } from '../../ui';\nimport { getRailManufacturers, getRailModels } from '../../../services/equipmentService';\nimport logger from '../../../services/devLogger';\n\n/**\n * Rails Section\n * Handles rail configuration (make and model)\n */\nconst RailsSection = ({ formData, onChange, railType = 'A', onClear }) => {\n  const prefix = railType === 'A' ? 'rta' : 'rtb';\n\n  const railMake = formData[`${prefix}_rail_make`] || '';\n  const railModel = formData[`${prefix}_rail_model`] || '';\n\n  // Local state for New/Existing and Rail-less toggles\n  const [isNewRail, setIsNewRail] = useState(false);\n  const [isRailless, setIsRailless] = useState(false);\n  const [isExpanded, setIsExpanded] = useState(false);\n\n  // Database state\n  const [manufacturers, setManufacturers] = useState([]);\n  const [models, setModels] = useState([]);\n  const [loadingMakes, setLoadingMakes] = useState(false);\n  const [loadingModels, setLoadingModels] = useState(false);\n\n  // Load manufacturers on mount\n  useEffect(() => {\n    loadManufacturers();\n  }, []);\n\n  // Load models when manufacturer changes\n  useEffect(() => {\n    if (railMake) {\n      loadModels(railMake);\n    } else {\n      setModels([]);\n    }\n  }, [railMake]);\n\n  const loadManufacturers = async () => {\n    setLoadingMakes(true);\n    try {\n      const response = await getRailManufacturers();\n      const manufacturersList = response?.data || [];\n      setManufacturers(manufacturersList.map(m => ({ label: m, value: m })));\n      logger.debug('Rails', `Loaded ${manufacturersList.length} rail manufacturers`);\n    } catch (error) {\n      logger.error('Rails', 'Failed to load rail manufacturers:', error);\n      setManufacturers([]);\n    } finally {\n      setLoadingMakes(false);\n    }\n  };\n\n  const loadModels = async (manufacturer) => {\n    setLoadingModels(true);\n    try {\n      const response = await getRailModels(manufacturer);\n      const modelsList = response?.data || [];\n      setModels(modelsList.map(m => {\n        // Handle both object format {model: \"...\"} and string format\n        const modelValue = typeof m === 'string' ? m : (m.model || m.model_number || '');\n        return {\n          label: modelValue,\n          value: modelValue\n        };\n      }));\n      logger.debug('Rails', `Loaded ${modelsList.length} models for ${manufacturer}`);\n    } catch (error) {\n      logger.error('Rails', `Failed to load models for ${manufacturer}:`, error);\n      setModels([]);\n    } finally {\n      setLoadingModels(false);\n    }\n  };\n\n  // Get rail makes from database\n  const railMakes = useMemo(() => manufacturers, [manufacturers]);\n\n  // Get rail models from database\n  const railModels = useMemo(() => models, [models]);\n\n  const handleRailMakeChange = (value) => {\n    onChange(`${prefix}_rail_make`, value);\n    // Clear model when make changes\n    onChange(`${prefix}_rail_model`, '');\n  };\n\n  const isComplete = !!(railMake && railModel) || isRailless;\n  const subtitle = railMake && railModel ? `${railMake} ${railModel}` : isRailless ? 'Rail-less' : undefined;\n\n  return (\n    <div style={{ marginBottom: 'var(--spacing)' }}>\n      <EquipmentRow\n        title={`Rail (${railType})`}\n        subtitle={subtitle}\n        isComplete={isComplete}\n        expanded={isExpanded}\n        onToggle={() => setIsExpanded(!isExpanded)}\n        onDelete={onClear}\n      >\n        {/* New/Existing Toggle and Rail-less - No label, left-justified */}\n        <div style={{\n          display: 'flex',\n          gap: 'var(--spacing-xs)',\n          padding: 'var(--spacing-tight) var(--spacing)',\n          borderBottom: '1px solid var(--border-subtle)',\n        }}>\n          <TableRowButton\n            label=\"New\"\n            variant=\"outline\"\n            active={isNewRail && !isRailless}\n            onClick={() => {\n              setIsNewRail(true);\n              setIsRailless(false);\n            }}\n          />\n          <TableRowButton\n            label=\"Existing\"\n            variant=\"outline\"\n            active={!isNewRail && !isRailless}\n            onClick={() => {\n              setIsNewRail(false);\n              setIsRailless(false);\n            }}\n          />\n          <TableRowButton\n            label=\"Rail-less\"\n            variant=\"outline\"\n            active={isRailless}\n            onClick={() => setIsRailless(!isRailless)}\n          />\n        </div>\n\n        {/* Rail Make and Model - Hidden when Rail-less is active */}\n        {!isRailless && (\n          <>\n            <TableDropdown\n              label=\"Rail Make\"\n              value={railMake}\n              onChange={handleRailMakeChange}\n              options={railMakes}\n              placeholder=\"Select make...\"\n            />\n\n            <TableDropdown\n              label=\"Rail Model\"\n              value={railModel}\n              onChange={(value) => onChange(`${prefix}_rail_model`, value)}\n              options={railModels}\n              placeholder={railMake ? \"Select model...\" : \"Select make first\"}\n              disabled={!railMake}\n            />\n          </>\n        )}\n      </EquipmentRow>\n    </div>\n  );\n};\n\nexport default RailsSection;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\structural\\RoofContainer.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\structural\\RoofingSection.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'styles' is defined but never used.","line":4,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":14},{"ruleId":"no-unused-vars","severity":1,"message":"'equipStyles' is defined but never used.","line":5,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'formStyles' is defined but never used.","line":6,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { ROOFING_MATERIAL_TYPES, FRAMING_MEMBER_SIZES, FRAMING_MEMBER_SPACINGS } from '../../../utils/constants';\nimport { EquipmentRow, FormFieldRow, TableDropdown, TableRowButton } from '../../ui';\nimport styles from '../../../styles/ProjectAdd.module.css';\nimport equipStyles from '../EquipmentForm.module.css';\nimport formStyles from '../../../styles/FormSections.module.css';\n\n/**\n * Roofing Section\n * Handles both Roofing Type A and Roofing Type B\n */\nconst RoofingSection = ({ formData, onChange, roofType = 'A', onCancel, onClear }) => {\n  const [isExpanded, setIsExpanded] = useState(false);\n  const prefix = roofType === 'A' ? 'rta' : 'rtb';\n\n  const roofingMaterial = formData[`${prefix}_roofing_material`] || '';\n  const framingSize = formData[`${prefix}_framing_size`] || '';\n  const roofArea = formData[`st_roof_${roofType.toLowerCase()}_area_sqft`] || '';\n  const framingSpacing = formData[`${prefix}_framing_spacing`] || '';\n  const framingType = formData[`st_roof_${roofType.toLowerCase()}_framing_type`] || '';\n  const isGroundMount = formData[`${prefix}_ground_mount`] === true;\n\n  const isComplete = isGroundMount || !!(roofingMaterial && framingSize && framingSpacing && framingType);\n\n  // Handler for Ground Mount toggle\n  const handleGroundMountToggle = () => {\n    onChange(`${prefix}_ground_mount`, !isGroundMount);\n  };\n\n  // Helper to check if Roofing B exists\n  const hasRoofingB = () => {\n    return !!(formData.rtb_roofing_material);\n  };\n\n  // Wrapper to save roofing fields and auto-set mounting plane roof types\n  const handleFieldChange = (fieldName, value) => {\n    onChange(fieldName, value);\n\n    // Only auto-set mounting planes when changing Roofing A material\n    // AND there is no Roofing B configured\n    if (fieldName === 'rta_roofing_material' && !hasRoofingB()) {\n      // Auto-set all mounting planes to roof_type \"A\" when only Roofing A exists\n      for (let i = 1; i <= 10; i++) {\n        onChange(`mp${i}_roof_type`, 'A');\n      }\n    }\n  };\n\n  // Build subtitle with key details\n  const subtitleParts = [];\n  if (!isGroundMount) {\n    if (roofArea) subtitleParts.push(`${roofArea} sq ft`);\n    if (roofingMaterial) subtitleParts.push(roofingMaterial);\n  }\n  const subtitle = subtitleParts.join(' | ') || undefined;\n\n  // Title changes to \"Ground Mount\" when active\n  const title = isGroundMount ? `Ground Mount` : `Roofing (${roofType})`;\n\n  return (\n    <div style={{\n      marginBottom: 'var(--spacing)'\n    }}>\n      <EquipmentRow\n        title={title}\n        subtitle={subtitle}\n        isComplete={isComplete}\n        expanded={isExpanded}\n        onToggle={() => setIsExpanded(!isExpanded)}\n        onDelete={onClear}\n      >\n      {/* Ground Mount Button - Left aligned */}\n      <div style={{\n        display: 'flex',\n        justifyContent: 'flex-start',\n        padding: 'var(--spacing-tight) var(--spacing)',\n        borderBottom: '1px solid var(--border-subtle)',\n      }}>\n        <TableRowButton\n          label=\"Ground Mount\"\n          variant=\"outline\"\n          active={isGroundMount}\n          onClick={handleGroundMountToggle}\n        />\n      </div>\n\n      {/* Roof/Framing Fields - Only show when NOT Ground Mount */}\n      {!isGroundMount && (\n        <>\n          {/* Roof Area - Only show for Roofing (A) */}\n          {roofType === 'A' && (\n            <FormFieldRow label=\"Roof Area (Sq Ft)\">\n              <input\n                type=\"number\"\n                value={roofArea}\n                onChange={(e) => handleFieldChange(`st_roof_${roofType.toLowerCase()}_area_sqft`, e.target.value)}\n                placeholder=\"Enter area...\"\n              />\n            </FormFieldRow>\n          )}\n\n          {/* Roofing Material */}\n          <TableDropdown\n            label=\"Roofing Material\"\n            value={roofingMaterial}\n            onChange={(value) => handleFieldChange(`${prefix}_roofing_material`, value)}\n            options={ROOFING_MATERIAL_TYPES}\n            placeholder=\"Select material...\"\n          />\n\n          {/* Framing Size */}\n          <TableDropdown\n            label=\"Framing Size\"\n            value={framingSize}\n            onChange={(value) => handleFieldChange(`${prefix}_framing_size`, value)}\n            options={FRAMING_MEMBER_SIZES}\n            placeholder=\"Select size...\"\n          />\n\n          {/* Framing Spacing */}\n          <TableDropdown\n            label=\"Framing Spacing\"\n            value={framingSpacing}\n            onChange={(value) => handleFieldChange(`${prefix}_framing_spacing`, value)}\n            options={FRAMING_MEMBER_SPACINGS}\n            placeholder=\"Select spacing...\"\n          />\n\n          {/* Framing Type */}\n          <FormFieldRow label=\"Framing Type\" noBorder>\n            <TableRowButton\n              label=\"Truss\"\n              variant=\"outline\"\n              active={framingType === 'Truss'}\n              onClick={() => handleFieldChange(`st_roof_${roofType.toLowerCase()}_framing_type`, 'Truss')}\n            />\n            <TableRowButton\n              label=\"Rafter\"\n              variant=\"outline\"\n              active={framingType === 'Rafter'}\n              onClick={() => handleFieldChange(`st_roof_${roofType.toLowerCase()}_framing_type`, 'Rafter')}\n            />\n          </FormFieldRow>\n        </>\n      )}\n      </EquipmentRow>\n    </div>\n  );\n};\n\nexport default RoofingSection;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\submit\\OrderContainer.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\project\\survey\\SiteSurveyReportPanel.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'ErrorState' is defined but never used.","line":6,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":44},{"ruleId":"no-unused-vars","severity":1,"message":"'isPrinting' is assigned a value but never used.","line":24,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":20},{"ruleId":"no-unused-vars","severity":1,"message":"'setTotalPages' is assigned a value but never used.","line":26,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":35},{"ruleId":"no-unused-vars","severity":1,"message":"'equipmentPhotos' is assigned a value but never used.","line":209,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":209,"endColumn":24},{"ruleId":"no-unused-vars","severity":1,"message":"'safeSystems' is assigned a value but never used.","line":246,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":246,"endColumn":22},{"ruleId":"no-unused-vars","severity":1,"message":"'safePhotos' is assigned a value but never used.","line":248,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":248,"endColumn":21},{"ruleId":"no-unused-vars","severity":1,"message":"'totalInverters' is assigned a value but never used.","line":253,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":253,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// src/components/project/survey/SiteSurveyReportPanel.js\n\nimport React, { useRef, useState, useCallback, useEffect } from 'react';\nimport { useReactToPrint } from 'react-to-print';\nimport { useSurveyReportData } from '../../../hooks/useSurveyReportData';\nimport { LoadingSpinner, Button, ErrorState } from '../../ui';\nimport styles from '../../../styles/SiteSurveyReport.module.css';\n\nconsole.log('ðŸ”¥ðŸ”¥ðŸ”¥ SiteSurveyReportPanel MODULE LOADED');\n\n/**\n * Site Survey Report Panel\n * Generates a professional 6-page printable report for solar site surveys\n *\n * @param {string} projectUuid - Project UUID (required)\n * @param {Object} projectData - Optional project data for customer/site fallback\n */\nconst SiteSurveyReportPanel = ({ projectUuid, projectData = null }) => {\n  console.log('ðŸ”¥ SiteSurveyReportPanel MOUNTED', { projectUuid, projectData });\n\n  const printRef = useRef(null);\n  const containerRef = useRef(null);\n  const pageRefs = useRef([]);\n  const [isPrinting, setIsPrinting] = useState(false);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [totalPages, setTotalPages] = useState(6);\n  const [isFullscreen, setIsFullscreen] = useState(false);\n  const [fullscreenScale, setFullscreenScale] = useState(1);\n\n  // Fetch all report data\n  const { loading, error, data, refresh } = useSurveyReportData(projectUuid, projectData);\n\n  console.log('ðŸ”¥ SiteSurveyReportPanel DATA STATE:', { loading, error, hasData: !!data });\n\n  // Fullscreen controls\n  const handleToggleFullscreen = useCallback(() => {\n    setIsFullscreen(prev => !prev);\n  }, []);\n\n  const handleCloseFullscreen = useCallback(() => {\n    setIsFullscreen(false);\n  }, []);\n\n  // Calculate scale for fullscreen mode\n  const calculateFullscreenScale = useCallback(() => {\n    if (typeof window === 'undefined') return 1;\n    const viewportHeight = window.innerHeight - 120; // Account for toolbar and padding\n    const pageHeight = 1056; // 11in at 96 DPI\n    return Math.min(viewportHeight / pageHeight, 1.2); // Max 120% scale\n  }, []);\n\n  // Page navigation\n  const goToPage = useCallback((pageNumber) => {\n    const pageIndex = pageNumber - 1;\n    if (pageRefs.current[pageIndex] && containerRef.current) {\n      pageRefs.current[pageIndex].scrollIntoView({ behavior: 'smooth', block: 'start' });\n      setCurrentPage(pageNumber);\n    }\n  }, []);\n\n  const handlePreviousPage = useCallback(() => {\n    if (currentPage > 1) {\n      goToPage(currentPage - 1);\n    }\n  }, [currentPage, goToPage]);\n\n  const handleNextPage = useCallback(() => {\n    if (currentPage < totalPages) {\n      goToPage(currentPage + 1);\n    }\n  }, [currentPage, totalPages, goToPage]);\n\n  const handlePageInput = useCallback((e) => {\n    const value = parseInt(e.target.value, 10);\n    if (!isNaN(value) && value >= 1 && value <= totalPages) {\n      if (isFullscreen) {\n        setCurrentPage(value);\n      } else {\n        goToPage(value);\n      }\n    }\n  }, [totalPages, goToPage, isFullscreen]);\n\n  // Track current page using Intersection Observer (only in normal mode)\n  useEffect(() => {\n    if (isFullscreen || !containerRef.current || pageRefs.current.length === 0) return;\n\n    const observer = new IntersectionObserver(\n      (entries) => {\n        entries.forEach((entry) => {\n          if (entry.isIntersecting && entry.intersectionRatio > 0.5) {\n            const pageIndex = pageRefs.current.indexOf(entry.target);\n            if (pageIndex !== -1) {\n              setCurrentPage(pageIndex + 1);\n            }\n          }\n        });\n      },\n      {\n        root: containerRef.current,\n        threshold: [0.5],\n      }\n    );\n\n    pageRefs.current.forEach((page) => {\n      if (page) observer.observe(page);\n    });\n\n    return () => {\n      observer.disconnect();\n    };\n  }, [data, isFullscreen]);\n\n  // Keyboard navigation\n  useEffect(() => {\n    const handleKeyDown = (e) => {\n      if (e.key === 'Escape' && isFullscreen) {\n        handleCloseFullscreen();\n      } else if (isFullscreen) {\n        if (e.key === 'ArrowLeft') {\n          handlePreviousPage();\n        } else if (e.key === 'ArrowRight') {\n          handleNextPage();\n        }\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [isFullscreen, handleCloseFullscreen, handlePreviousPage, handleNextPage]);\n\n  // Update fullscreen scale on window resize\n  useEffect(() => {\n    if (!isFullscreen) return;\n\n    const updateScale = () => {\n      setFullscreenScale(calculateFullscreenScale());\n    };\n\n    updateScale();\n    window.addEventListener('resize', updateScale);\n    return () => window.removeEventListener('resize', updateScale);\n  }, [isFullscreen, calculateFullscreenScale]);\n\n  // Setup print handler\n  const handlePrint = useReactToPrint({\n    content: () => printRef.current,\n    documentTitle: data\n      ? `Site_Survey_Report_${data.customer.lastName || 'Customer'}_${data.site.address || 'Site'}`\n          .replace(/\\s+/g, '_')\n          .replace(/[^\\w-]/g, '')\n      : 'Site_Survey_Report',\n    onBeforeGetContent: () => {\n      setIsPrinting(true);\n      return Promise.resolve();\n    },\n    onAfterPrint: () => {\n      setIsPrinting(false);\n    },\n  });\n\n  // Loading state\n  if (loading) {\n    return (\n      <div className={styles.loadingContainer}>\n        <LoadingSpinner />\n        <p className={styles.loadingText}>Loading report data...</p>\n      </div>\n    );\n  }\n\n  // Error state\n  if (error) {\n    return (\n      <div className={styles.errorContainer}>\n        <div className={styles.errorIcon}>âš ï¸</div>\n        <h3 className={styles.errorTitle}>Failed to Load Report</h3>\n        <p className={styles.errorText}>{error}</p>\n        <Button onClick={refresh} className={styles.refreshButton}>\n          Try Again\n        </Button>\n      </div>\n    );\n  }\n\n  // Empty state\n  if (!data) {\n    return (\n      <div className={styles.emptyContainer}>\n        <div className={styles.emptyIcon}>ðŸ“„</div>\n        <h3 className={styles.emptyTitle}>No Survey Data</h3>\n        <p className={styles.emptyText}>\n          Survey data will appear here once equipment and site information has been entered.\n        </p>\n      </div>\n    );\n  }\n\n  const { company, project, customer, site, electrical, systems, structural, notes, photos } = data;\n\n  // Calculate totals\n  const totalSystemSize = systems.reduce((sum, sys) => sum + parseFloat(sys.totalSystemSize || 0), 0).toFixed(2);\n  const totalPanels = systems.reduce((sum, sys) => sum + parseInt(sys.panels.qty || 0, 10), 0);\n  const totalInverters = systems.reduce((sum, sys) => sum + parseInt(sys.inverter.qty || 0, 10), 0);\n\n  // Group photos by section\n  const propertyPhotos = photos.property || [];\n  const electricalPhotos = photos.electrical || [];\n  const equipmentPhotos = photos.equipment || [];\n  const roofPhotos = photos.roof || [];\n\n  // Status label mapping\n  const STATUS_LABELS = {\n    0: 'New Project',\n    1: 'Site Survey',\n    2: 'Design',\n    3: 'Permitting',\n    4: 'Installation',\n    5: 'Inspection',\n    6: 'Complete',\n  };\n\n  const statusLabel = typeof project.status === 'number'\n    ? STATUS_LABELS[project.status] || 'Site Survey'\n    : project.status || 'Site Survey';\n\n  // Create fullscreen icon SVG\n  const FullscreenIcon = () => (\n    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n      <path d=\"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3\" />\n    </svg>\n  );\n\n  // Helper function to render a specific page for fullscreen mode\n  const renderPage = (pageNum) => {\n    if (!data) return null;\n\n    const { company, customer, site, project, electrical, systems, notes, photos } = data;\n\n    // Ensure we have default objects to prevent undefined errors\n    const safeCompany = company || {};\n    const safeCustomer = customer || {};\n    const safeSite = site || {};\n    const safeProject = project || {};\n    const safeElectrical = electrical || { mainPanel: {}, mountingPlanes: [] };\n    const safeSystems = systems || [];\n    const safeNotes = notes || [];\n    const safePhotos = photos || {};\n\n    // Calculate totals from systems array\n    const totalSystemSize = systems?.reduce((sum, sys) => sum + parseFloat(sys.totalSystemSize || 0), 0).toFixed(2) || '0.00';\n    const totalPanels = systems?.reduce((sum, sys) => sum + parseInt(sys.panels?.qty || 0, 10), 0) || 0;\n    const totalInverters = systems?.reduce((sum, sys) => sum + parseInt(sys.inverter?.qty || 0, 10), 0) || 0;\n\n    // Get first system for equipment details\n    const firstSystem = systems?.[0] || {};\n    const equipment = {\n      solar: {\n        systemSize: totalSystemSize,\n        annualProduction: firstSystem.annualProduction || 'TBD',\n        panelCount: totalPanels,\n        panelManufacturer: firstSystem.panels?.manufacturer || 'TBD',\n        panelModel: firstSystem.panels?.model || '',\n        panelWattage: firstSystem.panels?.watts || 'TBD',\n      },\n      inverter: {\n        type: firstSystem.inverter?.type || 'TBD',\n        manufacturer: firstSystem.inverter?.manufacturer || 'TBD',\n        model: firstSystem.inverter?.model || 'TBD',\n      }\n    };\n\n    // Group photos by section\n    const photosBySection = {\n      property: photos?.property || [],\n      electrical: photos?.electrical || [],\n      equipment: photos?.equipment || [],\n      roof: photos?.roof || [],\n    };\n    const STATUS_LABELS = {\n      0: 'New Project',\n      1: 'Site Survey',\n      2: 'Design',\n      3: 'Permitting',\n      4: 'Installation',\n      5: 'Inspection',\n      6: 'Complete',\n    };\n    const statusLabel = typeof safeProject.status === 'number'\n      ? STATUS_LABELS[safeProject.status] || 'Site Survey'\n      : safeProject.status || 'Site Survey';\n\n    switch (pageNum) {\n      case 1:\n        return (\n          <div className={styles.page} id={`fullscreen-page-${pageNum}`}>\n            <div className={styles.coverPage}>\n              <div className={styles.coverHeader}>\n                <div>\n                  {safeCompany.logo ? (\n                    <img src={safeCompany.logo} alt={safeCompany.name} className={styles.coverLogo} />\n                  ) : (\n                    <div className={styles.coverCompanyName}>{safeCompany.name || 'Solar Company'}</div>\n                  )}\n                </div>\n                <div className={styles.coverCompanyInfo}>\n                  {safeCompany.address && <div>{safeCompany.address}</div>}\n                  {(safeCompany.city || safeCompany.state) && (\n                    <div>{safeCompany.city}{safeCompany.city && safeCompany.state && ', '}{safeCompany.state} {safeCompany.zip}</div>\n                  )}\n                  {safeCompany.phone && <div>Phone: {safeCompany.phone}</div>}\n                  {safeCompany.email && <div>Email: {safeCompany.email}</div>}\n                  {safeCompany.license && <div>License: {safeCompany.license}</div>}\n                </div>\n              </div>\n              <div className={styles.coverMain}>\n                <h1 className={styles.coverTitle}>Site Survey Report</h1>\n                <div className={styles.coverSubtitle}>Solar Installation Assessment</div>\n                <div className={styles.coverAddress}>{formatAddress(safeSite)}</div>\n                <div className={styles.coverCityState}>{safeSite.city}{safeSite.city && safeSite.state && ', '}{safeSite.state} {safeSite.zip}</div>\n                {(safeCustomer.firstName || safeCustomer.lastName) && (\n                  <div className={styles.coverCustomer}>Prepared for: {safeCustomer.firstName} {safeCustomer.lastName}</div>\n                )}\n              </div>\n              <div className={styles.coverFooter}>\n                <div className={styles.coverDate}>Report Date: {formatDate(safeProject.surveyDate || new Date().toISOString())}</div>\n                <div className={styles.coverStatus}>Status: {statusLabel}</div>\n                <div className={styles.coverProject}>Project ID: {projectUuid || safeProject.uuid || 'N/A'}</div>\n              </div>\n            </div>\n          </div>\n        );\n\n      case 2:\n        return (\n          <div className={styles.page} id={`fullscreen-page-${pageNum}`}>\n            <PageHeader company={safeCompany} site={safeSite} pageNumber={2} />\n            <SectionTitle icon=\"ðŸ“‹\" title=\"Executive Summary\" />\n            <div className={styles.summarySection}>\n              <div className={styles.summaryGrid}>\n                <div className={styles.summaryItem}>\n                  <strong>System Size:</strong> {equipment.solar.systemSize || 'TBD'} kW\n                </div>\n                <div className={styles.summaryItem}>\n                  <strong>Annual Production:</strong> {equipment.solar.annualProduction || 'TBD'} kWh\n                </div>\n                <div className={styles.summaryItem}>\n                  <strong>Panel Count:</strong> {equipment.solar.panelCount || 'TBD'}\n                </div>\n                <div className={styles.summaryItem}>\n                  <strong>Panel Type:</strong> {equipment.solar.panelManufacturer || 'TBD'} {equipment.solar.panelModel || ''}\n                </div>\n                <div className={styles.summaryItem}>\n                  <strong>Inverter Type:</strong> {equipment.inverter.type || 'TBD'}\n                </div>\n                <div className={styles.summaryItem}>\n                  <strong>Main Service Size:</strong> {electrical.mainPanel.amperage || 'TBD'}A\n                </div>\n              </div>\n            </div>\n            <SectionTitle icon=\"ðŸ \" title=\"Property Photos\" />\n            <div className={styles.photoGrid}>\n              {photosBySection.property?.slice(0, 6).map((photo, idx) => (\n                <div key={idx} className={styles.photoItem}>\n                  <img src={photo.url} alt={photo.filename} className={styles.photo} />\n                  <div className={styles.photoCaption}>{photo.filename}</div>\n                </div>\n              ))}\n            </div>\n          </div>\n        );\n\n      case 3:\n        return (\n          <div className={styles.page} id={`fullscreen-page-${pageNum}`}>\n            <PageHeader company={safeCompany} site={safeSite} pageNumber={3} />\n            <SectionTitle icon=\"âš¡\" title=\"Electrical Configuration\" />\n            <h3 className={styles.subsectionTitle}>Main Service Panel</h3>\n            <table className={styles.fullTable}>\n              <tbody>\n                <tr><td><strong>Location:</strong></td><td>{safeElectrical.mainPanel.location || 'Not specified'}</td></tr>\n                <tr><td><strong>Amperage:</strong></td><td>{safeElectrical.mainPanel.amperage || 'TBD'}A</td></tr>\n                <tr><td><strong>Main Breaker Size:</strong></td><td>{safeElectrical.mainPanel.mainBreakerSize || 'TBD'}A</td></tr>\n                <tr><td><strong>Bus Rating:</strong></td><td>{safeElectrical.mainPanel.busRating || 'TBD'}A</td></tr>\n                <tr><td><strong>Available Spaces:</strong></td><td>{safeElectrical.mainPanel.availableSpaces || 'TBD'}</td></tr>\n              </tbody>\n            </table>\n            <SectionTitle icon=\"ðŸ“¸\" title=\"Electrical Photos\" />\n            <div className={styles.photoGrid}>\n              {photosBySection.electrical?.slice(0, 6).map((photo, idx) => (\n                <div key={idx} className={styles.photoItem}>\n                  <img src={photo.url} alt={photo.filename} className={styles.photo} />\n                  <div className={styles.photoCaption}>{photo.filename}</div>\n                </div>\n              ))}\n            </div>\n          </div>\n        );\n\n      case 4:\n        return (\n          <div className={styles.page} id={`fullscreen-page-${pageNum}`}>\n            <PageHeader company={safeCompany} site={safeSite} pageNumber={4} />\n            <SectionTitle icon=\"ðŸ”§\" title=\"Equipment Specifications\" />\n            <h3 className={styles.subsectionTitle}>Solar Panels</h3>\n            <table className={styles.fullTable}>\n              <tbody>\n                <tr><td><strong>Manufacturer:</strong></td><td>{equipment.solar.panelManufacturer || 'TBD'}</td></tr>\n                <tr><td><strong>Model:</strong></td><td>{equipment.solar.panelModel || 'TBD'}</td></tr>\n                <tr><td><strong>Wattage:</strong></td><td>{equipment.solar.panelWattage || 'TBD'}W</td></tr>\n                <tr><td><strong>Panel Count:</strong></td><td>{equipment.solar.panelCount || 'TBD'}</td></tr>\n              </tbody>\n            </table>\n            <h3 className={styles.subsectionTitle}>Inverter</h3>\n            <table className={styles.fullTable}>\n              <tbody>\n                <tr><td><strong>Type:</strong></td><td>{equipment.inverter.type || 'TBD'}</td></tr>\n                <tr><td><strong>Manufacturer:</strong></td><td>{equipment.inverter.manufacturer || 'TBD'}</td></tr>\n                <tr><td><strong>Model:</strong></td><td>{equipment.inverter.model || 'TBD'}</td></tr>\n              </tbody>\n            </table>\n            <SectionTitle icon=\"ðŸ“¸\" title=\"Equipment Photos\" />\n            <div className={styles.photoGrid}>\n              {photosBySection.equipment?.slice(0, 4).map((photo, idx) => (\n                <div key={idx} className={styles.photoItem}>\n                  <img src={photo.url} alt={photo.filename} className={styles.photo} />\n                  <div className={styles.photoCaption}>{photo.filename}</div>\n                </div>\n              ))}\n            </div>\n          </div>\n        );\n\n      case 5:\n        if (!safeNotes || safeNotes.length === 0) return null;\n        return (\n          <div className={styles.page} id={`fullscreen-page-${pageNum}`}>\n            <PageHeader company={safeCompany} site={safeSite} pageNumber={5} />\n            <SectionTitle icon=\"ðŸ“\" title=\"Site Survey Notes\" />\n            <div className={styles.notesSection}>\n              {safeNotes.map((note, idx) => (\n                <div key={idx} className={styles.noteItem}>\n                  <div className={styles.noteHeader}>\n                    <strong>{note.title || `Note ${idx + 1}`}</strong>\n                    <span className={styles.noteDate}>{formatDate(note.createdAt)}</span>\n                  </div>\n                  <div className={styles.noteContent}>{note.content}</div>\n                  {note.author && <div className={styles.noteAuthor}>â€” {note.author}</div>}\n                </div>\n              ))}\n            </div>\n          </div>\n        );\n\n      case 6:\n        if (safeElectrical.mountingPlanes?.length === 0) return null;\n        return (\n          <div className={styles.page} id={`fullscreen-page-${pageNum}`}>\n            <PageHeader company={safeCompany} site={safeSite} pageNumber={6} />\n            <SectionTitle icon=\"ðŸ“\" title=\"Mounting Planes\" />\n            <table className={styles.fullTable}>\n              <thead>\n                <tr>\n                  <th>Plane</th>\n                  <th>Stories</th>\n                  <th>Pitch</th>\n                  <th>Azimuth</th>\n                  <th>Roof Type</th>\n                  <th>Mode</th>\n                  <th>Panels</th>\n                </tr>\n              </thead>\n              <tbody>\n                {safeElectrical.mountingPlanes?.map((plane, idx) => (\n                  <tr key={idx}>\n                    <td>{plane.name || `Plane ${idx + 1}`}</td>\n                    <td>{plane.stories || 'N/A'}</td>\n                    <td>{plane.pitch || 'N/A'}Â°</td>\n                    <td>{plane.azimuth || 'N/A'}Â°</td>\n                    <td>{plane.roofType || 'N/A'}</td>\n                    <td>{plane.mode || 'N/A'}</td>\n                    <td>{plane.panels || 'N/A'}</td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n            <SectionTitle icon=\"ðŸ“¸\" title=\"Roof & Mounting Photos\" />\n            <div className={styles.photoGrid}>\n              {photosBySection.roof?.slice(0, 6).map((photo, idx) => (\n                <div key={idx} className={styles.photoItem}>\n                  <img src={photo.url} alt={photo.filename} className={styles.photo} />\n                  <div className={styles.photoCaption}>{photo.filename}</div>\n                </div>\n              ))}\n            </div>\n            <div className={styles.signatureSection}>\n              <h3 className={styles.subsectionTitle}>Acknowledgment</h3>\n              <div className={styles.signatureInfo}><strong>Surveyor Name:</strong> _________________________________</div>\n              <div className={styles.signatureInfo}><strong>Surveyor Signature:</strong> _________________________________</div>\n              <div className={styles.signatureInfo}><strong>Date:</strong> _____________</div>\n              <div className={styles.signatureInfo}><strong>Homeowner Signature:</strong> _________________________________</div>\n              <div className={styles.signatureInfo}><strong>Date:</strong> _____________</div>\n            </div>\n            <div className={styles.pageFooter}>Generated by {safeCompany.name || 'Solar Company'} â€¢ {formatDate(new Date().toISOString())}</div>\n          </div>\n        );\n\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <>\n      <div className={styles.reportWrapper}>\n        {/* Simplified Toolbar */}\n        <div className={styles.toolbar}>\n          <div className={styles.toolbarLeft}>\n            <h2 className={styles.reportTitle}>ðŸ“„ Site Survey Report</h2>\n            {/* Compact Page Navigation */}\n            <div className={styles.pageNavigation}>\n              <Button\n                onClick={handlePreviousPage}\n                variant=\"secondary\"\n                size=\"small\"\n                disabled={currentPage <= 1}\n                title=\"Previous page\"\n              >\n                â—€\n              </Button>\n              <div className={styles.pageInput}>\n                <input\n                  type=\"number\"\n                  min=\"1\"\n                  max={totalPages}\n                  value={currentPage}\n                  onChange={(e) => setCurrentPage(parseInt(e.target.value, 10) || 1)}\n                  onBlur={handlePageInput}\n                  onKeyDown={(e) => e.key === 'Enter' && handlePageInput(e)}\n                  className={styles.pageNumberInput}\n                />\n                <span>/ {totalPages}</span>\n              </div>\n              <Button\n                onClick={handleNextPage}\n                variant=\"secondary\"\n                size=\"small\"\n                disabled={currentPage >= totalPages}\n                title=\"Next page\"\n              >\n                â–¶\n              </Button>\n            </div>\n          </div>\n          <div className={styles.toolbarRight}>\n            <Button onClick={handleToggleFullscreen} variant=\"secondary\" title=\"Fullscreen view\">\n              <FullscreenIcon /> Fullscreen\n            </Button>\n            <Button onClick={handlePrint} variant=\"primary\">\n              ðŸ–¨ï¸ Print\n            </Button>\n          </div>\n        </div>\n\n        {/* Normal Scrollable Container */}\n        <div className={styles.printContainer} ref={containerRef}>\n          <div ref={printRef}>\n        {/* ==================== PAGE 1: COVER PAGE ==================== */}\n        <div\n          className={styles.page}\n          ref={(el) => (pageRefs.current[0] = el)}\n          id=\"page-1\"\n        >\n          <div className={styles.coverPage}>\n            {/* Header */}\n            <div className={styles.coverHeader}>\n              <div>\n                {company.logo ? (\n                  <img src={company.logo} alt={company.name} className={styles.coverLogo} />\n                ) : (\n                  <div className={styles.coverCompanyName}>{company.name}</div>\n                )}\n              </div>\n              <div className={styles.coverCompanyInfo}>\n                {company.address && <div>{company.address}</div>}\n                {(company.city || company.state) && (\n                  <div>\n                    {company.city}\n                    {company.city && company.state && ', '}\n                    {company.state} {company.zip}\n                  </div>\n                )}\n                {company.phone && <div>Phone: {company.phone}</div>}\n                {company.email && <div>Email: {company.email}</div>}\n                {company.license && <div>License: {company.license}</div>}\n              </div>\n            </div>\n\n            {/* Main Content */}\n            <div className={styles.coverMain}>\n              <h1 className={styles.coverTitle}>Site Survey Report</h1>\n              <div className={styles.coverSubtitle}>Solar Installation Assessment</div>\n\n              <div className={styles.coverAddress}>{formatAddress(site)}</div>\n              <div className={styles.coverCityState}>\n                {site.city}\n                {site.city && site.state && ', '}\n                {site.state} {site.zip}\n              </div>\n\n              {(customer.firstName || customer.lastName) && (\n                <div className={styles.coverCustomer}>\n                  Prepared for: {customer.firstName} {customer.lastName}\n                </div>\n              )}\n              {(customer.phone || customer.email) && (\n                <div className={styles.coverCustomerContact}>\n                  {customer.phone && <span>{customer.phone}</span>}\n                  {customer.phone && customer.email && ' â€¢ '}\n                  {customer.email && <span>{customer.email}</span>}\n                </div>\n              )}\n            </div>\n\n            {/* Footer */}\n            <div className={styles.coverFooter}>\n              <div>\n                <strong>Project ID</strong>\n                <span>{project.id.slice(0, 8).toUpperCase()}</span>\n              </div>\n              <div>\n                <strong>Survey Date</strong>\n                <span>{formatDate(project.surveyDate)}</span>\n              </div>\n              <div>\n                <strong>Surveyed By</strong>\n                <span>{project.surveyedBy}</span>\n              </div>\n              <div>\n                <strong>Status</strong>\n                <span>{statusLabel}</span>\n              </div>\n              <div>\n                <strong>Generated</strong>\n                <span>{formatDate(new Date().toISOString())}</span>\n              </div>\n              <div>\n                <strong>Page</strong>\n                <span>1 of 6</span>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* ==================== PAGE 2: EXECUTIVE SUMMARY ==================== */}\n        <div\n          className={styles.page}\n          ref={(el) => (pageRefs.current[1] = el)}\n          id=\"page-2\"\n        >\n          <PageHeader company={company} site={site} pageNumber={2} />\n\n          <SectionTitle icon=\"ðŸ“Š\" title=\"Executive Summary\" />\n\n          {/* Summary Stats Box */}\n          <div className={styles.summaryBox}>\n            <div className={styles.summaryTitle}>System Overview</div>\n            <div className={styles.summaryGrid}>\n              <div className={styles.summaryItem}>\n                <span className={styles.summaryValue}>{totalSystemSize}</span>\n                <span className={styles.summaryLabel}>Total kW</span>\n              </div>\n              <div className={styles.summaryItem}>\n                <span className={styles.summaryValue}>{totalPanels}</span>\n                <span className={styles.summaryLabel}>Solar Panels</span>\n              </div>\n              <div className={styles.summaryItem}>\n                <span className={styles.summaryValue}>{totalInverters}</span>\n                <span className={styles.summaryLabel}>Inverters</span>\n              </div>\n              <div className={styles.summaryItem}>\n                <span className={styles.summaryValue}>{systems.length}</span>\n                <span className={styles.summaryLabel}>Systems</span>\n              </div>\n            </div>\n          </div>\n\n          {/* Two Column Layout */}\n          <div className={styles.twoColumn}>\n            {/* Site Information */}\n            <div>\n              <h3 className={styles.reportHeadingLarge}>\n                Site Information\n              </h3>\n              <DataTable\n                data={{\n                  Address: formatAddress(site),\n                  'City, State': `${site.city}, ${site.state} ${site.zip}`,\n                  AHJ: site.ahj,\n                  Utility: site.utility,\n                  'APN/Parcel': site.apn,\n                  'Square Footage': site.squareFootage ? `${site.squareFootage} sq ft` : null,\n                  Stories: site.stories,\n                }}\n              />\n            </div>\n\n            {/* Electrical Summary */}\n            <div>\n              <h3 className={styles.reportHeadingLarge}>\n                Electrical Summary\n              </h3>\n              <DataTable\n                data={{\n                  'SES Type': electrical.sesType,\n                  'Main Panel Bus Bar': electrical.mainPanel.busBarRating\n                    ? `${electrical.mainPanel.busBarRating}A`\n                    : null,\n                  'Main Breaker': electrical.mainPanel.mainBreakerRating\n                    ? `${electrical.mainPanel.mainBreakerRating}A`\n                    : null,\n                  'Sub Panels': electrical.subPanels.length || 'None',\n                  'POI Method': electrical.poi.method,\n                  'POI Breaker': electrical.poi.breakerRating\n                    ? `${electrical.poi.breakerRating}A`\n                    : null,\n                }}\n              />\n            </div>\n          </div>\n\n          {/* Property Photos */}\n          {propertyPhotos.length > 0 && (\n            <div className={styles.photoSection}>\n              <h3 className={styles.reportHeadingMedium}>\n                Property Photos\n              </h3>\n              <PhotoGrid photos={propertyPhotos.slice(0, 4)} columns={4} />\n            </div>\n          )}\n        </div>\n\n        {/* ==================== PAGE 3: EQUIPMENT ==================== */}\n        <div\n          className={styles.page}\n          ref={(el) => (pageRefs.current[2] = el)}\n          id=\"page-3\"\n        >\n          <PageHeader company={company} site={site} pageNumber={3} />\n\n          <SectionTitle icon=\"âš¡\" title=\"System Equipment\" />\n\n          {/* Systems */}\n          {systems.map((system) => (\n            <div key={system.id} className={styles.systemSection}>\n              <h3 className={styles.systemTitle}>\n                {system.name} ({system.totalSystemSize} kW)\n              </h3>\n\n              {/* Inverter */}\n              {system.inverter.make && (\n                <EquipmentCard\n                  title=\"Inverter\"\n                  badge={system.inverter.type}\n                  data={{\n                    Make: system.inverter.make,\n                    Model: system.inverter.model,\n                    Quantity: system.inverter.qty,\n                    'Max Output': system.inverter.maxContinuousOutput\n                      ? `${system.inverter.maxContinuousOutput}A`\n                      : null,\n                  }}\n                />\n              )}\n\n              {/* Solar Panels */}\n              {system.panels.make && (\n                <EquipmentCard\n                  title=\"Solar Panels\"\n                  data={{\n                    Make: system.panels.make,\n                    Model: system.panels.model,\n                    Wattage: system.panels.wattage ? `${system.panels.wattage}W` : null,\n                    Quantity: system.panels.qty,\n                    'Total Output': system.totalSystemSize ? `${system.totalSystemSize} kW` : null,\n                  }}\n                />\n              )}\n\n              {/* Batteries */}\n              {system.batteries && (\n                <>\n                  {system.batteries.battery1 && (\n                    <EquipmentCard\n                      title=\"Battery Storage #1\"\n                      data={{\n                        Make: system.batteries.battery1.make,\n                        Model: system.batteries.battery1.model,\n                        Quantity: system.batteries.battery1.qty,\n                        Capacity: system.batteries.battery1.capacity\n                          ? `${system.batteries.battery1.capacity} kWh`\n                          : null,\n                      }}\n                    />\n                  )}\n                  {system.batteries.battery2 && (\n                    <EquipmentCard\n                      title=\"Battery Storage #2\"\n                      data={{\n                        Make: system.batteries.battery2.make,\n                        Model: system.batteries.battery2.model,\n                        Quantity: system.batteries.battery2.qty,\n                        Capacity: system.batteries.battery2.capacity\n                          ? `${system.batteries.battery2.capacity} kWh`\n                          : null,\n                      }}\n                    />\n                  )}\n                </>\n              )}\n            </div>\n          ))}\n\n          {/* Structural Information */}\n          {(structural.roofTypes.length > 0 || structural.mountingHardware.length > 0) && (\n            <>\n              <SectionTitle icon=\"ðŸ \" title=\"Structural Information\" />\n\n              {structural.roofTypes.map((roofType, index) => (\n                <EquipmentCard\n                  key={index}\n                  title={roofType.name}\n                  data={{\n                    Material: roofType.material,\n                    'Framing Type': roofType.framingType,\n                    'Framing Size': roofType.framingSize,\n                    'Framing Spacing': roofType.framingSpacing\n                      ? `${roofType.framingSpacing}\"`\n                      : null,\n                    'Area': roofType.areaSqft ? `${roofType.areaSqft} sq ft` : null,\n                  }}\n                />\n              ))}\n\n              {structural.mountingHardware.map((hardware, index) => (\n                <EquipmentCard\n                  key={index}\n                  title={`${hardware.roofType} - Mounting Hardware`}\n                  data={{\n                    'Rail Make': hardware.railMake,\n                    'Rail Model': hardware.railModel,\n                    'Attachment Make': hardware.attachmentMake,\n                    'Attachment Model': hardware.attachmentModel,\n                  }}\n                />\n              ))}\n            </>\n          )}\n        </div>\n\n        {/* ==================== PAGE 4: ELECTRICAL DETAILS ==================== */}\n        <div\n          className={styles.page}\n          ref={(el) => (pageRefs.current[3] = el)}\n          id=\"page-4\"\n        >\n          <PageHeader company={company} site={site} pageNumber={4} />\n\n          <SectionTitle icon=\"âš¡\" title=\"Electrical Configuration\" />\n\n          <div className={styles.twoColumn}>\n            {/* Main Panel */}\n            <div>\n              <h3 className={styles.reportHeadingLarge}>\n                Main Service Panel\n              </h3>\n              <DataTable\n                data={{\n                  'Bus Bar Rating': electrical.mainPanel.busBarRating\n                    ? `${electrical.mainPanel.busBarRating}A`\n                    : null,\n                  'Main Breaker': electrical.mainPanel.mainBreakerRating\n                    ? `${electrical.mainPanel.mainBreakerRating}A`\n                    : null,\n                  'Feeder Location': electrical.mainPanel.feederLocation,\n                  'Panel Type': electrical.mainPanel.existing ? 'Existing' : 'New',\n                  Derated: electrical.mainPanel.derated ? 'Yes' : 'No',\n                }}\n              />\n\n              {/* Sub Panels */}\n              {electrical.subPanels.length > 0 && (\n                <>\n                  <h3 className={`${styles.reportHeadingLarge} ${styles.reportSection}`}>\n                    Sub Panels\n                  </h3>\n                  {electrical.subPanels.map((subPanel, index) => (\n                    <div key={index} className={styles.reportSection}>\n                      <h4 className={styles.reportHeadingSmall}>\n                        {subPanel.name}\n                      </h4>\n                      <DataTable\n                        data={{\n                          'Bus Bar': subPanel.busBarRating ? `${subPanel.busBarRating}A` : null,\n                          'Main Breaker': subPanel.mainBreakerRating\n                            ? `${subPanel.mainBreakerRating}A`\n                            : null,\n                          'Upstream Breaker': subPanel.upstreamBreaker\n                            ? `${subPanel.upstreamBreaker}A`\n                            : null,\n                          'Conductor Size': subPanel.conductorSize,\n                          'Tie-In Location': subPanel.tieInLocation,\n                        }}\n                      />\n                    </div>\n                  ))}\n                </>\n              )}\n            </div>\n\n            {/* Point of Interconnection */}\n            <div>\n              <h3 className={styles.reportHeadingLarge}>\n                Point of Interconnection\n              </h3>\n              <DataTable\n                data={{\n                  Method: electrical.poi.method,\n                  'Breaker Rating': electrical.poi.breakerRating\n                    ? `${electrical.poi.breakerRating}A`\n                    : null,\n                  'Disconnect Rating': electrical.poi.disconnectRating\n                    ? `${electrical.poi.disconnectRating}A`\n                    : null,\n                  'Breaker Location': electrical.poi.breakerLocation,\n                }}\n              />\n\n              <h3 className={`${styles.reportHeadingLarge} ${styles.reportSection}`}>\n                Additional Electrical\n              </h3>\n              <DataTable\n                data={{\n                  'SES Type': electrical.sesType,\n                  'Main Circuit Breakers': electrical.mainCircuitBreakersQty,\n                }}\n              />\n            </div>\n          </div>\n\n          {/* Electrical Photos */}\n          {electricalPhotos.length > 0 && (\n            <div className={styles.photoSection}>\n              <h3 className={styles.reportHeadingMedium}>\n                Electrical Photos\n              </h3>\n              <PhotoGrid photos={electricalPhotos.slice(0, 6)} columns={3} />\n            </div>\n          )}\n        </div>\n\n        {/* ==================== PAGE 5: SURVEY NOTES (CONDITIONAL) ==================== */}\n        {notes.length > 0 && (\n          <div\n            className={styles.page}\n            ref={(el) => (pageRefs.current[4] = el)}\n            id=\"page-5\"\n          >\n            <PageHeader company={company} site={site} pageNumber={5} />\n\n            <SectionTitle icon=\"ðŸ“\" title=\"Survey Notes & Observations\" />\n\n            {/* Priority Legend */}\n            <div className={styles.legendBox}>\n              <strong>Priority:</strong>\n              <span className={styles.legendHigh}>High - Immediate Attention</span>\n              <span className={styles.legendMedium}>Medium - Plan Ahead</span>\n              <span className={styles.legendInfo}>Info - For Reference</span>\n            </div>\n\n            {/* Notes by Section */}\n            <div className={styles.twoColumn}>\n              <div>\n                {/* Electrical Notes */}\n                {data.notesBySection.electrical && data.notesBySection.electrical.length > 0 && (\n                  <>\n                    <h4 className={styles.noteSectionTitle}>âš¡ Electrical</h4>\n                    {data.notesBySection.electrical.map((note) => (\n                      <NoteItem key={note.id} note={note} />\n                    ))}\n                  </>\n                )}\n\n                {/* Roof Notes */}\n                {data.notesBySection.roof && data.notesBySection.roof.length > 0 && (\n                  <>\n                    <h4 className={styles.noteSectionTitle}>ðŸ  Roof & Structure</h4>\n                    {data.notesBySection.roof.map((note) => (\n                      <NoteItem key={note.id} note={note} />\n                    ))}\n                  </>\n                )}\n              </div>\n\n              <div>\n                {/* Equipment Notes */}\n                {data.notesBySection.equipment && data.notesBySection.equipment.length > 0 && (\n                  <>\n                    <h4 className={styles.noteSectionTitle}>âš™ï¸ Equipment</h4>\n                    {data.notesBySection.equipment.map((note) => (\n                      <NoteItem key={note.id} note={note} />\n                    ))}\n                  </>\n                )}\n\n                {/* General Notes */}\n                {data.notesBySection.general && data.notesBySection.general.length > 0 && (\n                  <>\n                    <h4 className={styles.noteSectionTitle}>ðŸ“‹ General</h4>\n                    {data.notesBySection.general.map((note) => (\n                      <NoteItem key={note.id} note={note} />\n                    ))}\n                  </>\n                )}\n              </div>\n            </div>\n\n            {/* Any remaining uncategorized notes */}\n            {notes\n              .filter(\n                (note) =>\n                  !['electrical', 'roof', 'equipment', 'general'].includes(note.section || 'general')\n              )\n              .map((note) => (\n                <NoteItem key={note.id} note={note} />\n              ))}\n          </div>\n        )}\n\n        {/* ==================== PAGE 6: MOUNTING PLANES (CONDITIONAL) ==================== */}\n        {structural.mountingPlanes.length > 0 && (\n          <div\n            className={styles.page}\n            ref={(el) => (pageRefs.current[5] = el)}\n            id=\"page-6\"\n          >\n            <PageHeader company={company} site={site} pageNumber={6} />\n\n            <SectionTitle icon=\"ðŸ“\" title=\"Mounting Planes\" />\n\n            <table className={styles.fullTable}>\n              <thead>\n                <tr>\n                  <th>Plane</th>\n                  <th>Stories</th>\n                  <th>Pitch</th>\n                  <th>Azimuth</th>\n                  <th>Roof Type</th>\n                  <th>Mode</th>\n                  <th>Panels</th>\n                </tr>\n              </thead>\n              <tbody>\n                {structural.mountingPlanes.map((plane) => (\n                  <tr key={plane.number}>\n                    <td>{plane.number}</td>\n                    <td>{plane.stories}</td>\n                    <td>{plane.pitch ? `${plane.pitch}Â°` : '-'}</td>\n                    <td>{plane.azimuth ? `${plane.azimuth}Â°` : '-'}</td>\n                    <td>{plane.roofType || '-'}</td>\n                    <td>{plane.mode || '-'}</td>\n                    <td>{plane.panelQty || '-'}</td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n\n            {/* Roof Photos */}\n            {roofPhotos.length > 0 && (\n              <div className={styles.photoSection}>\n                <h3 className={styles.reportHeadingMedium}>\n                  Roof & Mounting Photos\n                </h3>\n                <PhotoGrid photos={roofPhotos.slice(0, 6)} columns={3} />\n              </div>\n            )}\n\n            {/* Signature Section */}\n            <div className={styles.signatureSection}>\n              <h4 className={styles.signatureTitle}>Acknowledgment</h4>\n              <p className={styles.signatureText}>\n                This site survey report accurately represents the conditions observed at the property on\n                the survey date. All measurements, observations, and recommendations are subject to\n                verification during final engineering and permitting.\n              </p>\n\n              <div className={styles.signatureLine}>\n                <div className={styles.signatureInfo}>\n                  <strong>Surveyor:</strong> {project.surveyedBy}\n                </div>\n                <div className={styles.signatureInfo}>\n                  <strong>Date:</strong> {formatDate(project.surveyDate)}\n                </div>\n              </div>\n\n              <div className={`${styles.signatureLine} ${styles.signatureLineTop}`}>\n                <div className={styles.signatureInfo}>\n                  <strong>Homeowner Signature:</strong> _________________________________\n                </div>\n                <div className={styles.signatureInfo}>\n                  <strong>Date:</strong> _____________\n                </div>\n              </div>\n            </div>\n\n            {/* Page Footer */}\n            <div className={styles.pageFooter}>\n              Generated by {company.name} â€¢ {formatDate(new Date().toISOString())}\n            </div>\n          </div>\n        )}\n        </div>\n      </div>\n    </div>\n\n    {/* Fullscreen Modal */}\n    {isFullscreen && (\n      <div className={styles.fullscreenOverlay} onClick={handleCloseFullscreen}>\n        {/* Floating Toolbar */}\n        <div className={styles.fullscreenToolbar} onClick={(e) => e.stopPropagation()}>\n          <div className={styles.fullscreenToolbarLeft}>\n            <Button\n              onClick={handleCloseFullscreen}\n              variant=\"secondary\"\n              size=\"small\"\n              title=\"Close fullscreen (ESC)\"\n            >\n              âœ• Close\n            </Button>\n            {/* Page Navigation */}\n            <div className={styles.pageNavigation}>\n              <Button\n                onClick={handlePreviousPage}\n                variant=\"secondary\"\n                size=\"small\"\n                disabled={currentPage <= 1}\n                title=\"Previous page (â† Arrow)\"\n              >\n                â—€\n              </Button>\n              <div className={styles.pageInput}>\n                <input\n                  type=\"number\"\n                  min=\"1\"\n                  max={totalPages}\n                  value={currentPage}\n                  onChange={(e) => setCurrentPage(parseInt(e.target.value, 10) || 1)}\n                  onBlur={handlePageInput}\n                  onKeyDown={(e) => e.key === 'Enter' && handlePageInput(e)}\n                  className={styles.pageNumberInput}\n                />\n                <span>/ {totalPages}</span>\n              </div>\n              <Button\n                onClick={handleNextPage}\n                variant=\"secondary\"\n                size=\"small\"\n                disabled={currentPage >= totalPages}\n                title=\"Next page (â†’ Arrow)\"\n              >\n                â–¶\n              </Button>\n            </div>\n          </div>\n          <div className={styles.fullscreenToolbarRight}>\n            <Button onClick={handlePrint} variant=\"primary\">\n              ðŸ–¨ï¸ Print\n            </Button>\n          </div>\n        </div>\n\n        {/* Single Page View with Scaling */}\n        <div className={styles.fullscreenContent} onClick={(e) => e.stopPropagation()}>\n          <div\n            className={styles.fullscreenPageWrapper}\n            style={{\n              transform: `scale(${fullscreenScale})`,\n              transformOrigin: 'top center'\n            }}\n          >\n            {renderPage(currentPage)}\n          </div>\n        </div>\n\n        {/* Large clickable prev/next areas */}\n        <div\n          className={`${styles.fullscreenNavLeft} ${currentPage <= 1 ? styles.paginationHidden : styles.paginationVisible}`}\n          onClick={(e) => {\n            e.stopPropagation();\n            handlePreviousPage();\n          }}\n        />\n        <div\n          className={`${styles.fullscreenNavRight} ${currentPage >= totalPages ? styles.paginationHidden : styles.paginationVisible}`}\n          onClick={(e) => {\n            e.stopPropagation();\n            handleNextPage();\n          }}\n        />\n      </div>\n    )}\n  </>\n  );\n};\n\n/* ========================================\n   SUB-COMPONENTS\n   ======================================== */\n\n/**\n * Page Header - Company name, site address, page number\n */\nconst PageHeader = ({ company, site, pageNumber }) => (\n  <div className={styles.pageHeader}>\n    <span>{company.name}</span>\n    <span>{formatAddress(site)}</span>\n    <span>Page {pageNumber}</span>\n  </div>\n);\n\n/**\n * Section Title - Icon + Title with bottom border\n */\nconst SectionTitle = ({ icon, title }) => (\n  <div className={styles.sectionTitle}>\n    <span className={styles.sectionIcon}>{icon}</span>\n    <span>{title}</span>\n  </div>\n);\n\n/**\n * Data Table - Label/value rows, filters out null values\n */\nconst DataTable = ({ data }) => {\n  const entries = Object.entries(data).filter(([_, value]) => value !== null && value !== undefined);\n\n  if (entries.length === 0) {\n    return <p className={styles.noDataText}>No data available</p>;\n  }\n\n  return (\n    <table className={styles.dataTable}>\n      <tbody>\n        {entries.map(([label, value]) => (\n          <tr key={label}>\n            <td className={styles.dataLabel}>{label}</td>\n            <td className={styles.dataValue}>{value}</td>\n          </tr>\n        ))}\n      </tbody>\n    </table>\n  );\n};\n\n/**\n * Equipment Card - Title, optional badge, and data table\n */\nconst EquipmentCard = ({ title, badge, data }) => (\n  <div className={styles.equipmentCard}>\n    <div className={styles.equipmentHeader}>\n      <h4 className={styles.equipmentTitle}>{title}</h4>\n      {badge && <span className={styles.equipmentBadge}>{badge}</span>}\n    </div>\n    <DataTable data={data} />\n  </div>\n);\n\n/**\n * Photo Grid - Grid of photo cards with labels\n */\nconst PhotoGrid = ({ photos, columns = 3 }) => {\n  if (!photos || photos.length === 0) {\n    return null;\n  }\n\n  const gridClass = `${styles.photoGrid} ${styles[`cols${columns}`]}`;\n\n  return (\n    <div className={gridClass}>\n      {photos.map((photo, index) => (\n        <div key={photo.id || index} className={styles.photoCard}>\n          <img src={photo.url} alt={photo.label || photo.fileName || 'Photo'} className={styles.photoImage} />\n          <div className={styles.photoLabel}>{photo.label || photo.fileName || `Photo ${index + 1}`}</div>\n        </div>\n      ))}\n    </div>\n  );\n};\n\n/**\n * Note Item - Styled by priority (high/medium/info)\n */\nconst NoteItem = ({ note }) => {\n  const priorityClass =\n    note.priority === 'high'\n      ? styles.noteHigh\n      : note.priority === 'medium'\n      ? styles.noteMedium\n      : styles.noteInfo;\n\n  return (\n    <div className={`${styles.noteItem} ${priorityClass}`}>\n      {note.content || note.note || note.text}\n    </div>\n  );\n};\n\n/* ========================================\n   HELPER FUNCTIONS\n   ======================================== */\n\n/**\n * Format date string to \"Month Day, Year\"\n */\nconst formatDate = (dateString) => {\n  if (!dateString) return '';\n  try {\n    const date = new Date(dateString);\n    return date.toLocaleDateString('en-US', {\n      month: 'long',\n      day: 'numeric',\n      year: 'numeric',\n    });\n  } catch {\n    return dateString;\n  }\n};\n\n/**\n * Format address from site object\n */\nconst formatAddress = (site) => {\n  if (!site) return '';\n  return site.address || '';\n};\n\nexport default SiteSurveyReportPanel;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\scheduling\\EventCard.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\scheduling\\EventModal.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":1,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":36},{"ruleId":"no-unused-vars","severity":1,"message":"'motion' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16},{"ruleId":"no-unused-vars","severity":1,"message":"'getPriority' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { motion } from 'framer-motion';\nimport styles from '../../styles/Scheduling.module.css';\nimport {\n  EVENT_TYPES,\n  PRIORITY_OPTIONS,\n  REMINDER_OPTIONS,\n  RECURRENCE_OPTIONS,\n  getEventType,\n  getPriority\n} from '../../constants/scheduleConstants';\nimport SearchableSelect from '../common/SearchableSelect';\n\n/**\n * EventModal - Create/Edit event form\n *\n * All fields:\n * - Event Type, Title, Date, Start/End Time\n * - All Day toggle, Project Link, Assigned To\n * - Location, Description, Priority, Reminder, Recurrence\n *\n * @param {Object} event - Event to edit (null for new event)\n * @param {Function} onSave - Save handler\n * @param {Function} onDelete - Delete handler\n * @param {Function} onClose - Close handler\n * @param {Date} initialDate - Pre-filled date/time for new events\n */\nconst EventModal = ({\n  event = null,\n  onSave,\n  onDelete,\n  onClose,\n  initialDate = null\n}) => {\n  const isEditMode = !!event;\n\n  // Mock project data (will be replaced with real data)\n  const mockProjects = [\n    { value: 'proj_1', label: 'Johnson Solar Install' },\n    { value: 'proj_2', label: 'Martinez Residential' },\n    { value: 'proj_3', label: 'Thompson Solar' },\n    { value: 'proj_4', label: 'Davis 10kW System' },\n    { value: 'proj_5', label: 'Rodriguez Solar' },\n    { value: '', label: 'No Project' }\n  ];\n\n  // Mock team members (will be replaced with real data)\n  const mockTeamMembers = [\n    { value: 'user_1', label: 'John Smith' },\n    { value: 'user_2', label: 'Jane Doe' },\n    { value: 'user_3', label: 'Mike Johnson' },\n    { value: 'user_4', label: 'Sarah Williams' }\n  ];\n\n  // Initialize form state\n  const getInitialState = () => {\n    if (event) {\n      return {\n        type: event.type,\n        title: event.title,\n        date: event.startTime.split('T')[0],\n        startTime: new Date(event.startTime).toTimeString().slice(0, 5),\n        endTime: new Date(event.endTime).toTimeString().slice(0, 5),\n        allDay: event.allDay,\n        projectId: event.projectId || '',\n        assignedTo: event.assignedTo || [],\n        location: event.location || '',\n        description: event.description || '',\n        priority: event.priority,\n        reminder: event.reminder,\n        recurrence: event.recurrence || 'none'\n      };\n    } else {\n      const defaultDate = initialDate || new Date();\n      const startHour = initialDate ? initialDate.getHours() : 9;\n      const endHour = startHour + 1;\n\n      return {\n        type: 'site_survey',\n        title: '',\n        date: defaultDate.toISOString().split('T')[0],\n        startTime: `${startHour.toString().padStart(2, '0')}:00`,\n        endTime: `${endHour.toString().padStart(2, '0')}:00`,\n        allDay: false,\n        projectId: '',\n        assignedTo: [],\n        location: '',\n        description: '',\n        priority: 'medium',\n        reminder: '30',\n        recurrence: 'none'\n      };\n    }\n  };\n\n  const [formData, setFormData] = useState(getInitialState());\n  const [errors, setErrors] = useState({});\n\n  const selectedEventType = getEventType(formData.type);\n\n  // Handle form field changes\n  const handleChange = (field, value) => {\n    setFormData(prev => ({\n      ...prev,\n      [field]: value\n    }));\n\n    // Clear error for this field\n    if (errors[field]) {\n      setErrors(prev => {\n        const newErrors = { ...prev };\n        delete newErrors[field];\n        return newErrors;\n      });\n    }\n  };\n\n  // Handle all-day toggle\n  const handleAllDayToggle = () => {\n    setFormData(prev => ({\n      ...prev,\n      allDay: !prev.allDay,\n      startTime: !prev.allDay ? '00:00' : '09:00',\n      endTime: !prev.allDay ? '23:59' : '10:00'\n    }));\n  };\n\n  // Handle assigned to (multi-select)\n  const handleAssignedToToggle = (userId) => {\n    setFormData(prev => ({\n      ...prev,\n      assignedTo: prev.assignedTo.includes(userId)\n        ? prev.assignedTo.filter(id => id !== userId)\n        : [...prev.assignedTo, userId]\n    }));\n  };\n\n  // Validate form\n  const validateForm = () => {\n    const newErrors = {};\n\n    if (!formData.title.trim()) {\n      newErrors.title = 'Title is required';\n    }\n\n    if (!formData.date) {\n      newErrors.date = 'Date is required';\n    }\n\n    if (!formData.allDay) {\n      if (!formData.startTime) {\n        newErrors.startTime = 'Start time is required';\n      }\n      if (!formData.endTime) {\n        newErrors.endTime = 'End time is required';\n      }\n\n      // Check if end time is after start time\n      if (formData.startTime && formData.endTime && formData.startTime >= formData.endTime) {\n        newErrors.endTime = 'End time must be after start time';\n      }\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  // Handle save\n  const handleSave = () => {\n    if (!validateForm()) {\n      return;\n    }\n\n    // Construct event data\n    const eventData = {\n      type: formData.type,\n      title: formData.title,\n      description: formData.description,\n      startTime: formData.allDay\n        ? `${formData.date}T00:00:00Z`\n        : `${formData.date}T${formData.startTime}:00Z`,\n      endTime: formData.allDay\n        ? `${formData.date}T23:59:59Z`\n        : `${formData.date}T${formData.endTime}:00Z`,\n      allDay: formData.allDay,\n      projectId: formData.projectId || null,\n      projectName: mockProjects.find(p => p.value === formData.projectId)?.label || null,\n      assignedTo: formData.assignedTo,\n      assignedNames: formData.assignedTo.map(\n        id => mockTeamMembers.find(m => m.value === id)?.label || ''\n      ),\n      location: formData.location,\n      priority: formData.priority,\n      reminder: formData.reminder,\n      recurrence: formData.recurrence,\n      status: 'scheduled',\n      timezone: 'America/Phoenix'\n    };\n\n    if (onSave) {\n      onSave(eventData, event?.id);\n    }\n  };\n\n  // Handle delete\n  const handleDelete = () => {\n    if (window.confirm('Are you sure you want to delete this event?')) {\n      if (onDelete && event) {\n        onDelete(event.id);\n      }\n    }\n  };\n\n  return (\n    <div>\n      {/* Modal Header with Event Type Color */}\n      <div className={styles.eventModalHeader} style={{ borderTopColor: selectedEventType.color, borderTopWidth: '3px', borderTopStyle: 'solid' }}>\n        <h2 className={styles.eventModalTitle}>\n          {isEditMode ? 'Edit Event' : 'New Event'}\n        </h2>\n        <button className={styles.eventModalClose} onClick={onClose} aria-label=\"Close\">\n          Ã—\n        </button>\n      </div>\n\n      {/* Modal Body */}\n      <div className={styles.eventModalBody}>\n        {/* Event Type */}\n        <div className={styles.formGroup}>\n          <label className={styles.formLabel}>Event Type *</label>\n          <select\n            className={styles.formSelect}\n            value={formData.type}\n            onChange={(e) => handleChange('type', e.target.value)}\n          >\n            {EVENT_TYPES.map(type => (\n              <option key={type.id} value={type.id}>\n                {type.label}\n              </option>\n            ))}\n          </select>\n        </div>\n\n        {/* Title */}\n        <div className={styles.formGroup}>\n          <label className={styles.formLabel}>Title *</label>\n          <input\n            type=\"text\"\n            className={styles.formInput}\n            placeholder=\"e.g., Johnson Residence - Site Survey\"\n            value={formData.title}\n            onChange={(e) => handleChange('title', e.target.value)}\n            style={errors.title ? { borderColor: 'var(--color-error)' } : {}}\n          />\n          {errors.title && (\n            <div style={{ color: 'var(--color-error)', fontSize: 'var(--text-xs)', marginTop: 'var(--spacing-xs)' }}>\n              {errors.title}\n            </div>\n          )}\n        </div>\n\n        {/* Date and All Day */}\n        <div className={styles.formRow}>\n          <div className={styles.formGroup}>\n            <label className={styles.formLabel}>Date *</label>\n            <input\n              type=\"date\"\n              className={styles.formInput}\n              value={formData.date}\n              onChange={(e) => handleChange('date', e.target.value)}\n              style={errors.date ? { borderColor: 'var(--color-error)' } : {}}\n            />\n            {errors.date && (\n              <div style={{ color: 'var(--color-error)', fontSize: 'var(--text-xs)', marginTop: 'var(--spacing-xs)' }}>\n                {errors.date}\n              </div>\n            )}\n          </div>\n\n          <div className={styles.formGroup}>\n            <label className={styles.formLabel}>All Day</label>\n            <div className={styles.formCheckbox}>\n              <input\n                type=\"checkbox\"\n                id=\"allDay\"\n                checked={formData.allDay}\n                onChange={handleAllDayToggle}\n              />\n              <label htmlFor=\"allDay\">All day event</label>\n            </div>\n          </div>\n        </div>\n\n        {/* Start Time and End Time */}\n        {!formData.allDay && (\n          <div className={styles.formRow}>\n            <div className={styles.formGroup}>\n              <label className={styles.formLabel}>Start Time *</label>\n              <input\n                type=\"time\"\n                className={styles.formInput}\n                value={formData.startTime}\n                onChange={(e) => handleChange('startTime', e.target.value)}\n                style={errors.startTime ? { borderColor: 'var(--color-error)' } : {}}\n              />\n              {errors.startTime && (\n                <div style={{ color: 'var(--color-error)', fontSize: 'var(--text-xs)', marginTop: 'var(--spacing-xs)' }}>\n                  {errors.startTime}\n                </div>\n              )}\n            </div>\n\n            <div className={styles.formGroup}>\n              <label className={styles.formLabel}>End Time *</label>\n              <input\n                type=\"time\"\n                className={styles.formInput}\n                value={formData.endTime}\n                onChange={(e) => handleChange('endTime', e.target.value)}\n                style={errors.endTime ? { borderColor: 'var(--color-error)' } : {}}\n              />\n              {errors.endTime && (\n                <div style={{ color: 'var(--color-error)', fontSize: 'var(--text-xs)', marginTop: 'var(--spacing-xs)' }}>\n                  {errors.endTime}\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* Project Link */}\n        <div className={styles.formGroup}>\n          <label className={styles.formLabel}>Project</label>\n          <SearchableSelect\n            value={formData.projectId}\n            onChange={(value) => handleChange('projectId', value)}\n            options={mockProjects}\n            placeholder=\"Select a project...\"\n          />\n        </div>\n\n        {/* Assigned To (Multi-select) */}\n        <div className={styles.formGroup}>\n          <label className={styles.formLabel}>Assigned To</label>\n          <div style={{ display: 'flex', flexWrap: 'wrap', gap: 'var(--spacing-xs)' }}>\n            {mockTeamMembers.map(member => (\n              <button\n                key={member.value}\n                type=\"button\"\n                className={`${styles.filterChip} ${\n                  formData.assignedTo.includes(member.value) ? styles.filterChipActive : ''\n                }`}\n                onClick={() => handleAssignedToToggle(member.value)}\n              >\n                {member.label}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        {/* Location */}\n        <div className={styles.formGroup}>\n          <label className={styles.formLabel}>Location</label>\n          <input\n            type=\"text\"\n            className={styles.formInput}\n            placeholder=\"e.g., 1234 Solar Lane, Phoenix, AZ\"\n            value={formData.location}\n            onChange={(e) => handleChange('location', e.target.value)}\n          />\n        </div>\n\n        {/* Description */}\n        <div className={styles.formGroup}>\n          <label className={styles.formLabel}>Description</label>\n          <textarea\n            className={styles.formTextarea}\n            placeholder=\"Add notes or details about this event...\"\n            value={formData.description}\n            onChange={(e) => handleChange('description', e.target.value)}\n            rows={3}\n          />\n        </div>\n\n        {/* Priority and Reminder */}\n        <div className={styles.formRow}>\n          <div className={styles.formGroup}>\n            <label className={styles.formLabel}>Priority</label>\n            <select\n              className={styles.formSelect}\n              value={formData.priority}\n              onChange={(e) => handleChange('priority', e.target.value)}\n            >\n              {PRIORITY_OPTIONS.map(option => (\n                <option key={option.value} value={option.value}>\n                  {option.label}\n                </option>\n              ))}\n            </select>\n          </div>\n\n          <div className={styles.formGroup}>\n            <label className={styles.formLabel}>Reminder</label>\n            <select\n              className={styles.formSelect}\n              value={formData.reminder}\n              onChange={(e) => handleChange('reminder', e.target.value)}\n            >\n              {REMINDER_OPTIONS.map(option => (\n                <option key={option.value} value={option.value}>\n                  {option.label}\n                </option>\n              ))}\n            </select>\n          </div>\n        </div>\n\n        {/* Recurrence */}\n        <div className={styles.formGroup}>\n          <label className={styles.formLabel}>Recurrence</label>\n          <select\n            className={styles.formSelect}\n            value={formData.recurrence}\n            onChange={(e) => handleChange('recurrence', e.target.value)}\n          >\n            {RECURRENCE_OPTIONS.map(option => (\n              <option key={option.value} value={option.value}>\n                {option.label}\n              </option>\n            ))}\n          </select>\n        </div>\n      </div>\n\n      {/* Modal Footer */}\n      <div className={styles.eventModalFooter}>\n        <button className={styles.buttonSecondary} onClick={onClose}>\n          Cancel\n        </button>\n        {isEditMode && (\n          <button className={styles.buttonDanger} onClick={handleDelete}>\n            Delete\n          </button>\n        )}\n        <button className={styles.buttonPrimary} onClick={handleSave}>\n          {isEditMode ? 'Save Changes' : 'Create Event'}\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default EventModal;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\scheduling\\MiniCalendar.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\scheduling\\ScheduleCalendar.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\scheduling\\UpcomingEvents.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\scheduling\\WeekView.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'currentTime' is assigned a value but never used.","line":27,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef } from 'react';\nimport styles from '../../styles/Scheduling.module.css';\nimport EventCard from './EventCard';\n\n/**\n * WeekView - Week calendar view with time slots\n *\n * Features:\n * - Shows 7 days (Sunday - Saturday)\n * - Time slots from 6am to 8pm (working hours)\n * - Current time indicator (orange/red line)\n * - Events positioned based on start time and sized by duration\n * - Click empty slot to create new event\n * - Click event to edit\n *\n * @param {Date} selectedDate - Currently selected date (determines which week to show)\n * @param {Array} events - Array of event objects\n * @param {Function} onEventClick - Handler for event clicks\n * @param {Function} onTimeSlotClick - Handler for empty time slot clicks\n */\nconst WeekView = ({\n  selectedDate,\n  events = [],\n  onEventClick,\n  onTimeSlotClick\n}) => {\n  const [currentTime, setCurrentTime] = useState(new Date());\n  const gridRef = useRef(null);\n\n  // Update current time every minute\n  useEffect(() => {\n    const timer = setInterval(() => {\n      setCurrentTime(new Date());\n    }, 60000); // Update every minute\n\n    return () => clearInterval(timer);\n  }, []);\n\n  // Scroll to current time on mount\n  useEffect(() => {\n    if (gridRef.current) {\n      const now = new Date();\n      const currentHour = now.getHours();\n\n      // Only scroll if current time is within working hours\n      if (currentHour >= 6 && currentHour <= 20) {\n        const hoursSince6am = currentHour - 6;\n        const scrollPosition = hoursSince6am * 60; // 60px per hour slot\n        gridRef.current.scrollTop = scrollPosition;\n      }\n    }\n  }, []);\n\n  // Get week start (Sunday) and end (Saturday)\n  const getWeekDates = (date) => {\n    const current = new Date(date);\n    const dayOfWeek = current.getDay(); // 0 = Sunday\n    const weekStart = new Date(current);\n    weekStart.setDate(current.getDate() - dayOfWeek);\n    weekStart.setHours(0, 0, 0, 0);\n\n    const dates = [];\n    for (let i = 0; i < 7; i++) {\n      const date = new Date(weekStart);\n      date.setDate(weekStart.getDate() + i);\n      dates.push(date);\n    }\n\n    return dates;\n  };\n\n  const weekDates = getWeekDates(selectedDate);\n\n  // Working hours: 6am to 8pm\n  const HOURS_START = 6;\n  const HOURS_END = 20;\n  const hours = [];\n  for (let hour = HOURS_START; hour <= HOURS_END; hour++) {\n    hours.push(hour);\n  }\n\n  // Format hour for display\n  const formatHour = (hour) => {\n    if (hour === 0) return '12 AM';\n    if (hour === 12) return '12 PM';\n    if (hour < 12) return `${hour} AM`;\n    return `${hour - 12} PM`;\n  };\n\n  // Check if date is today\n  const isToday = (date) => {\n    const today = new Date();\n    return date.getDate() === today.getDate() &&\n           date.getMonth() === today.getMonth() &&\n           date.getFullYear() === today.getFullYear();\n  };\n\n  // Calculate current time indicator position\n  const getCurrentTimePosition = () => {\n    const now = new Date();\n    const currentHour = now.getHours();\n    const currentMinutes = now.getMinutes();\n\n    // If before working hours, show at top edge\n    if (currentHour < HOURS_START) {\n      return 0;\n    }\n\n    // If after working hours, show at bottom edge\n    if (currentHour > HOURS_END) {\n      const totalHours = HOURS_END - HOURS_START + 1;\n      return totalHours * 60 - 2; // -2 to keep it visible\n    }\n\n    // Within working hours - calculate exact position\n    const hoursSince6am = currentHour - HOURS_START;\n    const minuteOffset = (currentMinutes / 60) * 60; // 60px per hour\n    const topPosition = (hoursSince6am * 60) + minuteOffset;\n\n    return topPosition;\n  };\n\n  // Get events for a specific day\n  const getEventsForDay = (date) => {\n    return events.filter(event => {\n      const eventDate = new Date(event.startTime);\n      return eventDate.getDate() === date.getDate() &&\n             eventDate.getMonth() === date.getMonth() &&\n             eventDate.getFullYear() === date.getFullYear();\n    });\n  };\n\n  // Calculate event position and height\n  const getEventStyle = (event) => {\n    const startDate = new Date(event.startTime);\n    const endDate = new Date(event.endTime);\n\n    const startHour = startDate.getHours();\n    const startMinutes = startDate.getMinutes();\n    const endHour = endDate.getHours();\n    const endMinutes = endDate.getMinutes();\n\n    // Calculate position from 6am\n    const hoursSinceStart = startHour - HOURS_START;\n    const minuteOffset = (startMinutes / 60) * 60;\n    const top = (hoursSinceStart * 60) + minuteOffset;\n\n    // Calculate height based on duration\n    const durationHours = endHour - startHour;\n    const durationMinutes = endMinutes - startMinutes;\n    const totalMinutes = (durationHours * 60) + durationMinutes;\n    const height = (totalMinutes / 60) * 60; // 60px per hour\n\n    return {\n      position: 'absolute',\n      top: `${top}px`,\n      height: `${Math.max(height, 30)}px`, // Minimum 30px height\n      left: '2px',\n      right: '2px',\n      zIndex: 2\n    };\n  };\n\n  // Handle time slot click\n  const handleTimeSlotClick = (date, hour) => {\n    if (onTimeSlotClick) {\n      const clickedDate = new Date(date);\n      clickedDate.setHours(hour, 0, 0, 0);\n      onTimeSlotClick(clickedDate);\n    }\n  };\n\n  const currentTimePosition = getCurrentTimePosition();\n\n  // Check if there are any events for the current week\n  const hasEvents = weekDates.some(date => getEventsForDay(date).length > 0);\n\n  return (\n    <div className={styles.weekViewContainer}>\n      {/* Week Header */}\n      <div className={styles.weekViewHeader}>\n        <div className={styles.weekViewTimeLabel}>Time</div>\n        {weekDates.map((date, index) => (\n          <div\n            key={index}\n            className={`${styles.weekViewDayHeader} ${\n              isToday(date) ? styles.weekViewDayHeaderToday : ''\n            }`}\n          >\n            <div className={styles.weekViewDayName}>\n              {date.toLocaleDateString('en-US', { weekday: 'short' })}\n            </div>\n            <div className={styles.weekViewDayDate}>\n              {date.getDate()}\n            </div>\n          </div>\n        ))}\n      </div>\n\n      {/* Week Grid */}\n      <div className={styles.weekViewGrid} ref={gridRef}>\n        {/* Time Column */}\n        <div className={styles.timeColumn}>\n          {hours.map((hour, index) => (\n            <div key={hour} className={styles.hourSlot}>\n              {formatHour(hour)}\n            </div>\n          ))}\n        </div>\n\n        {/* Day Columns */}\n        {weekDates.map((date, dayIndex) => {\n          const dayEvents = getEventsForDay(date);\n          const isTodayColumn = isToday(date);\n\n          return (\n            <div key={dayIndex} className={styles.dayColumn}>\n              {/* Time Slots */}\n              {hours.map((hour, hourIndex) => (\n                <div\n                  key={hour}\n                  className={`${styles.timeSlot} ${\n                    isTodayColumn ? styles.timeSlotToday : ''\n                  }`}\n                  onClick={() => handleTimeSlotClick(date, hour)}\n                />\n              ))}\n\n              {/* Events */}\n              {dayEvents.map((event) => (\n                <EventCard\n                  key={event.id}\n                  event={event}\n                  onClick={onEventClick}\n                  style={getEventStyle(event)}\n                  compact={false}\n                />\n              ))}\n            </div>\n          );\n        })}\n\n        {/* Current Time Indicator */}\n        {currentTimePosition !== null && (\n          <div\n            className={styles.currentTimeIndicator}\n            style={{ top: `${currentTimePosition}px` }}\n          />\n        )}\n\n        {/* Empty State Overlay */}\n        {!hasEvents && (\n          <div style={{\n            position: 'absolute',\n            top: '50%',\n            left: '50%',\n            transform: 'translate(-50%, -50%)',\n            textAlign: 'center',\n            color: 'var(--text-muted)',\n            pointerEvents: 'none',\n            zIndex: 1\n          }}>\n            <div style={{ fontSize: 'var(--text-lg)', fontWeight: 'var(--font-semibold)', marginBottom: 'var(--spacing-xs)' }}>\n              No events this week\n            </div>\n            <div style={{ fontSize: 'var(--text-sm)', color: 'var(--text-disabled)' }}>\n              Click a time slot to create your first event\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default WeekView;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\support\\KeyboardShortcutsPanel.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'isMac' is assigned a value but never used.","line":10,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { KEYBOARD_SHORTCUTS, formatShortcutDisplay, CATEGORY_ORDER } from '../../constants/keyboardShortcuts';\nimport styles from './KeyboardShortcutsPanel.module.css';\n\n/**\n * Keyboard Shortcuts Table - Auto-generated from constants\n * Always in sync with actual shortcuts\n */\nconst KeyboardShortcutsPanel = () => {\n  const isMac = typeof window !== 'undefined' && navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n\n  // Group shortcuts by category\n  const shortcutsByCategory = {};\n  Object.entries(KEYBOARD_SHORTCUTS).forEach(([id, shortcut]) => {\n    // Skip context-only shortcuts (they're situational)\n    if (shortcut.contextOnly) return;\n\n    const category = shortcut.category || 'Other';\n    if (!shortcutsByCategory[category]) {\n      shortcutsByCategory[category] = [];\n    }\n    shortcutsByCategory[category].push({ id, ...shortcut });\n  });\n\n  return (\n    <div className={styles.container}>\n      {CATEGORY_ORDER.map(category => {\n        const shortcuts = shortcutsByCategory[category];\n        if (!shortcuts || shortcuts.length === 0) return null;\n\n        return (\n          <div key={category} className={styles.categorySection}>\n            <h4 className={styles.categoryTitle}>{category}</h4>\n            <table className={styles.table}>\n              <thead>\n                <tr>\n                  <th>Action</th>\n                  <th>Mac</th>\n                  <th>Windows</th>\n                </tr>\n              </thead>\n              <tbody>\n                {shortcuts.map(shortcut => {\n                  const macKey = formatShortcutDisplay(shortcut, true);\n                  const pcKey = formatShortcutDisplay(shortcut, false);\n\n                  return (\n                    <tr key={shortcut.id}>\n                      <td>\n                        <div className={styles.actionName}>{shortcut.label}</div>\n                        {shortcut.description && (\n                          <div className={styles.actionDesc}>{shortcut.description}</div>\n                        )}\n                      </td>\n                      <td><kbd>{macKey}</kbd></td>\n                      <td><kbd>{pcKey}</kbd></td>\n                    </tr>\n                  );\n                })}\n              </tbody>\n            </table>\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n\nexport default KeyboardShortcutsPanel;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\support\\SupportPanel.js","messages":[{"ruleId":"jsx-a11y/anchor-is-valid","severity":1,"message":"The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/anchor-is-valid.md","line":16,"column":9,"nodeType":"JSXOpeningElement","endLine":20,"endColumn":10},{"ruleId":"jsx-a11y/anchor-is-valid","severity":1,"message":"The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/anchor-is-valid.md","line":24,"column":9,"nodeType":"JSXOpeningElement","endLine":28,"endColumn":10}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport KeyboardShortcutsPanel from './KeyboardShortcutsPanel';\nimport styles from './SupportPanel.module.css';\n\n/**\n * Support Panel with Subtabs\n * Contains Keyboard Shortcuts and other help resources\n */\nconst SupportPanel = () => {\n  const [activeSubTab, setActiveSubTab] = useState('shortcuts');\n\n  return (\n    <div className={styles.container}>\n      {/* Subtab Navigation */}\n      <div className={styles.subTabContainer}>\n        <a\n          href=\"#\"\n          className={`${styles.subTab} ${activeSubTab === 'shortcuts' ? styles.subTabActive : ''}`}\n          onClick={(e) => { e.preventDefault(); setActiveSubTab('shortcuts'); }}\n        >\n          Keyboard Shortcuts\n          {activeSubTab === 'shortcuts' && <span className={styles.subTabUnderline}></span>}\n        </a>\n        <a\n          href=\"#\"\n          className={`${styles.subTab} ${activeSubTab === 'help' ? styles.subTabActive : ''}`}\n          onClick={(e) => { e.preventDefault(); setActiveSubTab('help'); }}\n        >\n          Help & Resources\n          {activeSubTab === 'help' && <span className={styles.subTabUnderline}></span>}\n        </a>\n      </div>\n\n      {/* Subtab Content */}\n      <div className={styles.subTabContent}>\n        {activeSubTab === 'shortcuts' && <KeyboardShortcutsPanel />}\n        {activeSubTab === 'help' && (\n          <div className={styles.placeholder}>\n            <p>Help and resources coming soon...</p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default SupportPanel;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\survey\\PhotoAnnotationLayer.js","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'currentTool'. Either include it or remove the dependency array.","line":94,"column":6,"nodeType":"ArrayExpression","endLine":94,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [currentTool, isActive]","fix":{"range":[3069,3079],"text":"[currentTool, isActive]"}}]},{"ruleId":"no-unused-vars","severity":1,"message":"'arcRadius' is assigned a value but never used.","line":478,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":478,"endColumn":20},{"ruleId":"no-unused-vars","severity":1,"message":"'arcLength' is assigned a value but never used.","line":484,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":484,"endColumn":20},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'deleteSelected', 'redo', and 'undo'. Either include them or remove the dependency array.","line":535,"column":6,"nodeType":"ArrayExpression","endLine":535,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [deleteSelected, isActive, redo, undo]","fix":{"range":[13691,13701],"text":"[deleteSelected, isActive, redo, undo]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'handleMouseDown', 'handleMouseMove', and 'handleMouseUp'. Either include them or remove the dependency array.","line":551,"column":6,"nodeType":"ArrayExpression","endLine":551,"endColumn":44,"suggestions":[{"desc":"Update the dependencies array to be: [currentTool, currentColor, isDrawing, handleMouseDown, handleMouseMove, handleMouseUp]","fix":{"range":[14141,14179],"text":"[currentTool, currentColor, isDrawing, handleMouseDown, handleMouseMove, handleMouseUp]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useRef, useState, useImperativeHandle, forwardRef } from 'react';\nimport * as fabric from 'fabric';\nimport logger from '../../services/devLogger';\nimport styles from './PhotoAnnotationLayer.module.css';\n\n/**\n * PhotoAnnotationLayer - Fabric.js canvas overlay for photo annotations\n *\n * Based on PdfAnnotationLayer but simplified for single images\n * - No page tracking needed (single image)\n * - Canvas sized to image dimensions\n * - Tools: select, text, arrow, circle, square, line, revision cloud\n */\nconst PhotoAnnotationLayer = forwardRef(({\n  isActive = false,\n  currentTool = 'select',\n  currentColor = 'var(--color-danger)',\n  annotations = [],\n  onAnnotationsChange,\n  onToolChange,\n}, ref) => {\n  const canvasRef = useRef(null);\n  const fabricCanvasRef = useRef(null);\n  const [isDrawing, setIsDrawing] = useState(false);\n  const drawingObjectRef = useRef(null);\n  const startPointRef = useRef({ x: 0, y: 0 });\n  const historyRef = useRef([]);\n  const historyStepRef = useRef(0);\n\n  // Tool-specific state refs\n  const arrowPartsRef = useRef({ line: null, triangle: null });\n  const lineStateRef = useRef({ startX: 0, startY: 0, tempLine: null });\n  const squareStateRef = useRef({ startX: 0, startY: 0, tempRect: null });\n  const circleStateRef = useRef({ startX: 0, startY: 0, tempCircle: null });\n  const cloudStartRef = useRef({ x: 0, y: 0 });\n\n  // Initialize Fabric.js canvas\n  useEffect(() => {\n    if (!canvasRef.current || fabricCanvasRef.current || !isActive) {\n      return;\n    }\n\n    let resizeHandler = null;\n\n    const initTimeout = setTimeout(() => {\n      const canvasElement = canvasRef.current;\n      if (!canvasElement) return;\n\n      const container = canvasElement.parentElement;\n      if (!container) return;\n\n      const canvas = new fabric.Canvas(canvasElement, {\n        isDrawingMode: false,\n        selection: currentTool === 'select',\n        backgroundColor: 'transparent',\n        renderOnAddRemove: true,\n        enableRetinaScaling: true,\n        width: container.offsetWidth,\n        height: container.offsetHeight\n      });\n\n      fabricCanvasRef.current = canvas;\n\n      // Handle canvas resize\n      resizeHandler = () => {\n        if (fabricCanvasRef.current && canvasRef.current?.parentElement) {\n          try {\n            const rect = canvasRef.current.parentElement.getBoundingClientRect();\n            fabricCanvasRef.current.setDimensions({\n              width: rect.width,\n              height: rect.height\n            });\n            fabricCanvasRef.current.renderAll();\n          } catch (err) {\n            logger.error('PhotoAnnotationLayer', 'Resize error:', err);\n          }\n        }\n      };\n\n      window.addEventListener('resize', resizeHandler);\n      canvas.renderAll();\n    }, 100);\n\n    return () => {\n      clearTimeout(initTimeout);\n      if (resizeHandler) {\n        window.removeEventListener('resize', resizeHandler);\n      }\n      if (fabricCanvasRef.current) {\n        fabricCanvasRef.current.dispose();\n        fabricCanvasRef.current = null;\n      }\n    };\n  }, [isActive]);\n\n  // Update tool mode\n  useEffect(() => {\n    const canvas = fabricCanvasRef.current;\n    if (!canvas) return;\n\n    const isSelectMode = currentTool === 'select';\n    canvas.selection = isSelectMode;\n    canvas.isDrawingMode = false;\n\n    canvas.forEachObject((obj) => {\n      obj.selectable = isSelectMode;\n      obj.evented = isSelectMode;\n      obj.hoverCursor = isSelectMode ? 'move' : 'default';\n    });\n\n    canvas.defaultCursor = isSelectMode ? 'default' : 'crosshair';\n    canvas.hoverCursor = isSelectMode ? 'move' : 'crosshair';\n\n    canvas.renderAll();\n  }, [currentTool]);\n\n  // Save to history\n  const saveHistory = () => {\n    const canvas = fabricCanvasRef.current;\n    if (!canvas) return;\n\n    const json = canvas.toJSON();\n    historyRef.current = historyRef.current.slice(0, historyStepRef.current + 1);\n    historyRef.current.push(json);\n    historyStepRef.current++;\n\n    if (onAnnotationsChange) {\n      onAnnotationsChange(canvas.getObjects());\n    }\n  };\n\n  // Undo\n  const undo = () => {\n    const canvas = fabricCanvasRef.current;\n    if (!canvas || historyStepRef.current <= 0) return;\n\n    historyStepRef.current--;\n    const previousState = historyRef.current[historyStepRef.current];\n\n    canvas.loadFromJSON(previousState, () => {\n      canvas.renderAll();\n      if (onAnnotationsChange) {\n        onAnnotationsChange(canvas.getObjects());\n      }\n    });\n  };\n\n  // Redo\n  const redo = () => {\n    const canvas = fabricCanvasRef.current;\n    if (!canvas || historyStepRef.current >= historyRef.current.length - 1) return;\n\n    historyStepRef.current++;\n    const nextState = historyRef.current[historyStepRef.current];\n\n    canvas.loadFromJSON(nextState, () => {\n      canvas.renderAll();\n      if (onAnnotationsChange) {\n        onAnnotationsChange(canvas.getObjects());\n      }\n    });\n  };\n\n  // Delete selected\n  const deleteSelected = () => {\n    const canvas = fabricCanvasRef.current;\n    if (!canvas) return;\n\n    const activeObjects = canvas.getActiveObjects();\n    if (activeObjects.length > 0) {\n      activeObjects.forEach(obj => canvas.remove(obj));\n      canvas.discardActiveObject();\n      canvas.renderAll();\n      saveHistory();\n    }\n  };\n\n  // Mouse down handler\n  const handleMouseDown = (e) => {\n    const canvas = fabricCanvasRef.current;\n    if (!canvas || currentTool === 'select') return;\n\n    const pointer = canvas.getPointer(e.e);\n    startPointRef.current = { x: pointer.x, y: pointer.y };\n    setIsDrawing(true);\n\n    switch (currentTool) {\n      case 'text':\n        addTextBox(pointer.x, pointer.y);\n        break;\n      case 'arrow':\n        startArrow(pointer.x, pointer.y);\n        break;\n      case 'circle':\n        startCircle(pointer.x, pointer.y);\n        break;\n      case 'square':\n        startSquare(pointer.x, pointer.y);\n        break;\n      case 'line':\n        startLine(pointer.x, pointer.y);\n        break;\n      case 'cloud':\n        startRevisionCloud(pointer.x, pointer.y);\n        break;\n      default:\n        break;\n    }\n  };\n\n  // Mouse move handler\n  const handleMouseMove = (e) => {\n    const canvas = fabricCanvasRef.current;\n    if (!canvas || !isDrawing || currentTool === 'select') return;\n\n    const pointer = canvas.getPointer(e.e);\n\n    switch (currentTool) {\n      case 'arrow':\n        updateArrow(pointer.x, pointer.y);\n        break;\n      case 'circle':\n        updateCircle(pointer.x, pointer.y);\n        break;\n      case 'square':\n        updateSquare(pointer.x, pointer.y);\n        break;\n      case 'line':\n        updateLine(pointer.x, pointer.y);\n        break;\n      case 'cloud':\n        updateRevisionCloud(pointer.x, pointer.y);\n        break;\n      default:\n        break;\n    }\n  };\n\n  // Mouse up handler\n  const handleMouseUp = () => {\n    if (!isDrawing) return;\n    setIsDrawing(false);\n\n    switch (currentTool) {\n      case 'arrow':\n        finishArrow();\n        break;\n      case 'circle':\n      case 'square':\n      case 'line':\n      case 'cloud':\n        saveHistory();\n        break;\n      default:\n        break;\n    }\n  };\n\n  // Text tool\n  const addTextBox = (x, y) => {\n    const canvas = fabricCanvasRef.current;\n    if (!canvas) return;\n\n    const textbox = new fabric.Textbox('Type here...', {\n      left: x,\n      top: y,\n      width: 200,\n      fontSize: 16,\n      fill: currentColor,\n      fontFamily: 'Arial',\n      editable: true,\n      selectable: true\n    });\n\n    canvas.add(textbox);\n    canvas.setActiveObject(textbox);\n    textbox.enterEditing();\n    textbox.selectAll();\n\n    saveHistory();\n    if (onToolChange) {\n      onToolChange('select');\n    }\n  };\n\n  // Arrow tool\n  const startArrow = (x, y) => {\n    const canvas = fabricCanvasRef.current;\n    if (!canvas) return;\n\n    const line = new fabric.Line([x, y, x, y], {\n      stroke: currentColor,\n      strokeWidth: 2,\n      selectable: false,\n      evented: false\n    });\n\n    const triangle = new fabric.Triangle({\n      left: x,\n      top: y,\n      width: 10,\n      height: 10,\n      fill: currentColor,\n      selectable: false,\n      evented: false,\n      angle: 0\n    });\n\n    canvas.add(line);\n    canvas.add(triangle);\n\n    arrowPartsRef.current = { line, triangle };\n  };\n\n  const updateArrow = (x, y) => {\n    const { line, triangle } = arrowPartsRef.current;\n    if (!line || !triangle) return;\n\n    const start = startPointRef.current;\n    line.set({ x2: x, y2: y });\n\n    const angle = Math.atan2(y - start.y, x - start.x) * 180 / Math.PI;\n    triangle.set({\n      left: x - 5,\n      top: y - 5,\n      angle: angle + 90\n    });\n\n    fabricCanvasRef.current?.renderAll();\n  };\n\n  const finishArrow = () => {\n    const { line, triangle } = arrowPartsRef.current;\n    if (!line || !triangle) return;\n\n    const canvas = fabricCanvasRef.current;\n    if (!canvas) return;\n\n    const group = new fabric.Group([line, triangle], {\n      selectable: true,\n      evented: true\n    });\n\n    canvas.remove(line);\n    canvas.remove(triangle);\n    canvas.add(group);\n\n    arrowPartsRef.current = { line: null, triangle: null };\n    saveHistory();\n  };\n\n  // Circle tool\n  const startCircle = (x, y) => {\n    const canvas = fabricCanvasRef.current;\n    if (!canvas) return;\n\n    const circle = new fabric.Circle({\n      left: x,\n      top: y,\n      radius: 1,\n      stroke: currentColor,\n      strokeWidth: 2,\n      fill: 'transparent',\n      selectable: false,\n      evented: false\n    });\n\n    canvas.add(circle);\n    circleStateRef.current = { startX: x, startY: y, tempCircle: circle };\n  };\n\n  const updateCircle = (x, y) => {\n    const { startX, startY, tempCircle } = circleStateRef.current;\n    if (!tempCircle) return;\n\n    const radius = Math.sqrt(Math.pow(x - startX, 2) + Math.pow(y - startY, 2)) / 2;\n    const centerX = (startX + x) / 2;\n    const centerY = (startY + y) / 2;\n\n    tempCircle.set({\n      left: centerX - radius,\n      top: centerY - radius,\n      radius: radius\n    });\n\n    fabricCanvasRef.current?.renderAll();\n  };\n\n  // Square tool\n  const startSquare = (x, y) => {\n    const canvas = fabricCanvasRef.current;\n    if (!canvas) return;\n\n    const rect = new fabric.Rect({\n      left: x,\n      top: y,\n      width: 1,\n      height: 1,\n      stroke: currentColor,\n      strokeWidth: 2,\n      fill: 'transparent',\n      selectable: false,\n      evented: false\n    });\n\n    canvas.add(rect);\n    squareStateRef.current = { startX: x, startY: y, tempRect: rect };\n  };\n\n  const updateSquare = (x, y) => {\n    const { startX, startY, tempRect } = squareStateRef.current;\n    if (!tempRect) return;\n\n    const width = Math.abs(x - startX);\n    const height = Math.abs(y - startY);\n    const left = Math.min(startX, x);\n    const top = Math.min(startY, y);\n\n    tempRect.set({ left, top, width, height });\n    fabricCanvasRef.current?.renderAll();\n  };\n\n  // Line tool\n  const startLine = (x, y) => {\n    const canvas = fabricCanvasRef.current;\n    if (!canvas) return;\n\n    const line = new fabric.Line([x, y, x, y], {\n      stroke: currentColor,\n      strokeWidth: 2,\n      selectable: false,\n      evented: false\n    });\n\n    canvas.add(line);\n    lineStateRef.current = { startX: x, startY: y, tempLine: line };\n  };\n\n  const updateLine = (x, y) => {\n    const { tempLine } = lineStateRef.current;\n    if (!tempLine) return;\n\n    tempLine.set({ x2: x, y2: y });\n    fabricCanvasRef.current?.renderAll();\n  };\n\n  // Revision Cloud tool\n  const startRevisionCloud = (x, y) => {\n    cloudStartRef.current = { x, y };\n  };\n\n  const updateRevisionCloud = (x, y) => {\n    const canvas = fabricCanvasRef.current;\n    if (!canvas) return;\n\n    const start = cloudStartRef.current;\n    const path = generateCloudPath(start.x, start.y, x, y);\n\n    if (drawingObjectRef.current) {\n      canvas.remove(drawingObjectRef.current);\n    }\n\n    const cloudPath = new fabric.Path(path, {\n      stroke: currentColor,\n      strokeWidth: 2,\n      fill: 'transparent',\n      selectable: false,\n      evented: false\n    });\n\n    canvas.add(cloudPath);\n    drawingObjectRef.current = cloudPath;\n    canvas.renderAll();\n  };\n\n  // Generate cloud path (simplified)\n  const generateCloudPath = (x1, y1, x2, y2) => {\n    const arcRadius = 10;\n    const numArcs = 12;\n\n    const width = Math.abs(x2 - x1);\n    const height = Math.abs(y2 - y1);\n    const perimeter = 2 * (width + height);\n    const arcLength = perimeter / numArcs;\n\n    let pathData = `M ${x1} ${y1}`;\n\n    // Simplified rectangular cloud\n    for (let i = 0; i < numArcs; i++) {\n      const progress = i / numArcs;\n      let x, y;\n\n      if (progress < 0.25) {\n        x = x1 + (x2 - x1) * (progress * 4);\n        y = y1;\n      } else if (progress < 0.5) {\n        x = x2;\n        y = y1 + (y2 - y1) * ((progress - 0.25) * 4);\n      } else if (progress < 0.75) {\n        x = x2 - (x2 - x1) * ((progress - 0.5) * 4);\n        y = y2;\n      } else {\n        x = x1;\n        y = y2 - (y2 - y1) * ((progress - 0.75) * 4);\n      }\n\n      pathData += ` Q ${x} ${y} ${x} ${y}`;\n    }\n\n    pathData += ' Z';\n    return pathData;\n  };\n\n  // Keyboard shortcuts\n  useEffect(() => {\n    const handleKeyDown = (e) => {\n      if (!isActive) return;\n\n      if (e.key === 'Delete' || e.key === 'Backspace') {\n        e.preventDefault();\n        deleteSelected();\n      } else if (e.ctrlKey || e.metaKey) {\n        if (e.key === 'z' || e.key === 'Z') {\n          e.preventDefault();\n          undo();\n        } else if (e.key === 'y' || e.key === 'Y') {\n          e.preventDefault();\n          redo();\n        }\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [isActive]);\n\n  // Attach mouse handlers to canvas\n  useEffect(() => {\n    const canvas = fabricCanvasRef.current;\n    if (!canvas) return;\n\n    canvas.on('mouse:down', handleMouseDown);\n    canvas.on('mouse:move', handleMouseMove);\n    canvas.on('mouse:up', handleMouseUp);\n\n    return () => {\n      canvas.off('mouse:down', handleMouseDown);\n      canvas.off('mouse:move', handleMouseMove);\n      canvas.off('mouse:up', handleMouseUp);\n    };\n  }, [currentTool, currentColor, isDrawing]);\n\n  // Expose methods to parent via ref\n  useImperativeHandle(ref, () => ({\n    undo,\n    redo,\n    deleteSelected,\n    getCanvas: () => fabricCanvasRef.current,\n    toDataURL: () => fabricCanvasRef.current?.toDataURL('image/png'),\n  }));\n\n  if (!isActive) return null;\n\n  return (\n    <div className={styles.annotationLayerContainer}>\n      <canvas ref={canvasRef} className={styles.annotationCanvas} />\n    </div>\n  );\n});\n\nPhotoAnnotationLayer.displayName = 'PhotoAnnotationLayer';\n\nexport default PhotoAnnotationLayer;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\survey\\PhotoToolbar.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\tasks\\TasksPanel.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\tasks\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\ActionButton.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\AddButton.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\AddSectionButton.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\Alert.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\Avatar.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\Breadcrumbs.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\Button.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\ButtonGroup.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\Card.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\Checkbox.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\CircleToggle.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\CollapsibleSection.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\CompactToggle.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\ConfirmActionModal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\ConfirmDialog.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\Divider.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\Drawer.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\Dropdown.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\EmptyState.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\EquipmentRow.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\ErrorState.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\FormFieldRow.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\FormInput.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\FormSection.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\FormSelect.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\GradientInput.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\GridSizeToggle.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\IconButton.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\InfoField.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\Inline.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\KeyboardHint.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\LaunchButton.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\LoadingSpinner.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\Modal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\Note.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\Pagination.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\PhotoModal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\Popover.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\PortalNavigationPill.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\PreferredButton.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\Progress.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\ProjectHeader.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\Radio.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\SearchableDropdown.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\SectionClearModal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\SectionHeader.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\SectionRemoveModal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\SendButton.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\Skeleton.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\Stack.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\StatusBadge.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\SystemDeleteModal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\TableDropdown.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\TableRowButton.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\TableSelect.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\Tabs.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\Textarea.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\Toast.js","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'handleClose'. Either include it or remove the dependency array.","line":39,"column":6,"nodeType":"ArrayExpression","endLine":39,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [duration, handleClose]","fix":{"range":[1307,1317],"text":"[duration, handleClose]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, createContext, useContext, useCallback } from 'react';\nimport styles from './Toast.module.css';\n\nconst ToastContext = createContext(null);\n\nconst ICONS = {\n  success: (\n    <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n      <path d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm-1-5l5-5-1.4-1.4L9 10.2 7.4 8.6 6 10l3 3z\" fill=\"currentColor\"/>\n    </svg>\n  ),\n  error: (\n    <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n      <path d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM9 9V5h2v4H9zm0 4v-2h2v2H9z\" fill=\"currentColor\"/>\n    </svg>\n  ),\n  warning: (\n    <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n      <path d=\"M10 2L1 18h18L10 2zm0 4l6.5 11h-13L10 6zm-1 4v3h2v-3H9zm0 5v2h2v-2H9z\" fill=\"currentColor\"/>\n    </svg>\n  ),\n  info: (\n    <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n      <path d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm-1-5V9h2v4H9zm0-6V5h2v2H9z\" fill=\"currentColor\"/>\n    </svg>\n  ),\n};\n\nconst Toast = ({ id, variant = 'info', title, message, duration = 5000, onClose }) => {\n  const [isExiting, setIsExiting] = useState(false);\n\n  useEffect(() => {\n    if (duration > 0) {\n      const timer = setTimeout(() => {\n        handleClose();\n      }, duration);\n      return () => clearTimeout(timer);\n    }\n  }, [duration]);\n\n  const handleClose = () => {\n    setIsExiting(true);\n    setTimeout(() => {\n      if (onClose) onClose(id);\n    }, 200);\n  };\n\n  return (\n    <div\n      className={`${styles.toast} ${styles[variant]} ${isExiting ? styles.exiting : ''}`}\n      role=\"alert\"\n    >\n      <div className={styles.icon}>{ICONS[variant]}</div>\n      <div className={styles.content}>\n        {title && <div className={styles.title}>{title}</div>}\n        {message && <div className={styles.message}>{message}</div>}\n      </div>\n      <button className={styles.close} onClick={handleClose} aria-label=\"Dismiss\">\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\">\n          <path d=\"M12 4L4 12M4 4l8 8\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\"/>\n        </svg>\n      </button>\n    </div>\n  );\n};\n\nconst ToastContainer = ({ position = 'top-right' }) => {\n  const { toasts, removeToast } = useContext(ToastContext);\n\n  return (\n    <div className={`${styles.container} ${styles[position]}`}>\n      {toasts.map((toast) => (\n        <Toast key={toast.id} {...toast} onClose={removeToast} />\n      ))}\n    </div>\n  );\n};\n\nexport const ToastProvider = ({ children, position = 'top-right' }) => {\n  const [toasts, setToasts] = useState([]);\n\n  const addToast = useCallback((toast) => {\n    const id = Date.now().toString();\n    setToasts((prev) => [...prev, { id, ...toast }]);\n    return id;\n  }, []);\n\n  const removeToast = useCallback((id) => {\n    setToasts((prev) => prev.filter((t) => t.id !== id));\n  }, []);\n\n  const toast = useCallback((options) => {\n    if (typeof options === 'string') {\n      return addToast({ message: options, variant: 'info' });\n    }\n    return addToast(options);\n  }, [addToast]);\n\n  toast.success = (message, options = {}) => addToast({ message, variant: 'success', ...options });\n  toast.error = (message, options = {}) => addToast({ message, variant: 'error', ...options });\n  toast.warning = (message, options = {}) => addToast({ message, variant: 'warning', ...options });\n  toast.info = (message, options = {}) => addToast({ message, variant: 'info', ...options });\n\n  return (\n    <ToastContext.Provider value={{ toasts, addToast, removeToast, toast }}>\n      {children}\n      <ToastContainer position={position} />\n    </ToastContext.Provider>\n  );\n};\n\nexport const useToast = () => {\n  const context = useContext(ToastContext);\n  if (!context) {\n    throw new Error('useToast must be used within a ToastProvider');\n  }\n  return context.toast;\n};\n\nexport default Toast;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\Toggle.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\ToggleButton.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\Tooltip.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\TripleToggle.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\UpdateModal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\WarningModal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\components\\ui\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\config\\api.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\config\\axios.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\config\\google.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\config\\keyboardShortcuts.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\config\\version.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\constants\\bosFieldPatterns.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\constants\\checklistConfig.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\constants\\equipmentCategories.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\constants\\generationConstants.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\constants\\keyboardShortcuts.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'BROWSER_CONFLICTS' is assigned a value but never used.","line":17,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Centralized Keyboard Shortcuts Configuration\n *\n * Professional-grade shortcut system for Skyfire\n * Auto-syncs with KeyboardShortcutsPanel UI\n */\n\n// Shortcut action types\nexport const SHORTCUT_ACTIONS = {\n  NAVIGATE: 'navigate',\n  TRIGGER: 'trigger',\n  FOCUS: 'focus',\n  TOGGLE: 'toggle',\n};\n\n// Browser conflict notes\nconst BROWSER_CONFLICTS = {\n  'Cmd+P': 'Browser print dialog (we override with preventDefault)',\n  'Cmd+F': 'Browser find (we override on pages with filters)',\n};\n\n/**\n * Main shortcuts configuration\n * Format: { key, meta, shift, label, description, action, handler, category, tier }\n */\nexport const KEYBOARD_SHORTCUTS = {\n  // ========== NAVIGATION (Portal Switching) ==========\n  DASHBOARD: {\n    key: '1',\n    meta: true,\n    label: 'Dashboard',\n    description: 'Go to main dashboard',\n    action: SHORTCUT_ACTIONS.NAVIGATE,\n    path: '/dashboard',\n    category: 'Navigation',\n    tier: 1,\n  },\n  PROJECTS: {\n    key: '2',\n    meta: true,\n    label: 'Projects',\n    description: 'View all projects',\n    action: SHORTCUT_ACTIONS.NAVIGATE,\n    path: '/existing-projects',\n    category: 'Navigation',\n    tier: 1,\n  },\n  INVENTORY: {\n    key: '3',\n    meta: true,\n    label: 'Inventory',\n    description: 'Open inventory management',\n    action: SHORTCUT_ACTIONS.NAVIGATE,\n    path: '/inventory',\n    category: 'Navigation',\n    tier: 1,\n  },\n  SCHEDULING: {\n    key: '4',\n    meta: true,\n    label: 'Scheduling',\n    description: 'Open scheduling portal',\n    action: SHORTCUT_ACTIONS.NAVIGATE,\n    path: '/scheduling',\n    category: 'Navigation',\n    tier: 1,\n  },\n  DRAFTER_PORTAL: {\n    key: '5',\n    meta: true,\n    label: 'Drafter Portal',\n    description: 'Open drafter dashboard',\n    action: SHORTCUT_ACTIONS.NAVIGATE,\n    path: '/drafter-portal',\n    category: 'Navigation',\n    tier: 1,\n  },\n  ACCOUNT: {\n    key: '0',\n    meta: true,\n    label: 'Account',\n    description: 'Open account settings',\n    action: SHORTCUT_ACTIONS.NAVIGATE,\n    path: '/account',\n    category: 'Navigation',\n    tier: 1,\n  },\n  GO_BACK: {\n    key: '[',\n    meta: true,\n    label: 'Go Back',\n    description: 'Navigate to previous page',\n    action: SHORTCUT_ACTIONS.TRIGGER,\n    handler: 'history.back',\n    category: 'Navigation',\n    tier: 2,\n  },\n  GO_FORWARD: {\n    key: ']',\n    meta: true,\n    label: 'Go Forward',\n    description: 'Navigate to next page',\n    action: SHORTCUT_ACTIONS.TRIGGER,\n    handler: 'history.forward',\n    category: 'Navigation',\n    tier: 2,\n  },\n\n  // ========== SEARCH & FILTER ==========\n  GLOBAL_SEARCH: {\n    key: 'k',\n    meta: true,\n    label: 'Global Search',\n    description: 'Open global search',\n    action: SHORTCUT_ACTIONS.TRIGGER,\n    handler: 'openGlobalSearch',\n    category: 'Search',\n    tier: 1,\n  },\n  QUICK_SEARCH: {\n    key: '/',\n    label: 'Quick Search',\n    description: 'Quick search (when not typing)',\n    action: SHORTCUT_ACTIONS.TRIGGER,\n    handler: 'openGlobalSearch',\n    category: 'Search',\n    tier: 1,\n  },\n  HELP_SHORTCUTS: {\n    key: '?',\n    shift: true, // ? is Shift+/\n    label: 'Help',\n    description: 'Show keyboard shortcuts',\n    action: SHORTCUT_ACTIONS.TRIGGER,\n    handler: 'openKeyboardShortcuts',\n    category: 'Help',\n    tier: 1,\n  },\n  FILTER_PAGE: {\n    key: 'f',\n    meta: true,\n    label: 'Filter',\n    description: 'Focus filter on current page',\n    action: SHORTCUT_ACTIONS.FOCUS,\n    handler: 'focusFilter',\n    category: 'Search',\n    tier: 2,\n  },\n\n  // ========== PROJECT ACTIONS ==========\n  NEW_PROJECT: {\n    key: 'n',\n    meta: true,\n    label: 'New Project',\n    description: 'Create a new project',\n    action: SHORTCUT_ACTIONS.TRIGGER,\n    handler: 'createNewProject',\n    category: 'Actions',\n    tier: 1,\n  },\n  OPEN_PROJECT: {\n    key: 'o',\n    meta: true,\n    label: 'Open Project',\n    description: 'Open project picker',\n    action: SHORTCUT_ACTIONS.TRIGGER,\n    handler: 'openProjectPicker',\n    category: 'Actions',\n    tier: 2,\n  },\n  COPY_LINK: {\n    key: 'c',\n    meta: true,\n    shift: true,\n    label: 'Copy Link',\n    description: 'Copy current page URL',\n    action: SHORTCUT_ACTIONS.TRIGGER,\n    handler: 'copyCurrentLink',\n    category: 'Actions',\n    tier: 2,\n  },\n  PRINT_EXPORT: {\n    key: 'p',\n    meta: true,\n    label: 'Print/Export',\n    description: 'Print or export to PDF',\n    action: SHORTCUT_ACTIONS.TRIGGER,\n    handler: 'printOrExport',\n    category: 'Actions',\n    tier: 2,\n  },\n\n  // ========== FORMS & EDITING ==========\n  SAVE: {\n    key: 's',\n    meta: true,\n    label: 'Save',\n    description: 'Save current form',\n    action: SHORTCUT_ACTIONS.TRIGGER,\n    handler: 'saveForm',\n    category: 'Editing',\n    tier: 1,\n  },\n  SUBMIT: {\n    key: 'Enter',\n    meta: true,\n    label: 'Submit',\n    description: 'Submit current form',\n    action: SHORTCUT_ACTIONS.TRIGGER,\n    handler: 'submitForm',\n    category: 'Editing',\n    tier: 1,\n  },\n  CANCEL: {\n    key: 'Escape',\n    label: 'Cancel',\n    description: 'Close modal or cancel action',\n    action: SHORTCUT_ACTIONS.TRIGGER,\n    handler: 'cancelOrClose',\n    category: 'General',\n    tier: 1,\n  },\n\n  // ========== COMMUNICATION ==========\n  OPEN_CHATTER: {\n    key: 'm',\n    meta: true,\n    shift: true,\n    label: 'Messages',\n    description: 'Open Chatter messages',\n    action: SHORTCUT_ACTIONS.TRIGGER,\n    handler: 'openChatter',\n    category: 'Communication',\n    tier: 1,\n  },\n  SEND_MESSAGE: {\n    key: 'Enter',\n    meta: true,\n    label: 'Send',\n    description: 'Send message (in chat)',\n    action: SHORTCUT_ACTIONS.TRIGGER,\n    handler: 'sendMessage',\n    category: 'Communication',\n    tier: 1,\n    contextOnly: true, // Only works in chat\n  },\n\n  // ========== MEDIA & FILES ==========\n  UPLOAD_FILE: {\n    key: 'u',\n    meta: true,\n    shift: true,\n    label: 'Upload',\n    description: 'Upload file or photo',\n    action: SHORTCUT_ACTIONS.TRIGGER,\n    handler: 'uploadFile',\n    category: 'Media',\n    tier: 2,\n  },\n  PREVIEW_FILE: {\n    key: 'p',\n    meta: true,\n    shift: true,\n    label: 'Preview',\n    description: 'Preview selected file',\n    action: SHORTCUT_ACTIONS.TRIGGER,\n    handler: 'previewFile',\n    category: 'Media',\n    tier: 2,\n  },\n\n  // ========== LIST NAVIGATION (J/K Gmail style) ==========\n  NEXT_ITEM: {\n    key: 'j',\n    label: 'Next',\n    description: 'Next item in list',\n    action: SHORTCUT_ACTIONS.TRIGGER,\n    handler: 'listNext',\n    category: 'List Navigation',\n    tier: 2,\n    contextOnly: true,\n  },\n  PREV_ITEM: {\n    key: 'k',\n    label: 'Previous',\n    description: 'Previous item in list',\n    action: SHORTCUT_ACTIONS.TRIGGER,\n    handler: 'listPrev',\n    category: 'List Navigation',\n    tier: 2,\n    contextOnly: true,\n  },\n  OPEN_ITEM: {\n    key: 'Enter',\n    label: 'Open',\n    description: 'Open selected item',\n    action: SHORTCUT_ACTIONS.TRIGGER,\n    handler: 'listOpen',\n    category: 'List Navigation',\n    tier: 2,\n    contextOnly: true,\n  },\n  TOGGLE_SELECT: {\n    key: ' ',\n    label: 'Select',\n    description: 'Toggle selection',\n    action: SHORTCUT_ACTIONS.TRIGGER,\n    handler: 'listToggleSelect',\n    category: 'List Navigation',\n    tier: 2,\n    contextOnly: true,\n  },\n  SELECT_ALL: {\n    key: 'a',\n    meta: true,\n    label: 'Select All',\n    description: 'Select all items',\n    action: SHORTCUT_ACTIONS.TRIGGER,\n    handler: 'selectAll',\n    category: 'List Navigation',\n    tier: 2,\n  },\n};\n\n/**\n * Get shortcuts by category\n */\nexport function getShortcutsByCategory() {\n  const categories = {};\n\n  Object.entries(KEYBOARD_SHORTCUTS).forEach(([id, shortcut]) => {\n    const category = shortcut.category || 'Other';\n    if (!categories[category]) {\n      categories[category] = [];\n    }\n    categories[category].push({ id, ...shortcut });\n  });\n\n  return categories;\n}\n\n/**\n * Get shortcuts by tier (for phased rollout)\n */\nexport function getShortcutsByTier(tier) {\n  return Object.entries(KEYBOARD_SHORTCUTS)\n    .filter(([_, shortcut]) => shortcut.tier === tier)\n    .map(([id, shortcut]) => ({ id, ...shortcut }));\n}\n\n/**\n * Get all categories\n */\nexport function getCategories() {\n  const categories = new Set();\n  Object.values(KEYBOARD_SHORTCUTS).forEach(s => {\n    categories.add(s.category || 'Other');\n  });\n  return Array.from(categories);\n}\n\n/**\n * Category display order\n */\nexport const CATEGORY_ORDER = [\n  'Navigation',\n  'Search',\n  'Actions',\n  'Editing',\n  'Communication',\n  'Media',\n  'List Navigation',\n  'Help',\n  'General',\n];\n\n/**\n * Format shortcut for display\n * @param {Object} shortcut - Shortcut configuration\n * @param {boolean} isMac - Whether user is on Mac\n * @returns {string} Formatted shortcut string\n */\nexport function formatShortcutDisplay(shortcut, isMac = true) {\n  const parts = [];\n\n  if (shortcut.meta) {\n    parts.push(isMac ? 'âŒ˜' : 'Ctrl');\n  }\n  if (shortcut.shift) {\n    parts.push('Shift');\n  }\n  if (shortcut.alt) {\n    parts.push(isMac ? 'Option' : 'Alt');\n  }\n\n  // Handle special keys\n  const keyDisplay = {\n    'Enter': 'â†µ',\n    'Escape': 'Esc',\n    ' ': 'Space',\n  }[shortcut.key] || shortcut.key.toUpperCase();\n\n  parts.push(keyDisplay);\n\n  return parts.join(isMac ? '' : ' + ');\n}\n\nexport default KEYBOARD_SHORTCUTS;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\constants\\photoSections.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\constants\\pricing.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\constants\\scheduleConstants.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\data\\qcChecklist.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\data\\qcDesignChecklist.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\data\\qcSitePlanChecklist.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\hooks\\useAdminDrafterQueue.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\hooks\\useAdminDrafterSocket.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\hooks\\useBOSData.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'generateSlotFields' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":21},{"ruleId":"no-unused-vars","severity":1,"message":"'extractSlotData' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * useBOSData Hook - Enhanced Version\n *\n * Features:\n * - All 5 BOS section types (utility, battery1, battery2, backup, postSMS)\n * - Trigger-based visibility\n * - Slot compaction on delete\n * - Chain reordering for Battery/Backup (when drag-drop is implemented)\n * - Auto-population support (placeholder for future implementation)\n * - Multi-system support (sys1-sys4)\n */\n\nimport { useState, useEffect, useCallback, useMemo } from 'react';\nimport { BOS_EQUIPMENT_CATALOG, NEC_CONSTANTS, STANDARD_AMP_RATINGS } from '../constants/bosConstants';\nimport {\n  generateSlotFields,\n  extractSlotData,\n  getPopulatedSlots,\n  getNextSlotNumber,\n  buildSlotPayload,\n  buildClearPayload,\n} from '../utils/bosFieldUtils';\nimport { compactBOSSlots, reorderChainItems } from '../utils/bosSlotCompactor';\nimport {\n  shouldShowBOSSection,\n  getActiveSystemCount,\n  getTriggerEquipmentDetails,\n  getVisibleSections,\n} from '../utils/bosTriggerUtils';\nimport api from '../config/axios';\nimport logger from '../services/devLogger';\n\nconst useBOSData = ({ projectUuid }) => {\n  // State\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [error, setError] = useState(null);\n  const [systemDetails, setSystemDetails] = useState({});\n  const [refreshKey, setRefreshKey] = useState(0);\n\n  // Fetch system details\n  useEffect(() => {\n    const fetchSystemDetails = async () => {\n      if (!projectUuid) return;\n\n      setLoading(true);\n      setError(null);\n\n      try {\n        const response = await api.get(`/project/${projectUuid}/system-details`);\n\n        // Handle successful response\n        if (response.status === 200 && (response.data?.success || response.data?.status === 'SUCCESS')) {\n          setSystemDetails(response.data.data || {});\n        } else {\n          setSystemDetails({});\n        }\n      } catch (err) {\n        // 404 is normal - new projects don't have system details yet\n        if (err?.response?.status === 404) {\n          logger.info('BOS', 'No system details yet (404)');\n          setSystemDetails({});\n        } else {\n          logger.error('BOS', 'Failed to fetch system details:', err);\n          setError(err.message || 'Failed to load system details');\n        }\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchSystemDetails();\n  }, [projectUuid, refreshKey]);\n\n  // Extract data for all 4 systems\n  const systems = useMemo(() => {\n    const result = {};\n\n    for (let sysNum = 1; sysNum <= 4; sysNum++) {\n      result[sysNum] = {\n        utilitySlots: getPopulatedSlots(systemDetails, 'utility', sysNum),\n        battery1Slots: getPopulatedSlots(systemDetails, 'battery1', sysNum),\n        battery2Slots: getPopulatedSlots(systemDetails, 'battery2', sysNum),\n        backupSlots: getPopulatedSlots(systemDetails, 'backup', sysNum),\n        postSMSSlots: getPopulatedSlots(systemDetails, 'postSMS', sysNum),\n      };\n    }\n\n    // Combine BOS (no system prefix)\n    result.combine = {\n      slots: getPopulatedSlots(systemDetails, 'combine', null),\n    };\n\n    return result;\n  }, [systemDetails]);\n\n  // Trigger equipment for each system\n  const triggerEquipment = useMemo(() => {\n    const result = {};\n\n    for (let sysNum = 1; sysNum <= 4; sysNum++) {\n      result[sysNum] = {\n        utility: getTriggerEquipmentDetails(systemDetails, 'utility', sysNum),\n        battery1: getTriggerEquipmentDetails(systemDetails, 'battery1', sysNum),\n        battery2: getTriggerEquipmentDetails(systemDetails, 'battery2', sysNum),\n        backup: getTriggerEquipmentDetails(systemDetails, 'backup', sysNum),\n        postSMS: getTriggerEquipmentDetails(systemDetails, 'postSMS', sysNum),\n      };\n    }\n\n    return result;\n  }, [systemDetails]);\n\n  // Visible sections per system\n  const visibleSections = useMemo(() => {\n    const result = {};\n\n    for (let sysNum = 1; sysNum <= 4; sysNum++) {\n      result[sysNum] = getVisibleSections(systemDetails, sysNum);\n    }\n\n    // Combine visibility\n    result.combine = shouldShowBOSSection(systemDetails, 'combine', null);\n\n    return result;\n  }, [systemDetails]);\n\n  // Add equipment to a section\n  const addEquipment = useCallback(async (section, systemNumber, equipmentData, position = null) => {\n    setSaving(true);\n    setError(null);\n\n    try {\n      let slotNumber;\n\n      if (section === 'combine') {\n        // For combine BOS, check slot within position\n        slotNumber = getNextSlotNumber(systemDetails, section, position, position);\n        if (!slotNumber) {\n          throw new Error('All slots in this position are full');\n        }\n        systemNumber = position; // For combine, systemNumber param becomes position\n      } else {\n        slotNumber = getNextSlotNumber(systemDetails, section, systemNumber);\n        if (!slotNumber) {\n          throw new Error('All slots are full');\n        }\n      }\n\n      const payload = buildSlotPayload(section, systemNumber, slotNumber, equipmentData);\n\n      await api.patch(`/project/${projectUuid}/system-details`, payload);\n\n      // Refresh data\n      setRefreshKey(prev => prev + 1);\n\n      return { success: true, slotNumber };\n    } catch (err) {\n      logger.error('BOS', 'Failed to add equipment:', err);\n      setError(err.message);\n      throw err;\n    } finally {\n      setSaving(false);\n    }\n  }, [projectUuid, systemDetails]);\n\n  // Update existing slot\n  const updateSlot = useCallback(async (slot, equipmentData) => {\n    setSaving(true);\n    setError(null);\n\n    try {\n      const payload = buildSlotPayload(\n        slot.section,\n        slot.systemNumber,\n        slot.slotNumber,\n        equipmentData\n      );\n\n      await api.patch(`/project/${projectUuid}/system-details`, payload);\n\n      setRefreshKey(prev => prev + 1);\n\n      return { success: true };\n    } catch (err) {\n      logger.error('BOS', 'Failed to update slot:', err);\n      setError(err.message);\n      throw err;\n    } finally {\n      setSaving(false);\n    }\n  }, [projectUuid]);\n\n  // Remove equipment and compact slots\n  const removeEquipment = useCallback(async (slot) => {\n    setSaving(true);\n    setError(null);\n\n    try {\n      // Clear the slot\n      const clearPayload = buildClearPayload(slot.section, slot.systemNumber, slot.slotNumber);\n      await api.patch(`/project/${projectUuid}/system-details`, clearPayload);\n\n      // Compact remaining slots (skip for combine BOS)\n      if (slot.section !== 'combine') {\n        // Refetch system details for accurate compaction\n        const response = await api.get(`/project/${projectUuid}/system-details`);\n        const updatedDetails = response.data?.data || response.data || {};\n\n        const compactPayload = compactBOSSlots(updatedDetails, slot.section, slot.systemNumber);\n        if (Object.keys(compactPayload).length > 0) {\n          await api.patch(`/project/${projectUuid}/system-details`, compactPayload);\n        }\n      }\n\n      setRefreshKey(prev => prev + 1);\n\n      return { success: true };\n    } catch (err) {\n      logger.error('BOS', 'Failed to remove equipment:', err);\n      setError(err.message);\n      throw err;\n    } finally {\n      setSaving(false);\n    }\n  }, [projectUuid]);\n\n  // Reorder chain items (for Battery/Backup BOS)\n  const reorderChain = useCallback(async (section, systemNumber, reorderedItems) => {\n    setSaving(true);\n    setError(null);\n\n    try {\n      const payload = reorderChainItems(reorderedItems, section, systemNumber);\n\n      if (Object.keys(payload).length === 0) {\n        logger.warn('BOS', `Section ${section} is not draggable or payload is empty`);\n        return { success: false };\n      }\n\n      await api.patch(`/project/${projectUuid}/system-details`, payload);\n\n      setRefreshKey(prev => prev + 1);\n\n      return { success: true };\n    } catch (err) {\n      logger.error('BOS', 'Failed to reorder chain:', err);\n      setError(err.message);\n      throw err;\n    } finally {\n      setSaving(false);\n    }\n  }, [projectUuid]);\n\n  // Calculate minimum amp rating based on NEC 1.25x rule\n  const calculateMinAmp = useCallback((context) => {\n    // NEC 1.25x rule: BOS must be rated at >= max continuous output Ã— 1.25\n    const { inverterAmperage, batteryMaxChargeCurrent } = context;\n\n    let baseAmperage = 0;\n    if (inverterAmperage) baseAmperage = Math.max(baseAmperage, parseFloat(inverterAmperage));\n    if (batteryMaxChargeCurrent) baseAmperage = Math.max(baseAmperage, parseFloat(batteryMaxChargeCurrent));\n\n    const minimumRating = Math.ceil(baseAmperage * NEC_CONSTANTS.CONTINUOUS_LOAD_MULTIPLIER);\n\n    // Find next standard amp rating\n    const recommendedRating = STANDARD_AMP_RATINGS.find(r => r >= minimumRating) || minimumRating;\n\n    return {\n      minimumAmpRating: minimumRating,\n      recommendedAmpRating: recommendedRating,\n      calculation: `${baseAmperage}A Ã— 1.25 = ${minimumRating}A`,\n    };\n  }, []);\n\n  // Find equipment in catalog\n  const findEquipment = useCallback((type, make, model) => {\n    return BOS_EQUIPMENT_CATALOG.find(item =>\n      item.type === type && item.make === make && item.model === model\n    );\n  }, []);\n\n  // Auto-populate BOS (stub - will be enhanced with utility requirements)\n  const autoPopulateBOS = useCallback(async (systemNumber, utilityName) => {\n    // Placeholder for configuration-based auto-population\n    logger.info('BOS', 'Auto-populate called for system', systemNumber, 'utility', utilityName);\n    return { added: 0, errors: [] };\n  }, []);\n\n  // Check if auto-populate is available\n  const canAutoPopulate = useCallback((systemNumber, utilityName) => {\n    // Placeholder - will check against configuration database\n    return { canPopulate: false, count: 0, reason: 'Not implemented' };\n  }, []);\n\n  // Refresh data\n  const refresh = useCallback(() => {\n    setRefreshKey(prev => prev + 1);\n  }, []);\n\n  return {\n    loading,\n    saving,\n    error,\n    systems,\n    triggerEquipment,\n    visibleSections,\n    equipmentCatalog: BOS_EQUIPMENT_CATALOG,\n    addEquipment,\n    updateSlot,\n    removeEquipment,\n    reorderChain,\n    calculateMinAmp,\n    findEquipment,\n    autoPopulateBOS,\n    canAutoPopulate,\n    refresh,\n    activeSystemCount: getActiveSystemCount(systemDetails),\n  };\n};\n\nexport default useBOSData;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\hooks\\useChatter.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\hooks\\useDashboardData.js","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchDashboardData'. Either include it or remove the dependency array.","line":27,"column":6,"nodeType":"ArrayExpression","endLine":27,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [fetchDashboardData]","fix":{"range":[699,701],"text":"[fetchDashboardData]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\hooks\\useDrafterAssignment.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\hooks\\useDrafterKeyboardShortcuts.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\hooks\\useDrafterSocket.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\hooks\\useDrafterStatus.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\hooks\\useEarnings.js","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'refresh'. Either include it or remove the dependency array.","line":138,"column":6,"nodeType":"ArrayExpression","endLine":138,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [refresh]","fix":{"range":[3698,3700],"text":"[refresh]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'fetchTransactions' and 'loading'. Either include them or remove the dependency array.","line":145,"column":6,"nodeType":"ArrayExpression","endLine":145,"endColumn":15,"suggestions":[{"desc":"Update the dependencies array to be: [fetchTransactions, filters, loading]","fix":{"range":[3828,3837],"text":"[fetchTransactions, filters, loading]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\nimport { earningsService } from '../services/earningsService';\n\n/**\n * Hook for managing earnings data and state\n */\nexport const useEarnings = () => {\n  const [summary, setSummary] = useState(null);\n  const [transactions, setTransactions] = useState([]);\n  const [weeklyChart, setWeeklyChart] = useState([]);\n  const [payoutHistory, setPayoutHistory] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // Pagination state\n  const [currentPage, setCurrentPage] = useState(1);\n  const [totalPages, setTotalPages] = useState(1);\n  const [itemsPerPage] = useState(20);\n\n  // Filter state\n  const [filters, setFilters] = useState({\n    dateFrom: null,\n    dateTo: null,\n    type: null\n  });\n\n  /**\n   * Fetch earnings summary\n   */\n  const fetchSummary = useCallback(async () => {\n    try {\n      const data = await earningsService.getSummary();\n      setSummary(data);\n    } catch (err) {\n      console.error('Failed to fetch earnings summary:', err);\n      setError(err.message);\n    }\n  }, []);\n\n  /**\n   * Fetch transactions with pagination and filters\n   */\n  const fetchTransactions = useCallback(async (page = currentPage) => {\n    try {\n      setLoading(true);\n      const data = await earningsService.getTransactions(page, itemsPerPage, filters);\n      setTransactions(data.transactions || []);\n      setTotalPages(data.totalPages || 1);\n      setCurrentPage(page);\n      setError(null);\n    } catch (err) {\n      console.error('Failed to fetch transactions:', err);\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  }, [currentPage, itemsPerPage, filters]);\n\n  /**\n   * Fetch weekly chart data\n   */\n  const fetchWeeklyChart = useCallback(async () => {\n    try {\n      const data = await earningsService.getWeeklyChart();\n      setWeeklyChart(data);\n    } catch (err) {\n      console.error('Failed to fetch weekly chart:', err);\n    }\n  }, []);\n\n  /**\n   * Fetch payout history\n   */\n  const fetchPayoutHistory = useCallback(async () => {\n    try {\n      const data = await earningsService.getPayoutHistory();\n      setPayoutHistory(data);\n    } catch (err) {\n      console.error('Failed to fetch payout history:', err);\n    }\n  }, []);\n\n  /**\n   * Request a payout\n   */\n  const requestPayout = useCallback(async (amount, method = 'bank_transfer') => {\n    try {\n      const result = await earningsService.requestPayout(amount, method);\n      // Refresh summary and payout history\n      await fetchSummary();\n      await fetchPayoutHistory();\n      return result;\n    } catch (err) {\n      console.error('Failed to request payout:', err);\n      throw err;\n    }\n  }, [fetchSummary, fetchPayoutHistory]);\n\n  /**\n   * Update filters\n   */\n  const updateFilters = useCallback((newFilters) => {\n    setFilters(prev => ({ ...prev, ...newFilters }));\n    setCurrentPage(1); // Reset to first page when filters change\n  }, []);\n\n  /**\n   * Go to specific page\n   */\n  const goToPage = useCallback((page) => {\n    if (page >= 1 && page <= totalPages) {\n      fetchTransactions(page);\n    }\n  }, [totalPages, fetchTransactions]);\n\n  /**\n   * Refresh all data\n   */\n  const refresh = useCallback(async () => {\n    setLoading(true);\n    try {\n      await Promise.all([\n        fetchSummary(),\n        fetchTransactions(),\n        fetchWeeklyChart(),\n        fetchPayoutHistory()\n      ]);\n    } catch (err) {\n      console.error('Failed to refresh earnings data:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, [fetchSummary, fetchTransactions, fetchWeeklyChart, fetchPayoutHistory]);\n\n  // Initial load\n  useEffect(() => {\n    refresh();\n  }, []);\n\n  // Reload transactions when filters change\n  useEffect(() => {\n    if (!loading) {\n      fetchTransactions(1);\n    }\n  }, [filters]);\n\n  return {\n    // Data\n    summary,\n    transactions,\n    weeklyChart,\n    payoutHistory,\n\n    // State\n    loading,\n    error,\n\n    // Pagination\n    currentPage,\n    totalPages,\n    itemsPerPage,\n    goToPage,\n\n    // Filters\n    filters,\n    updateFilters,\n\n    // Actions\n    requestPayout,\n    refresh\n  };\n};\n\nexport default useEarnings;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\hooks\\useGoogleMaps.js","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'isLoaded'. Either include it or remove the dependency array.","line":51,"column":6,"nodeType":"ArrayExpression","endLine":51,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [isLoaded]","fix":{"range":[1850,1852],"text":"[isLoaded]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\nimport { GOOGLE_API_KEY, GOOGLE_MAPS_LIBRARIES, GOOGLE_MAPS_CONFIG } from '../config/google';\n\n/**\n * Hook to load Google Maps JavaScript API\n * Prevents duplicate script loading and handles initialization\n */\nconst useGoogleMaps = () => {\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [loadError, setLoadError] = useState(null);\n\n  useEffect(() => {\n    // Check if Google Maps is already loaded\n    if (window.google && window.google.maps) {\n      setIsLoaded(true);\n      return;\n    }\n\n    // Check if script is already being loaded\n    const existingScript = document.querySelector('script[src*=\"maps.googleapis.com\"]');\n    if (existingScript) {\n      existingScript.addEventListener('load', () => setIsLoaded(true));\n      existingScript.addEventListener('error', () => setLoadError(new Error('Failed to load Google Maps')));\n      return;\n    }\n\n    // Create and load script\n    const script = document.createElement('script');\n    const libraries = GOOGLE_MAPS_LIBRARIES.join(',');\n    script.src = `https://maps.googleapis.com/maps/api/js?key=${GOOGLE_API_KEY}&libraries=${libraries}&v=${GOOGLE_MAPS_CONFIG.version}&region=${GOOGLE_MAPS_CONFIG.region}&language=${GOOGLE_MAPS_CONFIG.language}`;\n    script.async = true;\n    script.defer = true;\n\n    script.addEventListener('load', () => {\n      setIsLoaded(true);\n    });\n\n    script.addEventListener('error', () => {\n      setLoadError(new Error('Failed to load Google Maps script'));\n    });\n\n    document.head.appendChild(script);\n\n    return () => {\n      // Cleanup if component unmounts before script loads\n      if (!isLoaded) {\n        script.removeEventListener('load', () => setIsLoaded(true));\n        script.removeEventListener('error', () => setLoadError(new Error('Failed to load Google Maps')));\n      }\n    };\n  }, []);\n\n  return { isLoaded, loadError };\n};\n\nexport default useGoogleMaps;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\hooks\\useKeyboardShortcuts.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'lastTriggeredRef' is assigned a value but never used.","line":42,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":42,"endColumn":25},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'handleBuiltInTrigger', 'handleFocusAction', and 'showFeedback'. Either include them or remove the dependency array.","line":147,"column":6,"nodeType":"ArrayExpression","endLine":147,"endColumn":55,"suggestions":[{"desc":"Update the dependencies array to be: [handlers, enableVisualFeedback, showFeedback, handleBuiltInTrigger, handleFocusAction, navigate]","fix":{"range":[4149,4198],"text":"[handlers, enableVisualFeedback, showFeedback, handleBuiltInTrigger, handleFocusAction, navigate]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useCallback, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { KEYBOARD_SHORTCUTS, SHORTCUT_ACTIONS } from '../constants/keyboardShortcuts';\nimport { toast } from 'react-toastify';\n\n/**\n * Professional Keyboard Shortcuts Hook\n *\n * Centralized, scalable keyboard shortcut system supporting:\n * - Context-aware shortcuts\n * - Platform detection (Mac/Windows)\n * - Custom handlers\n * - Visual feedback\n * - Conflict detection\n *\n * Usage:\n *   useKeyboardShortcuts({\n *     onSave: () => saveForm(),\n *     onSearch: () => setSearchOpen(true),\n *     enableVisualFeedback: true,\n *   });\n */\nexport function useKeyboardShortcuts(options = {}) {\n  const navigate = useNavigate();\n  const {\n    // Custom handlers for specific shortcuts\n    handlers = {},\n    // Enable/disable shortcuts\n    enabled = true,\n    // Show toast feedback when shortcuts trigger\n    enableVisualFeedback = false,\n    // Only enable certain tiers (1, 2, 3)\n    enabledTiers = [1, 2, 3],\n    // Context (e.g., 'list', 'form', 'chat') for context-specific shortcuts\n    context = null,\n  } = options;\n\n  // Detect platform\n  const isMac = typeof window !== 'undefined' && navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n\n  // Track last triggered shortcut for visual feedback\n  const lastTriggeredRef = useRef(null);\n\n  /**\n   * Check if event target is an input field where we should ignore shortcuts\n   */\n  const shouldIgnoreEvent = useCallback((event, shortcut) => {\n    const target = event.target;\n    const tagName = target.tagName.toLowerCase();\n    const isEditable = target.isContentEditable;\n    const isTypingContext = tagName === 'input' || tagName === 'textarea' || tagName === 'select' || isEditable;\n\n    // Always allow Escape\n    if (event.key === 'Escape') {\n      return false;\n    }\n\n    // Ignore most shortcuts when typing\n    if (isTypingContext) {\n      // Exception: Allow Cmd/Ctrl+S (save), Cmd/Ctrl+Enter (submit) in forms\n      const isSaveOrSubmit = (event.key === 's' || event.key === 'Enter') &&\n                             (event.metaKey || event.ctrlKey);\n      if (isSaveOrSubmit) {\n        return false;\n      }\n      return true;\n    }\n\n    return false;\n  }, []);\n\n  /**\n   * Check if shortcut matches the current event\n   */\n  const matchesShortcut = useCallback((event, shortcut) => {\n    const eventKey = event.key.toLowerCase();\n    const shortcutKey = shortcut.key.toLowerCase();\n\n    // Check key match\n    if (eventKey !== shortcutKey && eventKey !== shortcut.key) {\n      return false;\n    }\n\n    // Check meta key (Cmd on Mac, Ctrl on Windows)\n    if (shortcut.meta) {\n      const hasModifier = isMac ? event.metaKey : event.ctrlKey;\n      if (!hasModifier) return false;\n    }\n\n    // Check shift\n    if (shortcut.shift && !event.shiftKey) {\n      return false;\n    }\n\n    // Check alt\n    if (shortcut.alt && !event.altKey) {\n      return false;\n    }\n\n    return true;\n  }, [isMac]);\n\n  /**\n   * Execute shortcut action\n   */\n  const executeShortcut = useCallback((shortcutId, shortcut, event) => {\n    event.preventDefault();\n\n    // Check if there's a custom handler\n    const customHandler = handlers[shortcut.handler];\n    if (customHandler) {\n      customHandler(event);\n      if (enableVisualFeedback) {\n        showFeedback(shortcut);\n      }\n      return;\n    }\n\n    // Execute built-in actions\n    switch (shortcut.action) {\n      case SHORTCUT_ACTIONS.NAVIGATE:\n        if (shortcut.path) {\n          console.log(`[Keyboard] Navigate to ${shortcut.path}`);\n          navigate(shortcut.path);\n          if (enableVisualFeedback) {\n            showFeedback(shortcut);\n          }\n        }\n        break;\n\n      case SHORTCUT_ACTIONS.TRIGGER:\n        // Handle built-in triggers\n        handleBuiltInTrigger(shortcut.handler, event);\n        if (enableVisualFeedback) {\n          showFeedback(shortcut);\n        }\n        break;\n\n      case SHORTCUT_ACTIONS.FOCUS:\n        // Handle focus actions\n        handleFocusAction(shortcut.handler, event);\n        break;\n\n      default:\n        console.warn(`[Keyboard] Unknown action: ${shortcut.action}`);\n    }\n  }, [handlers, navigate, enableVisualFeedback, isMac]);\n\n  /**\n   * Handle built-in trigger actions\n   */\n  const handleBuiltInTrigger = useCallback((handler, event) => {\n    switch (handler) {\n      case 'history.back':\n        window.history.back();\n        break;\n\n      case 'history.forward':\n        window.history.forward();\n        break;\n\n      case 'openGlobalSearch':\n        // Dispatch custom event for search component to listen to\n        window.dispatchEvent(new CustomEvent('openGlobalSearch'));\n        // Fallback: Focus search input\n        const searchInput = document.querySelector('input[type=\"search\"], input[placeholder*=\"Search\" i]');\n        if (searchInput) {\n          searchInput.focus();\n        }\n        break;\n\n      case 'openKeyboardShortcuts':\n        // Dispatch event for support panel to open\n        window.dispatchEvent(new CustomEvent('openKeyboardShortcuts'));\n        break;\n\n      case 'cancelOrClose':\n        // Dispatch escape event for modals\n        window.dispatchEvent(new CustomEvent('keyboardEscape'));\n        // Blur active element\n        if (document.activeElement) {\n          document.activeElement.blur();\n        }\n        break;\n\n      case 'copyCurrentLink':\n        const url = window.location.href;\n        navigator.clipboard.writeText(url).then(() => {\n          toast.success('Link copied to clipboard', { autoClose: 2000 });\n        });\n        break;\n\n      default:\n        console.log(`[Keyboard] Trigger: ${handler}`);\n    }\n  }, []);\n\n  /**\n   * Handle focus actions\n   */\n  const handleFocusAction = useCallback((handler, event) => {\n    switch (handler) {\n      case 'focusFilter':\n        const filterInput = document.querySelector('[data-filter-input], input[placeholder*=\"Filter\" i]');\n        if (filterInput) {\n          filterInput.focus();\n        }\n        break;\n\n      default:\n        console.log(`[Keyboard] Focus: ${handler}`);\n    }\n  }, []);\n\n  /**\n   * Show visual feedback for shortcut\n   */\n  const showFeedback = useCallback((shortcut) => {\n    const key = isMac ?\n      `âŒ˜${shortcut.key.toUpperCase()}` :\n      `Ctrl+${shortcut.key.toUpperCase()}`;\n\n    toast.info(`[${key}] ${shortcut.label}`, {\n      autoClose: 1500,\n      hideProgressBar: true,\n      position: 'bottom-right',\n    });\n  }, [isMac]);\n\n  /**\n   * Main keyboard event handler\n   */\n  const handleKeyDown = useCallback((event) => {\n    if (!enabled) return;\n\n    // Check all shortcuts for a match\n    for (const [shortcutId, shortcut] of Object.entries(KEYBOARD_SHORTCUTS)) {\n      // Skip if tier not enabled\n      if (!enabledTiers.includes(shortcut.tier)) {\n        continue;\n      }\n\n      // Skip context-only shortcuts if not in that context\n      if (shortcut.contextOnly && context !== shortcut.context) {\n        continue;\n      }\n\n      // Check if should ignore this event\n      if (shouldIgnoreEvent(event, shortcut)) {\n        continue;\n      }\n\n      // Check if shortcut matches\n      if (matchesShortcut(event, shortcut)) {\n        executeShortcut(shortcutId, shortcut, event);\n        break; // Only execute first matching shortcut\n      }\n    }\n  }, [enabled, enabledTiers, context, shouldIgnoreEvent, matchesShortcut, executeShortcut]);\n\n  // Register global keyboard listener\n  useEffect(() => {\n    if (!enabled) return;\n\n    window.addEventListener('keydown', handleKeyDown);\n\n    return () => {\n      window.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [enabled, handleKeyDown]);\n\n  // Return utilities\n  return {\n    isMac,\n    getModifierKey: () => isMac ? 'âŒ˜' : 'Ctrl',\n    formatShortcut: (keys) => {\n      const modKey = isMac ? 'âŒ˜' : 'Ctrl';\n      return keys.replace('Cmd', modKey).replace('Ctrl', modKey);\n    },\n  };\n}\n\n/**\n * Get keyboard shortcut display string\n */\nexport function getShortcutDisplay(shortcut) {\n  const isMac = typeof window !== 'undefined' && navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n  const modKey = isMac ? 'âŒ˜' : 'Ctrl';\n\n  return shortcut\n    .replace('Cmd', modKey)\n    .replace('Ctrl', modKey)\n    .replace('+', '');\n}\n\nexport default useKeyboardShortcuts;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\hooks\\useMediaSocket.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\hooks\\useSectionDelete.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\hooks\\useServiceWorker.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\hooks\\useSocket.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\hooks\\useStandaloneMode.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\hooks\\useSurveyReportData.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\hooks\\useSyncedTimer.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\hooks\\useTeamSocket.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'useCallback' is defined but never used.","line":7,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * useTeamSocket Hook\n * Handles real-time team event subscriptions via Socket.io\n * Extends the base useSocket hook with team-specific events\n */\n\nimport { useEffect, useCallback, useRef } from 'react';\nimport { toast } from 'react-toastify';\nimport useSocket from './useSocket';\n\n/**\n * Hook for subscribing to team events\n * @param {Object} options\n * @param {string} options.companyId - Company ID to filter events\n * @param {string} options.currentUserId - Current user UUID (to prevent duplicate toasts)\n * @param {Function} options.onMemberJoined - Callback when member joins\n * @param {Function} options.onMemberRemoved - Callback when member removed\n * @param {Function} options.onRoleChanged - Callback when role changes\n * @param {Function} options.onInviteSent - Callback when invite sent\n * @param {boolean} options.showToasts - Show toast notifications (default: true)\n */\nconst useTeamSocket = ({\n  companyId,\n  currentUserId,\n  onMemberJoined,\n  onMemberRemoved,\n  onRoleChanged,\n  onInviteSent,\n  showToasts = true,\n} = {}) => {\n  const { socket, isConnected } = useSocket();\n  const handlersRef = useRef({\n    onMemberJoined,\n    onMemberRemoved,\n    onRoleChanged,\n    onInviteSent,\n  });\n\n  // Keep handlers ref updated\n  useEffect(() => {\n    handlersRef.current = {\n      onMemberJoined,\n      onMemberRemoved,\n      onRoleChanged,\n      onInviteSent,\n    };\n  }, [onMemberJoined, onMemberRemoved, onRoleChanged, onInviteSent]);\n\n  useEffect(() => {\n    if (!socket || !isConnected || !companyId) return;\n\n    // Join company room for team events\n    socket.emit('join:company', { companyId });\n    console.log('[TeamSocket] Joined company room:', companyId);\n\n    // Member joined (accepted invite)\n    const handleMemberJoined = (data) => {\n      console.log('[TeamSocket] Member joined:', data);\n\n      if (data.companyId !== companyId) return;\n\n      // Don't show toast for own actions\n      if (showToasts && data.triggeredBy !== currentUserId) {\n        toast.success(\n          `ðŸŽ‰ ${data.firstName} ${data.lastName} joined the team!`,\n          { autoClose: 5000 }\n        );\n      }\n\n      handlersRef.current.onMemberJoined?.(data);\n    };\n\n    // Member removed\n    const handleMemberRemoved = (data) => {\n      console.log('[TeamSocket] Member removed:', data);\n\n      if (data.companyId !== companyId) return;\n\n      // Don't show toast for own actions\n      if (showToasts && data.triggeredBy !== currentUserId) {\n        toast.info(\n          `${data.firstName} ${data.lastName} was removed from the team`,\n          { autoClose: 4000 }\n        );\n      }\n\n      handlersRef.current.onMemberRemoved?.(data);\n    };\n\n    // Role changed\n    const handleRoleChanged = (data) => {\n      console.log('[TeamSocket] Role changed:', data);\n\n      if (data.companyId !== companyId) return;\n\n      // Don't show toast for own actions\n      if (showToasts && data.triggeredBy !== currentUserId) {\n        toast.info(\n          `${data.firstName}'s role changed to ${data.newRole}`,\n          { autoClose: 4000 }\n        );\n      }\n\n      handlersRef.current.onRoleChanged?.(data);\n    };\n\n    // Invite sent (by another admin)\n    const handleInviteSent = (data) => {\n      console.log('[TeamSocket] Invite sent:', data);\n\n      if (data.companyId !== companyId) return;\n\n      // Don't show toast for own actions\n      if (showToasts && data.triggeredBy !== currentUserId) {\n        toast.info(\n          `Invite sent to ${data.firstName} ${data.lastName}`,\n          { autoClose: 3000 }\n        );\n      }\n\n      handlersRef.current.onInviteSent?.(data);\n    };\n\n    // Subscribe to events\n    socket.on('team:memberJoined', handleMemberJoined);\n    socket.on('team:memberRemoved', handleMemberRemoved);\n    socket.on('team:roleChanged', handleRoleChanged);\n    socket.on('team:inviteSent', handleInviteSent);\n\n    // Cleanup\n    return () => {\n      socket.off('team:memberJoined', handleMemberJoined);\n      socket.off('team:memberRemoved', handleMemberRemoved);\n      socket.off('team:roleChanged', handleRoleChanged);\n      socket.off('team:inviteSent', handleInviteSent);\n      socket.emit('leave:company', { companyId });\n      console.log('[TeamSocket] Left company room:', companyId);\n    };\n  }, [socket, isConnected, companyId, currentUserId, showToasts]);\n\n  return {\n    socket,\n    isConnected,\n  };\n};\n\nexport default useTeamSocket;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\hooks\\useTeamSuggestions.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\mockData\\surveyMockData.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\Account.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'handleLogout' is assigned a value but never used.","line":79,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":79,"endColumn":21},{"ruleId":"jsx-a11y/anchor-is-valid","severity":1,"message":"The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/anchor-is-valid.md","line":138,"column":11,"nodeType":"JSXOpeningElement","endLine":146,"endColumn":12}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport { motion } from 'framer-motion';\r\nimport ProfileSection from '../components/account/ProfileSection';\r\nimport FormSection from '../components/ui/FormSection';\r\nimport Button from '../components/ui/Button';\r\nimport Card from '../components/ui/Card';\r\nimport ChangePasswordModal from '../components/account/ChangePasswordModal';\r\nimport TeamManagement from './Team/TeamManagement';\r\nimport CustomerInvitation from '../components/Admin/CustomerInvitation';\r\nimport { toast } from 'react-toastify';\r\nimport accountStyles from '../components/account/Account.module.css';\r\nimport { useServiceWorker } from '../hooks/useServiceWorker';\r\nimport { getVersionInfo, DEPLOYMENT_NUMBER, DEPLOYMENT_VERSION, BUILD_DATE, BUILD_TIME } from '../config/version';\r\nimport { isCurrentUserAdminAsync } from '../utils/adminUtils';\r\n\r\n/**\r\n * Account Management Page\r\n * Settings tab with Profile, Security, Team, Account Details, Danger Zone\r\n * Billing tab with placeholder for future payment integration\r\n */\r\nconst Account = () => {\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const [activeTab, setActiveTab] = useState('settings');\r\n  const [passwordModalOpen, setPasswordModalOpen] = useState(false);\r\n  const { updateAvailable, applyUpdate } = useServiceWorker();\r\n  const [checkingForUpdates, setCheckingForUpdates] = useState(false);\r\n  const [isSuperAdmin, setIsSuperAdmin] = useState(false);\r\n\r\n  // Get app version info\r\n  const versionInfo = getVersionInfo();\r\n\r\n  // Check if we should open Inventory tab (from navigation state)\r\n  useEffect(() => {\r\n    if (location.state?.openInventory) {\r\n      setActiveTab('inventory');\r\n    }\r\n  }, [location.state]);\r\n\r\n  // Check if user is super admin\r\n  useEffect(() => {\r\n    const checkAdminStatus = async () => {\r\n      const isAdmin = await isCurrentUserAdminAsync();\r\n      console.log('[Account] Super admin status:', isAdmin);\r\n\r\n      // TEMPORARY: Also check userData directly for debugging\r\n      const userData = JSON.parse(sessionStorage.getItem('userData') || '{}');\r\n      console.log('[Account] Current userData:', userData);\r\n      console.log('[Account] userData.isSuperAdmin:', userData.isSuperAdmin);\r\n      console.log('[Account] userData.is_super_user:', userData.is_super_user);\r\n      console.log('[Account] userData.email:', userData.email);\r\n\r\n      // Fallback: Also check userData directly if backend verification fails\r\n      const isAdminFromUserData = userData.isSuperAdmin === true ||\r\n                                   userData.is_super_user === true ||\r\n                                   userData.isSuperUser === true;\r\n\r\n      const finalAdminStatus = isAdmin || isAdminFromUserData;\r\n      console.log('[Account] Final admin status:', finalAdminStatus);\r\n      setIsSuperAdmin(finalAdminStatus);\r\n    };\r\n    checkAdminStatus();\r\n  }, []);\r\n\r\n  const tabs = [\r\n    { id: 'settings', label: 'Settings' },\r\n    { id: 'billing', label: 'Billing' },\r\n  ];\r\n\r\n  const handleSuccess = (message) => {\r\n    toast.success(message);\r\n  };\r\n\r\n  const handleError = (message) => {\r\n    toast.error(message);\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    localStorage.clear();\r\n    navigate('/login');\r\n  };\r\n\r\n  // Manual check for updates\r\n  const handleCheckForUpdates = async () => {\r\n    setCheckingForUpdates(true);\r\n\r\n    // Force service worker to check for updates\r\n    if ('serviceWorker' in navigator) {\r\n      try {\r\n        const registration = await navigator.serviceWorker.getRegistration();\r\n        if (registration) {\r\n          await registration.update();\r\n\r\n          // Wait a moment to see if update was found\r\n          setTimeout(() => {\r\n            setCheckingForUpdates(false);\r\n            if (!updateAvailable) {\r\n              toast.info('You are already on the latest version!', {\r\n                position: 'top-right',\r\n                autoClose: 3000,\r\n              });\r\n            }\r\n          }, 1500);\r\n        } else {\r\n          setCheckingForUpdates(false);\r\n          toast.info('Service worker not registered', {\r\n            position: 'top-right',\r\n            autoClose: 3000,\r\n          });\r\n        }\r\n      } catch (error) {\r\n        setCheckingForUpdates(false);\r\n        toast.error('Failed to check for updates', {\r\n          position: 'top-right',\r\n          autoClose: 3000,\r\n        });\r\n      }\r\n    } else {\r\n      setCheckingForUpdates(false);\r\n      toast.info('Updates not supported in this browser', {\r\n        position: 'top-right',\r\n        autoClose: 3000,\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      exit={{ opacity: 0 }}\r\n      className={accountStyles.container}\r\n    >\r\n      {/* Subtab Navigation */}\r\n      <div className={accountStyles.subtabContainer}>\r\n        {tabs.map((tab, index) => (\r\n          <a\r\n            key={tab.id}\r\n            href=\"#\"\r\n            onClick={(e) => {\r\n              e.preventDefault();\r\n              setActiveTab(tab.id);\r\n            }}\r\n            className={`${accountStyles.subtabLink} ${activeTab === tab.id ? accountStyles.subtabLinkActive : ''} ${index === 0 ? accountStyles.subtabLinkFirst : ''}`}\r\n          >\r\n            {tab.label}\r\n            {activeTab === tab.id && (\r\n              <span className={`${accountStyles.subtabIndicator} ${index === 0 ? accountStyles.subtabIndicatorFirst : accountStyles.subtabIndicatorCenter}`} />\r\n            )}\r\n          </a>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Tab Content */}\r\n      <div className={accountStyles.tabContent}>\r\n        {/* SETTINGS TAB */}\r\n        {activeTab === 'settings' && (\r\n          <div className={accountStyles.settingsGrid}>\r\n            {/* Left Column */}\r\n            <div className={accountStyles.leftColumn}>\r\n              {/* Profile Section with Account Details */}\r\n              <ProfileSection\r\n                onSuccess={handleSuccess}\r\n                onError={handleError}\r\n              />\r\n\r\n              {/* Customer Invitation Section - Super Admin Only */}\r\n              {isSuperAdmin && (\r\n                <FormSection title=\"Customer Invitation\">\r\n                  <CustomerInvitation />\r\n                </FormSection>\r\n              )}\r\n            </div>\r\n\r\n            {/* Right Column */}\r\n            <div className={accountStyles.rightColumn}>\r\n              {/* Security Section */}\r\n              <FormSection title=\"Security\">\r\n                <div className={accountStyles.securityContent}>\r\n                  <div className={accountStyles.securityItem}>\r\n                    <div>\r\n                      <h4 className={accountStyles.securityItemTitle}>Password</h4>\r\n                      <p className={accountStyles.securityItemDesc}>\r\n                        Change your password to keep your account secure\r\n                      </p>\r\n                    </div>\r\n                    <Button variant=\"secondary\" onClick={() => setPasswordModalOpen(true)}>\r\n                      Change Password\r\n                    </Button>\r\n                  </div>\r\n                  <div className={accountStyles.securityItem}>\r\n                    <div>\r\n                      <h4 className={accountStyles.securityItemTitle}>Two-Factor Authentication</h4>\r\n                      <p className={accountStyles.securityItemDesc}>\r\n                        Add an extra layer of security to your account\r\n                      </p>\r\n                    </div>\r\n                    <span className={accountStyles.comingSoonBadge}>Coming Soon</span>\r\n                  </div>\r\n                </div>\r\n              </FormSection>\r\n\r\n              {/* App Version & Updates Section */}\r\n              <FormSection title=\"App Version & Updates\">\r\n                <div className={accountStyles.securityContent}>\r\n                  {/* Deployment Info - Super Admin Only */}\r\n                  {isSuperAdmin && (\r\n                    <div className={accountStyles.deploymentInfoBox}>\r\n                      <div className={accountStyles.deploymentInfoGrid}>\r\n                        <div className={accountStyles.deploymentInfoItem}>\r\n                          <span className={accountStyles.deploymentInfoLabel}>Deploy #</span>\r\n                          <span className={accountStyles.deploymentInfoValue}>{DEPLOYMENT_NUMBER}</span>\r\n                        </div>\r\n                        <div className={accountStyles.deploymentInfoItem}>\r\n                          <span className={accountStyles.deploymentInfoLabel}>Version</span>\r\n                          <span className={accountStyles.deploymentInfoValue}>{DEPLOYMENT_VERSION}</span>\r\n                        </div>\r\n                        <div className={accountStyles.deploymentInfoItem}>\r\n                          <span className={accountStyles.deploymentInfoLabel}>Deployed</span>\r\n                          <span className={accountStyles.deploymentInfoValue}>{BUILD_DATE} {BUILD_TIME}</span>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  <div className={accountStyles.securityItem}>\r\n                    <div>\r\n                      <h4 className={accountStyles.securityItemTitle}>Current Version</h4>\r\n                      <p className={accountStyles.securityItemDesc}>\r\n                        Version {versionInfo.appVersion} ({versionInfo.buildDate})\r\n                        {versionInfo.serviceWorkerActive && ' â€¢ PWA Active'}\r\n                      </p>\r\n                    </div>\r\n                    <div className={accountStyles.versionActions}>\r\n                      {updateAvailable && (\r\n                        <span className={accountStyles.updateBadge}>\r\n                          Update Available\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  <div className={accountStyles.securityItem}>\r\n                    <div>\r\n                      <h4 className={accountStyles.securityItemTitle}>\r\n                        {updateAvailable ? 'Update Now' : 'Check for Updates'}\r\n                      </h4>\r\n                      <p className={accountStyles.securityItemDesc}>\r\n                        {updateAvailable\r\n                          ? 'A new version is ready to install'\r\n                          : 'Manually check if a new version is available'\r\n                        }\r\n                      </p>\r\n                    </div>\r\n                    <Button\r\n                      variant={updateAvailable ? \"primary\" : \"secondary\"}\r\n                      onClick={updateAvailable ? applyUpdate : handleCheckForUpdates}\r\n                      disabled={checkingForUpdates}\r\n                    >\r\n                      {checkingForUpdates\r\n                        ? 'Checking...'\r\n                        : updateAvailable\r\n                          ? 'Install Update'\r\n                          : 'Check for Updates'\r\n                      }\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </FormSection>\r\n\r\n              {/* Team Management Section - Super Admin Only */}\r\n              {isSuperAdmin && (\r\n                <FormSection title=\"Team Management\">\r\n                  <TeamManagement />\r\n                </FormSection>\r\n              )}\r\n\r\n              {/* Danger Zone */}\r\n              <FormSection title=\"Danger Zone\">\r\n                <Card className={accountStyles.dangerCard}>\r\n                  <Card.Body>\r\n                    <div className={accountStyles.dangerContent}>\r\n                      <div>\r\n                        <h4 className={accountStyles.dangerTitle}>Delete Account</h4>\r\n                        <p className={accountStyles.dangerDesc}>\r\n                          Permanently delete your account and all associated data. This action cannot\r\n                          be undone.\r\n                        </p>\r\n                      </div>\r\n                      <Button variant=\"secondary\" onClick={() => alert('Delete account feature coming soon')}>\r\n                        Delete Account\r\n                      </Button>\r\n                    </div>\r\n                  </Card.Body>\r\n                </Card>\r\n              </FormSection>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* BILLING TAB */}\r\n        {activeTab === 'billing' && (\r\n          <div className={accountStyles.billingContainer}>\r\n            <Card>\r\n              <Card.Header>\r\n                <h2>Billing & Project Credits</h2>\r\n              </Card.Header>\r\n              <Card.Body>\r\n                <div className={accountStyles.placeholderContent}>\r\n                  <div className={accountStyles.placeholderIcon}>ðŸ’³</div>\r\n                  <h3 className={accountStyles.placeholderHeading}>Coming Soon</h3>\r\n                  <p className={accountStyles.placeholderText}>\r\n                    Purchase project credits and manage billing directly from your account.\r\n                    Payment integration will be available soon.\r\n                  </p>\r\n                  <div className={accountStyles.billingFeatures}>\r\n                    <div className={accountStyles.feature}>âœ“ Flexible project credit packages</div>\r\n                    <div className={accountStyles.feature}>âœ“ Volume discounts</div>\r\n                    <div className={accountStyles.feature}>âœ“ Secure payment processing</div>\r\n                    <div className={accountStyles.feature}>âœ“ Transaction history</div>\r\n                  </div>\r\n                </div>\r\n              </Card.Body>\r\n            </Card>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Modals */}\r\n      <ChangePasswordModal\r\n        isOpen={passwordModalOpen}\r\n        onClose={() => setPasswordModalOpen(false)}\r\n        onSuccess={handleSuccess}\r\n        onError={handleError}\r\n      />\r\n    </motion.div>\r\n  );\r\n};\r\n\r\nexport default Account;\r\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\Admin\\PendingRegistrations.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\Auth\\RedeemInvite.js","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'handleValidateCode'. Either include it or remove the dependency array.","line":46,"column":6,"nodeType":"ArrayExpression","endLine":46,"endColumn":20,"suggestions":[{"desc":"Update the dependencies array to be: [handleValidateCode, searchParams]","fix":{"range":[1489,1503],"text":"[handleValidateCode, searchParams]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\Auth\\Register.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\Auth\\Registration.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\Auth\\RegistrationSuccess.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\Companies.js","messages":[{"ruleId":"array-callback-return","severity":1,"message":"Array.prototype.map() expects a return value from arrow function.","line":66,"column":39,"nodeType":"ArrowFunctionExpression","messageId":"expectedInside","endLine":66,"endColumn":41}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { Button, Input } from 'reactstrap';\r\nimport { AgGridReact } from 'ag-grid-react';\r\nimport Moment from 'react-moment';\r\nimport Swal from 'sweetalert2';\r\nimport { toast } from 'react-toastify';\r\nimport { LoadingSpinner } from '../components/ui';\r\nimport logger from '../services/devLogger';\r\nimport styles from './Companies.module.css';\r\n\r\n// Table component wrapper (same as ExistingProjects)\r\nconst TableComponent = ({ rowData, columnDefs, title }) => {\r\n  const [searchText, setSearchText] = useState('');\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"d-flex justify-content-between align-items-center mb-3\">\r\n        <h4>{title}</h4>\r\n        <input\r\n          type=\"text\"\r\n          value={searchText}\r\n          onChange={(e) => setSearchText(e.target.value)}\r\n          placeholder=\"Search...\"\r\n          className={`form-control ${styles.searchInput}`}\r\n        />\r\n      </div>\r\n      <div className={`ag-theme-alpine ${styles.gridContainer}`}>\r\n        <AgGridReact\r\n          rowData={rowData}\r\n          columnDefs={[\r\n            {\r\n              headerName: '#',\r\n              valueGetter: 'node.rowIndex + 1',\r\n              width: 50,\r\n              sortable: false,\r\n              filter: false,\r\n            },\r\n            ...columnDefs,\r\n          ]}\r\n          defaultColDef={{\r\n            resizable: true,\r\n            filter: false,\r\n            sortable: true,\r\n          }}\r\n          pagination={true}\r\n          quickFilterText={searchText}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst Companies = () => {\r\n  const [companies, setCompanies] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const fetchCompanies = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const response = await axios.get('/api/companies/list');\r\n      setLoading(false);\r\n\r\n      if (response && response.data && response.data.data.length > 0) {\r\n        const companyData = [];\r\n        response.data.data.map((item) => {\r\n          companyData.push({\r\n            companyName: item.company.name,\r\n            name: `${item.user.firstName} ${item.user.lastName}`,\r\n            email: item.user.email,\r\n            address: `${item.company.address ? item.company.address : ''} ${\r\n              item.company.city ? item.company.city : ''\r\n            } ${item.company.state ? `, ${item.company.state}` : ''} ${\r\n              item.company.zipCode ? `, ${item.company.zipCode}` : ''\r\n            }`,\r\n            status: item.user.status,\r\n            companyUuid: item.company.uuid,\r\n            createdDate: item.company.created_at,\r\n          });\r\n        });\r\n        setCompanies([...companyData]);\r\n      }\r\n    } catch (error) {\r\n      setLoading(false);\r\n      logger.log('General', 'error ...', error);\r\n    }\r\n  };\r\n\r\n  const handleStatusChange = async (e, rowData) => {\r\n    e.preventDefault();\r\n    const result = await Swal.fire({\r\n      title: 'Are you sure?',\r\n      text: 'Do you want to change the status?',\r\n      icon: 'warning',\r\n      showCancelButton: true,\r\n      confirmButtonText: 'Yes, change it!',\r\n      cancelButtonText: 'No, cancel!',\r\n      customClass: {\r\n        confirmButton: 'bg-success',\r\n        cancelButton: 'custom-cancel-button',\r\n      },\r\n    });\r\n\r\n    if (result.isConfirmed) {\r\n      setLoading(true);\r\n      try {\r\n        await axios.patch('/api/companies/accept-reject', {\r\n          companyUuid: rowData.companyUuid,\r\n          isVerified: rowData.status !== 2,\r\n        });\r\n        setLoading(false);\r\n        fetchCompanies();\r\n      } catch (error) {\r\n        setLoading(false);\r\n        let errorMessage = 'Request Failed';\r\n        if (error.response && error.response.data && error.response.data.message) {\r\n          errorMessage = error.response.data.message;\r\n        }\r\n        toast(`Error ! ${errorMessage}`, {\r\n          position: 'top-right',\r\n          hideProgressBar: true,\r\n          closeOnClick: false,\r\n          className: 'bg-danger text-white',\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (e, rowData) => {\r\n    e.preventDefault();\r\n    const result = await Swal.fire({\r\n      title: 'Are you sure?',\r\n      text: 'Do you really want to delete this record?',\r\n      icon: 'warning',\r\n      showCancelButton: true,\r\n      confirmButtonText: 'Yes, delete it!',\r\n      cancelButtonText: 'No, cancel!',\r\n      customClass: {\r\n        confirmButton: 'bg-success',\r\n        cancelButton: 'custom-cancel-button',\r\n      },\r\n    });\r\n\r\n    if (result.isConfirmed) {\r\n      setLoading(true);\r\n      try {\r\n        await axios.delete(`/api/companies/delete/${rowData.companyUuid}`);\r\n        setLoading(false);\r\n        fetchCompanies();\r\n      } catch (error) {\r\n        setLoading(false);\r\n        let errorMessage = 'Request Failed';\r\n        if (error.response && error.response.data && error.response.data.message) {\r\n          errorMessage = error.response.data.message;\r\n        }\r\n        toast(`Error ! ${errorMessage}`, {\r\n          position: 'top-right',\r\n          hideProgressBar: true,\r\n          closeOnClick: false,\r\n          className: 'bg-danger text-white',\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  const columnDefs = [\r\n    {\r\n      field: 'companyName',\r\n      headerName: 'Company Name',\r\n      sortable: true,\r\n      flex: 1,\r\n    },\r\n    {\r\n      field: 'name',\r\n      headerName: 'Name',\r\n      sortable: true,\r\n      flex: 1,\r\n    },\r\n    {\r\n      field: 'email',\r\n      headerName: 'Email',\r\n      sortable: true,\r\n    },\r\n    {\r\n      field: 'address',\r\n      headerName: 'Address',\r\n      sortable: true,\r\n      flex: 2,\r\n    },\r\n    {\r\n      field: 'createdDate',\r\n      headerName: 'Created Date',\r\n      sortable: false,\r\n      flex: 1,\r\n      cellRenderer: (params) => (\r\n        <Moment format=\"MM/DD/YYYY\">{params.value}</Moment>\r\n      ),\r\n    },\r\n    {\r\n      field: 'status',\r\n      headerName: 'Status',\r\n      sortable: false,\r\n      width: 100,\r\n      flex: 0.6,\r\n      cellRenderer: (params) => (\r\n        <>\r\n          <div className=\"form-check form-switch form-switch-success h-100 d-flex align-items-center\">\r\n            <Input\r\n              className=\"form-check-input\"\r\n              type=\"checkbox\"\r\n              role=\"switch\"\r\n              id={`flexSwitchCheckChecked-${params.data}`}\r\n              checked={params.data.status === 2}\r\n              onChange={(e) => handleStatusChange(e, params.data)}\r\n            />\r\n          </div>\r\n        </>\r\n      ),\r\n    },\r\n    {\r\n      field: 'action',\r\n      headerName: 'Action',\r\n      sortable: false,\r\n      width: 100,\r\n      flex: 1,\r\n      cellRenderer: (params) => (\r\n        <div className=\"h-100 d-flex align-items-center\">\r\n          <Button\r\n            color=\"danger\"\r\n            className={`btn-icon ${styles.deleteButton}`}\r\n            onClick={(e) => handleDelete(e, params.data)}\r\n          >\r\n            <i className=\"ri-delete-bin-5-line\"></i>\r\n          </Button>\r\n        </div>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  useEffect(() => {\r\n    fetchCompanies();\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"page-content\">\r\n      {loading && <LoadingSpinner />}\r\n      <TableComponent rowData={companies} columnDefs={columnDefs} title=\"Companies\" />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Companies;\r\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\CreateTicket.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\Dashboard.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'CSS_GRADIENTS' is defined but never used.","line":21,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'stats' is assigned a value but never used.","line":30,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":16},{"ruleId":"jsx-a11y/anchor-is-valid","severity":1,"message":"The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/anchor-is-valid.md","line":177,"column":11,"nodeType":"JSXOpeningElement","endLine":184,"endColumn":12},{"ruleId":"jsx-a11y/anchor-is-valid","severity":1,"message":"The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/anchor-is-valid.md","line":187,"column":11,"nodeType":"JSXOpeningElement","endLine":194,"endColumn":12},{"ruleId":"jsx-a11y/anchor-is-valid","severity":1,"message":"The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/anchor-is-valid.md","line":197,"column":11,"nodeType":"JSXOpeningElement","endLine":201,"endColumn":12}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useRef, useEffect, useMemo } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { motion } from 'framer-motion';\nimport logger from '../services/devLogger';\nimport StatusTabs from '../components/dashboard/StatusTabs';\nimport ProjectsOverview from '../components/dashboard/ProjectsOverview';\nimport ProjectInformationForm from '../components/project/ProjectInformationForm';\nimport ChatterPanel from '../components/chatter/ChatterPanel';\nimport NotificationBell from '../components/chatter/NotificationBell';\nimport TabbedPanel from '../components/common/TabbedPanel';\nimport { Button, FormSelect } from '../components/ui';\nimport Account from './Account';\nimport Inventory from './Inventory';\nimport SupportPanel from '../components/support/SupportPanel';\nimport useDashboardData from '../hooks/useDashboardData';\nimport { isCurrentUserAdminAsync } from '../utils/adminUtils';\nimport axios from '../config/axios';\nimport styles from '../styles/Dashboard.module.css';\nimport projectStyles from '../styles/ProjectAdd.module.css';\nimport pageStyles from '../pages/Project.module.css';\nimport { CSS_GRADIENTS } from '../styles/gradient';\nimport { getTimeBasedGreeting } from '../utils/constants';\n\n/**\n * Skyfire Admin Dashboard - Main Page\n * Professional industrial-themed dashboard with dark mode, animated KPI cards, and real-time data\n * Split layout: Dashboard content (70%) | Project creation form (30%)\n */\nconst Dashboard = () => {\n  const { stats, statusCounts, statusChanges, projects, loading, error, refetch} = useDashboardData();\n  const [selectedStatus, setSelectedStatus] = useState('all');\n  const [leftPanelMode, setLeftPanelMode] = useState('none'); // 'none' | 'newProject' | 'chatter'\n  const [selectedChatterProject, setSelectedChatterProject] = useState(null);\n  const [showMenuPanel, setShowMenuPanel] = useState(false); // Toggle menu/settings panel\n  const [isFormValid, setIsFormValid] = useState(false);\n  const [companies, setCompanies] = useState([]);\n  const [companyFilter, setCompanyFilter] = useState('All');\n  const [isSuperUser, setIsSuperUser] = useState(false);\n  const navigate = useNavigate();\n  const projectFormRef = useRef(null);\n\n  // Get user data from session\n  const userData = JSON.parse(sessionStorage.getItem('userData') || '{}');\n\n  // Check admin status on mount\n  useEffect(() => {\n    const checkAdminStatus = async () => {\n      const isAdmin = await isCurrentUserAdminAsync();\n      setIsSuperUser(isAdmin);\n    };\n    checkAdminStatus();\n  }, []);\n\n  // Fetch companies for super user filter\n  useEffect(() => {\n    const fetchCompanies = async () => {\n      if (!isSuperUser) return;\n\n      try {\n        const response = await axios.get('/companies/list-active');\n        if (response.data?.status === 'SUCCESS' && Array.isArray(response.data.data)) {\n          const companyOptions = [\n            { label: 'All Companies', value: 'All', uuid: 'All' },\n            ...response.data.data.map(c => ({\n              label: c.name,\n              value: c.uuid,\n              uuid: c.uuid\n            }))\n          ];\n          setCompanies(companyOptions);\n        }\n      } catch (error) {\n        logger.error('Dashboard', 'Failed to fetch companies:', error);\n      }\n    };\n\n    fetchCompanies();\n  }, [isSuperUser]);\n\n  // Filter projects by company for super users\n  const filteredProjects = useMemo(() => {\n    if (!isSuperUser || companyFilter === 'All') {\n      return projects;\n    }\n    return projects.filter(p => p.company?.uuid === companyFilter || p.company_id === companyFilter);\n  }, [projects, companyFilter, isSuperUser]);\n\n  const handleLogout = () => {\n    sessionStorage.clear();\n    navigate('/login');\n  };\n\n  const handleFlameIconClick = (e) => {\n    e.preventDefault();\n    setShowMenuPanel(!showMenuPanel);\n  };\n\n  const handleProjectCreated = (projectUuid) => {\n    logger.log('Dashboard', 'Project created on dashboard:', projectUuid);\n    // Navigate to the project page\n    navigate(`/project/${projectUuid}`);\n  };\n\n  const handleNewProjectToggle = () => {\n    if (leftPanelMode === 'newProject') {\n      setLeftPanelMode('none');\n    } else {\n      setLeftPanelMode('newProject');\n      setSelectedChatterProject(null);\n    }\n  };\n\n  const handleViewChatter = (projectInfo) => {\n    logger.debug('Dashboard', 'Opening chatter for project:', projectInfo);\n    setLeftPanelMode('chatter');\n    setSelectedChatterProject(projectInfo);\n  };\n\n  const handleCloseChatter = () => {\n    setLeftPanelMode('none');\n    setSelectedChatterProject(null);\n  };\n\n  const handleSwitchToNewProject = () => {\n    setLeftPanelMode('newProject');\n    setSelectedChatterProject(null);\n  };\n\n  const handleFormValidityChange = (isValid) => {\n    setIsFormValid(isValid);\n  };\n\n  const pageVariants = {\n    hidden: { opacity: 0 },\n    visible: {\n      opacity: 1,\n      transition: {\n        duration: 0.5,\n        when: \"beforeChildren\"\n      }\n    }\n  };\n\n  // Try multiple possible property names for first name\n  const userName = userData.first_name || userData.firstName || userData.firstname ||\n                   userData.name?.split(' ')[0] || userData.email?.split('@')[0] || 'Admin';\n\n  return (\n    <motion.div\n      className={styles.dashboardContainer}\n      variants={pageVariants}\n      initial=\"hidden\"\n      animate=\"visible\"\n    >\n      {/* Header */}\n      <div className={styles.dashboardHeader}>\n        <div className={styles.headerLeft}>\n          <h1 className={styles.dashboardTitle}>\n            {getTimeBasedGreeting(userName)}\n          </h1>\n          {/* Super User Company Filter - Left of NotificationBell */}\n          {isSuperUser && companies.length > 0 && (\n            <div className={styles.companyFilterWrapper}>\n              <FormSelect\n                options={companies}\n                value={companyFilter}\n                onChange={(e) => setCompanyFilter(e.target.value)}\n                fullWidth={false}\n                size=\"md\"\n              />\n            </div>\n          )}\n          <NotificationBell />\n        </div>\n\n        <nav className={styles.topNav}>\n          <a\n            href=\"#\"\n            onClick={(e) => {\n              e.preventDefault();\n              navigate('/scheduling');\n            }}\n            className={styles.navLink}\n          >\n            Scheduling\n          </a>\n          <a\n            href=\"#\"\n            onClick={(e) => {\n              e.preventDefault();\n              setShowMenuPanel(false);\n            }}\n            className={`${styles.navLink} ${!showMenuPanel ? styles.navLinkActive : ''}`}\n          >\n            Projects\n          </a>\n          <a\n            href=\"#\"\n            onClick={handleFlameIconClick}\n            className={styles.flameIconLink}\n          >\n            <img\n              src={showMenuPanel ? require('../assets/images/fire-active.png') : require('../assets/images/appIcon.png')}\n              alt=\"Skyfire\"\n              className={styles.flameIcon}\n            />\n          </a>\n        </nav>\n      </div>\n\n      {/* Split Layout: Project Form (30%) | Dashboard (70%) */}\n      <div className={`${styles.splitLayoutDashboard} ${leftPanelMode === 'none' ? styles.splitLayoutCollapsed : ''}`}>\n        {/* Left Column: New Project OR Chatter Panel */}\n        {leftPanelMode !== 'none' && (\n          <motion.div\n            className={`${styles.projectFormSidebar} ${\n              leftPanelMode === 'chatter' ? styles.chatterSidebarTransparent : styles.chatterSidebarSolid\n            }`}\n            initial={{ width: 0, opacity: 0 }}\n            animate={{ width: '100%', opacity: 1 }}\n            exit={{ width: 0, opacity: 0 }}\n            transition={{\n              width: { duration: 0.4, ease: [0.4, 0, 0.2, 1] },\n              opacity: { duration: 0.4, delay: 0.05, ease: [0.4, 0, 0.2, 1] }\n            }}\n          >\n            {leftPanelMode === 'newProject' && (\n              <>\n                <div className={styles.projectFormHeader}>\n                  <h2 className={styles.projectFormTitle}>New Project</h2>\n                  <Button\n                    variant=\"primary\"\n                    onClick={() => {\n                      if (projectFormRef.current && isFormValid) {\n                        projectFormRef.current.submitForm();\n                      }\n                    }}\n                    disabled={!isFormValid}\n                  >\n                    <span className={styles.createButtonIcon}>+</span>\n                    <span>Create</span>\n                  </Button>\n                </div>\n\n                <div className={projectStyles.tabContent}>\n                  <ProjectInformationForm\n                    ref={projectFormRef}\n                    onNext={handleProjectCreated}\n                    hideSubmitButton={true}\n                    onValidityChange={handleFormValidityChange}\n                  />\n                </div>\n              </>\n            )}\n\n            {leftPanelMode === 'chatter' && selectedChatterProject && (\n              <ChatterPanel\n                projectUuid={selectedChatterProject.uuid}\n                projectInfo={selectedChatterProject}\n                isInline={true}\n                onClose={handleCloseChatter}\n                onSwitchToNewProject={handleSwitchToNewProject}\n              />\n            )}\n          </motion.div>\n        )}\n\n        {/* Right: Dashboard Content (70% or 100% when collapsed) */}\n        <div className={styles.dashboardContent}>\n          {/* Error State */}\n          {error && (\n            <div className={`${styles.section} ${styles.errorSection}`}>\n              <div className={styles.errorContent}>\n                <div>\n                  <h3 className={styles.errorTitle}>âš ï¸ Error Loading Data</h3>\n                  <p className={styles.errorMessage}>{error}</p>\n                </div>\n                <Button variant=\"secondary\" onClick={refetch}>\n                  Retry\n                </Button>\n              </div>\n            </div>\n          )}\n\n          {/* Show either Menu Panel or Status Tabs */}\n          {showMenuPanel ? (\n            <div className={styles.menuPanelContainer}>\n              <TabbedPanel\n                tabs={[\n                  { id: 'account', label: 'Account' },\n                  { id: 'support', label: 'Support' },\n                  { id: 'inventory', label: 'Inventory' },\n                  { id: 'logout', label: 'Logout' }\n                ]}\n                defaultTab=\"account\"\n                storageKey=\"dashboardMenuTab\"\n                tabContent={{\n                  account: (\n                    <Account />\n                  ),\n                  support: (\n                    <div className={styles.menuTabContent}>\n                      <SupportPanel />\n                    </div>\n                  ),\n                  inventory: <Inventory />,\n                  logout: (\n                    <div className={styles.menuTabContent}>\n                      <h3 className={pageStyles.tabContentTitle}>Logout</h3>\n                      <p className={pageStyles.tabContentPlaceholder}>Are you sure you want to logout?</p>\n                      <div style={{ display: 'flex', gap: '12px' }}>\n                        <Button variant=\"primary\" onClick={handleLogout}>\n                          Confirm Logout\n                        </Button>\n                      </div>\n                    </div>\n                  )\n                }}\n              />\n            </div>\n          ) : (\n            <div>\n              <StatusTabs\n                statusCounts={statusCounts}\n                statusChanges={statusChanges}\n                selectedStatus={selectedStatus}\n                onStatusChange={setSelectedStatus}\n                loading={loading}\n              >\n                <ProjectsOverview\n                  projects={filteredProjects}\n                  loading={loading}\n                  selectedStatus={selectedStatus}\n                  onViewChatter={handleViewChatter}\n                  onNewProject={handleNewProjectToggle}\n                  isNewProjectOpen={leftPanelMode === 'newProject'}\n                  showCompanyBadge={isSuperUser}\n                />\n              </StatusTabs>\n            </div>\n          )}\n        </div>\n      </div>\n\n    </motion.div>\n  );\n};\n\nexport default Dashboard;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\DesignPortal.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'FilesTab' is defined but never used.","line":11,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":16},{"ruleId":"no-unused-vars","severity":1,"message":"'ChatterPanel' is defined but never used.","line":19,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":20},{"ruleId":"no-unused-vars","severity":1,"message":"'ProjectHeader' is defined but never used.","line":24,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":45},{"ruleId":"no-unused-vars","severity":1,"message":"'CSS_GRADIENTS' is defined but never used.","line":28,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'stats' is assigned a value but never used.","line":36,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":16},{"ruleId":"no-unused-vars","severity":1,"message":"'ahj' is assigned a value but never used.","line":145,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":145,"endColumn":12},{"ruleId":"no-unused-vars","severity":1,"message":"'utility' is assigned a value but never used.","line":146,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":146,"endColumn":16},{"ruleId":"jsx-a11y/anchor-is-valid","severity":1,"message":"The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/anchor-is-valid.md","line":187,"column":13,"nodeType":"JSXOpeningElement","endLine":194,"endColumn":14},{"ruleId":"jsx-a11y/anchor-is-valid","severity":1,"message":"The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/anchor-is-valid.md","line":203,"column":13,"nodeType":"JSXOpeningElement","endLine":207,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Link, useNavigate, useParams } from 'react-router-dom';\nimport { motion } from 'framer-motion';\nimport axios from '../config/axios';\nimport logger from '../services/devLogger';\nimport ProjectDetailsTabs from '../components/dashboard/ProjectDetailsTabs';\nimport ProjectOverviewTabs from '../components/dashboard/ProjectOverviewTabs';\nimport PlanSetVersions from '../components/dashboard/PlanSetVersions';\nimport SitePlanVersions from '../components/dashboard/SitePlanVersions';\nimport SurveyPanel from '../components/project/SurveyPanel';\nimport FilesTab from '../components/project/FilesTab';\nimport FilesPanel from '../components/project/FilesPanel';\nimport SiteForm from '../components/project/SiteForm';\nimport EquipmentForm from '../components/project/EquipmentForm';\nimport ElectricalForm from '../components/project/ElectricalForm';\nimport StructuralForm from '../components/project/StructuralForm';\nimport SubmitForm from '../components/project/SubmitForm';\nimport MapPanel from '../components/maps/MapPanel';\nimport ChatterPanel from '../components/chatter/ChatterPanel';\nimport TabbedPanel from '../components/common/TabbedPanel';\nimport QCChecklistPanel from '../components/pdf/QCChecklistPanel';\nimport Account from './Account';\nimport SupportPanel from '../components/support/SupportPanel';\nimport { PortalNavigationPill, ProjectHeader } from '../components/ui';\nimport useDashboardData from '../hooks/useDashboardData';\nimport styles from '../styles/Dashboard.module.css';\nimport portalStyles from '../styles/Portal.module.css';\nimport { CSS_GRADIENTS } from '../styles/gradient';\n\n/**\n * Design Portal Page\n * Design team view of project information\n */\nconst DesignPortal = () => {\n  const { projectUuid } = useParams();\n  const { stats, statusCounts, statusChanges, loading, error, refetch } = useDashboardData();\n  const [selectedStatus, setSelectedStatus] = useState('equipment');\n  const [equipmentInitialSubTab, setEquipmentInitialSubTab] = useState(null); // Track where to land in Equipment\n  const [selectedOverviewTab, setSelectedOverviewTab] = useState('survey');\n  const [projectData, setProjectData] = useState(null);\n  const [showMenuPanel, setShowMenuPanel] = useState(false); // Toggle menu/settings panel\n  const [showQCPanel, setShowQCPanel] = useState(false);\n  const [qcProjectId, setQcProjectId] = useState(null);\n  const [qcChecklistType, setQcChecklistType] = useState('site'); // 'site' or 'design'\n  const navigate = useNavigate();\n\n  // Enhanced navigation handler that supports sub-tab targeting\n  const handleNavigateToTab = (tabKey, options = {}) => {\n    setSelectedStatus(tabKey);\n\n    // If navigating to equipment tab with sub-tab specified\n    if (tabKey === 'equipment' && options.subTab) {\n      setEquipmentInitialSubTab(options.subTab);\n    } else {\n      setEquipmentInitialSubTab(null);\n    }\n  };\n\n  useEffect(() => {\n    const fetchProjectData = async () => {\n      try {\n        const userData = JSON.parse(\n          sessionStorage.getItem(\"userData\") || \"{}\"\n        );\n        const companyId = userData?.company?.uuid;\n\n        if (!projectUuid) {\n          logger.error(\"Portal\", \"Missing projectUuid\");\n          return;\n        }\n\n        // Fetch project data\n        const endpoint = companyId\n          ? `/project/${projectUuid}?companyId=${companyId}`\n          : `/project/${projectUuid}`;\n\n        const response = await axios.get(endpoint);\n\n        // Extract project data (API returns data nested in response.data.data)\n        const projectData = response.data.data || response.data;\n\n        if (projectData) {\n          setProjectData(projectData);\n        } else {\n          logger.warn(\"Portal\", \"No project data found in response\");\n        }\n      } catch (error) {\n        logger.error(\"Portal\", \"Error fetching project data:\", error);\n        if (error.response?.data) {\n          logger.error(\"Portal\", \"Error details:\", error.response.data);\n        }\n      }\n    };\n\n    fetchProjectData();\n  }, [projectUuid]);\n\n  const handleLogout = () => {\n    sessionStorage.clear();\n    navigate(\"/login\");\n  };\n\n  const handleFlameIconClick = (e) => {\n    e.preventDefault();\n    setShowMenuPanel(!showMenuPanel);\n  };\n\n  const handleQCPanelChange = (isOpen, projectId, checklistType = 'site') => {\n    setShowQCPanel(isOpen);\n    setQcProjectId(projectId);\n    setQcChecklistType(checklistType || 'site');\n  };\n\n  const pageVariants = {\n    hidden: { opacity: 0 },\n    visible: {\n      opacity: 1,\n      transition: {\n        duration: 0.5,\n        when: \"beforeChildren\",\n      },\n    },\n  };\n\n  // Get customer name, address, and project ID from project data\n  const customerName = projectData?.details\n    ? `${projectData.details.customer_last_name || \"\"}, ${\n        projectData.details.customer_first_name || \"\"\n      }`\n    : \"Loading...\";\n\n  const address = projectData?.site\n    ? `${projectData.site.address || \"\"}${\n        projectData.site.city ? `, ${projectData.site.city}` : \"\"\n      }${projectData.site.state ? `, ${projectData.site.state}` : \"\"}${\n        projectData.site.zip ? ` ${projectData.site.zip}` : \"\"\n      }`\n    : \"Loading...\";\n\n  const projectId =\n    projectData?.details?.installer_project_id ||\n    projectData?.uuid?.slice(0, 8) ||\n    \"Loading...\";\n\n  const ahj = projectData?.site?.ahj || '';\n  const utility = projectData?.site?.utility || '';\n\n  return (\n    <motion.div\n      className={styles.dashboardContainer}\n      variants={pageVariants}\n      initial=\"hidden\"\n      animate=\"visible\"\n    >\n      {/* Header */}\n      <div className={styles.dashboardHeader}>\n        <div className={portalStyles.headerInfoContainer}>\n          <span className={portalStyles.customerName}>\n            {customerName}\n          </span>\n          <span className={portalStyles.divider}>|</span>\n          <span className={portalStyles.address}>\n            {address}\n          </span>\n          <span className={portalStyles.divider}>|</span>\n          <span className={portalStyles.projectId}>\n            {projectId}\n          </span>\n        </div>\n\n        <div className={portalStyles.headerActions}>\n          {/* Main Navigation */}\n          <nav className={styles.topNav}>\n            <PortalNavigationPill to={`/project/${projectUuid}/sales`}>\n              Sales\n            </PortalNavigationPill>\n            <PortalNavigationPill to={`/project/${projectUuid}/design`} isActive>\n              Design\n            </PortalNavigationPill>\n            <PortalNavigationPill to={`/project/${projectUuid}/permitting`}>\n              Permitting\n            </PortalNavigationPill>\n            <PortalNavigationPill to={`/project/${projectUuid}/install`}>\n              Install\n            </PortalNavigationPill>\n            <span className={portalStyles.divider}>|</span>\n            <a\n              href=\"#\"\n              onClick={(e) => {\n                e.preventDefault();\n                // Scheduling functionality coming soon\n              }}\n              className={styles.navLink}\n            >\n              Scheduling\n            </a>\n            <Link\n              to=\"/dashboard\"\n              className={styles.navLink}\n            >\n              Projects\n            </Link>\n            <a\n              href=\"#\"\n              onClick={handleFlameIconClick}\n              className={portalStyles.flameIconLink}\n            >\n              <img\n                src={showMenuPanel ? require('../assets/images/fire-active.png') : require('../assets/images/appIcon.png')}\n                alt=\"Skyfire\"\n                className={styles.flameIcon}\n              />\n            </a>\n          </nav>\n        </div>\n      </div>\n\n      {/* Error State */}\n      {error && (\n        <div className={`${styles.section} ${portalStyles.errorSection}`}>\n          <div className={portalStyles.errorContainer}>\n            <div className={portalStyles.errorContent}>\n              <h3 className={portalStyles.errorTitle}>\n                âš ï¸ Error Loading Data\n              </h3>\n              <p className={portalStyles.errorMessage}>{error}</p>\n            </div>\n            <button\n              onClick={refetch}\n              className={`${styles.button} ${styles.buttonSecondary}`}\n            >\n              Retry\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Show either Menu Panel or Project Details */}\n      {showMenuPanel ? (\n        <div className={portalStyles.menuPanelContainer}>\n          <TabbedPanel\n            tabs={[\n              { id: 'account', label: 'Account' },\n              { id: 'support', label: 'Support' },\n              { id: 'inventory', label: 'Inventory' },\n              { id: 'logout', label: 'Logout' }\n            ]}\n            defaultTab=\"account\"\n            storageKey=\"designPortalMenuTab\"\n            tabContent={{\n              account: (\n                <Account />\n              ),\n              support: (\n                <div className={portalStyles.menuContent}>\n                  <SupportPanel />\n                </div>\n              ),\n              inventory: (\n                <div className={portalStyles.menuContent}>\n                  <h3>Inventory</h3>\n                  <p>Inventory management coming soon...</p>\n                </div>\n              ),\n              logout: (\n                <div className={portalStyles.menuContent}>\n                  <h3>Logout</h3>\n                  <p>Are you sure you want to logout?</p>\n                  <button onClick={handleLogout} className={portalStyles.logoutButton}>\n                    Confirm Logout\n                  </button>\n                </div>\n              )\n            }}\n          />\n        </div>\n      ) : (\n        <div className={`${styles.splitLayoutDashboard} ${portalStyles.splitLayoutRelative}`}>\n          {/* QC Modal Overlay - Covers entire left column */}\n          {showQCPanel && (\n            <div className={portalStyles.qcPanelOverlay}>\n              <QCChecklistPanel\n                isOpen={showQCPanel}\n                onClose={() => setShowQCPanel(false)}\n                projectId={qcProjectId}\n                checklistType={qcChecklistType}\n              />\n            </div>\n          )}\n\n          <ProjectDetailsTabs\n            statusCounts={statusCounts}\n            statusChanges={statusChanges}\n            selectedStatus={selectedStatus}\n            onStatusChange={setSelectedStatus}\n            loading={loading}\n          >\n            {selectedStatus === 'site' && (\n              <SiteForm projectUuid={projectUuid} projectData={projectData} />\n            )}\n            {selectedStatus === 'equipment' && (\n              <EquipmentForm\n                projectUuid={projectUuid}\n                projectData={projectData}\n                onNavigateToTab={handleNavigateToTab}\n                initialSubTab={equipmentInitialSubTab}\n              />\n            )}\n            {selectedStatus === 'electrical' && (\n              <ElectricalForm\n                projectUuid={projectUuid}\n                projectData={projectData}\n                onNavigateToTab={handleNavigateToTab}\n              />\n            )}\n            {selectedStatus === 'structural' && (\n              <StructuralForm\n                projectUuid={projectUuid}\n                projectData={projectData}\n                onNavigateToTab={handleNavigateToTab}\n              />\n            )}\n            {selectedStatus === 'submit' && (\n              <SubmitForm\n                projectUuid={projectUuid}\n                projectData={projectData}\n                onNavigateToTab={handleNavigateToTab}\n              />\n            )}\n          </ProjectDetailsTabs>\n\n          <ProjectOverviewTabs\n            selectedTab={selectedOverviewTab}\n            onTabChange={setSelectedOverviewTab}\n            loading={loading}\n          >\n            {selectedOverviewTab === 'overview' && projectUuid && (\n              <SitePlanVersions\n                projectUuid={projectUuid}\n                projectName={projectId}\n              />\n            )}\n            {selectedOverviewTab === 'survey' && projectUuid && (\n              <SurveyPanel\n                projectUuid={projectUuid}\n                onSwitchToFilesTab={() => setSelectedOverviewTab('files')}\n              />\n            )}\n            {selectedOverviewTab === 'map' && projectData && (\n              <MapPanel\n                address={projectData?.site?.address}\n                city={projectData?.site?.city}\n                state={projectData?.site?.state}\n                zip={projectData?.site?.zip}\n                lat={projectData?.site?.lat}\n                lng={projectData?.site?.lng}\n                projectUuid={projectData?.uuid}\n              />\n            )}\n            {selectedOverviewTab === 'planset' && (\n              <PlanSetVersions\n                projectUuid={projectUuid}\n                onQCPanelChange={handleQCPanelChange}\n              />\n            )}\n            {selectedOverviewTab === 'files' && projectUuid && (\n              <FilesPanel projectUuid={projectUuid} />\n            )}\n          </ProjectOverviewTabs>\n        </div>\n      )}\n    </motion.div>\n  );\n};\n\nexport default DesignPortal;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\DrafterPortalPage.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'CSS_GRADIENTS' is defined but never used.","line":19,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'stats' is assigned a value but never used.","line":26,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":16},{"ruleId":"jsx-a11y/anchor-is-valid","severity":1,"message":"The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/anchor-is-valid.md","line":117,"column":11,"nodeType":"JSXOpeningElement","endLine":124,"endColumn":12},{"ruleId":"jsx-a11y/anchor-is-valid","severity":1,"message":"The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/anchor-is-valid.md","line":127,"column":11,"nodeType":"JSXOpeningElement","endLine":134,"endColumn":12},{"ruleId":"jsx-a11y/anchor-is-valid","severity":1,"message":"The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/anchor-is-valid.md","line":137,"column":11,"nodeType":"JSXOpeningElement","endLine":141,"endColumn":12}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { motion } from 'framer-motion';\nimport logger from '../services/devLogger';\nimport StatusTabs from '../components/dashboard/StatusTabs';\nimport DrafterPortal from '../components/dashboard/DrafterPortal';\nimport ProjectInformationForm from '../components/project/ProjectInformationForm';\nimport ChatterPanel from '../components/chatter/ChatterPanel';\nimport NotificationBell from '../components/chatter/NotificationBell';\nimport TabbedPanel from '../components/common/TabbedPanel';\nimport { Button } from '../components/ui';\nimport Account from './Account';\nimport Inventory from './Inventory';\nimport SupportPanel from '../components/support/SupportPanel';\nimport useDashboardData from '../hooks/useDashboardData';\nimport styles from '../styles/Dashboard.module.css';\nimport projectStyles from '../styles/ProjectAdd.module.css';\nimport pageStyles from '../pages/Project.module.css';\nimport { CSS_GRADIENTS } from '../styles/gradient';\n\n/**\n * Drafter Portal Page\n * Dedicated portal for drafters with project management\n */\nconst DrafterPortalPage = () => {\n  const { stats, statusCounts, statusChanges, projects, loading, error, refetch} = useDashboardData();\n  const [selectedStatus, setSelectedStatus] = useState('all');\n  const [leftPanelMode, setLeftPanelMode] = useState('none'); // 'none' | 'newProject' | 'chatter'\n  const [selectedChatterProject, setSelectedChatterProject] = useState(null);\n  const [showMenuPanel, setShowMenuPanel] = useState(false); // Toggle menu/settings panel\n  const [isFormValid, setIsFormValid] = useState(false);\n  const navigate = useNavigate();\n  const projectFormRef = useRef(null);\n\n  // Solid midnight blue\n  const containerColor = 'var(--bg-panel)';\n\n  const handleLogout = () => {\n    sessionStorage.clear();\n    navigate('/login');\n  };\n\n  const handleFlameIconClick = (e) => {\n    e.preventDefault();\n    setShowMenuPanel(!showMenuPanel);\n  };\n\n  const handleProjectCreated = (projectUuid) => {\n    logger.log('DrafterPortal', 'Project created:', projectUuid);\n    // Navigate to the project page\n    navigate(`/project/${projectUuid}`);\n  };\n\n  const handleNewProjectToggle = () => {\n    if (leftPanelMode === 'newProject') {\n      setLeftPanelMode('none');\n    } else {\n      setLeftPanelMode('newProject');\n      setSelectedChatterProject(null);\n    }\n  };\n\n  const handleViewChatter = (projectInfo) => {\n    logger.debug('DrafterPortal', 'Opening chatter for project:', projectInfo);\n    setLeftPanelMode('chatter');\n    setSelectedChatterProject(projectInfo);\n  };\n\n  const handleCloseChatter = () => {\n    setLeftPanelMode('none');\n    setSelectedChatterProject(null);\n  };\n\n  const handleSwitchToNewProject = () => {\n    setLeftPanelMode('newProject');\n    setSelectedChatterProject(null);\n  };\n\n  const handleFormValidityChange = (isValid) => {\n    setIsFormValid(isValid);\n  };\n\n  const pageVariants = {\n    hidden: { opacity: 0 },\n    visible: {\n      opacity: 1,\n      transition: {\n        duration: 0.5,\n        when: \"beforeChildren\"\n      }\n    }\n  };\n\n  // Get user info from session\n  const userData = JSON.parse(sessionStorage.getItem('userData') || '{}');\n\n  // Try multiple possible property names for first name\n  const userName = userData.first_name || userData.firstName || userData.firstname ||\n                   userData.name?.split(' ')[0] || userData.email?.split('@')[0] || 'Admin';\n\n  return (\n    <motion.div\n      className={styles.dashboardContainer}\n      variants={pageVariants}\n      initial=\"hidden\"\n      animate=\"visible\"\n    >\n      {/* Header */}\n      <div className={styles.dashboardHeader}>\n        <div>\n          <h1 className={styles.dashboardTitle}>\n            Drafter Portal - Welcome, {userName} <NotificationBell />\n          </h1>\n        </div>\n\n        <nav className={styles.topNav}>\n          <a\n            href=\"#\"\n            onClick={(e) => {\n              e.preventDefault();\n              navigate('/dashboard');\n            }}\n            className={styles.navLink}\n          >\n            Dashboard\n          </a>\n          <a\n            href=\"#\"\n            onClick={(e) => {\n              e.preventDefault();\n              setShowMenuPanel(false);\n            }}\n            className={`${styles.navLink} ${!showMenuPanel ? styles.navLinkActive : ''}`}\n          >\n            Projects\n          </a>\n          <a\n            href=\"#\"\n            onClick={handleFlameIconClick}\n            className={styles.flameIconLink}\n          >\n            <img\n              src={showMenuPanel ? require('../assets/images/fire-active.png') : require('../assets/images/appIcon.png')}\n              alt=\"Skyfire\"\n              className={styles.flameIcon}\n            />\n          </a>\n        </nav>\n      </div>\n\n      {/* Split Layout: Project Form (30%) | Dashboard (70%) */}\n      <div className={`${styles.splitLayoutDashboard} ${leftPanelMode === 'none' ? styles.splitLayoutCollapsed : ''}`}>\n        {/* Left Column: New Project OR Chatter Panel */}\n        {leftPanelMode !== 'none' && (\n          <motion.div\n            className={`${styles.projectFormSidebar} ${\n              leftPanelMode === 'chatter' ? styles.chatterSidebarTransparent : styles.chatterSidebarSolid\n            }`}\n            initial={{ width: 0, opacity: 0 }}\n            animate={{ width: '100%', opacity: 1 }}\n            exit={{ width: 0, opacity: 0 }}\n            transition={{\n              width: { duration: 0.4, ease: [0.4, 0, 0.2, 1] },\n              opacity: { duration: 0.4, delay: 0.05, ease: [0.4, 0, 0.2, 1] }\n            }}\n          >\n            {leftPanelMode === 'newProject' && (\n              <>\n                <div className={styles.projectFormHeader}>\n                  <h2 className={styles.projectFormTitle}>New Project</h2>\n                  <Button\n                    variant=\"primary\"\n                    onClick={() => {\n                      if (projectFormRef.current && isFormValid) {\n                        projectFormRef.current.submitForm();\n                      }\n                    }}\n                    disabled={!isFormValid}\n                  >\n                    <span className={styles.createButtonIcon}>+</span>\n                    <span>Create</span>\n                  </Button>\n                </div>\n\n                <div className={projectStyles.tabContent}>\n                  <ProjectInformationForm\n                    ref={projectFormRef}\n                    onNext={handleProjectCreated}\n                    hideSubmitButton={true}\n                    onValidityChange={handleFormValidityChange}\n                  />\n                </div>\n              </>\n            )}\n\n            {leftPanelMode === 'chatter' && selectedChatterProject && (\n              <ChatterPanel\n                projectUuid={selectedChatterProject.uuid}\n                projectInfo={selectedChatterProject}\n                isInline={true}\n                onClose={handleCloseChatter}\n                onSwitchToNewProject={handleSwitchToNewProject}\n              />\n            )}\n          </motion.div>\n        )}\n\n        {/* Right: Dashboard Content (70% or 100% when collapsed) */}\n        <div className={styles.dashboardContent}>\n          {/* Error State */}\n          {error && (\n            <div className={`${styles.section} ${styles.errorSection}`}>\n              <div className={styles.errorContent}>\n                <div>\n                  <h3 className={styles.errorTitle}>âš ï¸ Error Loading Data</h3>\n                  <p className={styles.errorMessage}>{error}</p>\n                </div>\n                <Button variant=\"secondary\" onClick={refetch}>\n                  Retry\n                </Button>\n              </div>\n            </div>\n          )}\n\n          {/* Show either Menu Panel or Status Tabs */}\n          {showMenuPanel ? (\n            <div className={styles.menuPanelContainer}>\n              <TabbedPanel\n                tabs={[\n                  { id: 'account', label: 'Account' },\n                  { id: 'support', label: 'Support' },\n                  { id: 'inventory', label: 'Inventory' },\n                  { id: 'logout', label: 'Logout' }\n                ]}\n                defaultTab=\"account\"\n                storageKey=\"drafterPortalMenuTab\"\n                tabContent={{\n                  account: (\n                    <Account />\n                  ),\n                  support: (\n                    <div className={styles.menuTabContent}>\n                      <SupportPanel />\n                    </div>\n                  ),\n                  inventory: <Inventory />,\n                  logout: (\n                    <div className={styles.menuTabContent}>\n                      <h3 className={pageStyles.tabContentTitle}>Logout</h3>\n                      <p className={pageStyles.tabContentPlaceholder}>Are you sure you want to logout?</p>\n                      <Button variant=\"primary\" onClick={handleLogout}>\n                        Confirm Logout\n                      </Button>\n                    </div>\n                  )\n                }}\n              />\n            </div>\n          ) : (\n            <div>\n              <StatusTabs\n                statusCounts={statusCounts}\n                statusChanges={statusChanges}\n                selectedStatus={selectedStatus}\n                onStatusChange={setSelectedStatus}\n                loading={loading}\n                customColor={containerColor}\n              >\n                <DrafterPortal\n                  projects={projects}\n                  loading={loading}\n                  selectedStatus={selectedStatus}\n                  onViewChatter={handleViewChatter}\n                  onNewProject={handleNewProjectToggle}\n                  isNewProjectOpen={leftPanelMode === 'newProject'}\n                />\n              </StatusTabs>\n            </div>\n          )}\n        </div>\n      </div>\n\n    </motion.div>\n  );\n};\n\nexport default DrafterPortalPage;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\DrafterPortal\\AdminDrafterQueue.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\DrafterPortal\\DrafterDashboard.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'socketNextJob' is assigned a value but never used.","line":21,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":27}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useDrafterStatus } from '../../hooks/useDrafterStatus';\nimport { useDrafterSocket } from '../../hooks/useDrafterSocket';\nimport { useDrafterKeyboardShortcuts } from '../../hooks/useDrafterKeyboardShortcuts';\nimport { drafterPortalService } from '../../services/drafterPortalService';\nimport MetricCard from './components/MetricCard';\nimport StatusBanner from './components/StatusBanner';\nimport styles from './DrafterDashboard.module.css';\nimport { getTimeBasedGreeting } from '../../utils/constants';\n\nconst DrafterDashboard = () => {\n  const navigate = useNavigate();\n  const { status, loading, error, refresh } = useDrafterStatus();\n  const [claiming, setClaiming] = useState(false);\n  const [showClaimModal, setShowClaimModal] = useState(false);\n\n  // Socket.io connection for real-time updates\n  const {\n    isConnected: socketConnected,\n    nextJob: socketNextJob,\n    markAvailable,\n    connectionError\n  } = useDrafterSocket({\n    onJobAvailable: (job) => {\n      // Refresh status when new job available\n      refresh();\n    },\n    onJobClaimed: () => {\n      // Refresh when job claimed by another drafter\n      refresh();\n    },\n    onAchievementUnlocked: (achievement) => {\n      // Refresh to update XP/level display\n      refresh();\n    }\n  });\n\n  // Mark as available when on dashboard and not working\n  useEffect(() => {\n    if (socketConnected && !status?.activeAssignment) {\n      markAvailable();\n    }\n  }, [socketConnected, status?.activeAssignment, markAvailable]);\n\n  // Request notification permission on mount\n  useEffect(() => {\n    if ('Notification' in window && Notification.permission === 'default') {\n      Notification.requestPermission();\n    }\n  }, []);\n\n  // Keyboard shortcuts\n  useDrafterKeyboardShortcuts({\n    onClaimProject: () => {\n      const canClaim = status?.canClaimProject && !status?.activeAssignment && status?.queueCount > 0;\n      if (canClaim && !showClaimModal) {\n        handleClaimClick();\n      }\n    },\n    enabled: !status?.activeAssignment // Only enable when not working\n  });\n\n  const handleLogout = () => {\n    localStorage.removeItem('token');\n    localStorage.removeItem('userData');\n    sessionStorage.clear();\n    navigate('/login');\n  };\n\n  const handleClaimClick = () => {\n    setShowClaimModal(true);\n  };\n\n  const handleClaimConfirm = async () => {\n    try {\n      setClaiming(true);\n      const result = await drafterPortalService.claimNextProject();\n\n      // Redirect to workspace\n      navigate(`/drafter-portal/workspace/${result.assignment.uuid}`);\n    } catch (err) {\n      console.error('Failed to claim project:', err);\n      alert('Failed to claim project. Please try again.');\n      setClaiming(false);\n      setShowClaimModal(false);\n    }\n  };\n\n  const handleClaimCancel = () => {\n    setShowClaimModal(false);\n  };\n\n  const getCompletionRateColor = (rate) => {\n    if (rate >= 98) return 'green';\n    if (rate >= 95) return 'yellow';\n    return 'red';\n  };\n\n  const getDrafterName = () => {\n    const userData = localStorage.getItem('userData');\n    if (userData) {\n      try {\n        const user = JSON.parse(userData);\n        return user.firstName || user.first_name || 'Drafter';\n      } catch (e) {\n        return 'Drafter';\n      }\n    }\n    return 'Drafter';\n  };\n\n  if (loading && !status) {\n    return (\n      <div className={styles.container}>\n        <div className={styles.loading}>Loading dashboard...</div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className={styles.container}>\n        <div className={styles.error}>\n          <p>Failed to load dashboard</p>\n          <button onClick={refresh} className={styles.retryButton}>\n            Retry\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  const metrics = status?.metrics || {};\n  const canClaim = status?.canClaimProject && !status?.activeAssignment && status?.queueCount > 0;\n\n  return (\n    <div className={styles.container}>\n      {/* Header */}\n      <div className={styles.header}>\n        <h1 className={styles.title}>{getTimeBasedGreeting(getDrafterName())}</h1>\n        <div className={styles.headerRight}>\n          {socketConnected ? (\n            <div className={styles.connectionStatus}>\n              <span className={styles.connectedDot}></span>\n              Live\n            </div>\n          ) : (\n            <div className={styles.connectionStatus}>\n              <span className={styles.disconnectedDot}></span>\n              {connectionError || 'Connecting...'}\n            </div>\n          )}\n          <button onClick={handleLogout} className={styles.logoutButton}>\n            Logout\n          </button>\n        </div>\n      </div>\n\n      {/* Status Banner */}\n      {status?.drafterStatus && status.drafterStatus !== 'active' && (\n        <StatusBanner\n          status={status.drafterStatus}\n          releasesRemaining={metrics.releasesRemaining}\n        />\n      )}\n\n      {/* Metrics Grid */}\n      <div className={styles.metricsGrid}>\n        <MetricCard\n          label=\"Completion Rate\"\n          value={`${metrics.completionRate?.toFixed(1) || 0}%`}\n          icon={<span>âœ“</span>}\n          color={getCompletionRateColor(metrics.completionRate || 0)}\n        />\n        <MetricCard\n          label=\"On-Time Rate\"\n          value={`${metrics.onTimeRate?.toFixed(1) || 0}%`}\n          icon={<span>â±ï¸</span>}\n          color={metrics.onTimeRate >= 95 ? 'green' : metrics.onTimeRate >= 90 ? 'yellow' : 'red'}\n        />\n        <MetricCard\n          label=\"Current Streak\"\n          value={metrics.currentStreak || 0}\n          icon={<span>ðŸ”¥</span>}\n          color=\"neutral\"\n        />\n        <MetricCard\n          label=\"Releases Remaining\"\n          value={`${metrics.releasesRemaining || 0}/2`}\n          icon={<span>ðŸŽ¯</span>}\n          color={metrics.releasesRemaining === 2 ? 'green' : metrics.releasesRemaining === 1 ? 'yellow' : 'red'}\n        />\n      </div>\n\n      {/* Queue Status Card */}\n      <div className={styles.queueCard}>\n        <div className={styles.queueHeader}>\n          <h2 className={styles.queueTitle}>Project Queue</h2>\n          <div className={styles.queueCount}>\n            {status?.queueCount || 0} {status?.queueCount === 1 ? 'project' : 'projects'} available\n          </div>\n        </div>\n\n        {status?.activeAssignment ? (\n          <div className={styles.activeAssignment}>\n            <p className={styles.activeText}>You have an active project</p>\n            <button\n              onClick={() => navigate(`/drafter-portal/workspace/${status.activeAssignment.uuid}`)}\n              className={styles.goToWorkspaceButton}\n            >\n              Go to Workspace\n            </button>\n          </div>\n        ) : (\n          <>\n            <button\n              onClick={handleClaimClick}\n              disabled={!canClaim}\n              className={`${styles.claimButton} ${!canClaim ? styles.disabled : ''}`}\n            >\n              {status?.queueCount === 0 ? 'No Projects Available' : 'Assign Me Next'}\n            </button>\n            {canClaim && (\n              <div className={styles.keyboardHint}>\n                Press <kbd>Enter</kbd> to claim\n              </div>\n            )}\n          </>\n        )}\n      </div>\n\n      {/* Additional Stats */}\n      <div className={styles.statsRow}>\n        <div className={styles.statItem}>\n          <span className={styles.statLabel}>Total Completed:</span>\n          <span className={styles.statValue}>{metrics.totalCompleted || 0}</span>\n        </div>\n        <div className={styles.statItem}>\n          <span className={styles.statLabel}>Avg Completion Time:</span>\n          <span className={styles.statValue}>\n            {metrics.avgCompletionSeconds\n              ? `${Math.floor(metrics.avgCompletionSeconds / 60)}m ${metrics.avgCompletionSeconds % 60}s`\n              : 'N/A'}\n          </span>\n        </div>\n      </div>\n\n      {/* Claim Confirmation Modal */}\n      {showClaimModal && (\n        <div className={styles.modalOverlay}>\n          <div className={styles.modal}>\n            <h2 className={styles.modalTitle}>Ready to claim a project?</h2>\n            <div className={styles.modalContent}>\n              <p>You'll have 30 minutes to complete it.</p>\n              <p>Timer starts immediately.</p>\n            </div>\n            <div className={styles.modalActions}>\n              <button\n                onClick={handleClaimCancel}\n                disabled={claiming}\n                className={styles.cancelButton}\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleClaimConfirm}\n                disabled={claiming}\n                className={styles.confirmButton}\n              >\n                {claiming ? 'Claiming...' : 'Claim Project'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default DrafterDashboard;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\DrafterPortal\\DrafterWorkspace.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'isExpired' is assigned a value but never used.","line":60,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":60,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { toast } from 'react-toastify';\nimport { useDrafterAssignment } from '../../hooks/useDrafterAssignment';\nimport { useDrafterSocket } from '../../hooks/useDrafterSocket';\nimport { useSyncedTimer } from '../../hooks/useSyncedTimer';\nimport { useDrafterKeyboardShortcuts } from '../../hooks/useDrafterKeyboardShortcuts';\nimport CountdownTimer from './components/CountdownTimer';\nimport ProjectDetailsPanel from './components/ProjectDetailsPanel';\nimport FileUploadPanel from './components/FileUploadPanel';\nimport QAPanel from './components/QAPanel';\nimport ReleaseModal from './components/ReleaseModal';\nimport SubmitModal from './components/SubmitModal';\nimport styles from './DrafterWorkspace.module.css';\n\nconst DrafterWorkspace = () => {\n  const { uuid } = useParams();\n  const navigate = useNavigate();\n  const {\n    assignment,\n    project,\n    files,\n    questions,\n    loading,\n    error,\n    uploadFile,\n    deleteFile,\n    askQuestion,\n    completeAssignment,\n    releaseAssignment\n  } = useDrafterAssignment(uuid);\n\n  const [showReleaseModal, setShowReleaseModal] = useState(false);\n  const [showSubmitModal, setShowSubmitModal] = useState(false);\n  const [activeTab, setActiveTab] = useState('details'); // for mobile\n\n  // Socket.io integration\n  const {\n    isConnected: socketConnected,\n    markBusy\n  } = useDrafterSocket({\n    onTimerExpired: () => {\n      toast.error('â±ï¸ Time expired! Project returned to queue.', {\n        position: 'top-center',\n        autoClose: false\n      });\n      setTimeout(() => navigate('/drafter-portal'), 3000);\n    },\n    onQuestionAnswered: () => {\n      // Refresh assignment to get updated questions\n      window.location.reload();\n    }\n  });\n\n  // Synced timer\n  const {\n    remainingSeconds,\n    timerState,\n    formattedTime,\n    isExpired\n  } = useSyncedTimer(assignment?.expiresAt, {\n    onExpire: () => {\n      toast.error('â±ï¸ Time expired! Project returned to queue.', {\n        position: 'top-center',\n        autoClose: false\n      });\n      setTimeout(() => navigate('/drafter-portal'), 3000);\n    },\n    onWarning: (minutes) => {\n      toast.warning(`â±ï¸ Only ${minutes} minute${minutes > 1 ? 's' : ''} remaining!`, {\n        position: 'top-center',\n        autoClose: false,\n        closeOnClick: true,\n        className: 'drafter-toast-warning'\n      });\n    }\n  });\n\n  // Keyboard shortcuts\n  useDrafterKeyboardShortcuts({\n    onSubmit: () => {\n      const canSubmit = files.filter(f =>\n        ['site_plan_pdf', 'site_plan_dwg', 'single_line_pdf'].includes(f.fileType)\n      ).length === 3;\n      if (canSubmit && !showSubmitModal) {\n        setShowSubmitModal(true);\n      }\n    },\n    onRelease: () => {\n      if (showReleaseModal || showSubmitModal) {\n        setShowReleaseModal(false);\n        setShowSubmitModal(false);\n      } else {\n        setShowReleaseModal(true);\n      }\n    },\n    enabled: true\n  });\n\n  // Mark as busy when workspace loads\n  useEffect(() => {\n    if (assignment?.uuid && socketConnected) {\n      markBusy(assignment.uuid);\n    }\n  }, [assignment?.uuid, socketConnected, markBusy]);\n\n  // Check if assignment is expired or completed\n  useEffect(() => {\n    if (assignment?.status === 'completed' || assignment?.status === 'expired') {\n      navigate('/drafter-portal');\n    }\n  }, [assignment, navigate]);\n\n  const handleRelease = async (reason, notes) => {\n    try {\n      await releaseAssignment(reason, notes);\n      setShowReleaseModal(false);\n      toast.success('Project released successfully');\n      navigate('/drafter-portal');\n    } catch (error) {\n      toast.error('Failed to release project');\n      throw error;\n    }\n  };\n\n  const handleSubmit = async () => {\n    try {\n      await completeAssignment();\n      toast.success('ðŸŽ‰ Project submitted successfully!');\n      // Success handled by modal animation\n      setTimeout(() => {\n        navigate('/drafter-portal');\n      }, 2000);\n    } catch (error) {\n      toast.error('Failed to submit project');\n      throw error;\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className={styles.container}>\n        <div className={styles.loading}>Loading workspace...</div>\n      </div>\n    );\n  }\n\n  if (error || !assignment || !project) {\n    return (\n      <div className={styles.container}>\n        <div className={styles.error}>\n          <p>Failed to load assignment</p>\n          <button onClick={() => navigate('/drafter-portal')} className={styles.backButton}>\n            Back to Dashboard\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  const allRequiredFilesUploaded = files.filter(f =>\n    ['site_plan_pdf', 'site_plan_dwg', 'single_line_pdf'].includes(f.fileType)\n  ).length === 3;\n\n  return (\n    <div className={styles.container}>\n      {/* Header Bar */}\n      <div className={styles.header}>\n        <div className={styles.headerLeft}>\n          <h1 className={styles.projectTitle}>\n            {project.address || 'Project'}\n          </h1>\n          {project.customerName && (\n            <div className={styles.customerName}>{project.customerName}</div>\n          )}\n          {socketConnected && (\n            <div className={styles.liveIndicator}>\n              <span className={styles.liveDot}></span>\n              LIVE\n            </div>\n          )}\n        </div>\n\n        <div className={styles.headerCenter}>\n          <CountdownTimer\n            remainingSeconds={remainingSeconds}\n            timerState={timerState}\n            formattedTime={formattedTime}\n            totalSeconds={assignment.timeLimitSeconds || 1800}\n            showProgress={true}\n          />\n        </div>\n\n        <div className={styles.headerRight}>\n          <button\n            onClick={() => setShowReleaseModal(true)}\n            className={styles.releaseButton}\n          >\n            Release Project\n          </button>\n          <button\n            onClick={() => setShowSubmitModal(true)}\n            disabled={!allRequiredFilesUploaded}\n            className={`${styles.submitButton} ${!allRequiredFilesUploaded ? styles.disabled : ''}`}\n          >\n            Submit\n          </button>\n        </div>\n      </div>\n\n      {/* Keyboard Shortcuts Hint */}\n      <div className={styles.keyboardHints}>\n        <kbd>Ctrl</kbd> + <kbd>Enter</kbd> Submit â€¢ <kbd>Esc</kbd> Release â€¢ <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>R</kbd> Release with confirmation\n      </div>\n\n      {/* Mobile Tabs */}\n      <div className={styles.mobileTabs}>\n        <button\n          onClick={() => setActiveTab('details')}\n          className={`${styles.mobileTab} ${activeTab === 'details' ? styles.active : ''}`}\n        >\n          Details\n        </button>\n        <button\n          onClick={() => setActiveTab('files')}\n          className={`${styles.mobileTab} ${activeTab === 'files' ? styles.active : ''}`}\n        >\n          Files\n        </button>\n        <button\n          onClick={() => setActiveTab('qa')}\n          className={`${styles.mobileTab} ${activeTab === 'qa' ? styles.active : ''}`}\n        >\n          Q&amp;A\n        </button>\n      </div>\n\n      {/* Three-Panel Layout */}\n      <div className={styles.workspace}>\n        <div className={`${styles.panel} ${styles.leftPanel} ${activeTab === 'details' ? styles.mobileActive : ''}`}>\n          <ProjectDetailsPanel project={project} />\n        </div>\n\n        <div className={`${styles.panel} ${styles.centerPanel} ${activeTab === 'files' ? styles.mobileActive : ''}`}>\n          <FileUploadPanel\n            files={files}\n            onUpload={uploadFile}\n            onDelete={deleteFile}\n          />\n        </div>\n\n        <div className={`${styles.panel} ${styles.rightPanel} ${activeTab === 'qa' ? styles.mobileActive : ''}`}>\n          <QAPanel\n            questions={questions}\n            onAskQuestion={askQuestion}\n          />\n        </div>\n      </div>\n\n      {/* Modals */}\n      <ReleaseModal\n        isOpen={showReleaseModal}\n        onClose={() => setShowReleaseModal(false)}\n        onRelease={handleRelease}\n        releasesRemaining={assignment.releasesRemaining || 0}\n      />\n\n      <SubmitModal\n        isOpen={showSubmitModal}\n        onClose={() => setShowSubmitModal(false)}\n        onSubmit={handleSubmit}\n        files={files}\n      />\n    </div>\n  );\n};\n\nexport default DrafterWorkspace;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\DrafterPortal\\components\\CountdownTimer.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\DrafterPortal\\components\\FileUploadPanel.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\DrafterPortal\\components\\MetricCard.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\DrafterPortal\\components\\ProjectDetailsPanel.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\DrafterPortal\\components\\QAPanel.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\DrafterPortal\\components\\ReleaseModal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\DrafterPortal\\components\\StatusBanner.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\DrafterPortal\\components\\SubmitModal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\DrafterPortal\\components\\admin\\AddToQueueModal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\DrafterPortal\\components\\admin\\AdminActiveAssignments.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\DrafterPortal\\components\\admin\\AdminPendingQuestions.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\DrafterPortal\\components\\admin\\AdminQueueList.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\DrafterPortal\\components\\admin\\AdminQueueStats.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\DrafterPortal\\components\\earnings\\EarningsSummaryCards.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\ExistingProjects.js","messages":[{"ruleId":"array-callback-return","severity":1,"message":"Array.prototype.map() expects a return value from arrow function.","line":73,"column":42,"nodeType":"ArrowFunctionExpression","messageId":"expectedInside","endLine":73,"endColumn":44}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { Button } from 'reactstrap';\r\nimport { AgGridReact } from 'ag-grid-react';\r\nimport Moment from 'react-moment';\r\nimport Swal from 'sweetalert2';\r\nimport { LoadingSpinner } from '../components/ui';\r\nimport logger from '../services/devLogger';\r\nimport styles from './ExistingProjects.module.css';\r\n\r\n// Table component wrapper\r\nconst TableComponent = ({ rowData, columnDefs, title }) => {\r\n  const [searchText, setSearchText] = useState('');\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"d-flex justify-content-between align-items-center mb-3\">\r\n        <h4>{title}</h4>\r\n        <input\r\n          type=\"text\"\r\n          value={searchText}\r\n          onChange={(e) => setSearchText(e.target.value)}\r\n          placeholder=\"Search...\"\r\n          className={`form-control ${styles.searchInput}`}\r\n        />\r\n      </div>\r\n      <div className={`ag-theme-alpine ${styles.gridContainer}`}>\r\n        <AgGridReact\r\n          rowData={rowData}\r\n          columnDefs={[\r\n            {\r\n              headerName: '#',\r\n              valueGetter: 'node.rowIndex + 1',\r\n              width: 50,\r\n              sortable: false,\r\n              filter: false,\r\n            },\r\n            ...columnDefs,\r\n          ]}\r\n          defaultColDef={{\r\n            resizable: true,\r\n            filter: false,\r\n            sortable: true,\r\n          }}\r\n          pagination={true}\r\n          quickFilterText={searchText}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst ExistingProjects = () => {\r\n  const [projects, setProjects] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const fetchProjects = async () => {\r\n    setLoading(true);\r\n    const userData = sessionStorage.getItem('userData') || '';\r\n    let parsedData = null;\r\n\r\n    if (userData !== '') {\r\n      parsedData = JSON.parse(userData);\r\n    }\r\n\r\n    try {\r\n      const response = await axios.get(\r\n        `/api/projects/list?companyId=${parsedData?.company?.uuid}`\r\n      );\r\n\r\n      if (response.data.data && response.data.data.length > 0) {\r\n        const projectData = [];\r\n        response.data.data.map((project) => {\r\n          projectData.push({\r\n            projectId: project.uuid,\r\n            installer: project.details.installer_name,\r\n            customerName: `${project.details.customer_first_name} ${project.details.customer_last_name}`,\r\n            address: '',\r\n            status: project.is_draft === true ? 'DRAFT' : '',\r\n            description: '',\r\n            createdOn: project._created_at,\r\n          });\r\n        });\r\n        setProjects([...projectData]);\r\n      }\r\n      setLoading(false);\r\n    } catch (error) {\r\n      setLoading(false);\r\n      logger.error('Project', 'Error fetching projects:', error);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (e, rowData) => {\r\n    e.preventDefault();\r\n    const result = await Swal.fire({\r\n      title: 'Are you sure?',\r\n      text: 'Do you really want to delete this record?',\r\n      icon: 'warning',\r\n      showCancelButton: true,\r\n      confirmButtonText: 'Yes, delete it!',\r\n      cancelButtonText: 'No, cancel!',\r\n      customClass: {\r\n        confirmButton: 'bg-success',\r\n        cancelButton: 'custom-cancel-button',\r\n      },\r\n    });\r\n\r\n    if (result.isConfirmed) {\r\n      // Delete logic would go here\r\n      logger.log('Project', 'Delete project:', rowData);\r\n    }\r\n  };\r\n\r\n  const columnDefs = [\r\n    {\r\n      field: 'projectId',\r\n      headerName: 'Project Id',\r\n      sortable: true,\r\n      flex: 1,\r\n    },\r\n    {\r\n      field: 'installer',\r\n      headerName: 'Installer',\r\n      sortable: true,\r\n      flex: 1,\r\n    },\r\n    {\r\n      field: 'customerName',\r\n      headerName: 'Customer Name',\r\n      sortable: true,\r\n    },\r\n    {\r\n      field: 'address',\r\n      headerName: 'Address',\r\n      sortable: true,\r\n      flex: 2,\r\n    },\r\n    {\r\n      field: 'description',\r\n      headerName: 'Description',\r\n      sortable: true,\r\n      flex: 2,\r\n    },\r\n    {\r\n      field: 'createdOn',\r\n      headerName: 'Created On',\r\n      sortable: false,\r\n      flex: 1.2,\r\n      cellRenderer: (params) => (\r\n        <Moment format=\"MM/DD/YYYY\">{params.value}</Moment>\r\n      ),\r\n    },\r\n    {\r\n      field: 'status',\r\n      headerName: 'Status',\r\n      sortable: false,\r\n      width: 100,\r\n      flex: 1,\r\n      cellRenderer: (params) => (\r\n        <div className=\"h-100 d-flex align-items-center py-2\">\r\n          {params.value === 'DRAFT' && (\r\n            <span className=\"status-draft\">Draft</span>\r\n          )}\r\n        </div>\r\n      ),\r\n    },\r\n    {\r\n      field: 'action',\r\n      headerName: 'Action',\r\n      sortable: false,\r\n      width: 100,\r\n      flex: 1,\r\n      cellRenderer: (params) => (\r\n        <div className=\"h-100 d-flex align-items-center\">\r\n          <Button\r\n            color=\"danger\"\r\n            className={`btn-icon ${styles.deleteButton}`}\r\n            onClick={(e) => handleDelete(e, params.data)}\r\n          >\r\n            <i className=\"ri-delete-bin-5-line\"></i>\r\n          </Button>\r\n        </div>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  useEffect(() => {\r\n    fetchProjects();\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"page-content\">\r\n      {loading && <LoadingSpinner />}\r\n      <div className=\"existing-project-wrapper\">\r\n        <TableComponent\r\n          rowData={projects}\r\n          columnDefs={columnDefs}\r\n          title=\"Existing Projects\"\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ExistingProjects;\r\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\Home.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'Yup' is defined but never used.","line":5,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { Container, Row, Col, Form, Nav, NavItem, NavLink, TabContent, TabPane } from 'reactstrap';\r\nimport classnames from 'classnames';\r\nimport { useFormik } from 'formik';\r\nimport * as Yup from 'yup';\r\nimport logger from '../services/devLogger';\r\n\r\n// Project Form Component\r\nconst ProjectForm = () => {\r\n  const validation = useFormik({\r\n    enableReinitialize: true,\r\n    initialValues: {\r\n      installer: '',\r\n      installerProjectId: '',\r\n      customerFirstName: '',\r\n      customerLastName: '',\r\n      projectNotes: '',\r\n      siteSurveyScheduledDate: '',\r\n      additionalServices: [],\r\n      documents: [],\r\n      siteSurveyPhotos: [],\r\n    },\r\n    onSubmit: (values) => {\r\n      logger.log('General', 'Project submitted:', values);\r\n    },\r\n  });\r\n\r\n  return (\r\n    <Container className=\"filter-wrapper\">\r\n      <Row>\r\n        <Form\r\n          onSubmit={(e) => {\r\n            e.preventDefault();\r\n            validation.handleSubmit();\r\n            return false;\r\n          }}\r\n          className=\"needs-validation\"\r\n        >\r\n          <Row>\r\n            <Col md={3}>\r\n              <label htmlFor=\"category\" className=\"form-label d-block\">\r\n                Category\r\n              </label>\r\n              <select\r\n                className=\"form-select\"\r\n                id=\"category\"\r\n                value={validation.values.category || ''}\r\n                name=\"category\"\r\n                onChange={validation.handleChange}\r\n              >\r\n                <option defaultValue=\"\">Choose...</option>\r\n                <option>California</option>\r\n              </select>\r\n            </Col>\r\n            <Col md={3}>\r\n              <label htmlFor=\"status\" className=\"form-label d-block\">\r\n                Status\r\n              </label>\r\n              <select\r\n                className=\"form-select\"\r\n                id=\"eqStatus\"\r\n                value={validation.values.eqStatus || ''}\r\n                name=\"eqStatus\"\r\n                onChange={validation.handleChange}\r\n              >\r\n                <option defaultValue=\"\">Choose...</option>\r\n                <option>California</option>\r\n              </select>\r\n            </Col>\r\n            <Col md={3}>\r\n              <label htmlFor=\"companyName\" className=\"form-label d-block\">\r\n                Company Name\r\n              </label>\r\n              <select\r\n                className=\"form-select\"\r\n                id=\"companyName\"\r\n                value={validation.values.companyName || ''}\r\n                name=\"companyName\"\r\n                onChange={validation.handleChange}\r\n              >\r\n                <option defaultValue=\"\">Choose...</option>\r\n                <option>California</option>\r\n              </select>\r\n            </Col>\r\n          </Row>\r\n        </Form>\r\n      </Row>\r\n    </Container>\r\n  );\r\n};\r\n\r\n// Main Home Page Component\r\nconst Home = () => {\r\n  const [activeTab, setActiveTab] = useState(1);\r\n  const [passedSteps, setPassedSteps] = useState([1]);\r\n\r\n  const toggleTab = (tab) => {\r\n    if (activeTab !== tab) {\r\n      const modifiedSteps = [...passedSteps, tab];\r\n      setActiveTab(tab);\r\n      setPassedSteps(modifiedSteps);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"page-content\">\r\n      <Container fluid className=\"home-page-wrapper\">\r\n        <Row>\r\n          <Col xl={12}>\r\n            <Form className=\"form-steps\">\r\n              <div className=\"text-center pt-3 pb-4 mb-1\"></div>\r\n\r\n              {/* Navigation Tabs */}\r\n              <div className=\"mb-4\">\r\n                <Nav pills className=\"nav-pills nav custom-nav nav-justified\" role=\"tablist\">\r\n                  <NavItem>\r\n                    <NavLink\r\n                      href=\"#\"\r\n                      id=\"steparrow-gen-info-tab\"\r\n                      className={classnames({ active: activeTab === 1 })}\r\n                      onClick={() => {\r\n                        toggleTab(1);\r\n                      }}\r\n                    >\r\n                      Solar New Project\r\n                    </NavLink>\r\n                  </NavItem>\r\n                  <NavItem>\r\n                    <NavLink\r\n                      href=\"#\"\r\n                      id=\"steparrow-gen-info-tab\"\r\n                      className={classnames({ active: activeTab === 2 })}\r\n                      onClick={() => {\r\n                        toggleTab(2);\r\n                      }}\r\n                    >\r\n                      EV New Project\r\n                    </NavLink>\r\n                  </NavItem>\r\n                  <NavItem>\r\n                    <NavLink\r\n                      href=\"#\"\r\n                      id=\"steparrow-gen-info-tab\"\r\n                      className={classnames({ active: activeTab === 3 })}\r\n                      onClick={() => {\r\n                        toggleTab(3);\r\n                      }}\r\n                    >\r\n                      Existing Projects\r\n                    </NavLink>\r\n                  </NavItem>\r\n                  <NavItem>\r\n                    <NavLink\r\n                      href=\"#\"\r\n                      id=\"steparrow-gen-info-tab\"\r\n                      className={classnames({ active: activeTab === 4 })}\r\n                      onClick={() => {\r\n                        toggleTab(4);\r\n                      }}\r\n                    >\r\n                      Preferred Equipment\r\n                    </NavLink>\r\n                  </NavItem>\r\n                  <NavItem>\r\n                    <NavLink\r\n                      href=\"#\"\r\n                      id=\"steparrow-gen-info-tab\"\r\n                      className={classnames({ active: activeTab === 5 })}\r\n                      onClick={() => {\r\n                        toggleTab(5);\r\n                      }}\r\n                    >\r\n                      Manual Upload\r\n                    </NavLink>\r\n                  </NavItem>\r\n                </Nav>\r\n              </div>\r\n\r\n              {/* Tab Content */}\r\n              <TabContent activeTab={activeTab}>\r\n                <TabPane id=\"steparrow-gen-info\" tabId={1}>\r\n                  <ProjectForm />\r\n                </TabPane>\r\n                <TabPane id=\"steparrow-description-info\" tabId={2}>\r\n                  <ProjectForm />\r\n                </TabPane>\r\n                <TabPane id=\"pills-experience\" tabId={3}>\r\n                  <ProjectForm />\r\n                </TabPane>\r\n                <TabPane id=\"pills-experience\" tabId={4}>\r\n                  <ProjectForm />\r\n                </TabPane>\r\n                <TabPane id=\"pills-experience\" tabId={5}>\r\n                  <ProjectForm />\r\n                </TabPane>\r\n              </TabContent>\r\n            </Form>\r\n          </Col>\r\n        </Row>\r\n      </Container>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\InstallPortal.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'handleLogout' is assigned a value but never used.","line":56,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":56,"endColumn":21},{"ruleId":"jsx-a11y/anchor-is-valid","severity":1,"message":"The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/anchor-is-valid.md","line":127,"column":13,"nodeType":"JSXOpeningElement","endLine":134,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Link, useNavigate, useParams } from 'react-router-dom';\r\nimport { motion } from 'framer-motion';\r\nimport axios from '../config/axios';\r\nimport logger from '../services/devLogger';\r\nimport { PortalNavigationPill } from '../components/ui';\r\nimport styles from '../styles/Dashboard.module.css';\r\nimport portalStyles from '../styles/Portal.module.css';\r\nimport pageStyles from '../pages/InstallPortal.module.css';\r\n\r\n/**\r\n * Install Portal Page\r\n * Under construction placeholder\r\n */\r\nconst InstallPortal = () => {\r\n  const { projectUuid } = useParams();\r\n  const [projectData, setProjectData] = useState(null);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const fetchProjectData = async () => {\r\n      try {\r\n        const userData = JSON.parse(\r\n          sessionStorage.getItem(\"userData\") || \"{}\"\r\n        );\r\n        const companyId = userData?.company?.uuid;\r\n\r\n        if (!projectUuid) {\r\n          logger.error(\"Portal\", \"Missing projectUuid\");\r\n          return;\r\n        }\r\n\r\n        const endpoint = companyId\r\n          ? `/project/${projectUuid}?companyId=${companyId}`\r\n          : `/project/${projectUuid}`;\r\n\r\n        const response = await axios.get(endpoint);\r\n        const projectData = response.data.data || response.data;\r\n\r\n        if (projectData) {\r\n          setProjectData(projectData);\r\n        } else {\r\n          logger.warn(\"Portal\", \"No project data found in response\");\r\n        }\r\n      } catch (error) {\r\n        logger.error(\"Portal\", \"Error fetching project data:\", error);\r\n        if (error.response?.data) {\r\n          logger.error(\"Portal\", \"Error details:\", error.response.data);\r\n        }\r\n      }\r\n    };\r\n\r\n    fetchProjectData();\r\n  }, [projectUuid]);\r\n\r\n  const handleLogout = () => {\r\n    sessionStorage.clear();\r\n    navigate(\"/login\");\r\n  };\r\n\r\n  const pageVariants = {\r\n    hidden: { opacity: 0 },\r\n    visible: {\r\n      opacity: 1,\r\n      transition: {\r\n        duration: 0.5,\r\n      },\r\n    },\r\n  };\r\n\r\n  const customerName = projectData?.details\r\n    ? `${projectData.details.customer_last_name || \"\"}, ${\r\n        projectData.details.customer_first_name || \"\"\r\n      }`\r\n    : \"Loading...\";\r\n\r\n  const address = projectData?.site\r\n    ? `${projectData.site.address || \"\"}${\r\n        projectData.site.city ? `, ${projectData.site.city}` : \"\"\r\n      }${projectData.site.state ? `, ${projectData.site.state}` : \"\"}${\r\n        projectData.site.zip ? ` ${projectData.site.zip}` : \"\"\r\n      }`\r\n    : \"Loading...\";\r\n\r\n  const projectId =\r\n    projectData?.details?.installer_project_id ||\r\n    projectData?.uuid?.slice(0, 8) ||\r\n    \"Loading...\";\r\n\r\n  return (\r\n    <motion.div\r\n      className={styles.dashboardContainer}\r\n      variants={pageVariants}\r\n      initial=\"hidden\"\r\n      animate=\"visible\"\r\n    >\r\n      <div className={styles.dashboardHeader}>\r\n        <div className={portalStyles.headerInfoContainer}>\r\n          <span className={portalStyles.customerName}>\r\n            {customerName}\r\n          </span>\r\n          <span className={portalStyles.divider}>|</span>\r\n          <span className={portalStyles.address}>\r\n            {address}\r\n          </span>\r\n          <span className={portalStyles.divider}>|</span>\r\n          <span className={portalStyles.projectId}>\r\n            {projectId}\r\n          </span>\r\n        </div>\r\n\r\n        <div className={portalStyles.headerActions}>\r\n          <nav className={styles.topNav}>\r\n            <PortalNavigationPill to={`/project/${projectUuid}/sales`}>\r\n              Sales\r\n            </PortalNavigationPill>\r\n            <PortalNavigationPill to={`/project/${projectUuid}/design`}>\r\n              Design\r\n            </PortalNavigationPill>\r\n            <PortalNavigationPill to={`/project/${projectUuid}/permitting`}>\r\n              Permitting\r\n            </PortalNavigationPill>\r\n            <PortalNavigationPill to={`/project/${projectUuid}/install`} isActive>\r\n              Install\r\n            </PortalNavigationPill>\r\n            <span className={portalStyles.divider}>|</span>\r\n            <a\r\n              href=\"#\"\r\n              onClick={(e) => {\r\n                e.preventDefault();\r\n                // Scheduling functionality coming soon\r\n              }}\r\n              className={styles.navLink}\r\n            >\r\n              Scheduling\r\n            </a>\r\n            <Link\r\n              to=\"/dashboard\"\r\n              className={styles.navLink}\r\n            >\r\n              Projects\r\n            </Link>\r\n          </nav>\r\n        </div>\r\n      </div>\r\n\r\n      <div className={pageStyles.constructionContainer}>\r\n        <div className={pageStyles.constructionIcon}>ðŸš§</div>\r\n        <h1 className={pageStyles.constructionTitle}>Under Construction</h1>\r\n        <p className={pageStyles.constructionText}>\r\n          The Install Portal is currently being built.\r\n        </p>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n};\r\n\r\nexport default InstallPortal;\r\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\Inventory\\AddEquipmentForm.js","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadManufacturers'. Either include it or remove the dependency array.","line":37,"column":6,"nodeType":"ArrayExpression","endLine":37,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [categoryId, loadManufacturers]","fix":{"range":[1166,1178],"text":"[categoryId, loadManufacturers]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * AddEquipmentForm - Inline form for adding preferred equipment\n * Replaces the category list in the left panel when active\n */\n\nimport React, { useState, useEffect } from 'react';\nimport { ArrowLeft } from 'lucide-react';\nimport { isModelOptional, getEquipmentTypeForCategory } from '../../constants/equipmentCategories';\nimport {\n  getEquipmentManufacturers,\n  getEquipmentModels,\n} from '../../services/preferredEquipmentService';\nimport styles from './AddEquipmentForm.module.css';\n\nconst AddEquipmentForm = ({\n  onClose,\n  onAdd,\n  categoryId,\n  categoryLabel,\n  isSolarPanel = false,\n}) => {\n  const [make, setMake] = useState('');\n  const [model, setModel] = useState('');\n  const [quantity, setQuantity] = useState('');\n  const [wattageFilter, setWattageFilter] = useState('');\n  const [makes, setMakes] = useState([]);\n  const [models, setModels] = useState([]);\n  const [loadingMakes, setLoadingMakes] = useState(false);\n  const [loadingModels, setLoadingModels] = useState(false);\n  const [saving, setSaving] = useState(false);\n\n  // Load manufacturers when form mounts\n  useEffect(() => {\n    if (categoryId) {\n      loadManufacturers();\n    }\n  }, [categoryId]);\n\n  const loadManufacturers = async () => {\n    setLoadingMakes(true);\n    try {\n      const equipmentType = getEquipmentTypeForCategory(categoryId);\n      const data = await getEquipmentManufacturers(equipmentType, wattageFilter || undefined);\n      const makeOptions = (data || []).map(m => ({\n        label: m.manufacturer || m.manufacturerName || m.name || m,\n        value: m.manufacturer || m.manufacturerName || m.name || m,\n      }));\n      setMakes(makeOptions);\n    } catch (error) {\n      console.error('[AddEquipmentForm] Error loading manufacturers:', error);\n    } finally {\n      setLoadingMakes(false);\n    }\n  };\n\n  const loadModels = async (selectedMake) => {\n    if (!selectedMake) {\n      setModels([]);\n      return;\n    }\n    setLoadingModels(true);\n    try {\n      const equipmentType = getEquipmentTypeForCategory(categoryId);\n      const data = await getEquipmentModels(equipmentType, selectedMake, wattageFilter || undefined);\n      const modelOptions = (data || []).map(m => ({\n        label: m.model_number || m.model || m.name || m,\n        value: m.model_number || m.model || m.name || m,\n        wattage: m.nameplate_pmax || m.wattage || null,\n      }));\n      setModels(modelOptions);\n    } catch (error) {\n      console.error('[AddEquipmentForm] Error loading models:', error);\n    } finally {\n      setLoadingModels(false);\n    }\n  };\n\n  const handleMakeChange = (value) => {\n    setMake(value);\n    setModel('');\n    loadModels(value);\n  };\n\n  const handleWattageFilterChange = (value) => {\n    setWattageFilter(value);\n    setMake('');\n    setModel('');\n    setModels([]);\n    // Reload manufacturers with new filter after brief delay\n    setTimeout(() => loadManufacturers(), 100);\n  };\n\n  const handleSubmit = async () => {\n    if (!make) return;\n\n    setSaving(true);\n    try {\n      await onAdd({\n        categoryId,\n        make,\n        model,\n        quantity: quantity ? parseInt(quantity, 10) : 0,\n      });\n      onClose(); // Return to category list after successful add\n    } catch (error) {\n      console.error('[AddEquipmentForm] Error adding equipment:', error);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  // Check if model is optional for this category\n  const modelOptional = isModelOptional(categoryId);\n\n  return (\n    <div className={styles.container}>\n      {/* Header with back button */}\n      <div className={styles.header}>\n        <button className={styles.backButton} onClick={onClose}>\n          <ArrowLeft size={18} />\n          <span>Back</span>\n        </button>\n      </div>\n\n      {/* Title */}\n      <h3 className={styles.title}>Add {categoryLabel}</h3>\n\n      {/* Form Fields */}\n      <div className={styles.formContent}>\n        {/* Wattage Filter - Solar Panels Only */}\n        {isSolarPanel && (\n          <div className={styles.formGroup}>\n            <label className={styles.label}>Filter by Wattage</label>\n            <input\n              type=\"number\"\n              className={styles.input}\n              value={wattageFilter}\n              onChange={(e) => handleWattageFilterChange(e.target.value)}\n              placeholder=\"e.g., 400\"\n            />\n          </div>\n        )}\n\n        {/* Manufacturer */}\n        <div className={styles.formGroup}>\n          <label className={styles.label}>Manufacturer *</label>\n          <select\n            className={styles.select}\n            value={make}\n            onChange={(e) => handleMakeChange(e.target.value)}\n            disabled={loadingMakes}\n          >\n            <option value=\"\">\n              {loadingMakes ? 'Loading...' : 'Select Manufacturer'}\n            </option>\n            {makes.map(m => (\n              <option key={m.value} value={m.value}>{m.label}</option>\n            ))}\n          </select>\n        </div>\n\n        {/* Model */}\n        <div className={styles.formGroup}>\n          <label className={styles.label}>\n            Model {modelOptional ? '(optional)' : '*'}\n          </label>\n          <select\n            className={styles.select}\n            value={model}\n            onChange={(e) => setModel(e.target.value)}\n            disabled={!make || loadingModels}\n          >\n            <option value=\"\">\n              {loadingModels ? 'Loading...' : make ? 'Select Model' : 'Select Manufacturer First'}\n            </option>\n            {models.map(m => (\n              <option key={m.value} value={m.value}>{m.label}</option>\n            ))}\n          </select>\n        </div>\n\n        {/* Quantity */}\n        <div className={styles.formGroup}>\n          <label className={styles.label}>Qty on Hand</label>\n          <input\n            type=\"number\"\n            className={styles.input}\n            value={quantity}\n            onChange={(e) => setQuantity(e.target.value)}\n            placeholder=\"0\"\n            min=\"0\"\n          />\n          <span className={styles.hint}>Quantity tracking coming soon</span>\n        </div>\n      </div>\n\n      {/* Action Buttons */}\n      <div className={styles.actions}>\n        <button\n          className={styles.addButton}\n          onClick={handleSubmit}\n          disabled={saving || !make || (!modelOptional && !model)}\n        >\n          {saving ? 'Adding...' : `+ Add ${categoryLabel.replace(/s$/, '')}`}\n        </button>\n        <button className={styles.cancelButton} onClick={onClose}>\n          Cancel\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default AddEquipmentForm;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\Inventory\\index.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'CollapsibleSection' is defined but never used.","line":22,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":26},{"ruleId":"no-unused-vars","severity":1,"message":"'location' is assigned a value but never used.","line":30,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":17},{"ruleId":"no-unused-vars","severity":1,"message":"'selectedCompanyName' is assigned a value but never used.","line":48,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":48,"endColumn":29},{"ruleId":"no-unused-vars","severity":1,"message":"'savingEquipment' is assigned a value but never used.","line":86,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":86,"endColumn":25},{"ruleId":"no-unused-vars","severity":1,"message":"'setSavingEquipment' is assigned a value but never used.","line":86,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":86,"endColumn":45},{"ruleId":"no-unused-vars","severity":1,"message":"'setWatts' is assigned a value but never used.","line":89,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":89,"endColumn":25},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchCompanies'. Either include it or remove the dependency array.","line":113,"column":6,"nodeType":"ArrayExpression","endLine":113,"endColumn":19,"suggestions":[{"desc":"Update the dependencies array to be: [fetchCompanies, isSuperUser]","fix":{"range":[3833,3846],"text":"[fetchCompanies, isSuperUser]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'inventory'. Either include it or remove the dependency array.","line":199,"column":6,"nodeType":"ArrayExpression","endLine":199,"endColumn":26,"suggestions":[{"desc":"Update the dependencies array to be: [getActiveCompanyId, inventory]","fix":{"range":[6763,6783],"text":"[getActiveCompanyId, inventory]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'currentUserCompanyId'. Either include it or remove the dependency array.","line":265,"column":6,"nodeType":"ArrayExpression","endLine":265,"endColumn":43,"suggestions":[{"desc":"Update the dependencies array to be: [selectedCompanyId, loadAllEquipment, currentUserCompanyId]","fix":{"range":[8851,8888],"text":"[selectedCompanyId, loadAllEquipment, currentUserCompanyId]"}}]},{"ruleId":"no-unused-vars","severity":1,"message":"'toggleSection' is assigned a value but never used.","line":305,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":305,"endColumn":22},{"ruleId":"no-unused-vars","severity":1,"message":"'handleMakeChange' is assigned a value but never used.","line":318,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":318,"endColumn":25},{"ruleId":"no-unused-vars","severity":1,"message":"'handleModelChange' is assigned a value but never used.","line":336,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":336,"endColumn":26},{"ruleId":"no-unused-vars","severity":1,"message":"'handleQuantityChange' is assigned a value but never used.","line":347,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":347,"endColumn":29}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":13,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Inventory Management - 30/70 Split Panel Layout\n * Left: Category navigation + Add form (30%)\n * Right: Equipment display grid for selected category (70%)\n */\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { toast } from 'react-toastify';\nimport { Trash2, ArrowLeft } from 'lucide-react';\nimport { isCurrentUserAdminAsync } from '../../utils/adminUtils';\nimport { EQUIPMENT_CATEGORIES, isModelOptional, getEquipmentTypeForCategory } from '../../constants/equipmentCategories';\nimport {\n  getPreferredEquipment,\n  createPreferredEquipment,\n  updatePreferredEquipment,\n  deletePreferredEquipment,\n  getEquipmentManufacturers,\n  getEquipmentModels,\n  getAllCompanies,\n} from '../../services/preferredEquipmentService';\nimport CollapsibleSection from '../../components/ui/CollapsibleSection';\nimport AddEquipmentForm from './AddEquipmentForm';\nimport styles from './Inventory.module.css';\n\nconst Inventory = () => {\n  console.log('[Inventory] âœ… NEW 30/70 SPLIT LAYOUT - src/pages/Inventory/index.js');\n\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  // Get user data from session storage\n  const userData = JSON.parse(sessionStorage.getItem('userData') || '{}');\n  const currentUserCompanyId = userData?.company?.uuid;\n  const currentUserCompanyName = userData?.company?.name || '';\n  const userId = userData?.uuid || userData?.id;\n\n  // Check if we have a return project path\n  const returnToProjectPath = sessionStorage.getItem('returnToProject');\n\n  // Selected category for 30/70 split (NEW)\n  const [selectedCategory, setSelectedCategory] = useState('solar-panels');\n\n  // Super user state\n  const [isSuperUser, setIsSuperUser] = useState(false);\n  const [companies, setCompanies] = useState([]);\n  const [selectedCompanyId, setSelectedCompanyId] = useState(currentUserCompanyId);\n  const [selectedCompanyName, setSelectedCompanyName] = useState(currentUserCompanyName);\n  const [loadingCompanies, setLoadingCompanies] = useState(false);\n\n  // Inventory state - all equipment for all categories\n  const [inventory, setInventory] = useState({\n    'solar-panels': [],\n    'inverters': [],\n    'micro-inverters': [],\n    'batteries': [],\n    'storage-management': [],\n    'ac-disconnects': [],\n    'pv-meters': [],\n    'load-centers': [],\n    'rails': [],\n    'attachments': [],\n    'ev-chargers': [],\n  });\n\n  // Expand/collapse state - Solar Panels and Inverters expanded by default\n  const [expandedSections, setExpandedSections] = useState({\n    'solar-panels': true,\n    'inverters': true,\n    'micro-inverters': false,\n    'batteries': false,\n    'storage-management': false,\n    'ac-disconnects': false,\n    'pv-meters': false,\n    'load-centers': false,\n    'rails': false,\n    'attachments': false,\n    'ev-chargers': false,\n  });\n\n  // Dropdown state for each category\n  const [dropdownState, setDropdownState] = useState({});\n\n  // Loading states\n  const [loading, setLoading] = useState(true);\n  const [savingEquipment, setSavingEquipment] = useState({});\n\n  // Wattage filter (solar panels only)\n  const [watts, setWatts] = useState('');\n\n  // Delete confirmation modal\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\n  const [equipmentToDelete, setEquipmentToDelete] = useState(null);\n\n  // Add equipment modal state\n  const [addModalOpen, setAddModalOpen] = useState(false);\n  const [addModalCategory, setAddModalCategory] = useState(null);\n\n  // Check admin status on mount\n  useEffect(() => {\n    const checkAdminStatus = async () => {\n      const isAdmin = await isCurrentUserAdminAsync();\n      setIsSuperUser(isAdmin);\n    };\n    checkAdminStatus();\n  }, []);\n\n  // Fetch companies for super users\n  useEffect(() => {\n    if (isSuperUser) {\n      fetchCompanies();\n    }\n  }, [isSuperUser]);\n\n  const fetchCompanies = async () => {\n    setLoadingCompanies(true);\n    try {\n      const response = await getAllCompanies();\n\n      if (response?.data) {\n        // Filter for APPROVED companies only\n        const approvedCompanies = response.data\n          .filter((item) => {\n            const approved = item.user?.approved ?? item.approved ?? item.company?.approved;\n            return approved === true || approved === 1;\n          })\n          .map((item) => ({\n            uuid: item.company?.uuid || item.uuid,\n            name: item.company?.name || item.name,\n            email: item.user?.email,\n          }));\n\n        console.log(`[Inventory] Loaded ${approvedCompanies.length} approved companies`);\n        setCompanies(approvedCompanies);\n\n        // Default to current user's company if available\n        const currentCompany = approvedCompanies.find(c => c.uuid === currentUserCompanyId);\n        if (currentCompany) {\n          setSelectedCompanyId(currentCompany.uuid);\n          setSelectedCompanyName(currentCompany.name);\n        } else if (approvedCompanies.length > 0) {\n          setSelectedCompanyId(approvedCompanies[0].uuid);\n          setSelectedCompanyName(approvedCompanies[0].name);\n        }\n      }\n    } catch (error) {\n      console.error('[Inventory] Error fetching companies:', error);\n      toast.error('Failed to load companies');\n    } finally {\n      setLoadingCompanies(false);\n    }\n  };\n\n  // Get active company ID\n  const getActiveCompanyId = useCallback(() => {\n    if (isSuperUser && selectedCompanyId) {\n      return selectedCompanyId;\n    }\n    return currentUserCompanyId;\n  }, [isSuperUser, selectedCompanyId, currentUserCompanyId]);\n\n  // Load ALL equipment for ALL categories\n  const loadAllEquipment = useCallback(async (companyIdOverride) => {\n    const activeCompanyId = companyIdOverride || getActiveCompanyId();\n    if (!activeCompanyId) {\n      console.warn('[Inventory] No company ID available');\n      setLoading(false);\n      return;\n    }\n\n    console.log(`[Inventory] Loading all equipment for company: ${activeCompanyId}`);\n    setLoading(true);\n\n    try {\n      const newInventory = { ...inventory };\n\n      // Load equipment for each category\n      for (const category of EQUIPMENT_CATEGORIES) {\n        if (category.disabled) {\n          newInventory[category.id] = [];\n          continue;\n        }\n\n        try {\n          const data = await getPreferredEquipment(activeCompanyId, category.id);\n          const equipment = Array.isArray(data) ? data : data?.data || [];\n          newInventory[category.id] = equipment;\n        } catch (error) {\n          console.error(`[Inventory] Error loading ${category.id}:`, error);\n          newInventory[category.id] = [];\n        }\n      }\n\n      console.log('[Inventory] All equipment loaded:', newInventory);\n      setInventory(newInventory);\n    } finally {\n      setLoading(false);\n    }\n  }, [getActiveCompanyId]);\n\n  // Load manufacturers for a category\n  const loadManufacturers = useCallback(async (categoryId) => {\n    try {\n      const equipmentType = getEquipmentTypeForCategory(categoryId);\n      const data = await getEquipmentManufacturers(equipmentType);\n\n      const manufacturers = data?.data || data || [];\n      const formatted = manufacturers.map((m) => {\n        if (typeof m === 'string') return { label: m, value: m };\n        return {\n          label: m.manufacturer || m.manufacturerName || m.name || m.label,\n          value: m.manufacturer || m.manufacturerName || m.name || m.value,\n        };\n      });\n\n      setDropdownState(prev => ({\n        ...prev,\n        [categoryId]: {\n          ...prev[categoryId],\n          makes: formatted,\n        },\n      }));\n    } catch (error) {\n      console.error(`[Inventory] Error loading manufacturers for ${categoryId}:`, error);\n    }\n  }, []);\n\n  // Load models for a category\n  const loadModels = useCallback(async (categoryId, make) => {\n    if (!make) return;\n\n    try {\n      const equipmentType = getEquipmentTypeForCategory(categoryId);\n      const isSolarPanel = categoryId === 'solar-panels';\n      const pmax = isSolarPanel && watts ? parseInt(watts) : null;\n\n      const data = await getEquipmentModels(equipmentType, make, pmax);\n\n      const modelsList = data?.data || data || [];\n      const formatted = modelsList.map((m) => {\n        if (typeof m === 'string') return { label: m, value: m };\n        return {\n          label: m.model || m.modelNumber || m.name || m.label,\n          value: m.model || m.modelNumber || m.name || m.value,\n        };\n      });\n\n      setDropdownState(prev => ({\n        ...prev,\n        [categoryId]: {\n          ...prev[categoryId],\n          models: formatted,\n        },\n      }));\n    } catch (error) {\n      console.error(`[Inventory] Error loading models for ${categoryId}:`, error);\n    }\n  }, [watts]);\n\n  // Load on mount and when company changes\n  useEffect(() => {\n    if (selectedCompanyId || currentUserCompanyId) {\n      loadAllEquipment();\n    }\n  }, [selectedCompanyId, loadAllEquipment]);\n\n  // Load manufacturers when category changes (for 30/70 split layout)\n  useEffect(() => {\n    if (selectedCategory && !dropdownState[selectedCategory]?.makes) {\n      loadManufacturers(selectedCategory);\n    }\n  }, [selectedCategory, dropdownState, loadManufacturers]);\n\n  // Handle company change (super users)\n  const handleCompanyChange = async (e) => {\n    const companyUuid = e.target.value;\n    const company = companies.find(c => c.uuid === companyUuid);\n    if (!company) return;\n\n    console.log(`[Inventory] Switching to company: ${company.name}`);\n\n    // Clear current inventory\n    setInventory({\n      'solar-panels': [],\n      'inverters': [],\n      'micro-inverters': [],\n      'batteries': [],\n      'storage-management': [],\n      'ac-disconnects': [],\n      'pv-meters': [],\n      'load-centers': [],\n      'rails': [],\n      'attachments': [],\n      'ev-chargers': [],\n    });\n    setSelectedCompanyId(companyUuid);\n    setSelectedCompanyName(company.name);\n\n    toast.info(`Now managing: ${company.name}`, { autoClose: 2000 });\n\n    await loadAllEquipment(companyUuid);\n  };\n\n  // Toggle section expand/collapse\n  const toggleSection = (categoryId) => {\n    setExpandedSections(prev => ({\n      ...prev,\n      [categoryId]: !prev[categoryId],\n    }));\n\n    // Load manufacturers when expanding if not already loaded\n    if (!expandedSections[categoryId] && !dropdownState[categoryId]?.makes) {\n      loadManufacturers(categoryId);\n    }\n  };\n\n  // Handle manufacturer change\n  const handleMakeChange = (categoryId, value) => {\n    setDropdownState(prev => ({\n      ...prev,\n      [categoryId]: {\n        ...prev[categoryId],\n        make: value,\n        model: '', // Reset model when make changes\n        models: [], // Clear models\n      },\n    }));\n\n    // Load models for selected make\n    if (value) {\n      loadModels(categoryId, value);\n    }\n  };\n\n  // Handle model change\n  const handleModelChange = (categoryId, value) => {\n    setDropdownState(prev => ({\n      ...prev,\n      [categoryId]: {\n        ...prev[categoryId],\n        model: value,\n      },\n    }));\n  };\n\n  // Handle quantity change (NEW for 30/70 split)\n  const handleQuantityChange = (categoryId, value) => {\n    setDropdownState(prev => ({\n      ...prev,\n      [categoryId]: {\n        ...prev[categoryId],\n        quantity: value,\n      },\n    }));\n  };\n\n  // Open add equipment form\n  const handleOpenAddModal = (category) => {\n    setAddModalCategory(category);\n    setAddModalOpen(true);\n  };\n\n  // Add equipment from modal\n  const handleAddFromModal = async ({ categoryId, make, model, quantity }) => {\n    const modelOptional = isModelOptional(categoryId);\n\n    if (!make) {\n      toast.warning('Please select a manufacturer');\n      return;\n    }\n\n    if (!modelOptional && !model) {\n      toast.warning('Please select a model');\n      return;\n    }\n\n    // Check for duplicates\n    const isDuplicate = inventory[categoryId].some(\n      (eq) => eq.make === make && eq.model === model\n    );\n\n    if (isDuplicate) {\n      toast.warning('This equipment is already in your preferred list');\n      return;\n    }\n\n    try {\n      const activeCompanyId = getActiveCompanyId();\n      await createPreferredEquipment({\n        equipmentType: categoryId,\n        make: make,\n        model: model || '',\n        companyId: activeCompanyId,\n        createdBy: userId,\n        isDefault: inventory[categoryId].length === 0, // First one is default\n      });\n\n      toast.success('Equipment added successfully');\n\n      // Reload equipment for this category\n      const data = await getPreferredEquipment(activeCompanyId, categoryId);\n      const equipment = Array.isArray(data) ? data : data?.data || [];\n      setInventory(prev => ({\n        ...prev,\n        [categoryId]: equipment,\n      }));\n    } catch (error) {\n      console.error('[Inventory] Error adding equipment:', error);\n      toast.error('Failed to add equipment');\n      throw error; // Re-throw so modal can handle it\n    }\n  };\n\n  // Delete equipment (show confirmation)\n  const handleDeleteClick = (categoryId, equipment) => {\n    setEquipmentToDelete({ categoryId, equipment });\n    setShowDeleteConfirm(true);\n  };\n\n  // Confirm delete\n  const handleDeleteConfirm = async () => {\n    if (!equipmentToDelete) return;\n\n    const { categoryId, equipment } = equipmentToDelete;\n\n    try {\n      await deletePreferredEquipment(equipment.uuid);\n      toast.success('Equipment removed');\n      setShowDeleteConfirm(false);\n      setEquipmentToDelete(null);\n\n      // Reload equipment for this category\n      const activeCompanyId = getActiveCompanyId();\n      const data = await getPreferredEquipment(activeCompanyId, categoryId);\n      const equipmentList = Array.isArray(data) ? data : data?.data || [];\n      setInventory(prev => ({\n        ...prev,\n        [categoryId]: equipmentList,\n      }));\n    } catch (error) {\n      console.error('[Inventory] Error deleting equipment:', error);\n      toast.error('Failed to remove equipment');\n    }\n  };\n\n  // Cancel delete\n  const handleDeleteCancel = () => {\n    setShowDeleteConfirm(false);\n    setEquipmentToDelete(null);\n  };\n\n  // Set as default\n  const handleSetDefault = async (categoryId, equipment) => {\n    try {\n      await updatePreferredEquipment(equipment.uuid, { is_default: true });\n      toast.success(`${equipment.make} set as default`);\n\n      // Reload equipment for this category\n      const activeCompanyId = getActiveCompanyId();\n      const data = await getPreferredEquipment(activeCompanyId, categoryId);\n      const equipmentList = Array.isArray(data) ? data : data?.data || [];\n      setInventory(prev => ({\n        ...prev,\n        [categoryId]: equipmentList,\n      }));\n    } catch (error) {\n      console.error('[Inventory] Error setting default:', error);\n      toast.error('Failed to set as default');\n    }\n  };\n\n  const handleBackToProject = () => {\n    if (returnToProjectPath) {\n      sessionStorage.removeItem('returnToProject'); // Clear after use\n      navigate(returnToProjectPath);\n    }\n  };\n\n  return (\n    <div className={styles.container}>\n      {/* Header */}\n      <div className={styles.header}>\n        <div className={styles.headerContent}>\n          <div>\n            <h1>Inventory Management</h1>\n            <p>Manage your preferred equipment for each category</p>\n          </div>\n          {returnToProjectPath && (\n            <button onClick={handleBackToProject} className={styles.backToProjectButton}>\n              <ArrowLeft size={18} />\n              <span>Back to Project</span>\n            </button>\n          )}\n        </div>\n      </div>\n\n      {/* Super User Company Selector */}\n      {isSuperUser && companies.length > 0 && (\n        <div className={styles.companySelectorContainer}>\n          <label className={styles.companySelectorLabel}>\n            Managing Equipment For:\n          </label>\n          <select\n            value={selectedCompanyId || ''}\n            onChange={handleCompanyChange}\n            className={styles.companySelect}\n            disabled={loadingCompanies}\n          >\n            {companies.map((company) => (\n              <option key={company.uuid} value={company.uuid}>\n                {company.name}\n              </option>\n            ))}\n          </select>\n        </div>\n      )}\n\n      {/* Loading State */}\n      {loading ? (\n        <div className={styles.loadingContainer}>\n          <div className={styles.spinner} />\n          <p>Loading equipment...</p>\n        </div>\n      ) : (\n        /* 30/70 Split Layout */\n        <div className={styles.splitLayout}>\n          {/* LEFT PANEL: Category Navigation OR Add Form (30%) */}\n          <div className={styles.categoryPanel}>\n            {addModalOpen && addModalCategory ? (\n              // INLINE ADD FORM\n              <AddEquipmentForm\n                onClose={() => {\n                  setAddModalOpen(false);\n                  setAddModalCategory(null);\n                }}\n                onAdd={handleAddFromModal}\n                categoryId={addModalCategory.id}\n                categoryLabel={addModalCategory.label}\n                isSolarPanel={addModalCategory.id === 'solar-panels'}\n              />\n            ) : (\n              // CATEGORY LIST\n              <>\n                <h3 className={styles.categoryPanelTitle}>Equipment Categories</h3>\n\n                <div className={styles.categoryList}>\n                  {EQUIPMENT_CATEGORIES.map((category) => (\n                    <button\n                      key={category.id}\n                      className={`${styles.categoryItem} ${selectedCategory === category.id ? styles.categoryItemSelected : ''}`}\n                      onClick={() => setSelectedCategory(category.id)}\n                      disabled={category.disabled}\n                    >\n                      <span className={styles.categoryName}>{category.label}</span>\n                      <div className={styles.categoryRight}>\n                        {!category.disabled && !category.comingSoon && (\n                          <button\n                            className={styles.addCategoryButton}\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              handleOpenAddModal(category);\n                            }}\n                            title={`Add ${category.label}`}\n                          >\n                            + Add\n                          </button>\n                        )}\n                        {!category.comingSoon && (\n                          <span className={styles.categoryBadge}>\n                            {inventory[category.id]?.length || 0}\n                          </span>\n                        )}\n                        {category.comingSoon && (\n                          <span className={styles.comingSoonBadge}>Soon</span>\n                        )}\n                      </div>\n                    </button>\n                  ))}\n                </div>\n              </>\n            )}\n          </div>\n\n          {/* RIGHT PANEL: Equipment Display Grid (70%) */}\n          <div className={styles.displayPanel}>\n            <h3 className={styles.displayPanelTitle}>\n              {EQUIPMENT_CATEGORIES.find(c => c.id === selectedCategory)?.label || 'Equipment'}\n            </h3>\n\n            {(inventory[selectedCategory] || []).length === 0 ? (\n              <div className={styles.emptyState}>\n                <p>\n                  No preferred {EQUIPMENT_CATEGORIES.find(c => c.id === selectedCategory)?.label?.toLowerCase() || 'equipment'} added yet.\n                </p>\n                <p className={styles.emptyHint}>Use the form on the left to add equipment.</p>\n              </div>\n            ) : (\n              <div className={styles.equipmentGrid}>\n                {(inventory[selectedCategory] || []).map((equipment) => (\n                  <div key={equipment.uuid} className={styles.equipmentCard}>\n                    <div className={styles.equipmentInfo}>\n                      <div className={styles.equipmentHeader}>\n                        <span className={styles.equipmentMake}>{equipment.make}</span>\n                        {equipment.is_default && (\n                          <span className={styles.defaultBadge}>Default</span>\n                        )}\n                      </div>\n                      {equipment.model && (\n                        <span className={styles.equipmentModel}>{equipment.model}</span>\n                      )}\n\n                      {/* Quantity on Hand Display (NEW) */}\n                      <div className={styles.qtyOnHand}>\n                        <span className={styles.qtyLabel}>In Stock:</span>\n                        <span className={styles.qtyValue}>\n                          {equipment.quantity_on_hand || 0}\n                        </span>\n                      </div>\n                    </div>\n\n                    <div className={styles.equipmentActions}>\n                      {!equipment.is_default && (\n                        <button\n                          className={styles.setDefaultButton}\n                          onClick={() => handleSetDefault(selectedCategory, equipment)}\n                        >\n                          Set Default\n                        </button>\n                      )}\n                      <button\n                        className={styles.deleteButton}\n                        onClick={() => handleDeleteClick(selectedCategory, equipment)}\n                        aria-label=\"Delete equipment\"\n                      >\n                        <Trash2 size={16} />\n                      </button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Delete Confirmation Modal */}\n      {showDeleteConfirm && equipmentToDelete && (\n        <div className={styles.modalOverlay}>\n          <div className={styles.modal}>\n            <h3>Remove Equipment?</h3>\n            <p>\n              Are you sure you want to remove{' '}\n              <strong>{equipmentToDelete.equipment.make}</strong>\n              {equipmentToDelete.equipment.model && (\n                <> - {equipmentToDelete.equipment.model}</>\n              )}{' '}\n              from your preferred list?\n            </p>\n            <div className={styles.modalButtons}>\n              <button className={styles.cancelButton} onClick={handleDeleteCancel}>\n                Cancel\n              </button>\n              <button className={styles.confirmDeleteButton} onClick={handleDeleteConfirm}>\n                Remove\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Inventory;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\PermittingPortal.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'ProjectHeader' is defined but never used.","line":10,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":45},{"ruleId":"no-unused-vars","severity":1,"message":"'LoadingSpinner' is defined but never used.","line":10,"column":59,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":73},{"ruleId":"no-unused-vars","severity":1,"message":"'stats' is assigned a value but never used.","line":21,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":16},{"ruleId":"no-unused-vars","severity":1,"message":"'handleLogout' is assigned a value but never used.","line":66,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":66,"endColumn":21},{"ruleId":"jsx-a11y/anchor-is-valid","severity":1,"message":"The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/anchor-is-valid.md","line":140,"column":13,"nodeType":"JSXOpeningElement","endLine":147,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Link, useNavigate, useParams } from 'react-router-dom';\nimport { motion } from 'framer-motion';\nimport axios from '../config/axios';\nimport logger from '../services/devLogger';\nimport ProjectDetailsTabs from '../components/dashboard/ProjectDetailsTabs';\nimport ProjectOverviewTabs from '../components/dashboard/ProjectOverviewTabs';\nimport SiteForm from '../components/project/SiteForm';\nimport ChatterPanel from '../components/chatter/ChatterPanel';\nimport { PortalNavigationPill, ProjectHeader, ErrorState, LoadingSpinner } from '../components/ui';\nimport useDashboardData from '../hooks/useDashboardData';\nimport styles from '../styles/Dashboard.module.css';\nimport portalStyles from '../styles/Portal.module.css';\n\n/**\n * Permitting Portal Page\n * Permitting team view of project information\n */\nconst PermittingPortal = () => {\n  const { projectUuid } = useParams();\n  const { stats, statusCounts, statusChanges, loading, error, refetch } = useDashboardData();\n  const [selectedStatus, setSelectedStatus] = useState('site');\n  const [selectedOverviewTab, setSelectedOverviewTab] = useState('survey');\n  const [projectData, setProjectData] = useState(null);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const fetchProjectData = async () => {\n      try {\n        const userData = JSON.parse(\n          sessionStorage.getItem(\"userData\") || \"{}\"\n        );\n        const companyId = userData?.company?.uuid;\n\n        if (!projectUuid) {\n          logger.error(\"Portal\", \"Missing projectUuid\");\n          return;\n        }\n\n        // Fetch project data\n        const endpoint = companyId\n          ? `/project/${projectUuid}?companyId=${companyId}`\n          : `/project/${projectUuid}`;\n\n        const response = await axios.get(endpoint);\n\n        // Extract project data (API returns data nested in response.data.data)\n        const projectData = response.data.data || response.data;\n\n        if (projectData) {\n          setProjectData(projectData);\n        } else {\n          logger.warn(\"Portal\", \"No project data found in response\");\n        }\n      } catch (error) {\n        logger.error(\"Portal\", \"Error fetching project data:\", error);\n        if (error.response?.data) {\n          logger.error(\"Portal\", \"Error details:\", error.response.data);\n        }\n      }\n    };\n\n    fetchProjectData();\n  }, [projectUuid]);\n\n  const handleLogout = () => {\n    sessionStorage.clear();\n    navigate(\"/login\");\n  };\n\n  const pageVariants = {\n    hidden: { opacity: 0 },\n    visible: {\n      opacity: 1,\n      transition: {\n        duration: 0.5,\n        when: \"beforeChildren\",\n      },\n    },\n  };\n\n  // Get customer name, address, and project ID from project data\n  const customerName = projectData?.details\n    ? `${projectData.details.customer_last_name || \"\"}, ${\n        projectData.details.customer_first_name || \"\"\n      }`\n    : \"Loading...\";\n\n  const address = projectData?.site\n    ? `${projectData.site.address || \"\"}${\n        projectData.site.city ? `, ${projectData.site.city}` : \"\"\n      }${projectData.site.state ? `, ${projectData.site.state}` : \"\"}${\n        projectData.site.zip ? ` ${projectData.site.zip}` : \"\"\n      }`\n    : \"Loading...\";\n\n  const projectId =\n    projectData?.details?.installer_project_id ||\n    projectData?.uuid?.slice(0, 8) ||\n    \"Loading...\";\n\n  return (\n    <motion.div\n      className={styles.dashboardContainer}\n      variants={pageVariants}\n      initial=\"hidden\"\n      animate=\"visible\"\n    >\n      {/* Header */}\n      <div className={styles.dashboardHeader}>\n        <div className={portalStyles.headerInfoContainer}>\n          <span className={portalStyles.customerName}>\n            {customerName}\n          </span>\n          <span className={portalStyles.divider}>|</span>\n          <span className={portalStyles.address}>\n            {address}\n          </span>\n          <span className={portalStyles.divider}>|</span>\n          <span className={portalStyles.projectId}>\n            {projectId}\n          </span>\n        </div>\n\n        <div className={portalStyles.headerActions}>\n          <nav className={styles.topNav}>\n            <PortalNavigationPill to={`/project/${projectUuid}/sales`}>\n              Sales\n            </PortalNavigationPill>\n            <PortalNavigationPill to={`/project/${projectUuid}/design`}>\n              Design\n            </PortalNavigationPill>\n            <PortalNavigationPill to={`/project/${projectUuid}/permitting`} isActive>\n              Permitting\n            </PortalNavigationPill>\n            <PortalNavigationPill to={`/project/${projectUuid}/install`}>\n              Install\n            </PortalNavigationPill>\n            <span className={portalStyles.divider}>|</span>\n            <a\n              href=\"#\"\n              onClick={(e) => {\n                e.preventDefault();\n                // Scheduling functionality coming soon\n              }}\n              className={styles.navLink}\n            >\n              Scheduling\n            </a>\n            <Link\n              to=\"/dashboard\"\n              className={styles.navLink}\n            >\n              Projects\n            </Link>\n          </nav>\n        </div>\n      </div>\n\n      {/* Error State */}\n      {error && (\n        <div className={`${styles.section} ${portalStyles.errorSection}`}>\n          <ErrorState\n            title=\"Error Loading Data\"\n            message={error}\n            onRetry={refetch}\n          />\n        </div>\n      )}\n\n      {/* Project Details Tabs - Side by Side (30% / 70%) */}\n      <div className={portalStyles.gridLayout}>\n        <ProjectDetailsTabs\n          statusCounts={statusCounts}\n          statusChanges={statusChanges}\n          selectedStatus={selectedStatus}\n          onStatusChange={setSelectedStatus}\n          loading={loading}\n        >\n          {selectedStatus === 'site' && (\n            <SiteForm projectUuid={projectUuid} projectData={projectData} />\n          )}\n        </ProjectDetailsTabs>\n\n        <ProjectOverviewTabs\n          selectedTab={selectedOverviewTab}\n          onTabChange={setSelectedOverviewTab}\n          loading={loading}\n        >\n          {selectedOverviewTab === 'overview' && projectUuid && (\n            <div className={portalStyles.chatterContainer}>\n              <ChatterPanel\n                projectUuid={projectUuid}\n                projectName={projectData?.details?.installer_project_id || projectData?.uuid?.slice(0, 8) || 'Project'}\n                isDrawer={false}\n                maxHeight=\"calc(100vh - 450px)\"\n              />\n            </div>\n          )}\n          {selectedOverviewTab !== 'overview' && (\n            <div className={portalStyles.comingSoonContainer}>\n              <div className={portalStyles.comingSoonIcon}>ðŸš§</div>\n              <h3 className={portalStyles.comingSoonHeading}>Coming Soon</h3>\n              <p>This feature is under development</p>\n            </div>\n          )}\n        </ProjectOverviewTabs>\n      </div>\n    </motion.div>\n  );\n};\n\nexport default PermittingPortal;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\PhotoGallery.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\PreferredEquipment.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\Project.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'projectStyles' is defined but never used.","line":11,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Link, useNavigate, useParams } from 'react-router-dom';\r\nimport { motion } from 'framer-motion';\r\nimport axios from '../config/axios';\r\nimport TabbedPanel from '../components/common/TabbedPanel';\r\nimport Account from './Account';\r\nimport Inventory from './Inventory';\r\nimport SupportPanel from '../components/support/SupportPanel';\r\nimport { Button } from '../components/ui';\r\nimport styles from '../styles/Dashboard.module.css';\r\nimport projectStyles from '../styles/ProjectAdd.module.css';\r\nimport pageStyles from './Project.module.css';\r\nimport logger from '../services/devLogger';\r\n\r\nconst TABS = [\r\n  { key: 'site', label: 'Site' },\r\n  { key: 'equipment', label: 'Equipment' },\r\n  { key: 'electrical', label: 'Electrical' },\r\n  { key: 'structural', label: 'Structural' },\r\n];\r\n\r\n/**\r\n * Project Details Page\r\n * Uses same layout as Dashboard with tabs for different project sections\r\n */\r\nconst Project = () => {\r\n  const { projectUuid } = useParams();\r\n  const [selectedTab, setSelectedTab] = useState('site');\r\n  const [projectData, setProjectData] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const fetchProjectData = async () => {\r\n      try {\r\n        const companyData = JSON.parse(sessionStorage.getItem('companyData') || '{}');\r\n        const companyId = companyData.uuid;\r\n\r\n        if (!projectUuid || !companyId) {\r\n          logger.error('Project', 'Missing projectUuid or companyId');\r\n          return;\r\n        }\r\n\r\n        // Fetch project data\r\n        const response = await axios.get(`/project/${projectUuid}?companyId=${companyId}`);\r\n        if (response.data.status === 'SUCCESS' && response.data.project) {\r\n          const project = response.data.project;\r\n          setProjectData(project);\r\n        }\r\n      } catch (error) {\r\n        logger.error('Project', 'Error fetching project data:', error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchProjectData();\r\n  }, [projectUuid]);\r\n\r\n  const handleLogout = () => {\r\n    sessionStorage.clear();\r\n    navigate('/login');\r\n  };\r\n\r\n  const pageVariants = {\r\n    hidden: { opacity: 0 },\r\n    visible: {\r\n      opacity: 1,\r\n      transition: {\r\n        duration: 0.5,\r\n        when: \"beforeChildren\"\r\n      }\r\n    }\r\n  };\r\n\r\n  const renderTabContent = () => {\r\n    switch (selectedTab) {\r\n      case 'site':\r\n        return (\r\n          <div className={pageStyles.tabContent}>\r\n            <h3 className={pageStyles.tabContentTitle}>Site Information</h3>\r\n            <p className={pageStyles.tabContentPlaceholder}>Site details form coming soon...</p>\r\n          </div>\r\n        );\r\n      case 'equipment':\r\n        return (\r\n          <div className={pageStyles.tabContent}>\r\n            <h3 className={pageStyles.tabContentTitle}>Equipment</h3>\r\n            <p className={pageStyles.tabContentPlaceholder}>Equipment details form coming soon...</p>\r\n          </div>\r\n        );\r\n      case 'electrical':\r\n        return (\r\n          <div className={pageStyles.tabContent}>\r\n            <h3 className={pageStyles.tabContentTitle}>Electrical Information</h3>\r\n            <p className={pageStyles.tabContentPlaceholder}>Electrical details form coming soon...</p>\r\n          </div>\r\n        );\r\n      case 'structural':\r\n        return (\r\n          <div className={pageStyles.tabContent}>\r\n            <h3 className={pageStyles.tabContentTitle}>Structural Information</h3>\r\n            <p className={pageStyles.tabContentPlaceholder}>Structural details form coming soon...</p>\r\n          </div>\r\n        );\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  const containerVariants = {\r\n    initial: { opacity: 0 },\r\n    animate: {\r\n      opacity: 1,\r\n      transition: {\r\n        staggerChildren: 0.05,\r\n        delayChildren: 0.1,\r\n      },\r\n    },\r\n  };\r\n\r\n  return (\r\n    <motion.div\r\n      className={styles.dashboardContainer}\r\n      variants={pageVariants}\r\n      initial=\"hidden\"\r\n      animate=\"visible\"\r\n    >\r\n      {/* Header */}\r\n      <div className={styles.dashboardHeader}>\r\n        <div>\r\n          <h1 className={styles.dashboardTitle}>\r\n            <img src={require('../assets/images/appIcon.png')} alt=\"Skyfire\" className={styles.flameIcon} />\r\n            {loading ? 'Loading...' : projectData ? `${projectData.customer_first_name} ${projectData.customer_last_name}` : 'Project'}\r\n          </h1>\r\n        </div>\r\n\r\n        <nav className={styles.topNav}>\r\n          <Link to=\"/dashboard\" className={styles.navLink}>Dashboard</Link>\r\n        </nav>\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <div className={styles.dashboardContent}>\r\n        {/* Admin Tabs Panel (Account, Support, Inventory, Logout) */}\r\n        <div className={pageStyles.menuPanel}>\r\n          <TabbedPanel\r\n            tabs={[\r\n              { id: 'account', label: 'Account' },\r\n              { id: 'support', label: 'Support' },\r\n              { id: 'inventory', label: 'Inventory' },\r\n              { id: 'logout', label: 'Logout' }\r\n            ]}\r\n            panels={{\r\n              account: (\r\n                <div className={pageStyles.panelNoPadding}>\r\n                  <Account />\r\n                </div>\r\n              ),\r\n              support: (\r\n                <div className={pageStyles.panelNoPadding}>\r\n                  <SupportPanel />\r\n                </div>\r\n              ),\r\n              inventory: <Inventory />,\r\n              logout: (\r\n                <div className={pageStyles.logoutPanel}>\r\n                  <h3 className={pageStyles.tabContentTitle}>Logout</h3>\r\n                  <p className={pageStyles.logoutMessage}>Are you sure you want to logout?</p>\r\n                  <Button variant=\"primary\" onClick={handleLogout}>\r\n                    Confirm Logout\r\n                  </Button>\r\n                </div>\r\n              ),\r\n            }}\r\n          />\r\n        </div>\r\n\r\n        {/* Project Tabs with Content Panel */}\r\n        <div className={styles.statusTabsWrapper}>\r\n          {/* Tabs Row */}\r\n          <motion.div\r\n            className={styles.statusTabsContainer}\r\n            variants={containerVariants}\r\n            initial=\"initial\"\r\n            animate=\"animate\"\r\n          >\r\n            {TABS.map((tab) => {\r\n              const isSelected = selectedTab === tab.key;\r\n\r\n              return (\r\n                <button\r\n                  key={tab.key}\r\n                  onClick={() => setSelectedTab(tab.key)}\r\n                  className={`${styles.statusTab} ${isSelected ? styles.statusTabSelected : ''} ${isSelected ? pageStyles.tabSelected : ''}`}\r\n                >\r\n                  <div className={`${styles.statusTabLabel} ${isSelected ? pageStyles.tabLabelSelected : pageStyles.tabLabelUnselected}`}>\r\n                    {tab.label}\r\n                  </div>\r\n                </button>\r\n              );\r\n            })}\r\n          </motion.div>\r\n\r\n          {/* Content Panel - connects to selected tab */}\r\n          <div\r\n            className={`${styles.statusContentPanel} ${\r\n              selectedTab === 'site' && selectedTab === 'structural'\r\n                ? pageStyles.contentPanelBothSquare\r\n                : selectedTab === 'site'\r\n                ? pageStyles.contentPanelLeftSquare\r\n                : selectedTab === 'structural'\r\n                ? pageStyles.contentPanelRightSquare\r\n                : pageStyles.contentPanelBothRounded\r\n            }`}\r\n          >\r\n            {renderTabContent()}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n};\r\n\r\nexport default Project;\r\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\ProjectAdd.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\SalesPortal.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'handleLogout' is assigned a value but never used.","line":56,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":56,"endColumn":21},{"ruleId":"jsx-a11y/anchor-is-valid","severity":1,"message":"The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/anchor-is-valid.md","line":127,"column":13,"nodeType":"JSXOpeningElement","endLine":134,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Link, useNavigate, useParams } from 'react-router-dom';\r\nimport { motion } from 'framer-motion';\r\nimport axios from '../config/axios';\r\nimport logger from '../services/devLogger';\r\nimport { PortalNavigationPill } from '../components/ui';\r\nimport styles from '../styles/Dashboard.module.css';\r\nimport portalStyles from '../styles/Portal.module.css';\r\nimport pageStyles from '../pages/SalesPortal.module.css';\r\n\r\n/**\r\n * Sales Portal Page\r\n * Under construction placeholder\r\n */\r\nconst SalesPortal = () => {\r\n  const { projectUuid } = useParams();\r\n  const [projectData, setProjectData] = useState(null);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const fetchProjectData = async () => {\r\n      try {\r\n        const userData = JSON.parse(\r\n          sessionStorage.getItem(\"userData\") || \"{}\"\r\n        );\r\n        const companyId = userData?.company?.uuid;\r\n\r\n        if (!projectUuid) {\r\n          logger.error(\"Portal\", \"Missing projectUuid\");\r\n          return;\r\n        }\r\n\r\n        const endpoint = companyId\r\n          ? `/project/${projectUuid}?companyId=${companyId}`\r\n          : `/project/${projectUuid}`;\r\n\r\n        const response = await axios.get(endpoint);\r\n        const projectData = response.data.data || response.data;\r\n\r\n        if (projectData) {\r\n          setProjectData(projectData);\r\n        } else {\r\n          logger.warn(\"Portal\", \"No project data found in response\");\r\n        }\r\n      } catch (error) {\r\n        logger.error(\"Portal\", \"Error fetching project data:\", error);\r\n        if (error.response?.data) {\r\n          logger.error(\"Portal\", \"Error details:\", error.response.data);\r\n        }\r\n      }\r\n    };\r\n\r\n    fetchProjectData();\r\n  }, [projectUuid]);\r\n\r\n  const handleLogout = () => {\r\n    sessionStorage.clear();\r\n    navigate(\"/login\");\r\n  };\r\n\r\n  const pageVariants = {\r\n    hidden: { opacity: 0 },\r\n    visible: {\r\n      opacity: 1,\r\n      transition: {\r\n        duration: 0.5,\r\n      },\r\n    },\r\n  };\r\n\r\n  const customerName = projectData?.details\r\n    ? `${projectData.details.customer_last_name || \"\"}, ${\r\n        projectData.details.customer_first_name || \"\"\r\n      }`\r\n    : \"Loading...\";\r\n\r\n  const address = projectData?.site\r\n    ? `${projectData.site.address || \"\"}${\r\n        projectData.site.city ? `, ${projectData.site.city}` : \"\"\r\n      }${projectData.site.state ? `, ${projectData.site.state}` : \"\"}${\r\n        projectData.site.zip ? ` ${projectData.site.zip}` : \"\"\r\n      }`\r\n    : \"Loading...\";\r\n\r\n  const projectId =\r\n    projectData?.details?.installer_project_id ||\r\n    projectData?.uuid?.slice(0, 8) ||\r\n    \"Loading...\";\r\n\r\n  return (\r\n    <motion.div\r\n      className={styles.dashboardContainer}\r\n      variants={pageVariants}\r\n      initial=\"hidden\"\r\n      animate=\"visible\"\r\n    >\r\n      <div className={styles.dashboardHeader}>\r\n        <div className={portalStyles.headerInfoContainer}>\r\n          <span className={portalStyles.customerName}>\r\n            {customerName}\r\n          </span>\r\n          <span className={portalStyles.divider}>|</span>\r\n          <span className={portalStyles.address}>\r\n            {address}\r\n          </span>\r\n          <span className={portalStyles.divider}>|</span>\r\n          <span className={portalStyles.projectId}>\r\n            {projectId}\r\n          </span>\r\n        </div>\r\n\r\n        <div className={portalStyles.headerActions}>\r\n          <nav className={styles.topNav}>\r\n            <PortalNavigationPill to={`/project/${projectUuid}/sales`} isActive>\r\n              Sales\r\n            </PortalNavigationPill>\r\n            <PortalNavigationPill to={`/project/${projectUuid}/design`}>\r\n              Design\r\n            </PortalNavigationPill>\r\n            <PortalNavigationPill to={`/project/${projectUuid}/permitting`}>\r\n              Permitting\r\n            </PortalNavigationPill>\r\n            <PortalNavigationPill to={`/project/${projectUuid}/install`}>\r\n              Install\r\n            </PortalNavigationPill>\r\n            <span className={portalStyles.divider}>|</span>\r\n            <a\r\n              href=\"#\"\r\n              onClick={(e) => {\r\n                e.preventDefault();\r\n                // Scheduling functionality coming soon\r\n              }}\r\n              className={styles.navLink}\r\n            >\r\n              Scheduling\r\n            </a>\r\n            <Link\r\n              to=\"/dashboard\"\r\n              className={styles.navLink}\r\n            >\r\n              Projects\r\n            </Link>\r\n          </nav>\r\n        </div>\r\n      </div>\r\n\r\n      <div className={pageStyles.constructionContainer}>\r\n        <div className={pageStyles.constructionIcon}>ðŸš§</div>\r\n        <h1 className={pageStyles.constructionTitle}>Under Construction</h1>\r\n        <p className={pageStyles.constructionText}>\r\n          The Sales Portal is currently being built.\r\n        </p>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n};\r\n\r\nexport default SalesPortal;\r\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\SchedulingPortal.js","messages":[{"ruleId":"jsx-a11y/anchor-is-valid","severity":1,"message":"The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/anchor-is-valid.md","line":151,"column":11,"nodeType":"JSXOpeningElement","endLine":158,"endColumn":12},{"ruleId":"jsx-a11y/anchor-is-valid","severity":1,"message":"The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/anchor-is-valid.md","line":161,"column":11,"nodeType":"JSXOpeningElement","endLine":168,"endColumn":12},{"ruleId":"jsx-a11y/anchor-is-valid","severity":1,"message":"The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/jsx-eslint/eslint-plugin-jsx-a11y/blob/HEAD/docs/rules/anchor-is-valid.md","line":171,"column":11,"nodeType":"JSXOpeningElement","endLine":178,"endColumn":12}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport styles from '../styles/Scheduling.module.css';\nimport dashboardStyles from '../styles/Dashboard.module.css';\nimport { VIEW_TYPES } from '../constants/scheduleConstants';\nimport MiniCalendar from '../components/scheduling/MiniCalendar';\nimport UpcomingEvents from '../components/scheduling/UpcomingEvents';\nimport ScheduleCalendar from '../components/scheduling/ScheduleCalendar';\nimport EventModal from '../components/scheduling/EventModal';\nimport { getEvents, createEvent, updateEvent, deleteEvent } from '../services/scheduleService';\n\n/**\n * SchedulingPortal - Main scheduling page\n *\n * Layout:\n * - Header with title and \"New Event\" button\n * - View tabs (Day, Week, Month, List)\n * - Split layout: Sidebar (30%) | Calendar (70%)\n * - Sidebar contains: Mini calendar, Filters, Upcoming events\n * - Main content shows the selected calendar view\n */\nconst SchedulingPortal = () => {\n  const navigate = useNavigate();\n  const [currentView, setCurrentView] = useState(VIEW_TYPES.WEEK);\n  const [selectedDate, setSelectedDate] = useState(new Date());\n  const [showEventModal, setShowEventModal] = useState(false);\n  const [selectedEvent, setSelectedEvent] = useState(null);\n  const [events, setEvents] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [initialEventDate, setInitialEventDate] = useState(null);\n\n  // View tabs configuration\n  const viewTabs = [\n    { id: VIEW_TYPES.DAY, label: 'Day' },\n    { id: VIEW_TYPES.WEEK, label: 'Week' },\n    { id: VIEW_TYPES.MONTH, label: 'Month' },\n    { id: VIEW_TYPES.LIST, label: 'List' },\n  ];\n\n  const handleNewEvent = () => {\n    setSelectedEvent(null);\n    setShowEventModal(true);\n  };\n\n  const handleEventClick = (event) => {\n    setSelectedEvent(event);\n    setShowEventModal(true);\n  };\n\n  const handleCloseModal = () => {\n    setShowEventModal(false);\n    setSelectedEvent(null);\n  };\n\n  const handleSaveEvent = async (eventData, eventId = null) => {\n    try {\n      if (eventId) {\n        // Update existing event\n        await updateEvent(eventId, eventData);\n      } else {\n        // Create new event\n        await createEvent(eventData);\n      }\n\n      // Reload events\n      const start = new Date(selectedDate);\n      start.setDate(start.getDate() - 14);\n      const end = new Date(selectedDate);\n      end.setDate(end.getDate() + 14);\n      const fetchedEvents = await getEvents(start, end);\n      setEvents(fetchedEvents);\n\n      handleCloseModal();\n    } catch (error) {\n      console.error('Error saving event:', error);\n      alert('Failed to save event. Please try again.');\n    }\n  };\n\n  const handleDeleteEvent = async (eventId) => {\n    try {\n      await deleteEvent(eventId);\n\n      // Reload events\n      const start = new Date(selectedDate);\n      start.setDate(start.getDate() - 14);\n      const end = new Date(selectedDate);\n      end.setDate(end.getDate() + 14);\n      const fetchedEvents = await getEvents(start, end);\n      setEvents(fetchedEvents);\n\n      handleCloseModal();\n    } catch (error) {\n      console.error('Error deleting event:', error);\n      alert('Failed to delete event. Please try again.');\n    }\n  };\n\n  const handleDateSelect = (date) => {\n    setSelectedDate(date);\n  };\n\n  const handleTimeSlotClick = (dateTime) => {\n    setInitialEventDate(dateTime);\n    setSelectedEvent(null);\n    setShowEventModal(true);\n  };\n\n  // Load events when date range changes\n  useEffect(() => {\n    const loadEvents = async () => {\n      setLoading(true);\n      try {\n        // Get start and end of current week/month based on view\n        const start = new Date(selectedDate);\n        start.setDate(start.getDate() - 14); // 2 weeks before\n        const end = new Date(selectedDate);\n        end.setDate(end.getDate() + 14); // 2 weeks after\n\n        const fetchedEvents = await getEvents(start, end);\n        setEvents(fetchedEvents);\n      } catch (error) {\n        console.error('Error loading events:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    loadEvents();\n  }, [selectedDate]);\n\n  // Get event dates for mini calendar dots\n  const eventDates = events.map(event => event.startTime);\n\n  return (\n    <div className={styles.schedulingContainer}>\n      {/* ===== HEADER ===== */}\n      <div className={dashboardStyles.dashboardHeader}>\n        <div>\n          <h1 className={dashboardStyles.dashboardTitle}>\n            Schedule\n          </h1>\n        </div>\n\n        <nav className={dashboardStyles.topNav}>\n          <button className={styles.newEventButton} onClick={handleNewEvent}>\n            <span className={styles.newEventButtonIcon}>+</span>\n            New Event\n          </button>\n          <a\n            href=\"#\"\n            onClick={(e) => {\n              e.preventDefault();\n              // Already on scheduling page\n            }}\n            className={`${dashboardStyles.navLink} ${dashboardStyles.navLinkActive}`}\n          >\n            Scheduling\n          </a>\n          <a\n            href=\"#\"\n            onClick={(e) => {\n              e.preventDefault();\n              navigate('/dashboard');\n            }}\n            className={dashboardStyles.navLink}\n          >\n            Projects\n          </a>\n          <a\n            href=\"#\"\n            onClick={(e) => {\n              e.preventDefault();\n              navigate('/dashboard');\n            }}\n            className={dashboardStyles.flameIconLink}\n          >\n            <img\n              src={require('../assets/images/appIcon.png')}\n              alt=\"Skyfire\"\n              className={dashboardStyles.flameIcon}\n            />\n          </a>\n        </nav>\n      </div>\n\n      {/* ===== VIEW TABS (File Folder Style) ===== */}\n      <div className={styles.viewTabsWrapper}>\n        {/* Tabs Navigation */}\n        <div className={styles.viewTabsContainer}>\n          {viewTabs.map((tab) => (\n            <button\n              key={tab.id}\n              className={`${styles.viewTab} ${\n                currentView === tab.id ? styles.viewTabSelected : ''\n              }`}\n              onClick={() => setCurrentView(tab.id)}\n            >\n              {tab.label}\n            </button>\n          ))}\n        </div>\n\n        {/* Content Panel */}\n        <div\n          className={`${styles.scheduleContentPanel} ${\n            currentView === viewTabs[0].id\n              ? styles.scheduleContentPanelFirstTab\n              : currentView === viewTabs[viewTabs.length - 1].id\n              ? styles.scheduleContentPanelLastTab\n              : styles.scheduleContentPanelMiddleTab\n          }`}\n        >\n          {/* ===== SPLIT LAYOUT ===== */}\n          <div className={styles.schedulingSplitLayout}>\n            {/* LEFT SIDEBAR (30%) */}\n            <aside className={styles.schedulingSidebar}>\n              {/* Mini Calendar */}\n              <div>\n                <MiniCalendar\n                  selectedDate={selectedDate}\n                  onDateSelect={handleDateSelect}\n                  eventsData={eventDates}\n                />\n              </div>\n\n              {/* Filters Section */}\n              <div>\n                <h3 className={styles.filtersHeader}>\n                  Filters\n                </h3>\n                <div className={styles.filtersContainer}>\n                  <button className={`${styles.filterChip} ${styles.filterChipActive}`}>\n                    All Events\n                  </button>\n                  <button className={styles.filterChip}>\n                    Installations\n                  </button>\n                  <button className={styles.filterChip}>\n                    Inspections\n                  </button>\n                  <button className={styles.filterChip}>\n                    Sales\n                  </button>\n                </div>\n              </div>\n\n              {/* Upcoming Events */}\n              <div className={styles.upcomingEventsWrapper}>\n                <UpcomingEvents\n                  onEventClick={handleEventClick}\n                  onDateSelect={handleDateSelect}\n                />\n              </div>\n            </aside>\n\n            {/* MAIN CONTENT (70%) - Calendar */}\n            <main className={styles.scheduleMainContent}>\n              <div className={styles.calendarContainer}>\n                {/* Calendar Header */}\n                <div className={styles.calendarHeader}>\n                  <div className={styles.calendarHeaderTitle}>\n                    {selectedDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}\n                  </div>\n                  <div className={styles.calendarNavigation}>\n                    <button\n                      className={styles.calendarNavButton}\n                      onClick={() => {\n                        const newDate = new Date(selectedDate);\n                        newDate.setDate(newDate.getDate() - 7);\n                        setSelectedDate(newDate);\n                      }}\n                    >\n                      â† Prev\n                    </button>\n                    <button\n                      className={styles.todayButton}\n                      onClick={() => setSelectedDate(new Date())}\n                    >\n                      Today\n                    </button>\n                    <button\n                      className={styles.calendarNavButton}\n                      onClick={() => {\n                        const newDate = new Date(selectedDate);\n                        newDate.setDate(newDate.getDate() + 7);\n                        setSelectedDate(newDate);\n                      }}\n                    >\n                      Next â†’\n                    </button>\n                  </div>\n                </div>\n\n                {/* Calendar View Content */}\n                <ScheduleCalendar\n                  currentView={currentView}\n                  selectedDate={selectedDate}\n                  events={events}\n                  onEventClick={handleEventClick}\n                  onTimeSlotClick={handleTimeSlotClick}\n                  loading={loading}\n                />\n              </div>\n            </main>\n          </div>\n        </div>\n      </div>\n\n      {/* ===== EVENT MODAL ===== */}\n      <AnimatePresence>\n        {showEventModal && (\n          <motion.div\n            className={styles.eventModalOverlay}\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            onClick={handleCloseModal}\n          >\n            <motion.div\n              className={styles.eventModal}\n              initial={{ opacity: 0, scale: 0.95 }}\n              animate={{ opacity: 1, scale: 1 }}\n              exit={{ opacity: 0, scale: 0.95 }}\n              onClick={(e) => e.stopPropagation()}\n            >\n              <EventModal\n                event={selectedEvent}\n                onSave={handleSaveEvent}\n                onDelete={handleDeleteEvent}\n                onClose={handleCloseModal}\n                initialDate={initialEventDate}\n              />\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n};\n\nexport default SchedulingPortal;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\ServiceTerritory.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\Support.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\SupportTickets.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'DEFAULT_OPTIONS' is defined but never used.","line":25,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":18},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadTickets'. Either include it or remove the dependency array.","line":107,"column":6,"nodeType":"ArrayExpression","endLine":107,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [loadTickets]","fix":{"range":[3098,3100],"text":"[loadTickets]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'loadTickets' and 'searchDebounce'. Either include them or remove the dependency array.","line":128,"column":6,"nodeType":"ArrayExpression","endLine":128,"endColumn":19,"suggestions":[{"desc":"Update the dependencies array to be: [loadTickets, searchDebounce, searchQuery]","fix":{"range":[3446,3459],"text":"[loadTickets, searchDebounce, searchQuery]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\nimport { useSelector } from 'react-redux';\nimport { motion } from 'framer-motion';\nimport { toast } from 'react-toastify';\nimport FormInput from '../components/ui/FormInput';\nimport FormSelect from '../components/ui/FormSelect';\nimport Textarea from '../components/ui/Textarea';\nimport Button from '../components/ui/Button';\nimport styles from '../styles/SupportTickets.module.css';\nimport {\n  getUserTickets,\n  searchTickets,\n  getTicketDetails,\n  createTicket,\n  canCreateTicket,\n  updateLastTicketTime,\n  getRemainingCooldown,\n  getDeviceInfo,\n  getPriorityColor,\n  getStatusColor,\n  getStatusLabel,\n  getCategoryLabel,\n  formatDate,\n  formatDateTime,\n  DEFAULT_OPTIONS,\n} from '../services/supportTicketService';\n\n/**\n * Support Tickets Page\n * Manages support ticket creation, viewing, and keyboard shortcuts\n */\nconst SupportTickets = () => {\n  // Redux\n  const user = useSelector((state) => state.auth?.user);\n  const company = useSelector((state) => state.auth?.company);\n\n  // Tab state\n  const [activeTab, setActiveTab] = useState('support'); // 'support' | 'shortcuts'\n\n  // Tickets list state\n  const [tickets, setTickets] = useState([]);\n  const [ticketsLoading, setTicketsLoading] = useState(true);\n  const [pagination, setPagination] = useState({\n    page: 1,\n    limit: 10,\n    total: 0,\n    totalPages: 1\n  });\n  const [searchQuery, setSearchQuery] = useState('');\n  const [searchDebounce, setSearchDebounce] = useState(null);\n\n  // Ticket details modal\n  const [selectedTicket, setSelectedTicket] = useState(null);\n  const [ticketDetailsLoading, setTicketDetailsLoading] = useState(false);\n\n  // Create form state\n  const [formData, setFormData] = useState({\n    subject: '',\n    description: '',\n    category: '',\n    priority: 'medium'\n  });\n  const [formErrors, setFormErrors] = useState({});\n  const [formSubmitting, setFormSubmitting] = useState(false);\n  const [rateLimitInfo, setRateLimitInfo] = useState({ canCreate: true, remainingMs: 0 });\n\n  // Tabs configuration\n  const tabs = [\n    { id: 'support', label: 'Support Tickets' },\n    { id: 'shortcuts', label: 'Keyboard Shortcuts' }\n  ];\n\n  /**\n   * Load tickets with pagination\n   */\n  const loadTickets = useCallback(async (page = 1) => {\n    setTicketsLoading(true);\n    try {\n      let response;\n      if (searchQuery.trim()) {\n        response = await searchTickets(searchQuery, page, pagination.limit);\n      } else {\n        response = await getUserTickets(page, pagination.limit);\n      }\n\n      setTickets(response.tickets || []);\n      setPagination({\n        page: response.page || 1,\n        limit: response.limit || 10,\n        total: response.total || 0,\n        totalPages: response.totalPages || 1\n      });\n    } catch (error) {\n      console.error('Error loading tickets:', error);\n      toast.error('Failed to load tickets. Please try again.');\n      setTickets([]);\n    } finally {\n      setTicketsLoading(false);\n    }\n  }, [searchQuery, pagination.limit]);\n\n  /**\n   * Initial load\n   */\n  useEffect(() => {\n    loadTickets();\n  }, []);\n\n  /**\n   * Search debounce effect\n   */\n  useEffect(() => {\n    if (searchDebounce) {\n      clearTimeout(searchDebounce);\n    }\n\n    const timeout = setTimeout(() => {\n      loadTickets(1);\n    }, 300);\n\n    setSearchDebounce(timeout);\n\n    return () => {\n      if (searchDebounce) {\n        clearTimeout(searchDebounce);\n      }\n    };\n  }, [searchQuery]);\n\n  /**\n   * Handle ticket click - load full details\n   */\n  const handleTicketClick = async (ticket) => {\n    setSelectedTicket(ticket);\n    setTicketDetailsLoading(true);\n\n    try {\n      const fullDetails = await getTicketDetails(ticket.ticketNumber);\n      setSelectedTicket(fullDetails);\n    } catch (error) {\n      console.error('Error loading ticket details:', error);\n      toast.error('Failed to load ticket details');\n      // Keep basic info visible\n    } finally {\n      setTicketDetailsLoading(false);\n    }\n  };\n\n  /**\n   * Close modal\n   */\n  const closeModal = () => {\n    setSelectedTicket(null);\n  };\n\n  /**\n   * Render priority badge\n   */\n  const renderPriorityBadge = (priority) => {\n    const colors = getPriorityColor(priority);\n    return (\n      <span\n        className={styles.priorityBadge}\n        style={{\n          backgroundColor: colors.bg,\n          color: colors.text\n        }}\n      >\n        {priority}\n      </span>\n    );\n  };\n\n  /**\n   * Render status badge\n   */\n  const renderStatusBadge = (status) => {\n    const colors = getStatusColor(status);\n    return (\n      <span\n        className={styles.statusBadge}\n        style={{\n          backgroundColor: colors.bg,\n          color: colors.text\n        }}\n      >\n        {getStatusLabel(status)}\n      </span>\n    );\n  };\n\n  /**\n   * Handle refresh button\n   */\n  const handleRefresh = () => {\n    loadTickets(pagination.page);\n  };\n\n  /**\n   * Handle pagination\n   */\n  const handlePrevPage = () => {\n    if (pagination.page > 1) {\n      loadTickets(pagination.page - 1);\n    }\n  };\n\n  const handleNextPage = () => {\n    if (pagination.page < pagination.totalPages) {\n      loadTickets(pagination.page + 1);\n    }\n  };\n\n  /**\n   * Handle email about ticket\n   */\n  const handleEmailAboutTicket = () => {\n    const email = 'support@skyfireapp.io';\n    const subject = `Re: Ticket ${selectedTicket?.ticketNumber}`;\n    const body = `Hello Skyfire Support,\\n\\nI am following up on ticket ${selectedTicket?.ticketNumber}.\\n\\n`;\n    window.location.href = `mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;\n  };\n\n  /**\n   * Check rate limit and set up interval if needed\n   */\n  const checkRateLimit = useCallback(() => {\n    const rateLimitCheck = canCreateTicket();\n    setRateLimitInfo(rateLimitCheck);\n\n    if (!rateLimitCheck.canCreate) {\n      const interval = setInterval(() => {\n        const check = canCreateTicket();\n        setRateLimitInfo(check);\n\n        if (check.canCreate) {\n          clearInterval(interval);\n        }\n      }, 1000);\n\n      return () => clearInterval(interval);\n    }\n  }, []);\n\n  /**\n   * Rate limit check on mount\n   */\n  useEffect(() => {\n    const cleanup = checkRateLimit();\n    return cleanup;\n  }, [checkRateLimit]);\n\n  /**\n   * Handle form input change\n   */\n  const handleInputChange = (field, value) => {\n    setFormData(prev => ({\n      ...prev,\n      [field]: value\n    }));\n\n    // Clear field error when user starts typing\n    if (formErrors[field]) {\n      setFormErrors(prev => ({\n        ...prev,\n        [field]: ''\n      }));\n    }\n  };\n\n  /**\n   * Validate form\n   */\n  const validateForm = () => {\n    const errors = {};\n\n    // Subject validation\n    if (!formData.subject.trim()) {\n      errors.subject = 'Subject is required';\n    } else if (formData.subject.length < 5) {\n      errors.subject = 'Subject must be at least 5 characters';\n    } else if (formData.subject.length > 255) {\n      errors.subject = 'Subject cannot exceed 255 characters';\n    }\n\n    // Description validation\n    if (!formData.description.trim()) {\n      errors.description = 'Description is required';\n    } else if (formData.description.length < 10) {\n      errors.description = 'Description must be at least 10 characters';\n    } else if (formData.description.length > 2000) {\n      errors.description = 'Description cannot exceed 2000 characters';\n    }\n\n    // Category validation\n    if (!formData.category) {\n      errors.category = 'Please select a category';\n    }\n\n    setFormErrors(errors);\n    return Object.keys(errors).length === 0;\n  };\n\n  /**\n   * Handle form submission\n   */\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    // Check rate limit first\n    const rateLimitCheck = canCreateTicket();\n    if (!rateLimitCheck.canCreate) {\n      toast.error(`Please wait ${getRemainingCooldown(rateLimitCheck.remainingMs)} before creating another ticket`);\n      return;\n    }\n\n    // Validate form\n    if (!validateForm()) {\n      toast.error('Please fix the errors in the form');\n      return;\n    }\n\n    setFormSubmitting(true);\n\n    try {\n      const ticketData = {\n        subject: formData.subject,\n        description: formData.description,\n        category: formData.category,\n        priority: formData.priority || 'medium',\n        current_screen: window.location.pathname,\n        app_version: '1.0.0-web',\n        user_id: user?.id,\n        company_id: company?.id || user?.company_id,\n        user_info: {\n          firstName: user?.first_name || user?.firstName || '',\n          lastName: user?.last_name || user?.lastName || '',\n          email: user?.email || '',\n          companyName: company?.name || ''\n        },\n        screenshots: [],\n        logs: null,\n        deviceInfo: getDeviceInfo(),\n        additionalData: {\n          timestamp: new Date().toISOString(),\n          platform: 'web'\n        }\n      };\n\n      const response = await createTicket(ticketData);\n\n      // Update rate limit\n      updateLastTicketTime();\n      checkRateLimit();\n\n      // Show success message\n      toast.success(`Ticket ${response.ticketNumber || 'created'} submitted successfully!`);\n\n      // Reset form\n      setFormData({\n        subject: '',\n        description: '',\n        category: '',\n        priority: 'medium'\n      });\n      setFormErrors({});\n\n      // Refresh ticket list\n      loadTickets(1);\n    } catch (error) {\n      console.error('Error creating ticket:', error);\n      const errorMessage = error.response?.data?.message || 'Failed to create ticket. Please try again.';\n      toast.error(errorMessage);\n    } finally {\n      setFormSubmitting(false);\n    }\n  };\n\n  /**\n   * Get character count class\n   */\n  const getCharCountClass = (current, max, warningThreshold = 0.8) => {\n    if (current >= max) {\n      return styles.charCountError;\n    }\n    if (current >= max * warningThreshold) {\n      return styles.charCountWarning;\n    }\n    return '';\n  };\n\n  return (\n    <motion.div\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      exit={{ opacity: 0 }}\n      className={styles.container}\n    >\n      {/* Subtab Navigation */}\n      <div className={styles.subtabContainer}>\n        {tabs.map((tab, index) => (\n          <button\n            key={tab.id}\n            onClick={() => setActiveTab(tab.id)}\n            className={`${styles.subtabLink} ${styles.subtabButton} ${activeTab === tab.id ? styles.subtabLinkActive : ''}`}\n          >\n            {tab.label}\n            {activeTab === tab.id && (\n              <span className={styles.subtabIndicator} />\n            )}\n          </button>\n        ))}\n      </div>\n\n      <div className={styles.tabContent}>\n        {/* SUPPORT TICKETS TAB */}\n        {activeTab === 'support' && (\n          <div className={styles.supportGrid}>\n            {/* LEFT COLUMN - Ticket List */}\n            <div className={styles.leftColumn}>\n              <div className={styles.panelWrapper}>\n                {/* Panel Header */}\n                <div className={styles.panelHeader}>\n                  <h2 className={styles.panelTitle}>\n                    My Tickets {!ticketsLoading && `(${pagination.total})`}\n                  </h2>\n                  <Button\n                    variant=\"secondary\"\n                    size=\"sm\"\n                    onClick={handleRefresh}\n                    disabled={ticketsLoading}\n                  >\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" className={styles.iconWithMargin}>\n                      <path d=\"M21 2v6h-6M3 12a9 9 0 0 1 15-6.7L21 8M3 22v-6h6M21 12a9 9 0 0 1-15 6.7L3 16\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                    </svg>\n                    Refresh\n                  </Button>\n                </div>\n\n                {/* Search Container */}\n                <div className={styles.searchContainer}>\n                  <div className={styles.searchWrapper}>\n                    <svg className={styles.searchIcon} width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\n                      <circle cx=\"11\" cy=\"11\" r=\"8\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                      <path d=\"M21 21l-4.35-4.35\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                    </svg>\n                    <input\n                      type=\"text\"\n                      className={styles.searchInput}\n                      placeholder=\"Search tickets...\"\n                      value={searchQuery}\n                      onChange={(e) => setSearchQuery(e.target.value)}\n                    />\n                  </div>\n                </div>\n\n                {/* Panel Content */}\n                <div className={styles.panelContent}>\n                  {ticketsLoading ? (\n                    // Loading State\n                    <div className={styles.loadingState}>\n                      <div className={styles.loadingSpinner}></div>\n                    </div>\n                  ) : tickets.length === 0 ? (\n                    // Empty State\n                    <div className={styles.emptyState}>\n                      <div className={styles.emptyIcon}>ðŸŽ«</div>\n                      <h3 className={styles.emptyTitle}>\n                        {searchQuery ? 'No tickets found' : 'No support tickets yet'}\n                      </h3>\n                      <p className={styles.emptyText}>\n                        {searchQuery\n                          ? 'Try adjusting your search query'\n                          : 'Create your first support ticket to get started'}\n                      </p>\n                    </div>\n                  ) : (\n                    // Ticket List\n                    <div className={styles.ticketList}>\n                      {tickets.map((ticket) => (\n                        <div\n                          key={ticket.ticketNumber}\n                          className={`${styles.ticketItem} ${selectedTicket?.ticketNumber === ticket.ticketNumber ? styles.ticketItemActive : ''}`}\n                          onClick={() => handleTicketClick(ticket)}\n                        >\n                          <div className={styles.ticketItemHeader}>\n                            <span className={styles.ticketNumber}>\n                              {ticket.ticketNumber}\n                            </span>\n                            <span className={styles.ticketDate}>\n                              {formatDate(ticket.createdAt)}\n                            </span>\n                          </div>\n                          <div className={styles.ticketSubject}>\n                            {ticket.subject}\n                          </div>\n                          <div className={styles.ticketMeta}>\n                            {renderStatusBadge(ticket.status)}\n                            {renderPriorityBadge(ticket.priority)}\n                            <span className={styles.categoryBadge}>\n                              {getCategoryLabel(ticket.category)}\n                            </span>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  )}\n                </div>\n\n                {/* Pagination */}\n                {!ticketsLoading && pagination.totalPages > 1 && (\n                  <div className={styles.pagination}>\n                    <button\n                      className={styles.paginationButton}\n                      onClick={handlePrevPage}\n                      disabled={pagination.page === 1}\n                    >\n                      <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\n                        <path d=\"M15 18l-6-6 6-6\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                      </svg>\n                      Previous\n                    </button>\n                    <span className={styles.paginationInfo}>\n                      Page {pagination.page} of {pagination.totalPages}\n                    </span>\n                    <button\n                      className={styles.paginationButton}\n                      onClick={handleNextPage}\n                      disabled={pagination.page === pagination.totalPages}\n                    >\n                      Next\n                      <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\n                        <path d=\"M9 18l6-6-6-6\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                      </svg>\n                    </button>\n                  </div>\n                )}\n              </div>\n            </div>\n\n            {/* RIGHT COLUMN - Create Ticket Form */}\n            <div className={styles.rightColumn}>\n              <div className={styles.panelWrapper}>\n                <div className={styles.panelHeader}>\n                  <h2 className={styles.panelTitle}>Create New Ticket</h2>\n                </div>\n\n                <form onSubmit={handleSubmit} className={styles.panelContent}>\n                  <div className={styles.formContent}>\n                    {/* Rate Limit Warning */}\n                    {!rateLimitInfo.canCreate && (\n                      <div className={styles.rateLimitWarning}>\n                        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                          <circle cx=\"12\" cy=\"12\" r=\"10\"/>\n                          <polyline points=\"12 6 12 12 16 14\"/>\n                        </svg>\n                        Please wait {getRemainingCooldown(rateLimitInfo.remainingMs)} before creating another ticket\n                      </div>\n                    )}\n\n                    <div className={styles.formGrid}>\n                      {/* Subject Field */}\n                      <div>\n                        <FormInput\n                          label=\"Subject\"\n                          value={formData.subject}\n                          onChange={(e) => handleInputChange('subject', e.target.value)}\n                          placeholder=\"Brief summary of your issue\"\n                          error={formErrors.subject}\n                          required\n                          maxLength={255}\n                        />\n                        <div className={`${styles.charCount} ${getCharCountClass(formData.subject.length, 255)}`}>\n                          {formData.subject.length}/255\n                        </div>\n                      </div>\n\n                      {/* Category & Priority Row */}\n                      <div className={styles.formTwoColumn}>\n                        <FormSelect\n                          label=\"Category\"\n                          value={formData.category}\n                          onChange={(e) => handleInputChange('category', e.target.value)}\n                          options={[\n                            { value: 'bug', label: 'Bug Report' },\n                            { value: 'feature_request', label: 'Feature Request' },\n                            { value: 'general_support', label: 'General Support' },\n                            { value: 'account_issue', label: 'Account Issue' }\n                          ]}\n                          placeholder=\"Select category\"\n                          error={formErrors.category}\n                          required\n                        />\n                        <FormSelect\n                          label=\"Priority\"\n                          value={formData.priority}\n                          onChange={(e) => handleInputChange('priority', e.target.value)}\n                          options={[\n                            { value: 'low', label: 'Low' },\n                            { value: 'medium', label: 'Medium' },\n                            { value: 'high', label: 'High' },\n                            { value: 'urgent', label: 'Urgent' }\n                          ]}\n                          placeholder=\"Select priority\"\n                        />\n                      </div>\n\n                      {/* Description Field */}\n                      <div>\n                        <Textarea\n                          label=\"Description\"\n                          value={formData.description}\n                          onChange={(e) => handleInputChange('description', e.target.value)}\n                          placeholder=\"Please describe your issue in detail. Include steps to reproduce if reporting a bug.\"\n                          error={formErrors.description}\n                          required\n                          rows={6}\n                          maxLength={2000}\n                          showCount\n                        />\n                      </div>\n\n                      {/* Help Section */}\n                      <div className={styles.helpSection}>\n                        <h4 className={styles.helpTitle}>Tips for a great ticket</h4>\n                        <p className={styles.helpText}>\n                          â€¢ Be specific about what you were doing when the issue occurred<br/>\n                          â€¢ Include any error messages you saw<br/>\n                          â€¢ Describe what you expected to happen<br/>\n                          â€¢ For bugs, list the steps to reproduce the issue\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Form Footer */}\n                  <div className={styles.formFooter}>\n                    <div className={styles.supportContact}>\n                      <a href=\"mailto:logan@skyfiresd.com\" className={styles.contactLink}>\n                        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" className={styles.iconWithMargin}>\n                          <path d=\"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z\"/>\n                          <polyline points=\"22,6 12,13 2,6\"/>\n                        </svg>\n                        Email Support\n                      </a>\n                      <a href=\"tel:+14807593473\" className={styles.contactLink}>\n                        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" className={styles.iconWithMargin}>\n                          <path d=\"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z\"/>\n                        </svg>\n                        (480) 759-3473\n                      </a>\n                    </div>\n                    <Button\n                      type=\"submit\"\n                      onClick={handleSubmit}\n                      loading={formSubmitting}\n                      disabled={!rateLimitInfo.canCreate || formSubmitting}\n                    >\n                      Submit Ticket\n                    </Button>\n                  </div>\n                </form>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* KEYBOARD SHORTCUTS TAB */}\n        {activeTab === 'shortcuts' && (\n          <div className={`${styles.panelWrapper} ${styles.panelWrapperNarrow}`}>\n            <div className={styles.panelHeader}>\n              <h2 className={styles.panelTitle}>Keyboard Shortcuts</h2>\n            </div>\n            <div className={styles.panelContent}>\n              <div className={styles.keyboardShortcuts}>\n\n                {/* General Navigation */}\n                <div className={styles.shortcutSection}>\n                  <h3 className={styles.shortcutSectionTitle}>General Navigation</h3>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Go to Dashboard</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>G</span>\n                      <span className={styles.keyboardPlus}>+</span>\n                      <span className={styles.keyboardKey}>D</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Go to Projects</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>G</span>\n                      <span className={styles.keyboardPlus}>+</span>\n                      <span className={styles.keyboardKey}>P</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Global Search</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>âŒ˜</span>\n                      <span className={styles.keyboardPlus}>+</span>\n                      <span className={styles.keyboardKey}>K</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Toggle Sidebar</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>[</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Open Notifications</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>G</span>\n                      <span className={styles.keyboardPlus}>+</span>\n                      <span className={styles.keyboardKey}>N</span>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Project Actions */}\n                <div className={styles.shortcutSection}>\n                  <h3 className={styles.shortcutSectionTitle}>Project Actions</h3>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>New Project</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>N</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Save Changes</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>âŒ˜</span>\n                      <span className={styles.keyboardPlus}>+</span>\n                      <span className={styles.keyboardKey}>S</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Undo</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>âŒ˜</span>\n                      <span className={styles.keyboardPlus}>+</span>\n                      <span className={styles.keyboardKey}>Z</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Redo</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>âŒ˜</span>\n                      <span className={styles.keyboardPlus}>+</span>\n                      <span className={styles.keyboardKey}>â‡§</span>\n                      <span className={styles.keyboardPlus}>+</span>\n                      <span className={styles.keyboardKey}>Z</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Duplicate</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>âŒ˜</span>\n                      <span className={styles.keyboardPlus}>+</span>\n                      <span className={styles.keyboardKey}>D</span>\n                    </div>\n                  </div>\n                </div>\n\n                {/* PDF Viewer */}\n                <div className={styles.shortcutSection}>\n                  <h3 className={styles.shortcutSectionTitle}>PDF Viewer</h3>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Zoom In</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>+</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Zoom Out</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>-</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Reset Zoom / Fit to Width</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>0</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Next Page</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>â†’</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Previous Page</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>â†</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>First Page</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>Home</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Last Page</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>End</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Delete Selected Annotation</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>Delete</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Toggle Fullscreen</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>F</span>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Table / Grid Navigation */}\n                <div className={styles.shortcutSection}>\n                  <h3 className={styles.shortcutSectionTitle}>Tables & Grids</h3>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Select All</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>âŒ˜</span>\n                      <span className={styles.keyboardPlus}>+</span>\n                      <span className={styles.keyboardKey}>A</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Copy Selection</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>âŒ˜</span>\n                      <span className={styles.keyboardPlus}>+</span>\n                      <span className={styles.keyboardKey}>C</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Paste</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>âŒ˜</span>\n                      <span className={styles.keyboardPlus}>+</span>\n                      <span className={styles.keyboardKey}>V</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Navigate Cells</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>â†‘</span>\n                      <span className={styles.keyboardKey}>â†“</span>\n                      <span className={styles.keyboardKey}>â†</span>\n                      <span className={styles.keyboardKey}>â†’</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Edit Cell</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>Enter</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Cancel Edit</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>Esc</span>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Forms & Modals */}\n                <div className={styles.shortcutSection}>\n                  <h3 className={styles.shortcutSectionTitle}>Forms & Modals</h3>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Submit Form</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>âŒ˜</span>\n                      <span className={styles.keyboardPlus}>+</span>\n                      <span className={styles.keyboardKey}>Enter</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Close Modal / Cancel</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>Esc</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Next Field</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>Tab</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Previous Field</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>â‡§</span>\n                      <span className={styles.keyboardPlus}>+</span>\n                      <span className={styles.keyboardKey}>Tab</span>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Chatter */}\n                <div className={styles.shortcutSection}>\n                  <h3 className={styles.shortcutSectionTitle}>Chatter</h3>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Send Message</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>Enter</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>New Line in Message</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>â‡§</span>\n                      <span className={styles.keyboardPlus}>+</span>\n                      <span className={styles.keyboardKey}>Enter</span>\n                    </div>\n                  </div>\n\n                  <div className={styles.shortcutItem}>\n                    <span className={styles.shortcutLabel}>Mention User</span>\n                    <div className={styles.shortcutKeys}>\n                      <span className={styles.keyboardKey}>@</span>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Platform Note */}\n                <div className={`${styles.helpSection} ${styles.helpSectionTop}`}>\n                  <p className={`${styles.helpText} ${styles.helpTextSmall}`}>\n                    <strong>Note:</strong> On Windows, use <span className={`${styles.keyboardKey} ${styles.keyboardKeyInline}`}>Ctrl</span> instead of <span className={`${styles.keyboardKey} ${styles.keyboardKeyInline}`}>âŒ˜</span>\n                  </p>\n                </div>\n\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Ticket Details Modal */}\n      {selectedTicket && (\n        <div className={styles.modalOverlay} onClick={closeModal}>\n          <div className={styles.modalContent} onClick={(e) => e.stopPropagation()}>\n            {/* Modal Header */}\n            <div className={styles.modalHeader}>\n              <h2 className={styles.panelTitle}>\n                Ticket {selectedTicket.ticketNumber}\n              </h2>\n              <button\n                className={styles.modalClose}\n                onClick={closeModal}\n                aria-label=\"Close modal\"\n              >\n                <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\n                  <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                  <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                </svg>\n              </button>\n            </div>\n\n            {/* Modal Body */}\n            <div className={styles.modalBody}>\n              {ticketDetailsLoading ? (\n                <div className={styles.loadingState}>\n                  <div className={styles.loadingSpinner}></div>\n                </div>\n              ) : (\n                <>\n                  {/* Badges */}\n                  <div className={styles.detailSection}>\n                    <div className={styles.detailBadges}>\n                      {renderStatusBadge(selectedTicket.status)}\n                      {renderPriorityBadge(selectedTicket.priority)}\n                      <span className={styles.categoryBadge}>\n                        {getCategoryLabel(selectedTicket.category)}\n                      </span>\n                    </div>\n                  </div>\n\n                  {/* Subject */}\n                  <div className={styles.detailSection}>\n                    <div className={styles.detailLabel}>Subject</div>\n                    <div className={styles.detailValue}>{selectedTicket.subject}</div>\n                  </div>\n\n                  {/* Description */}\n                  <div className={styles.detailSection}>\n                    <div className={styles.detailLabel}>Description</div>\n                    <div className={`${styles.detailValue} ${styles.detailValuePreWrap}`}>\n                      {selectedTicket.description || 'No description provided'}\n                    </div>\n                  </div>\n\n                  {/* Created Date */}\n                  <div className={styles.detailSection}>\n                    <div className={styles.detailLabel}>Created</div>\n                    <div className={styles.detailValue}>\n                      {formatDateTime(selectedTicket.createdAt)}\n                    </div>\n                  </div>\n\n                  {/* Updated Date */}\n                  {selectedTicket.updatedAt && (\n                    <div className={styles.detailSection}>\n                      <div className={styles.detailLabel}>Last Updated</div>\n                      <div className={styles.detailValue}>\n                        {formatDateTime(selectedTicket.updatedAt)}\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Assigned To */}\n                  {selectedTicket.assignedTo && (\n                    <div className={styles.detailSection}>\n                      <div className={styles.detailLabel}>Assigned To</div>\n                      <div className={styles.detailValue}>\n                        {selectedTicket.assignedTo}\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Resolution Notes */}\n                  {selectedTicket.resolutionNotes && (\n                    <div className={styles.detailSection}>\n                      <div className={styles.detailLabel}>Resolution Notes</div>\n                      <div className={`${styles.detailValue} ${styles.detailValuePreWrap}`}>\n                        {selectedTicket.resolutionNotes}\n                      </div>\n                    </div>\n                  )}\n                </>\n              )}\n            </div>\n\n            {/* Modal Footer */}\n            <div className={styles.modalFooter}>\n              <Button\n                variant=\"secondary\"\n                onClick={handleEmailAboutTicket}\n              >\n                Email About Ticket\n              </Button>\n              <Button\n                variant=\"primary\"\n                onClick={closeModal}\n              >\n                Close\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n    </motion.div>\n  );\n};\n\nexport default SupportTickets;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\pages\\Team\\TeamManagement.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'setProjects' is assigned a value but never used.","line":43,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":43,"endColumn":31},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadMembers'. Either include it or remove the dependency array.","line":79,"column":6,"nodeType":"ArrayExpression","endLine":79,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [loadMembers, navigate]","fix":{"range":[3098,3108],"text":"[loadMembers, navigate]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Team Management Screen\n * Unified view of active members and pending invites\n * With inline role editing and real-time socket notifications\n */\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { toast } from 'react-toastify';\nimport {\n  getCompanyUsers,\n  deleteCompanyUser,\n  resendInviteCode,\n  updateUserRole,\n} from '../../services/teamService';\nimport useTeamSocket from '../../hooks/useTeamSocket';\nimport useTeamSuggestions from '../../hooks/useTeamSuggestions';\nimport Avatar from '../../components/ui/Avatar';\nimport Button from '../../components/ui/Button';\nimport StatusBadge from '../../components/ui/StatusBadge';\nimport Dropdown from '../../components/ui/Dropdown';\nimport Modal from '../../components/ui/Modal';\nimport EmptyState from '../../components/ui/EmptyState';\nimport LoadingSpinner from '../../components/ui/LoadingSpinner';\nimport AddUserModal from '../../components/Team/AddUserModal';\nimport TeamSuggestionCard from '../../components/Team/TeamSuggestionCard';\nimport styles from './TeamManagement.module.css';\n\n// Available roles - matches backend role table\nconst ROLES = [\n  { id: 1, name: 'Admin', icon: 'ri-shield-star-line' },\n  { id: 2, name: 'Designer', icon: 'ri-layout-line' },\n  { id: 3, name: 'Surveyor', icon: 'ri-map-pin-line' },\n  { id: 4, name: 'Drafter', icon: 'ri-draft-line' },\n  { id: 5, name: 'Installer', icon: 'ri-tools-line' },\n  { id: 6, name: 'Sales', icon: 'ri-money-dollar-circle-line' },\n  { id: 7, name: 'Viewer', icon: 'ri-eye-line' },\n];\n\nconst TeamManagement = () => {\n  const navigate = useNavigate();\n  const [members, setMembers] = useState([]);\n  const [projects, setProjects] = useState([]); // Optional: load from API for project-aware suggestions\n  const [loading, setLoading] = useState(true);\n  const [currentUserId, setCurrentUserId] = useState(null);\n  const [currentCompanyId, setCurrentCompanyId] = useState(null);\n  const [isCurrentUserAdmin, setIsCurrentUserAdmin] = useState(false);\n\n  // Modals\n  const [showAddModal, setShowAddModal] = useState(false);\n  const [preselectedRole, setPreselectedRole] = useState(null); // For suggestion clicks\n  const [showRemoveModal, setShowRemoveModal] = useState(false);\n  const [memberToRemove, setMemberToRemove] = useState(null);\n  const [removing, setRemoving] = useState(false);\n\n  // Get current user info on mount\n  useEffect(() => {\n    const userData = JSON.parse(sessionStorage.getItem('userData') || '{}');\n    setCurrentUserId(userData.uuid || userData.id);\n    setCurrentCompanyId(userData.companyId || userData.company_id);\n\n    // Check if current user is admin\n    const isAdmin =\n      userData.isSuperAdmin === true ||\n      userData.isSuperUser === true ||\n      userData.is_super_user === true ||\n      userData.is_company_admin === true ||\n      userData.isCompanyAdmin === true;\n\n    setIsCurrentUserAdmin(isAdmin);\n\n    if (!isAdmin) {\n      toast.error('You do not have permission to manage team members');\n      navigate('/dashboard');\n      return;\n    }\n\n    loadMembers();\n  }, [navigate]);\n\n  const loadMembers = useCallback(async () => {\n    setLoading(true);\n    try {\n      const result = await getCompanyUsers();\n      if (result.status === 'SUCCESS' && result.data) {\n        // Sort: current user first, then by name\n        const sorted = [...result.data].sort((a, b) => {\n          if (a.uuid === currentUserId) return -1;\n          if (b.uuid === currentUserId) return 1;\n          return `${a.first_name} ${a.last_name}`.localeCompare(`${b.first_name} ${b.last_name}`);\n        });\n        setMembers(sorted);\n      }\n    } catch (error) {\n      console.error('[TeamManagement] Error:', error);\n      toast.error('Failed to load team members');\n    } finally {\n      setLoading(false);\n    }\n  }, [currentUserId]);\n\n  useEffect(() => {\n    loadMembers();\n  }, [loadMembers]);\n\n  // Real-time socket events\n  const { isConnected } = useTeamSocket({\n    companyId: currentCompanyId,\n    currentUserId: currentUserId,\n    showToasts: true,\n\n    onMemberJoined: useCallback((data) => {\n      console.log('[TeamManagement] Socket: Member joined', data);\n      // Add new member to list or update status to active\n      setMembers(prev => {\n        // Check if already exists (was pending invite)\n        const existingIndex = prev.findIndex(m =>\n          m.uuid === data.uuid || m.email === data.email\n        );\n\n        if (existingIndex !== -1) {\n          // Update existing (change status to active)\n          const updated = [...prev];\n          updated[existingIndex] = {\n            ...updated[existingIndex],\n            uuid: data.uuid,\n            status: 2,\n            role_name: data.role,\n            role_id: data.roleId,\n          };\n          return updated;\n        }\n\n        // Add new member\n        return [...prev, {\n          uuid: data.uuid,\n          first_name: data.firstName,\n          last_name: data.lastName,\n          email: data.email,\n          role_name: data.role,\n          role_id: data.roleId,\n          status: 2,\n          created_at: new Date().toISOString(),\n        }];\n      });\n    }, []),\n\n    onMemberRemoved: useCallback((data) => {\n      console.log('[TeamManagement] Socket: Member removed', data);\n      // Remove from list\n      setMembers(prev => prev.filter(m => m.uuid !== data.uuid));\n    }, []),\n\n    onRoleChanged: useCallback((data) => {\n      console.log('[TeamManagement] Socket: Role changed', data);\n      // Update role in list\n      setMembers(prev => prev.map(m =>\n        m.uuid === data.uuid\n          ? { ...m, role_name: data.newRole, role_id: data.newRoleId }\n          : m\n      ));\n    }, []),\n\n    onInviteSent: useCallback((data) => {\n      console.log('[TeamManagement] Socket: Invite sent', data);\n      // Add pending invite to list\n      setMembers(prev => {\n        // Check if already exists\n        if (prev.some(m => m.email === data.email)) {\n          return prev;\n        }\n\n        return [...prev, {\n          uuid: data.uuid || `pending-${Date.now()}`,\n          first_name: data.firstName,\n          last_name: data.lastName,\n          email: data.email,\n          role_name: data.role,\n          role_id: data.roleId,\n          status: 1, // Pending\n          created_at: new Date().toISOString(),\n        }];\n      });\n    }, []),\n  });\n\n  // Smart suggestions\n  const {\n    suggestions,\n    dismissSuggestion,\n    hasSuggestions,\n  } = useTeamSuggestions({\n    members,\n    projects, // Pass projects if available\n    enabled: isCurrentUserAdmin,\n  });\n\n  // Handle suggestion action - open modal with preselected role\n  const handleSuggestionAction = (role) => {\n    // Find role ID\n    const roleObj = ROLES.find(r => r.name === role);\n    setPreselectedRole(roleObj?.id || null);\n    setShowAddModal(true);\n  };\n\n  const handleRoleChange = async (member, newRoleId) => {\n    // Optimistic update\n    const previousMembers = [...members];\n    const newRole = ROLES.find(r => r.id === newRoleId);\n\n    setMembers(prev => prev.map(m =>\n      m.uuid === member.uuid\n        ? { ...m, role_id: newRoleId, role_name: newRole?.name || 'Team Member' }\n        : m\n    ));\n\n    try {\n      const result = await updateUserRole(member.uuid, newRoleId);\n      if (result.status === 'SUCCESS') {\n        toast.success(`${member.first_name}'s role updated to ${newRole?.name}`);\n      } else {\n        // Revert on failure\n        setMembers(previousMembers);\n        toast.error(result.message || 'Failed to update role');\n      }\n    } catch (error) {\n      // Revert on error\n      setMembers(previousMembers);\n      toast.error(error?.message || 'Failed to update role');\n    }\n  };\n\n  const handleResendInvite = async (member) => {\n    try {\n      const result = await resendInviteCode(member.email);\n      if (result.status === 'SUCCESS') {\n        toast.success(`Invite sent to ${member.email}`);\n      } else {\n        toast.error(result.message || 'Failed to resend invite');\n      }\n    } catch (error) {\n      toast.error(error?.message || 'Failed to resend invite');\n    }\n  };\n\n  const handleRemoveMember = async () => {\n    if (!memberToRemove) return;\n\n    setRemoving(true);\n    try {\n      const result = await deleteCompanyUser(memberToRemove.uuid);\n      if (result.status === 'SUCCESS') {\n        toast.success('Team member removed');\n        setShowRemoveModal(false);\n        setMemberToRemove(null);\n        // Remove from local state (socket will notify others)\n        setMembers(prev => prev.filter(m => m.uuid !== memberToRemove.uuid));\n      } else {\n        toast.error(result.message || 'Failed to remove member');\n      }\n    } catch (error) {\n      toast.error(error?.message || 'Failed to remove member');\n    } finally {\n      setRemoving(false);\n    }\n  };\n\n  const openRemoveModal = (member) => {\n    setMemberToRemove(member);\n    setShowRemoveModal(true);\n  };\n\n  // Separate active vs pending\n  const activeMembers = members.filter(m => m.status === 2);\n  const pendingMembers = members.filter(m => m.status !== 2);\n\n  // Stats\n  const stats = {\n    total: members.length,\n    active: activeMembers.length,\n    pending: pendingMembers.length,\n  };\n\n  return (\n    <div className={styles.container}>\n      {/* Header */}\n      <div className={styles.header}>\n        <div className={styles.headerContent}>\n          <h1 className={styles.title}>Team</h1>\n          <p className={styles.subtitle}>\n            {stats.total} {stats.total === 1 ? 'member' : 'members'}\n            {stats.pending > 0 && ` Â· ${stats.pending} pending`}\n          </p>\n        </div>\n        <Button\n          variant=\"primary\"\n          onClick={() => {\n            setPreselectedRole(null);\n            setShowAddModal(true);\n          }}\n        >\n          <i className=\"ri-user-add-line\" /> Add Member\n        </Button>\n      </div>\n\n      {/* Smart Suggestions */}\n      {hasSuggestions && (\n        <div className={styles.suggestionsSection}>\n          {suggestions.map(suggestion => (\n            <TeamSuggestionCard\n              key={suggestion.id}\n              suggestion={suggestion}\n              onAction={handleSuggestionAction}\n              onDismiss={dismissSuggestion}\n            />\n          ))}\n        </div>\n      )}\n\n      {/* Live indicator */}\n      {isConnected && currentCompanyId && (\n        <div className={styles.liveIndicator}>\n          <span className={styles.liveDot} />\n          <span>Live updates enabled</span>\n        </div>\n      )}\n\n      {/* Content */}\n      {loading ? (\n        <div className={styles.loadingContainer}>\n          <LoadingSpinner size=\"lg\" label=\"Loading team...\" />\n        </div>\n      ) : members.length === 0 ? (\n        <EmptyState\n          icon=\"ðŸ‘¥\"\n          title=\"No team members yet\"\n          description=\"Invite people to collaborate on projects\"\n          action={\n            <Button variant=\"primary\" onClick={() => setShowAddModal(true)}>\n              <i className=\"ri-user-add-line\" /> Add First Member\n            </Button>\n          }\n        />\n      ) : (\n        <div className={styles.memberList}>\n          {/* Active Members */}\n          {activeMembers.map((member) => (\n            <MemberRow\n              key={member.uuid}\n              member={member}\n              isCurrentUser={member.uuid === currentUserId}\n              canEditRole={isCurrentUserAdmin && member.uuid !== currentUserId}\n              onRoleChange={handleRoleChange}\n              onResendInvite={handleResendInvite}\n              onRemove={openRemoveModal}\n            />\n          ))}\n\n          {/* Pending Section */}\n          {pendingMembers.length > 0 && (\n            <>\n              <div className={styles.sectionDivider}>\n                <span>Pending Invites ({pendingMembers.length})</span>\n              </div>\n              {pendingMembers.map((member) => (\n                <MemberRow\n                  key={member.uuid}\n                  member={member}\n                  isPending\n                  canEditRole={isCurrentUserAdmin}\n                  onRoleChange={handleRoleChange}\n                  onResendInvite={handleResendInvite}\n                  onRemove={openRemoveModal}\n                />\n              ))}\n            </>\n          )}\n        </div>\n      )}\n\n      {/* Add User Modal */}\n      {showAddModal && (\n        <AddUserModal\n          onClose={() => {\n            setShowAddModal(false);\n            setPreselectedRole(null);\n          }}\n          onUserAdded={() => {\n            setShowAddModal(false);\n            setPreselectedRole(null);\n            loadMembers();\n          }}\n          preselectedRole={preselectedRole}\n        />\n      )}\n\n      {/* Remove Confirmation Modal */}\n      <Modal\n        isOpen={showRemoveModal}\n        onClose={() => setShowRemoveModal(false)}\n        title=\"Remove Team Member\"\n        size=\"sm\"\n        footer={\n          <div className={styles.modalFooter}>\n            <Button\n              variant=\"ghost\"\n              onClick={() => setShowRemoveModal(false)}\n              disabled={removing}\n            >\n              Cancel\n            </Button>\n            <Button\n              variant=\"danger\"\n              onClick={handleRemoveMember}\n              loading={removing}\n            >\n              Remove\n            </Button>\n          </div>\n        }\n      >\n        {memberToRemove && (\n          <div className={styles.removeConfirm}>\n            <p>\n              Are you sure you want to remove{' '}\n              <strong>{memberToRemove.first_name} {memberToRemove.last_name}</strong>?\n            </p>\n            <p className={styles.removeWarning}>\n              They will lose access to all company projects and data.\n            </p>\n          </div>\n        )}\n      </Modal>\n    </div>\n  );\n};\n\n/**\n * MemberRow Component\n * Displays a single team member with inline role editing\n */\nconst MemberRow = ({\n  member,\n  isCurrentUser = false,\n  isPending = false,\n  canEditRole = false,\n  onRoleChange,\n  onResendInvite,\n  onRemove\n}) => {\n  const fullName = `${member.first_name} ${member.last_name}`;\n\n  // Find current role\n  const currentRole = ROLES.find(r => r.id === member.role_id) ||\n                      ROLES.find(r => r.name === member.role_name) ||\n                      { id: 0, name: member.role_name || 'Team Member', icon: 'ri-user-line' };\n\n  const getStatusVariant = () => {\n    if (member.status === 2) return 'active';\n    if (member.status === 1) return 'pending';\n    if (member.status === 0) return 'inactive';\n    return 'pending';\n  };\n\n  const getStatusLabel = () => {\n    if (member.status === 2) return 'Active';\n    if (member.status === 1) return 'Invite Sent';\n    if (member.status === 0) return 'Deactivated';\n    return 'Pending';\n  };\n\n  return (\n    <div className={`${styles.memberRow} ${isPending ? styles.pendingRow : ''}`}>\n      {/* Avatar + Identity */}\n      <div className={styles.memberIdentity}>\n        <Avatar\n          name={fullName}\n          size=\"md\"\n          status={member.status === 2 ? 'online' : undefined}\n        />\n        <div className={styles.memberInfo}>\n          <span className={styles.memberName}>\n            {fullName}\n            {isCurrentUser && <span className={styles.youBadge}>(you)</span>}\n          </span>\n          <span className={styles.memberEmail}>{member.email}</span>\n        </div>\n      </div>\n\n      {/* Role - Editable or Static */}\n      <div className={styles.memberRole}>\n        {canEditRole ? (\n          <RoleSelector\n            currentRole={currentRole}\n            onSelect={(roleId) => onRoleChange(member, roleId)}\n          />\n        ) : (\n          <span className={styles.roleLabel}>\n            <i className={currentRole.icon} />\n            {currentRole.name}\n          </span>\n        )}\n      </div>\n\n      {/* Status */}\n      <div className={styles.memberStatus}>\n        <StatusBadge\n          status={getStatusVariant()}\n          label={getStatusLabel()}\n          size=\"sm\"\n        />\n      </div>\n\n      {/* Actions */}\n      <div className={styles.memberActions}>\n        {!isCurrentUser && (\n          <Dropdown\n            trigger={\n              <button className={styles.actionButton}>\n                <i className=\"ri-more-2-fill\" />\n              </button>\n            }\n            align=\"right\"\n          >\n            {isPending && (\n              <Dropdown.Item\n                icon={<i className=\"ri-mail-send-line\" />}\n                onClick={() => onResendInvite(member)}\n              >\n                Resend Invite\n              </Dropdown.Item>\n            )}\n            <Dropdown.Item\n              icon={<i className=\"ri-user-unfollow-line\" />}\n              danger\n              onClick={() => onRemove(member)}\n            >\n              Remove\n            </Dropdown.Item>\n          </Dropdown>\n        )}\n      </div>\n    </div>\n  );\n};\n\n/**\n * RoleSelector Component\n * Inline dropdown for changing user roles\n */\nconst RoleSelector = ({ currentRole, onSelect }) => {\n  return (\n    <Dropdown\n      trigger={\n        <button className={styles.roleSelectorTrigger}>\n          <i className={currentRole.icon} />\n          <span>{currentRole.name}</span>\n          <i className=\"ri-arrow-down-s-line\" />\n        </button>\n      }\n      align=\"left\"\n      closeOnClick={true}\n    >\n      <Dropdown.Label>Change Role</Dropdown.Label>\n      {ROLES.map((role) => (\n        <Dropdown.Item\n          key={role.id}\n          icon={<i className={role.icon} />}\n          onClick={() => onSelect(role.id)}\n          className={role.id === currentRole.id ? styles.roleItemActive : ''}\n        >\n          {role.name}\n          {role.id === currentRole.id && (\n            <i className={`ri-check-line ${styles.roleCheckmark}`} />\n          )}\n        </Dropdown.Item>\n      ))}\n    </Dropdown>\n  );\n};\n\nexport default TeamManagement;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\accountAPI.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\adminDrafterService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\adminDrafterSocketService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\adminService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\authService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\azimuthService.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getMultipartHeaders' is assigned a value but never used.","line":29,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":26}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import logger from './devLogger';\n\nconst API_BASE = process.env.REACT_APP_API_BASE_URL || 'https://api.skyfireapp.io';\n\nconst getAuthToken = () => localStorage.getItem('token') || sessionStorage.getItem('token');\n\nconst getHeaders = () => ({\n  'Authorization': `Bearer ${getAuthToken()}`,\n  'Content-Type': 'application/json',\n});\n\nconst getCompanyId = () => {\n  try {\n    // Try companyData first (matches surveyService.js pattern)\n    const companyData = JSON.parse(sessionStorage.getItem('companyData') || '{}');\n    if (companyData.uuid) {\n      return companyData.uuid;\n    }\n\n    // Fallback to userData.company.uuid\n    const userData = JSON.parse(sessionStorage.getItem('userData') || '{}');\n    return userData?.company?.uuid;\n  } catch {\n    logger.error('AzimuthService', 'Failed to get company ID from session storage');\n    return null;\n  }\n};\n\nconst getMultipartHeaders = () => ({\n  'Authorization': `Bearer ${getAuthToken()}`,\n  // Don't set Content-Type - browser sets it with boundary for multipart/form-data\n});\n\nexport const azimuthService = {\n  /**\n   * Get presigned S3 upload URL for azimuth map\n   * @param {string} projectUuid - Project UUID\n   * @param {string} fileName - Name of the file\n   * @returns {Promise<{uploadUrl: string, fileKey: string}>} Presigned URL and S3 key\n   */\n  async getUploadUrl(projectUuid, fileName) {\n    try {\n      logger.log('AzimuthService', `Getting upload URL for ${fileName}`);\n\n      const url = `${API_BASE}/project/${projectUuid}/files/upload-url?fileName=${encodeURIComponent(fileName)}&fileType=azimuth_map&contentType=image/png`;\n\n      const response = await fetch(url, {\n        method: 'GET',\n        headers: getHeaders(),\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        logger.error('AzimuthService', `Failed to get upload URL: ${response.status} ${errorText}`);\n        throw new Error('Failed to get upload URL');\n      }\n\n      const data = await response.json();\n      logger.log('AzimuthService', 'Upload URL retrieved successfully');\n      return data.data;\n    } catch (error) {\n      logger.error('AzimuthService', 'Error getting upload URL:', error);\n      throw error;\n    }\n  },\n\n  /**\n   * Register uploaded file with project\n   * @param {string} projectUuid - Project UUID\n   * @param {Object} fileData - File metadata\n   * @returns {Promise<Object>} Registered file data\n   */\n  async registerFile(projectUuid, fileData) {\n    try {\n      logger.log('AzimuthService', `Registering file ${fileData.fileName}`);\n\n      const response = await fetch(`${API_BASE}/project/${projectUuid}/files`, {\n        method: 'POST',\n        headers: getHeaders(),\n        body: JSON.stringify(fileData),\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        logger.error('AzimuthService', `Failed to register file: ${response.status} ${errorText}`);\n        throw new Error('Failed to register file');\n      }\n\n      const data = await response.json();\n      logger.log('AzimuthService', 'File registered successfully');\n      return data;\n    } catch (error) {\n      logger.error('AzimuthService', 'Error registering file:', error);\n      throw error;\n    }\n  },\n\n  /**\n   * Save azimuth measurements to project\n   * NOTE: This endpoint may not exist yet on the backend - gracefully handle 404\n   * @param {string} projectUuid - Project UUID\n   * @param {Array} measurements - Array of measurement objects\n   * @returns {Promise<Object|null>} Save response or null if endpoint doesn't exist\n   */\n  async saveMeasurements(projectUuid, measurements) {\n    try {\n      const companyId = getCompanyId();\n      if (!companyId) {\n        logger.warn('AzimuthService', 'Company ID not found - skipping measurements save');\n        return null;\n      }\n\n      logger.log('AzimuthService', `Attempting to save ${measurements.length} measurements`);\n\n      const response = await fetch(`${API_BASE}/project/${projectUuid}/azimuth`, {\n        method: 'PUT',\n        headers: getHeaders(),\n        body: JSON.stringify({\n          companyId,\n          measurements,\n        }),\n      });\n\n      if (!response.ok) {\n        // If endpoint doesn't exist yet (404), just log and continue\n        if (response.status === 404) {\n          logger.warn('AzimuthService', 'Measurements endpoint not implemented yet - image saved but measurements not persisted');\n          return null;\n        }\n\n        const errorText = await response.text();\n        logger.error('AzimuthService', `Failed to save measurements: ${response.status} ${errorText}`);\n        throw new Error('Failed to save measurements');\n      }\n\n      const data = await response.json();\n      logger.log('AzimuthService', 'Measurements saved successfully');\n      return data;\n    } catch (error) {\n      // Don't throw - measurements save is optional (image is more important)\n      logger.error('AzimuthService', 'Error saving measurements (non-fatal):', error);\n      return null;\n    }\n  },\n\n  /**\n   * Get azimuth measurements for project\n   * @param {string} projectUuid - Project UUID\n   * @returns {Promise<Array>} Array of measurements\n   */\n  async getMeasurements(projectUuid) {\n    try {\n      const companyId = getCompanyId();\n      if (!companyId) {\n        throw new Error('Company information not found');\n      }\n\n      logger.log('AzimuthService', `Fetching measurements for project ${projectUuid}`);\n\n      const response = await fetch(\n        `${API_BASE}/project/${projectUuid}/azimuth?companyId=${companyId}`,\n        { headers: getHeaders() }\n      );\n\n      if (!response.ok) {\n        // If 404, return empty array (no measurements yet)\n        if (response.status === 404) {\n          logger.log('AzimuthService', 'No measurements found for this project');\n          return [];\n        }\n\n        const errorText = await response.text();\n        logger.error('AzimuthService', `Failed to get measurements: ${response.status} ${errorText}`);\n        throw new Error('Failed to get measurements');\n      }\n\n      const data = await response.json();\n      const measurements = data.data?.measurements || [];\n      logger.log('AzimuthService', `Retrieved ${measurements.length} measurements`);\n      return measurements;\n    } catch (error) {\n      logger.error('AzimuthService', 'Error getting measurements:', error);\n      throw error;\n    }\n  },\n};\n\nexport default azimuthService;\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\chatterService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\customerInvitationService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\devLogger.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\documentService.js","messages":[{"ruleId":"import/no-anonymous-default-export","severity":1,"message":"Assign object to a variable before exporting as module default","line":274,"column":1,"nodeType":"ExportDefaultDeclaration","endLine":276,"endColumn":3}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Document Service - Standardized API endpoints for project documents\n * Handles sales proposals, supporting docs, contracts, permits, etc.\n */\n\nimport logger from './devLogger';\n\nconst API_BASE = process.env.REACT_APP_API_URL || 'https://api.skyfireapp.io';\n\n// Helper to get auth token\nconst getAuthToken = () => {\n  return localStorage.getItem('token') || sessionStorage.getItem('token');\n};\n\n// Standardized headers\nconst getHeaders = () => ({\n  'Authorization': `Bearer ${getAuthToken()}`,\n  'Content-Type': 'application/json',\n});\n\nconst getMultipartHeaders = () => ({\n  'Authorization': `Bearer ${getAuthToken()}`,\n  // Don't set Content-Type for multipart - browser sets it with boundary\n});\n\n// Helper to get companyId from session\nconst getCompanyId = () => {\n  try {\n    const companyData = JSON.parse(sessionStorage.getItem('companyData') || '{}');\n    return companyData.uuid;\n  } catch (error) {\n    logger.error('DocumentService', 'Failed to get companyId:', error);\n    return null;\n  }\n};\n\n// Standardized endpoints matching backend (using singular /project/ not /projects/)\nconst ENDPOINTS = {\n  documents: {\n    list: (projectId, companyId) =>\n      `${API_BASE}/project/${projectId}/documents?companyId=${companyId}`,\n    upload: (projectId) =>\n      `${API_BASE}/project/${projectId}/documents/upload`,\n    bulkDelete: (projectId) =>\n      `${API_BASE}/project/${projectId}/documents/bulk`,\n    deleteOne: (projectId, documentId) =>\n      `${API_BASE}/project/${projectId}/documents/${documentId}`,\n    update: (projectId, documentId) =>\n      `${API_BASE}/project/${projectId}/documents/${documentId}`,\n  }\n};\n\n/**\n * Documents API\n */\nexport const documentsApi = {\n  /**\n   * List all documents for a project\n   * @param {string} projectId - Project UUID\n   * @param {Object} filters - Optional filters (documentType, category)\n   * @returns {Promise<Array>} Array of document objects\n   */\n  async list(projectId, filters = {}) {\n    const companyId = getCompanyId();\n    if (!companyId) throw new Error('Company ID not found');\n\n    try {\n      const url = new URL(ENDPOINTS.documents.list(projectId, companyId));\n      if (filters.documentType) url.searchParams.append('documentType', filters.documentType);\n      if (filters.category) url.searchParams.append('category', filters.category);\n\n      logger.log('DocumentService', `[Documents] Fetching from: ${url.toString()}`);\n      logger.log('DocumentService', `[Documents] CompanyId: ${companyId}, ProjectId: ${projectId}`);\n      logger.log('DocumentService', `[Documents] Auth Token: ${getAuthToken() ? 'Present' : 'Missing'}`);\n\n      const response = await fetch(url, { headers: getHeaders() });\n\n      logger.log('DocumentService', `[Documents] Response status: ${response.status} ${response.statusText}`);\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      logger.log('DocumentService', `[Documents] Response data:`, data);\n\n      // Handle different response formats\n      if (data.status === 'SUCCESS') {\n        return data.data || [];\n      }\n      if (Array.isArray(data.data)) {\n        return data.data;\n      }\n      if (Array.isArray(data)) {\n        return data;\n      }\n\n      logger.warn('DocumentService', 'Unexpected documents response format:', data);\n      return [];\n    } catch (error) {\n      logger.error('DocumentService', 'Failed to fetch documents:', error);\n      throw error;\n    }\n  },\n\n  /**\n   * Upload a document\n   * @param {string} projectId - Project UUID\n   * @param {File} file - Document file\n   * @param {Object} metadata - Optional metadata (documentType, category, note)\n   * @returns {Promise<Object>} Uploaded document object\n   */\n  async upload(projectId, file, metadata = {}) {\n    const companyId = getCompanyId();\n    if (!companyId) throw new Error('Company ID not found');\n\n    try {\n      const formData = new FormData();\n      formData.append('document', file);  // Backend expects 'document' field name\n      formData.append('companyId', companyId);\n      formData.append('projectId', projectId);\n      formData.append('fileName', file.name);\n      formData.append('fileSize', file.size.toString());\n      formData.append('mimeType', file.type);\n      if (metadata.documentType) formData.append('documentType', metadata.documentType);\n      if (metadata.category) formData.append('category', metadata.category);\n      if (metadata.note) formData.append('note', metadata.note);\n\n      logger.log('DocumentService', `[Documents] Uploading document with field name 'document'`);\n\n      const response = await fetch(ENDPOINTS.documents.upload(projectId), {\n        method: 'POST',\n        headers: getMultipartHeaders(),\n        body: formData,\n      });\n\n      logger.log('DocumentService', `[Documents] Upload response: ${response.status} ${response.statusText}`);\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      logger.log('DocumentService', `[Documents] Upload successful:`, data);\n      return data.data || data;\n    } catch (error) {\n      logger.error('DocumentService', 'Failed to upload document:', error);\n      throw error;\n    }\n  },\n\n  /**\n   * Upload multiple documents (bulk)\n   * @param {string} projectId - Project UUID\n   * @param {Array<File>} files - Array of document files\n   * @param {Object} metadata - Optional metadata applied to all (documentType, category, note)\n   * @returns {Promise<Array>} Array of uploaded document objects\n   */\n  async uploadBulk(projectId, files, metadata = {}) {\n    try {\n      logger.log('DocumentService', `[Documents] Bulk uploading ${files.length} documents`);\n\n      const uploadPromises = files.map(file => this.upload(projectId, file, metadata));\n      const results = await Promise.all(uploadPromises);\n\n      logger.log('DocumentService', `[Documents] Bulk upload successful: ${results.length} documents`);\n      return results;\n    } catch (error) {\n      logger.error('DocumentService', 'Failed to bulk upload documents:', error);\n      throw error;\n    }\n  },\n\n  /**\n   * Bulk delete documents\n   * @param {string} projectId - Project UUID\n   * @param {Array<string>} documentIds - Array of document IDs to delete\n   * @returns {Promise<Object>} Delete result\n   */\n  async bulkDelete(projectId, documentIds) {\n    const companyId = getCompanyId();\n    if (!companyId) throw new Error('Company ID not found');\n\n    try {\n      logger.log('DocumentService', `[Documents] Bulk deleting ${documentIds.length} documents`);\n\n      const response = await fetch(ENDPOINTS.documents.bulkDelete(projectId), {\n        method: 'DELETE',\n        headers: getHeaders(),\n        body: JSON.stringify({\n          ids: documentIds,\n          companyId: companyId\n        }),\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        logger.error('DocumentService', `Bulk delete failed: ${response.status} ${errorText}`);\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      logger.log('DocumentService', `[Documents] Bulk delete successful`);\n      return data;\n    } catch (error) {\n      logger.error('DocumentService', 'Failed to delete documents:', error);\n      throw error;\n    }\n  },\n\n  /**\n   * Delete a single document\n   * @param {string} projectId - Project UUID\n   * @param {string} documentId - Document ID to delete\n   * @returns {Promise<Object>} Delete result\n   */\n  async deleteOne(projectId, documentId) {\n    const companyId = getCompanyId();\n    if (!companyId) throw new Error('Company ID not found');\n\n    try {\n      logger.log('DocumentService', `[Documents] Deleting document ${documentId}`);\n\n      const response = await fetch(ENDPOINTS.documents.deleteOne(projectId, documentId), {\n        method: 'DELETE',\n        headers: getHeaders(),\n        body: JSON.stringify({ companyId }),\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        logger.error('DocumentService', `Delete failed: ${response.status} ${errorText}`);\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      logger.log('DocumentService', `[Documents] Delete successful`);\n      return data;\n    } catch (error) {\n      logger.error('DocumentService', 'Failed to delete document:', error);\n      throw error;\n    }\n  },\n\n  /**\n   * Update document metadata\n   * @param {string} projectId - Project UUID\n   * @param {string} documentId - Document ID\n   * @param {Object} updates - Fields to update (documentType, category, note)\n   * @returns {Promise<Object>} Updated document object\n   */\n  async updateMetadata(projectId, documentId, updates) {\n    try {\n      const response = await fetch(ENDPOINTS.documents.update(projectId, documentId), {\n        method: 'PATCH',\n        headers: getHeaders(),\n        body: JSON.stringify(updates),\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      return data.data || data;\n    } catch (error) {\n      logger.error('DocumentService', 'Failed to update document:', error);\n      throw error;\n    }\n  },\n};\n\n// Default export\nexport default {\n  documents: documentsApi,\n};\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\drafterAssignmentService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\drafterPortalService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\drafterSocketService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\earningsService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\equipmentService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\notificationService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\preferredEquipmentService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\projectService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\scheduleService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\stampPermitService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\supportTicketService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\surveyService.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getMultipartHeaders' is assigned a value but never used.","line":21,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":26},{"ruleId":"import/no-anonymous-default-export","severity":1,"message":"Assign object to a variable before exporting as module default","line":834,"column":1,"nodeType":"ExportDefaultDeclaration","endLine":839,"endColumn":3}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Survey Service - Standardized API endpoints for Survey tab\n * Handles photos, videos, and notes for project surveys\n */\n\nimport logger from './devLogger';\n\nconst API_BASE = process.env.REACT_APP_API_URL || 'https://api.skyfireapp.io';\n\n// Helper to get auth token\nconst getAuthToken = () => {\n  return localStorage.getItem('token') || sessionStorage.getItem('token');\n};\n\n// Standardized headers\nconst getHeaders = () => ({\n  'Authorization': `Bearer ${getAuthToken()}`,\n  'Content-Type': 'application/json',\n});\n\nconst getMultipartHeaders = () => ({\n  'Authorization': `Bearer ${getAuthToken()}`,\n  // Don't set Content-Type for multipart - browser sets it with boundary\n});\n\n// Helper to get companyId from session\nconst getCompanyId = () => {\n  try {\n    const companyData = JSON.parse(sessionStorage.getItem('companyData') || '{}');\n    return companyData.uuid;\n  } catch (error) {\n    logger.error('SurveyService', 'Failed to get companyId:', error);\n    return null;\n  }\n};\n\n/**\n * Upload file to S3 using presigned URL\n * @param {File} file - File to upload\n * @param {string} projectId - Project UUID for directory path\n * @param {string} directory - Optional directory override (default: 'photos')\n * @returns {Promise<string>} S3 URL of uploaded file\n */\nconst uploadFileToS3 = async (file, projectId, directory = 'photos') => {\n  const companyId = getCompanyId();\n  if (!companyId) throw new Error('Company ID not found');\n\n  try {\n    // Step 1: Get presigned S3 upload URL using GET with query params\n    logger.log('SurveyService', `[S3] Getting presigned URL for ${file.name} (directory: ${directory})`);\n\n    const url = new URL(`${API_BASE}/company/${companyId}/file-upload-url`);\n    url.searchParams.append('directory', `projects/${projectId}/${directory}`);\n    url.searchParams.append('fileName', file.name);\n\n    const urlResponse = await fetch(url.toString(), {\n      method: 'GET',\n      headers: getHeaders(),\n    });\n\n    if (!urlResponse.ok) {\n      throw new Error(`Failed to get upload URL: ${urlResponse.status}`);\n    }\n\n    const { upload_url, key } = await urlResponse.json();\n    logger.log('SurveyService', `[S3] Got presigned URL, uploading to S3...`);\n\n    // Step 2: Upload file directly to S3\n    const s3Response = await fetch(upload_url, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': file.type,\n      },\n      body: file,\n    });\n\n    if (!s3Response.ok) {\n      throw new Error(`S3 upload failed: ${s3Response.status}`);\n    }\n\n    // Step 3: Construct S3 URL from key\n    const s3Url = `https://skyfire-media-files.s3.amazonaws.com/${key}`;\n    logger.log('SurveyService', `[S3] Upload successful:`, s3Url);\n\n    return s3Url;\n  } catch (error) {\n    logger.error('SurveyService', '[S3] Upload failed:', error);\n    throw error;\n  }\n};\n\n// Standardized endpoints matching backend (using singular /project/ not /projects/)\nconst ENDPOINTS = {\n  photos: {\n    list: (projectId, companyId) =>\n      `${API_BASE}/project/${projectId}/photos?companyId=${companyId}`,\n    upload: (projectId, companyId) =>\n      `${API_BASE}/project/${projectId}/photos?companyId=${companyId}`,\n    bulkDelete: (projectId) =>\n      `${API_BASE}/project/${projectId}/photos/bulk-delete`,\n    deleteOne: (projectId, photoId) =>\n      `${API_BASE}/project/${projectId}/photos/${photoId}`,\n    update: (projectId, photoId) =>\n      `${API_BASE}/project/${projectId}/photos/${photoId}`,\n  },\n  videos: {\n    // NOTE: Backend stores photos and videos in the same table\n    // All video operations use the photos endpoint with type=video\n    list: (projectId, companyId) =>\n      `${API_BASE}/project/${projectId}/photos?companyId=${companyId}&type=video`,\n    upload: (projectId, companyId) =>\n      `${API_BASE}/project/${projectId}/photos?companyId=${companyId}`,\n    bulkDelete: (projectId) =>\n      `${API_BASE}/project/${projectId}/photos/bulk-delete`,\n    deleteOne: (projectId, videoId) =>\n      `${API_BASE}/project/${projectId}/photos/${videoId}`,\n    update: (projectId, videoId) =>\n      `${API_BASE}/project/${projectId}/photos/${videoId}`,\n  },\n  notes: {\n    list: (projectId, companyId) =>\n      `${API_BASE}/project/${projectId}/survey-notes?companyId=${companyId}`,\n    create: (projectId) =>\n      `${API_BASE}/project/${projectId}/survey-notes`,\n    update: (projectId, noteId) =>\n      `${API_BASE}/project/${projectId}/survey-notes/${noteId}`,\n    delete: (projectId, noteId) =>\n      `${API_BASE}/project/${projectId}/survey-notes/${noteId}`,\n  },\n  documents: {\n    // Documents use the photos table with media_type='document'\n    list: (projectId, companyId) =>\n      `${API_BASE}/project/${projectId}/photos?companyId=${companyId}&type=document`,\n    upload: (projectId, companyId) =>\n      `${API_BASE}/project/${projectId}/photos?companyId=${companyId}`,\n    bulkDelete: (projectId) =>\n      `${API_BASE}/project/${projectId}/photos/bulk-delete`,\n    deleteOne: (projectId, docId) =>\n      `${API_BASE}/project/${projectId}/photos/${docId}`,\n    update: (projectId, docId) =>\n      `${API_BASE}/project/${projectId}/photos/${docId}`,\n  }\n};\n\n/**\n * Photos API\n */\nexport const photosApi = {\n  /**\n   * List all photos for a project\n   * @param {string} projectId - Project UUID\n   * @param {Object} filters - Optional filters (section, tag)\n   * @returns {Promise<Array>} Array of photo objects\n   */\n  async list(projectId, filters = {}) {\n    const companyId = getCompanyId();\n    if (!companyId) throw new Error('Company ID not found');\n\n    try {\n      const url = new URL(ENDPOINTS.photos.list(projectId, companyId));\n      if (filters.section) url.searchParams.append('section', filters.section);\n      if (filters.tag) url.searchParams.append('tag', filters.tag);\n\n      logger.log('SurveyService', `[Photos] Fetching from: ${url.toString()}`);\n      logger.log('SurveyService', `[Photos] CompanyId: ${companyId}, ProjectId: ${projectId}`);\n      logger.log('SurveyService', `[Photos] Auth Token: ${getAuthToken() ? 'Present' : 'Missing'}`);\n\n      const response = await fetch(url, { headers: getHeaders() });\n\n      logger.log('SurveyService', `[Photos] Response status: ${response.status} ${response.statusText}`);\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      logger.log('SurveyService', `[Photos] Response data:`, data);\n\n      // Handle different response formats\n      if (data.status === 'SUCCESS') {\n        return data.data || [];\n      }\n      if (Array.isArray(data.data)) {\n        return data.data;\n      }\n      if (Array.isArray(data)) {\n        return data;\n      }\n\n      logger.warn('SurveyService', 'Unexpected photos response format:', data);\n      return [];\n    } catch (error) {\n      logger.error('SurveyService', 'Failed to fetch photos:', error);\n      throw error;\n    }\n  },\n\n  /**\n   * Upload a photo\n   * @param {string} projectId - Project UUID\n   * @param {File} file - Photo file\n   * @param {Object} metadata - Optional metadata (section, tag, note)\n   * @returns {Promise<Object>} Uploaded photo object\n   */\n  async upload(projectId, file, metadata = {}) {\n    const companyId = getCompanyId();\n    if (!companyId) throw new Error('Company ID not found');\n\n    try {\n      // Step 1: Upload file to S3 using presigned URL\n      logger.log('SurveyService', `[Photos] Uploading ${file.name} to S3...`);\n      const s3Url = await uploadFileToS3(file, projectId);\n\n      // Step 2: Create photo record in database with S3 URL\n      logger.log('SurveyService', `[Photos] Creating photo record at ${ENDPOINTS.photos.upload(projectId, companyId)}`);\n\n      const response = await fetch(ENDPOINTS.photos.upload(projectId, companyId), {\n        method: 'POST',\n        headers: getHeaders(),\n        body: JSON.stringify({\n          url: s3Url,\n          section: metadata.section || 'general', // Required field - default to 'general'\n          fileName: file.name,\n          mimeType: file.type,\n          fileSize: file.size,\n          tag: metadata.tag || null,\n          note: metadata.note || null,\n        }),\n      });\n\n      logger.log('SurveyService', `[Photos] Upload response: ${response.status} ${response.statusText}`);\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        logger.error('SurveyService', `[Photos] Upload failed: ${errorText}`);\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      logger.log('SurveyService', `[Photos] Upload successful:`, data);\n      return data.data || data;\n    } catch (error) {\n      logger.error('SurveyService', 'Failed to upload photo:', error);\n      throw error;\n    }\n  },\n\n  /**\n   * Bulk delete photos\n   * @param {string} projectId - Project UUID\n   * @param {Array<string>} photoIds - Array of photo IDs to delete\n   * @returns {Promise<Object>} Delete result\n   */\n  async bulkDelete(projectId, photoIds) {\n    const companyId = getCompanyId();\n    if (!companyId) throw new Error('Company ID not found');\n\n    try {\n      logger.log('SurveyService', `[Photos] Bulk deleting ${photoIds.length} photos`);\n\n      const response = await fetch(ENDPOINTS.photos.bulkDelete(projectId), {\n        method: 'DELETE',\n        headers: getHeaders(),\n        body: JSON.stringify({\n          ids: photoIds,\n          companyId: companyId\n        }),\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        logger.error('SurveyService', `Bulk delete failed: ${response.status} ${errorText}`);\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      logger.log('SurveyService', `[Photos] Bulk delete successful`);\n      return data;\n    } catch (error) {\n      logger.error('SurveyService', 'Failed to delete photos:', error);\n      throw error;\n    }\n  },\n\n  /**\n   * Delete a single photo\n   * @param {string} projectId - Project UUID\n   * @param {string} photoId - Photo ID to delete\n   * @returns {Promise<Object>} Delete result\n   */\n  async deleteOne(projectId, photoId) {\n    const companyId = getCompanyId();\n    if (!companyId) throw new Error('Company ID not found');\n\n    try {\n      logger.log('SurveyService', `[Photos] Deleting photo ${photoId}`);\n\n      const response = await fetch(ENDPOINTS.photos.deleteOne(projectId, photoId), {\n        method: 'DELETE',\n        headers: getHeaders(),\n        body: JSON.stringify({ companyId }),\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        logger.error('SurveyService', `Delete failed: ${response.status} ${errorText}`);\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      logger.log('SurveyService', `[Photos] Delete successful`);\n      return data;\n    } catch (error) {\n      logger.error('SurveyService', 'Failed to delete photo:', error);\n      throw error;\n    }\n  },\n\n  /**\n   * Update photo metadata\n   * @param {string} projectId - Project UUID\n   * @param {string} photoId - Photo ID\n   * @param {Object} updates - Fields to update (section, tag, note)\n   * @returns {Promise<Object>} Updated photo object\n   */\n  async updateMetadata(projectId, photoId, updates) {\n    try {\n      const response = await fetch(ENDPOINTS.photos.update(projectId, photoId), {\n        method: 'PATCH',\n        headers: getHeaders(),\n        body: JSON.stringify(updates),\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      return data.data || data;\n    } catch (error) {\n      logger.error('SurveyService', 'Failed to update photo:', error);\n      throw error;\n    }\n  },\n};\n\n/**\n * Videos API\n */\nexport const videosApi = {\n  /**\n   * List all videos for a project\n   * NOTE: Backend stores both photos and videos in the same table with media_type column\n   * We use the photos endpoint with type=video filter\n   * @param {string} projectId - Project UUID\n   * @param {Object} filters - Optional filters (section, tag)\n   * @returns {Promise<Array>} Array of video objects\n   */\n  async list(projectId, filters = {}) {\n    const companyId = getCompanyId();\n    if (!companyId) throw new Error('Company ID not found');\n\n    try {\n      // Use photos endpoint with type=video filter (backend stores both in same table)\n      const url = new URL(ENDPOINTS.photos.list(projectId, companyId));\n      url.searchParams.append('type', 'video');\n      if (filters.section) url.searchParams.append('section', filters.section);\n      if (filters.tag) url.searchParams.append('tag', filters.tag);\n\n      logger.log('SurveyService', `[Videos] Fetching from: ${url.toString()}`);\n      logger.log('SurveyService', `[Videos] CompanyId: ${companyId}, ProjectId: ${projectId}`);\n      logger.log('SurveyService', `[Videos] Auth Token: ${getAuthToken() ? 'Present' : 'Missing'}`);\n\n      const response = await fetch(url, { headers: getHeaders() });\n\n      logger.log('SurveyService', `[Videos] Response status: ${response.status} ${response.statusText}`);\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      logger.log('SurveyService', `[Videos] Response data:`, data);\n\n      // Handle different response formats\n      if (data.status === 'SUCCESS') {\n        return data.data || [];\n      }\n      if (Array.isArray(data.data)) {\n        return data.data;\n      }\n      if (Array.isArray(data)) {\n        return data;\n      }\n\n      logger.warn('SurveyService', 'Unexpected videos response format:', data);\n      return [];\n    } catch (error) {\n      logger.error('SurveyService', 'Failed to fetch videos:', error);\n      throw error;\n    }\n  },\n\n  /**\n   * Upload a video\n   * @param {string} projectId - Project UUID\n   * @param {File} file - Video file\n   * @param {Object} metadata - Optional metadata (section, tag, note)\n   * @returns {Promise<Object>} Uploaded video object\n   */\n  async upload(projectId, file, metadata = {}) {\n    const companyId = getCompanyId();\n    if (!companyId) throw new Error('Company ID not found');\n\n    try {\n      logger.log('SurveyService', `[Videos] Starting S3 upload for ${file.name}`);\n\n      // Step 1: Upload file to S3 using presigned URL\n      const s3Url = await uploadFileToS3(file, projectId);\n      logger.log('SurveyService', `[Videos] File uploaded to S3: ${s3Url}`);\n\n      // Step 2: Create video record in database with S3 URL\n      logger.log('SurveyService', `[Videos] Creating DB record at ${ENDPOINTS.videos.upload(projectId, companyId)}`);\n\n      const response = await fetch(ENDPOINTS.videos.upload(projectId, companyId), {\n        method: 'POST',\n        headers: getHeaders(),\n        body: JSON.stringify({\n          url: s3Url,\n          section: metadata.section || 'general', // Required field - default to 'general'\n          fileName: file.name,\n          mimeType: file.type,\n          fileSize: file.size,\n          mediaType: 'video', // Specify this is a video in the shared photos table\n          tag: metadata.tag || null,\n          note: metadata.note || null,\n        }),\n      });\n\n      logger.log('SurveyService', `[Videos] DB record response: ${response.status} ${response.statusText}`);\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        logger.error('SurveyService', `[Videos] DB record creation failed: ${errorText}`);\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      logger.log('SurveyService', `[Videos] Upload successful:`, data);\n      return data.data || data;\n    } catch (error) {\n      logger.error('SurveyService', 'Failed to upload video:', error);\n      throw error;\n    }\n  },\n\n  /**\n   * Bulk delete videos\n   * @param {string} projectId - Project UUID\n   * @param {Array<string>} videoIds - Array of video IDs to delete\n   * @returns {Promise<Object>} Delete result\n   */\n  async bulkDelete(projectId, videoIds) {\n    const companyId = getCompanyId();\n    if (!companyId) throw new Error('Company ID not found');\n\n    try {\n      logger.log('SurveyService', `[Videos] Bulk deleting ${videoIds.length} videos`);\n\n      const response = await fetch(ENDPOINTS.videos.bulkDelete(projectId), {\n        method: 'DELETE',\n        headers: getHeaders(),\n        body: JSON.stringify({\n          ids: videoIds,\n          companyId: companyId\n        }),\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        logger.error('SurveyService', `Bulk delete failed: ${response.status} ${errorText}`);\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      logger.log('SurveyService', `[Videos] Bulk delete successful`);\n      return data;\n    } catch (error) {\n      logger.error('SurveyService', 'Failed to delete videos:', error);\n      throw error;\n    }\n  },\n\n  /**\n   * Delete a single video\n   * @param {string} projectId - Project UUID\n   * @param {string} videoId - Video ID to delete\n   * @returns {Promise<Object>} Delete result\n   */\n  async deleteOne(projectId, videoId) {\n    const companyId = getCompanyId();\n    if (!companyId) throw new Error('Company ID not found');\n\n    try {\n      logger.log('SurveyService', `[Videos] Deleting video ${videoId}`);\n\n      const response = await fetch(ENDPOINTS.videos.deleteOne(projectId, videoId), {\n        method: 'DELETE',\n        headers: getHeaders(),\n        body: JSON.stringify({ companyId }),\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        logger.error('SurveyService', `Delete failed: ${response.status} ${errorText}`);\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      logger.log('SurveyService', `[Videos] Delete successful`);\n      return data;\n    } catch (error) {\n      logger.error('SurveyService', 'Failed to delete video:', error);\n      throw error;\n    }\n  },\n\n  /**\n   * Update video metadata\n   * @param {string} projectId - Project UUID\n   * @param {string} videoId - Video ID\n   * @param {Object} updates - Fields to update (section, tag, note)\n   * @returns {Promise<Object>} Updated video object\n   */\n  async updateMetadata(projectId, videoId, updates) {\n    try {\n      const response = await fetch(ENDPOINTS.videos.update(projectId, videoId), {\n        method: 'PATCH',\n        headers: getHeaders(),\n        body: JSON.stringify(updates),\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      return data.data || data;\n    } catch (error) {\n      logger.error('SurveyService', 'Failed to update video:', error);\n      throw error;\n    }\n  },\n};\n\n/**\n * Notes API - Currently using mock data\n * TODO: Replace with real API when backend is ready\n */\nexport const notesApi = {\n  /**\n   * List all notes for a project\n   * @param {string} projectId - Project UUID\n   * @param {Object} filters - Optional filters (section)\n   * @returns {Promise<Array>} Array of note objects\n   */\n  async list(projectId, filters = {}) {\n    // TODO: Replace with real API when backend is ready\n    logger.debug('SurveyService', '[notesApi] Using mock data - backend not implemented');\n\n    try {\n      const { mockSurveyNotes, getNotesBySection } = await import('../mockData/surveyMockData');\n\n      if (filters.section) {\n        return getNotesBySection(filters.section);\n      }\n      return mockSurveyNotes;\n    } catch (error) {\n      logger.error('SurveyService', 'Failed to load mock notes:', error);\n      return [];\n    }\n  },\n\n  /**\n   * Create a new note\n   * @param {string} projectId - Project UUID\n   * @param {Object} noteData - Note content and metadata\n   * @returns {Promise<Object>} Created note object\n   */\n  async create(projectId, noteData) {\n    // TODO: Replace with real API\n    logger.debug('SurveyService', '[notesApi] Mock create:', noteData);\n    return {\n      id: `note-${Date.now()}`,\n      ...noteData,\n      createdAt: new Date().toISOString(),\n      updatedAt: new Date().toISOString(),\n    };\n  },\n\n  /**\n   * Update an existing note\n   * @param {string} projectId - Project UUID\n   * @param {string} noteId - Note ID\n   * @param {Object} updates - Fields to update\n   * @returns {Promise<Object>} Updated note object\n   */\n  async update(projectId, noteId, updates) {\n    // TODO: Replace with real API\n    logger.debug('SurveyService', '[notesApi] Mock update:', noteId, updates);\n    return {\n      id: noteId,\n      ...updates,\n      updatedAt: new Date().toISOString(),\n    };\n  },\n\n  /**\n   * Delete a note\n   * @param {string} projectId - Project UUID\n   * @param {string} noteId - Note ID\n   * @returns {Promise<Object>} Delete result\n   */\n  async delete(projectId, noteId) {\n    // TODO: Replace with real API\n    logger.debug('SurveyService', '[notesApi] Mock delete:', noteId);\n    return { success: true };\n  },\n};\n\n/**\n * Documents API\n */\nexport const documentsApi = {\n  /**\n   * List all documents for a project\n   * NOTE: Backend stores photos, videos, and documents in the same table with media_type column\n   * We use the photos endpoint with type=document filter\n   * @param {string} projectId - Project UUID\n   * @returns {Promise<Array>} Array of document objects\n   */\n  async list(projectId) {\n    const companyId = getCompanyId();\n    if (!companyId) throw new Error('Company ID not found');\n\n    try {\n      const url = new URL(ENDPOINTS.documents.list(projectId, companyId));\n\n      logger.log('SurveyService', `[Documents] Fetching from: ${url.toString()}`);\n\n      const response = await fetch(url, { headers: getHeaders() });\n\n      logger.log('SurveyService', `[Documents] Response status: ${response.status} ${response.statusText}`);\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      logger.log('SurveyService', `[Documents] Response data:`, data);\n\n      // Handle different response formats\n      if (data.status === 'SUCCESS') {\n        return data.data || [];\n      }\n      if (Array.isArray(data.data)) {\n        return data.data;\n      }\n      if (Array.isArray(data)) {\n        return data;\n      }\n\n      logger.warn('SurveyService', 'Unexpected documents response format:', data);\n      return [];\n    } catch (error) {\n      logger.error('SurveyService', 'Failed to fetch documents:', error);\n      throw error;\n    }\n  },\n\n  /**\n   * Upload a document\n   * @param {string} projectId - Project UUID\n   * @param {File} file - Document file\n   * @param {Object} metadata - Optional metadata (section, tag, note)\n   * @returns {Promise<Object>} Uploaded document object\n   */\n  async upload(projectId, file, metadata = {}) {\n    const companyId = getCompanyId();\n    if (!companyId) throw new Error('Company ID not found');\n\n    try {\n      logger.log('SurveyService', `[Documents] Starting S3 upload for ${file.name}`);\n\n      // Step 1: Upload file to S3 using presigned URL (files directory instead of photos)\n      const s3Url = await uploadFileToS3(file, projectId, 'files');\n      logger.log('SurveyService', `[Documents] File uploaded to S3: ${s3Url}`);\n\n      // Step 2: Create document record in database with S3 URL\n      logger.log('SurveyService', `[Documents] Creating DB record at ${ENDPOINTS.documents.upload(projectId, companyId)}`);\n\n      const response = await fetch(ENDPOINTS.documents.upload(projectId, companyId), {\n        method: 'POST',\n        headers: getHeaders(),\n        body: JSON.stringify({\n          url: s3Url,\n          section: metadata.section || 'general', // Required field - default to 'general'\n          fileName: file.name,\n          mimeType: file.type,\n          fileSize: file.size,\n          mediaType: 'document', // Specify this is a document in the shared photos table\n          tag: metadata.tag || null,\n          note: metadata.note || null,\n        }),\n      });\n\n      logger.log('SurveyService', `[Documents] DB record response: ${response.status} ${response.statusText}`);\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        logger.error('SurveyService', `[Documents] DB record creation failed: ${errorText}`);\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      logger.log('SurveyService', `[Documents] Upload successful:`, data);\n      return data.data || data;\n    } catch (error) {\n      logger.error('SurveyService', 'Failed to upload document:', error);\n      throw error;\n    }\n  },\n\n  /**\n   * Bulk delete documents\n   * @param {string} projectId - Project UUID\n   * @param {Array<string>} docIds - Array of document IDs to delete\n   * @returns {Promise<Object>} Delete result\n   */\n  async bulkDelete(projectId, docIds) {\n    const companyId = getCompanyId();\n    if (!companyId) throw new Error('Company ID not found');\n\n    try {\n      logger.log('SurveyService', `[Documents] Bulk deleting ${docIds.length} documents`);\n\n      const response = await fetch(ENDPOINTS.documents.bulkDelete(projectId), {\n        method: 'DELETE',\n        headers: getHeaders(),\n        body: JSON.stringify({\n          ids: docIds,\n          companyId: companyId\n        }),\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        logger.error('SurveyService', `Bulk delete failed: ${response.status} ${errorText}`);\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      logger.log('SurveyService', `[Documents] Bulk delete successful`);\n      return data;\n    } catch (error) {\n      logger.error('SurveyService', 'Failed to delete documents:', error);\n      throw error;\n    }\n  },\n\n  /**\n   * Delete a single document\n   * @param {string} projectId - Project UUID\n   * @param {string} docId - Document ID to delete\n   * @returns {Promise<Object>} Delete result\n   */\n  async deleteOne(projectId, docId) {\n    const companyId = getCompanyId();\n    if (!companyId) throw new Error('Company ID not found');\n\n    try {\n      logger.log('SurveyService', `[Documents] Deleting document ${docId}`);\n\n      const response = await fetch(ENDPOINTS.documents.deleteOne(projectId, docId), {\n        method: 'DELETE',\n        headers: getHeaders(),\n        body: JSON.stringify({ companyId }),\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        logger.error('SurveyService', `Delete failed: ${response.status} ${errorText}`);\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      logger.log('SurveyService', `[Documents] Delete successful`);\n      return data;\n    } catch (error) {\n      logger.error('SurveyService', 'Failed to delete document:', error);\n      throw error;\n    }\n  },\n\n  /**\n   * Update document metadata\n   * @param {string} projectId - Project UUID\n   * @param {string} docId - Document ID\n   * @param {Object} updates - Fields to update (section, tag, note)\n   * @returns {Promise<Object>} Updated document object\n   */\n  async updateMetadata(projectId, docId, updates) {\n    try {\n      const response = await fetch(ENDPOINTS.documents.update(projectId, docId), {\n        method: 'PATCH',\n        headers: getHeaders(),\n        body: JSON.stringify(updates),\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      return data.data || data;\n    } catch (error) {\n      logger.error('SurveyService', 'Failed to update document:', error);\n      throw error;\n    }\n  },\n};\n\n// Default export with all APIs\nexport default {\n  photos: photosApi,\n  videos: videosApi,\n  notes: notesApi,\n  documents: documentsApi,\n};\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\taskService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\services\\teamService.js","messages":[{"ruleId":"no-useless-escape","severity":1,"message":"Unnecessary escape character: \\(.","line":116,"column":39,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":116,"endColumn":40,"suggestions":[{"messageId":"removeEscape","fix":{"range":[3724,3725],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[3724,3724],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-useless-escape","severity":1,"message":"Unnecessary escape character: \\).","line":116,"column":41,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":116,"endColumn":42,"suggestions":[{"messageId":"removeEscape","fix":{"range":[3726,3727],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[3726,3726],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Team Management API Service\n * Handles team member CRUD and invitation operations\n */\n\nimport axios from '../config/axios';\n\n/**\n * Get all users in the current user's company\n * Company is determined by JWT token on backend\n * @returns {Promise<Object>} - { status: 'SUCCESS', data: CompanyUser[] }\n */\nexport const getCompanyUsers = async () => {\n  try {\n    const response = await axios.get('/company/users');\n    return response.data;\n  } catch (error) {\n    console.error('[TeamService] Error fetching users:', error);\n    if (error?.response?.data?.message) {\n      throw new Error(error.response.data.message);\n    }\n    throw new Error(error?.message || 'Unable to load team members');\n  }\n};\n\n/**\n * Add/invite a new user to the company\n * Backend will:\n * - Create user record with status=0 (pending)\n * - Generate invite code (SKY-XXXX-XXXX)\n * - Send email with invite code\n * - Code expires in 24 hours\n *\n * @param {Object} userData - User data\n * @param {string} userData.firstName - First name\n * @param {string} userData.lastName - Last name\n * @param {string} userData.email - Email address\n * @param {string} [userData.phone] - Phone number (optional)\n * @param {number} [userData.roleId] - Role ID (optional, defaults to Team Member on backend)\n * @returns {Promise<Object>} - { status: 'SUCCESS', data: CompanyUser }\n */\nexport const addCompanyUser = async (userData) => {\n  try {\n    const response = await axios.post('/company/users', {\n      firstName: userData.firstName.trim(),\n      lastName: userData.lastName.trim(),\n      email: userData.email.trim().toLowerCase(),\n      phone: userData.phone?.trim() || undefined,\n      roleId: userData.roleId || undefined,\n    });\n    return response.data;\n  } catch (error) {\n    console.error('[TeamService] Error adding user:', error);\n    if (error?.response?.data?.message) {\n      throw new Error(error.response.data.message);\n    }\n    throw new Error(error?.message || 'Unable to add user');\n  }\n};\n\n/**\n * Delete/remove a user from company (soft delete)\n * Backend should set status=99, company_id=0\n * @param {string} userUuid - User UUID\n * @returns {Promise<Object>} - { status: 'SUCCESS', message: string }\n */\nexport const deleteCompanyUser = async (userUuid) => {\n  try {\n    console.log('[TeamService] Deleting user:', userUuid);\n    const response = await axios.delete(`/company/users/${userUuid}`);\n    return response.data;\n  } catch (error) {\n    console.error('[TeamService] Error deleting user:', error);\n    if (error?.response?.data?.message) {\n      throw new Error(error.response.data.message);\n    }\n    throw new Error(error?.message || 'Unable to remove user');\n  }\n};\n\n/**\n * Resend invite code to a user\n * Generates new code, expires in 24 hours\n * @param {string} email - User email\n * @returns {Promise<Object>} - { status: 'SUCCESS', message: string }\n */\nexport const resendInviteCode = async (email) => {\n  try {\n    const response = await axios.post('/company/users/resend-invite', { email });\n    return response.data;\n  } catch (error) {\n    console.error('[TeamService] Error resending invite:', error);\n    if (error?.response?.data?.message) {\n      throw new Error(error.response.data.message);\n    }\n    throw new Error(error?.message || 'Unable to resend invite');\n  }\n};\n\n/**\n * Validate email format\n * @param {string} email - Email to validate\n * @returns {boolean}\n */\nexport const validateEmail = (email) => {\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  return emailRegex.test(email);\n};\n\n/**\n * Validate phone format (at least 10 digits)\n * @param {string} phone - Phone to validate\n * @returns {boolean}\n */\nexport const validatePhone = (phone) => {\n  const cleaned = phone.replace(/[\\s\\-\\(\\)]/g, '');\n  return cleaned.length >= 10;\n};\n\n/**\n * Get all available roles grouped by category\n * @returns {Promise<Object>} - { status: 'SUCCESS', data: { solar_ops: [], corporate: [], internal: [] } }\n */\nexport const getRoles = async () => {\n  try {\n    const response = await axios.get('/roles');\n    return response.data;\n  } catch (error) {\n    console.error('[TeamService] Error fetching roles:', error);\n    throw new Error(error?.response?.data?.message || 'Unable to load roles');\n  }\n};\n\n/**\n * Update a team member's role\n * @param {string} userUuid - User UUID\n * @param {number} roleId - New role ID\n * @returns {Promise<Object>}\n */\nexport const updateUserRole = async (userUuid, roleId) => {\n  try {\n    const response = await axios.patch(`/company/users/${userUuid}/role`, {\n      roleId,\n    });\n    return response.data;\n  } catch (error) {\n    console.error('[TeamService] Error updating role:', error);\n    if (error?.response?.data?.message) {\n      throw new Error(error.response.data.message);\n    }\n    throw new Error(error?.message || 'Unable to update role');\n  }\n};\n\n/**\n * Get roles assigned to a specific user\n * @param {string} userUuid - User UUID\n * @returns {Promise<Object>} - { status: 'SUCCESS', data: Role[] }\n */\nexport const getUserRoles = async (userUuid) => {\n  try {\n    const response = await axios.get(`/roles/users/${userUuid}/roles`);\n    return response.data;\n  } catch (error) {\n    console.error('[TeamService] Error fetching user roles:', error);\n    throw new Error(error?.response?.data?.message || 'Unable to load user roles');\n  }\n};\n\n/**\n * Set roles for a user (replaces all existing roles)\n * @param {string} userUuid - User UUID\n * @param {number[]} roleIds - Array of role IDs\n * @returns {Promise<Object>} - { status: 'SUCCESS', data: Role[] }\n */\nexport const setUserRoles = async (userUuid, roleIds) => {\n  try {\n    const response = await axios.put(`/roles/users/${userUuid}/roles`, { roleIds });\n    return response.data;\n  } catch (error) {\n    console.error('[TeamService] Error setting user roles:', error);\n    throw new Error(error?.response?.data?.message || 'Unable to update roles');\n  }\n};\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\styles\\gradient.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\styles\\tokens.js","messages":[{"ruleId":"import/no-anonymous-default-export","severity":1,"message":"Assign object to a variable before exporting as module default","line":77,"column":1,"nodeType":"ExportDefaultDeclaration","endLine":77,"endColumn":81}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * SKYFIRE DESIGN SYSTEM - JS TOKENS\n *\n * Usage: import { colors, spacing } from './styles/tokens';\n */\n\nexport const colors = {\n  primary: '#FD7332',\n  primaryDark: '#B92011',\n  primaryLight: '#FF8C42',\n\n  accentBlue: '#3B82F6',\n  accentBlueDark: '#2563EB',\n  accentBlueLight: '#60A5FA',\n\n  bgPage: '#0C1F3F',\n  bgPanel: '#0A1628',\n  bgSurface: '#111C2E',\n  bgElevated: '#213454',\n\n  textPrimary: '#F9FAFB',\n  textSecondary: '#D1D5DB',\n  textMuted: '#9CA3AF',\n  textDisabled: '#6B7280',\n\n  success: '#10B981',\n  info: '#3B82F6',\n  warning: '#F59E0B',\n  error: '#EF4444',\n};\n\nexport const spacing = {\n  xs: '0.125rem',       // 2px - super tight, hairline gaps\n  tight: '0.25rem',     // 4px - button groups, icon gaps\n  default: '0.5rem',    // 8px - DEFAULT\n  loose: '1rem',        // 16px - panels, sections\n  wide: '1.5rem',       // 24px - page margins\n  '2xl': '2rem',        // 32px - hero sections\n};\n\nexport const typography = {\n  fontSans: \"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif\",\n  fontMono: \"ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Monaco, Consolas, monospace\",\n\n  textXs: '0.75rem',\n  textSm: '0.875rem',\n  textBase: '1rem',\n  textLg: '1.125rem',\n  textXl: '1.25rem',\n  text2xl: '1.5rem',\n  text3xl: '1.875rem',\n  text4xl: '2.5rem',\n};\n\nexport const shadows = {\n  sm: '0 1px 2px rgba(0, 0, 0, 0.1)',\n  md: '0 4px 12px rgba(0, 0, 0, 0.2)',\n  lg: '0 10px 25px rgba(0, 0, 0, 0.3)',\n  glowOrange: '0 0 20px rgba(253, 115, 50, 0.4)',\n  glowBlue: '0 0 20px rgba(59, 130, 246, 0.3)',\n};\n\nexport const gradients = {\n  primary: 'linear-gradient(180deg, #FD7332 0%, #B92011 100%)',\n  chatter: 'linear-gradient(180deg, #3B82F6 0%, #2563EB 100%)',\n  input: 'linear-gradient(180deg, #0C1F3F 0%, #2E4161 100%)',\n  page: 'linear-gradient(180deg, #0C1F3F 0%, #2E4161 100%)',\n};\n\nexport const breakpoints = {\n  sm: 640,\n  md: 768,\n  lg: 1024,\n  xl: 1280,\n};\n\nexport default { colors, spacing, typography, shadows, gradients, breakpoints };\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\utils\\bosFieldUtils.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'prefix' is assigned a value but never used.","line":152,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":152,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * BOS Field Utilities\n * Generates field names and handles data extraction for all BOS section types\n */\n\nimport { BOS_FIELD_PATTERNS } from '../constants/bosFieldPatterns';\n\n/**\n * Generate all field names for a BOS slot\n * @param {string} section - BOS section type (utility, battery1, battery2, backup, postSMS, combine)\n * @param {number} systemNumber - System number (1-4) or position number for combine\n * @param {number} slotNumber - Slot number within the section\n * @returns {{prefix: string, fields: Object}} Field prefix and field name map\n */\nexport const generateSlotFields = (section, systemNumber, slotNumber) => {\n  const pattern = BOS_FIELD_PATTERNS[section];\n  if (!pattern) {\n    console.error(`Unknown BOS section: ${section}`);\n    return { prefix: '', fields: {} };\n  }\n\n  let prefix;\n  if (section === 'combine') {\n    // Combine uses position_slot pattern\n    prefix = pattern.slotPattern(systemNumber, slotNumber); // systemNumber = position for combine\n  } else {\n    prefix = pattern.slotPattern(systemNumber, slotNumber);\n  }\n\n  const fields = {};\n  pattern.fields.forEach(field => {\n    fields[field] = `${prefix}_${field}`;\n  });\n\n  return { prefix, fields };\n};\n\n/**\n * Extract BOS slot data from system details\n * @param {Object} systemDetails - System details object from API\n * @param {string} section - BOS section type\n * @param {number} systemNumber - System number (1-4) or position for combine\n * @param {number} slotNumber - Slot number\n * @returns {Object} Slot data with normalized fields\n */\nexport const extractSlotData = (systemDetails, section, systemNumber, slotNumber) => {\n  const { prefix, fields } = generateSlotFields(section, systemNumber, slotNumber);\n\n  const data = {\n    fieldPrefix: prefix,\n    slotNumber,\n    systemNumber,\n    section,\n  };\n\n  // Extract all field values\n  Object.entries(fields).forEach(([key, fieldName]) => {\n    data[key] = systemDetails?.[fieldName] ?? null;\n  });\n\n  // Normalize is_new/existing for consistent interface\n  if (section === 'combine') {\n    data.isNew = !data.existing; // Invert existing to isNew\n  } else {\n    data.isNew = data.is_new ?? true;\n  }\n\n  return data;\n};\n\n/**\n * Get all populated slots for a section\n * @param {Object} systemDetails - System details from API\n * @param {string} section - BOS section type\n * @param {number} systemNumber - System number (1-4), null for combine\n * @returns {Array} Array of populated slot data objects\n */\nexport const getPopulatedSlots = (systemDetails, section, systemNumber) => {\n  const pattern = BOS_FIELD_PATTERNS[section];\n  if (!pattern) return [];\n\n  const slots = [];\n\n  if (section === 'combine') {\n    // Combine: iterate positions and slots\n    for (let pos = 1; pos <= pattern.maxPositions; pos++) {\n      for (let slot = 1; slot <= pattern.maxSlotsPerPosition; slot++) {\n        const data = extractSlotData(systemDetails, section, pos, slot);\n        if (data.equipment_type) {\n          slots.push({ ...data, position: pos });\n        }\n      }\n    }\n  } else {\n    // Standard sections: iterate slots\n    const maxSlots = pattern.maxSlots;\n    for (let slot = 1; slot <= maxSlots; slot++) {\n      const data = extractSlotData(systemDetails, section, systemNumber, slot);\n      if (data.equipment_type) {\n        slots.push(data);\n      }\n    }\n  }\n\n  return slots;\n};\n\n/**\n * Find next available slot number for a section\n * @param {Object} systemDetails - System details from API\n * @param {string} section - BOS section type\n * @param {number} systemNumber - System number (1-4)\n * @param {number} position - Position number (for combine BOS only)\n * @returns {number|null} Next available slot number, or null if full\n */\nexport const getNextSlotNumber = (systemDetails, section, systemNumber, position = null) => {\n  const pattern = BOS_FIELD_PATTERNS[section];\n  if (!pattern) return null;\n\n  if (section === 'combine') {\n    // For combine, check slots within a specific position\n    const maxSlots = pattern.maxSlotsPerPosition;\n    for (let slot = 1; slot <= maxSlots; slot++) {\n      const { fields } = generateSlotFields(section, position, slot);\n      if (!systemDetails?.[fields.equipment_type]) {\n        return slot;\n      }\n    }\n  } else {\n    // For standard sections, check slots within system\n    const maxSlots = pattern.maxSlots;\n    for (let slot = 1; slot <= maxSlots; slot++) {\n      const { fields } = generateSlotFields(section, systemNumber, slot);\n      if (!systemDetails?.[fields.equipment_type]) {\n        return slot;\n      }\n    }\n  }\n\n  return null; // All slots full\n};\n\n/**\n * Build payload for creating/updating a BOS slot\n * @param {string} section - BOS section type\n * @param {number} systemNumber - System number (1-4) or position for combine\n * @param {number} slotNumber - Slot number\n * @param {Object} equipmentData - Equipment data to save\n * @returns {Object} Payload for API PATCH request\n */\nexport const buildSlotPayload = (section, systemNumber, slotNumber, equipmentData) => {\n  const { prefix, fields } = generateSlotFields(section, systemNumber, slotNumber);\n  const pattern = BOS_FIELD_PATTERNS[section];\n  const payload = {};\n\n  // Core equipment fields\n  payload[fields.equipment_type] = equipmentData.equipmentType || equipmentData.equipment_type;\n  payload[fields.make] = equipmentData.make;\n  payload[fields.model] = equipmentData.model;\n  payload[fields.amp_rating] = equipmentData.ampRating || equipmentData.amp_rating;\n\n  // New/Existing handling\n  if (section === 'combine') {\n    payload[fields.existing] = !equipmentData.isNew;\n    payload[fields.position] = 'POST COMBINE';\n  } else {\n    payload[fields.is_new] = equipmentData.isNew ?? true;\n  }\n\n  // Trigger field (if applicable)\n  if (pattern.hasTrigger && fields.trigger) {\n    payload[fields.trigger] = pattern.triggerValue(systemNumber);\n  }\n\n  // Active field (if applicable)\n  if (pattern.hasActive && fields.active) {\n    payload[fields.active] = true;\n  }\n\n  // Block name (if applicable)\n  if (fields.block_name) {\n    payload[fields.block_name] = equipmentData.blockName || pattern.defaultBlockName;\n  }\n\n  return payload;\n};\n\n/**\n * Build payload for clearing a BOS slot (delete)\n * @param {string} section - BOS section type\n * @param {number} systemNumber - System number (1-4) or position for combine\n * @param {number} slotNumber - Slot number\n * @returns {Object} Payload to clear all fields\n */\nexport const buildClearPayload = (section, systemNumber, slotNumber) => {\n  const { fields } = generateSlotFields(section, systemNumber, slotNumber);\n  const pattern = BOS_FIELD_PATTERNS[section];\n  const payload = {};\n\n  // Clear all fields to null/defaults\n  payload[fields.equipment_type] = null;\n  payload[fields.make] = null;\n  payload[fields.model] = null;\n  payload[fields.amp_rating] = null;\n\n  if (section === 'combine') {\n    payload[fields.existing] = null;\n    payload[fields.position] = null;\n  } else {\n    payload[fields.is_new] = true; // Reset to default\n    if (pattern.hasTrigger && fields.trigger) {\n      payload[fields.trigger] = null;\n    }\n    if (pattern.hasActive && fields.active) {\n      payload[fields.active] = false;\n    }\n    if (fields.block_name) {\n      payload[fields.block_name] = null;\n    }\n  }\n\n  return payload;\n};\n\n/**\n * Get field count for a section\n * @param {string} section - BOS section type\n * @returns {number} Number of fields per slot\n */\nexport const getFieldCount = (section) => {\n  const pattern = BOS_FIELD_PATTERNS[section];\n  return pattern?.fields?.length || 0;\n};\n\n/**\n * Check if a section supports drag-and-drop reordering\n * @param {string} section - BOS section type\n * @returns {boolean} True if draggable\n */\nexport const isDraggableSection = (section) => {\n  const pattern = BOS_FIELD_PATTERNS[section];\n  return pattern?.isDraggable === true;\n};\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\utils\\bosSlotCompactor.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\utils\\bosTriggerUtils.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\utils\\combineSystemsHelpers.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\utils\\constants.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\utils\\powerWallDetection.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\utils\\sectionDirtyCheck.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\utils\\serviceWorkerRegistration.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\utils\\stringingCalculations.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getStringingSpecs' is defined but never used.","line":7,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":20},{"ruleId":"no-unused-vars","severity":1,"message":"'getMaxBranches' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Stringing Calculation Utilities\n * Auto-calculation logic for distributing panels across branches\n */\n\nimport {\n  getStringingSpecs,\n  getMaxBranches,\n  isDualQtyManufacturer\n} from './stringingConstants';\n\n// ============================================\n// STANDARD MICROINVERTER CALCULATIONS (Enphase)\n// ============================================\n\n/**\n * Calculate max panels per branch for standard microinverters\n * Based on 20A branch circuit / (max_cont_output_amps Ã— 1.25 safety factor)\n *\n * @param {number} maxContOutputAmps - Microinverter max continuous output amps\n * @returns {number} - Maximum panels allowed per branch\n *\n * Example: IQ8PLUS-72-2-US has 1.21A\n * 20 / (1.21 Ã— 1.25) = 20 / 1.5125 = 13.22 â†’ 13 panels max\n */\nexport const calculateMaxPanelsPerBranch = (maxContOutputAmps) => {\n  if (!maxContOutputAmps || maxContOutputAmps <= 0) {\n    return 20; // Default fallback\n  }\n  return Math.floor(20 / (maxContOutputAmps * 1.25));\n};\n\n/**\n * Auto-distribute panels across branches for standard micros (1:1 ratio)\n *\n * @param {number} totalPanels - Total solar panels to distribute\n * @param {number} maxPanelsPerBranch - Max panels per branch\n * @param {number} maxBranches - Max available branches\n * @returns {Array} - Array of branch objects with panel quantities\n */\nexport const distributeStandardMicros = (totalPanels, maxPanelsPerBranch, maxBranches) => {\n  const branches = [];\n  let remainingPanels = totalPanels;\n\n  for (let i = 0; i < maxBranches && remainingPanels > 0; i++) {\n    const panelsThisBranch = Math.min(remainingPanels, maxPanelsPerBranch);\n\n    branches.push({\n      branchIndex: i + 1,\n      panelQty: panelsThisBranch,\n      microQty: panelsThisBranch, // 1:1 ratio\n      isNew: true,\n    });\n\n    remainingPanels -= panelsThisBranch;\n  }\n\n  return {\n    branches,\n    totalPanelsAssigned: totalPanels - remainingPanels,\n    remainingPanels,\n    isComplete: remainingPanels === 0,\n  };\n};\n\n// ============================================\n// DUAL-QTY MICROINVERTER CALCULATIONS (Hoymiles/APSystems)\n// ============================================\n\n/**\n * Calculate microinverter distribution for Hoymiles/APSystems\n * These have multi-panel microinverters (2:1, 4:1 ratios)\n *\n * @param {number} totalPanels - Total solar panels\n * @param {object} specs - Stringing specs from constants\n * @param {number} maxBranches - Max branches from combiner panel\n * @returns {object} - Distribution object with branches and micro assignments\n *\n * Example: 26 panels with HMS-1600-4T-NA (4:1 ratio, max 4 micros/branch)\n * - Total micros needed: ceil(26 / 4) = 7 micros\n * - Branch 1: 4 micros (16 panels)\n * - Branch 2: 3 micros (10 panels)\n */\nexport const calculateDualQtyDistribution = (totalPanels, specs, maxBranches) => {\n  if (!specs || !totalPanels || totalPanels <= 0) {\n    return null;\n  }\n\n  // Parse ratio (e.g., \"4:1\" â†’ 4)\n  const ratio = parseInt(specs.panelRatio.split(':')[0], 10);\n  const maxMicrosPerBranch = specs.maxUnitsBranch;\n  const maxPanelsPerBranch = specs.maxPanelsBranch;\n\n  // Step 1: Calculate total microinverters needed\n  const totalMicros = Math.ceil(totalPanels / ratio);\n\n  // Step 2: Distribute microinverters across branches\n  const branches = [];\n  let remainingMicros = totalMicros;\n  let remainingPanels = totalPanels;\n\n  for (let b = 0; b < maxBranches && remainingMicros > 0; b++) {\n    const microsThisBranch = Math.min(remainingMicros, maxMicrosPerBranch);\n\n    // Calculate panels for this branch (limited by max panels per branch)\n    let panelsThisBranch = microsThisBranch * ratio;\n    panelsThisBranch = Math.min(panelsThisBranch, remainingPanels, maxPanelsPerBranch);\n\n    branches.push({\n      branchIndex: b + 1,\n      microQty: microsThisBranch,\n      panelQty: panelsThisBranch,\n      isNew: true,\n    });\n\n    remainingMicros -= microsThisBranch;\n    remainingPanels -= panelsThisBranch;\n  }\n\n  // Step 3: Calculate individual micro panel assignments (granular tracking)\n  const microAssignments = [];\n  let panelsLeft = totalPanels;\n\n  for (let m = 0; m < totalMicros && m < 25; m++) {\n    const panelsThisMicro = Math.min(panelsLeft, ratio);\n    microAssignments.push({\n      microIndex: m + 1,\n      panelCount: panelsThisMicro,\n    });\n    panelsLeft -= panelsThisMicro;\n  }\n\n  return {\n    totalMicros,\n    totalPanels,\n    ratio,\n    maxMicrosPerBranch,\n    maxPanelsPerBranch,\n    branches,\n    microAssignments,\n    totalPanelsAssigned: totalPanels - remainingPanels,\n    remainingPanels,\n    isComplete: remainingPanels === 0,\n    specs,\n  };\n};\n\n// ============================================\n// STRING INVERTER CALCULATIONS\n// ============================================\n\n/**\n * Calculate string distribution for standard inverters\n * Distributes panels across inputs (formerly MPPTs)\n *\n * @param {number} totalPanels - Total solar panels\n * @param {number} maxInputs - Max inputs on the inverter (from max_strings_branches)\n * @param {number} stringsPerInput - Strings per input (1 or 2)\n * @param {number} maxPanelsPerString - Max panels per string (voltage limited)\n * @returns {object} - Distribution across inputs\n */\nexport const calculateInverterInputDistribution = (\n  totalPanels,\n  maxInputs,\n  stringsPerInput = 1,\n  maxPanelsPerString = 15\n) => {\n  const maxPanelsPerInput = stringsPerInput * maxPanelsPerString;\n  const inputs = [];\n  let remainingPanels = totalPanels;\n\n  for (let i = 0; i < maxInputs && remainingPanels > 0; i++) {\n    const panelsThisInput = Math.min(remainingPanels, maxPanelsPerInput);\n\n    inputs.push({\n      inputIndex: i + 1,\n      strings: stringsPerInput,\n      panelQty: panelsThisInput,\n      isNew: true,\n    });\n\n    remainingPanels -= panelsThisInput;\n  }\n\n  return {\n    inputs,\n    totalPanelsAssigned: totalPanels - remainingPanels,\n    remainingPanels,\n    isComplete: remainingPanels === 0,\n  };\n};\n\n// ============================================\n// VALIDATION UTILITIES\n// ============================================\n\n/**\n * Validate branch/input configuration\n * @param {Array} branches - Array of branch configurations\n * @param {number} totalPanels - Expected total panels\n * @returns {object} - Validation result\n */\nexport const validateStringingConfig = (branches, totalPanels) => {\n  const assignedPanels = branches.reduce((sum, b) => sum + (parseInt(b.panelQty) || 0), 0);\n  const remaining = totalPanels - assignedPanels;\n\n  return {\n    isValid: remaining === 0,\n    assignedPanels,\n    remainingPanels: remaining,\n    overAssigned: remaining < 0,\n    underAssigned: remaining > 0,\n    message: remaining === 0\n      ? 'All panels assigned'\n      : remaining > 0\n        ? `${remaining} panels remaining`\n        : `${Math.abs(remaining)} panels over-assigned`,\n  };\n};\n\n/**\n * Get stringing mode based on inverter type and manufacturer\n * @param {string} inverterType - 'microinverter' or 'inverter'\n * @param {string} manufacturer - Manufacturer name\n * @returns {string} - 'standard', 'dual-qty', or 'inverter-input'\n */\nexport const getStringingMode = (inverterType, manufacturer) => {\n  if (inverterType === 'inverter') {\n    return 'inverter-input';\n  }\n\n  if (isDualQtyManufacturer(manufacturer)) {\n    return 'dual-qty';\n  }\n\n  return 'standard';\n};\n\n// ============================================\n// VOLTAGE AND CURRENT VALIDATION\n// ============================================\n\n/**\n * Calculate string voltage at coldest temperature\n * @param {number} panelsPerString - Number of panels in string\n * @param {number} panelVoc - Panel open circuit voltage (STC)\n * @param {number} tempCoeffVoc - Temperature coefficient of Voc (%/Â°C), typically negative\n * @param {number} minTemp - Minimum expected temperature (Â°C), default -10\n * @returns {number} - String Voc at coldest temp\n */\nexport const calculateStringVoltage = (panelsPerString, panelVoc, tempCoeffVoc = -0.3, minTemp = -10) => {\n  // Voc increases as temperature decreases (tempCoeff is negative)\n  const tempDelta = minTemp - 25; // STC is 25Â°C\n  const vocCold = panelVoc * (1 + (tempCoeffVoc / 100) * tempDelta);\n  return panelsPerString * vocCold;\n};\n\n/**\n * Validate string voltage against inverter max\n * @param {number} stringVoltage - Calculated string voltage\n * @param {number} inverterMaxVdc - Inverter maximum DC voltage\n * @returns {object} - Validation result\n */\nexport const validateStringVoltage = (stringVoltage, inverterMaxVdc) => {\n  const isValid = stringVoltage <= inverterMaxVdc;\n  const margin = inverterMaxVdc - stringVoltage;\n  const percentUsed = (stringVoltage / inverterMaxVdc) * 100;\n\n  return {\n    isValid,\n    stringVoltage: Math.round(stringVoltage * 10) / 10,\n    maxVoltage: inverterMaxVdc,\n    margin: Math.round(margin * 10) / 10,\n    percentUsed: Math.round(percentUsed),\n    message: isValid\n      ? `${Math.round(percentUsed)}% of max voltage`\n      : `Exceeds max by ${Math.abs(Math.round(margin))}V`,\n  };\n};\n\n/**\n * Calculate string current\n * @param {number} panelIsc - Panel short circuit current\n * @param {number} stringsParallel - Number of parallel strings (1 or 2)\n * @returns {number} - Combined string current with 125% safety factor\n */\nexport const calculateStringCurrent = (panelIsc, stringsParallel = 1) => {\n  return panelIsc * stringsParallel * 1.25;\n};\n\n/**\n * Validate string current against input max\n * @param {number} stringCurrent - Calculated string current\n * @param {number} inputMaxIsc - Input maximum short circuit current\n * @returns {object} - Validation result\n */\nexport const validateStringCurrent = (stringCurrent, inputMaxIsc) => {\n  const isValid = stringCurrent <= inputMaxIsc;\n\n  return {\n    isValid,\n    stringCurrent: Math.round(stringCurrent * 100) / 100,\n    maxCurrent: inputMaxIsc,\n    message: isValid\n      ? `${Math.round((stringCurrent / inputMaxIsc) * 100)}% of max current`\n      : `Exceeds max by ${(stringCurrent - inputMaxIsc).toFixed(2)}A`,\n  };\n};\n","usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\utils\\stringingConstants.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\utils\\stringingFieldMapping.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\utils\\stringingUtils.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]},{"filePath":"C:\\Users\\logan\\Skyfire_WebApp\\src\\utils\\triggerPlanAutomation.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"dot-location","replacedBy":[]},{"ruleId":"new-parens","replacedBy":[]},{"ruleId":"no-mixed-operators","replacedBy":[]},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"]},{"ruleId":"no-whitespace-before-property","replacedBy":[]},{"ruleId":"rest-spread-spacing","replacedBy":[]}]}]
ESLint found too many warnings (maximum: 0).
